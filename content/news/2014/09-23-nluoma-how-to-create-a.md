---
title: "How to Create an Open Approvals Reminder Email"
date: 2014-09-22T22:34:46.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=a98ce6e1dbd0dbc01dcaf3231f961927"
---
<p>On a project I am currently working on, the business users receive approvals at certain points in the workflow. They are very busy, and sometimes the process of deciding if they can approve or reject a step takes a while. They wanted to make sure that the approvals didn't get forgotten, and asked me to create a regular report that would list all the items they needed to approve.</p><p>I first tried doing this with a report that showed all of the projects open approvals, but they quickly vetoed that--they only wanted to see their own approvals, and not get bogged down trying to figure out if anything in the report applied to them.</p><p>Instead, we now send out an individualized notification to any business users who may have approvals that are still pending.</p><h2>What You Need</h2><p>To replicate this process, you will need three pieces: an event, a scheduled job that will generate the event, and a notification that will be sent out when the event is generated.</p><p><em>Note: I created the screen shots and the Update Set using the current ServiceNow Sandbox, running Eureka. However, I developed the tool originally using our instance, which is running Dublin. Also, I used the Change module when duplicating this rather than my custom application.<br/></em></p><h3>Create Your Event</h3><ol><li>Go to <strong>System Policy | Events | Registry</strong>.</li><li>Click <strong>New</strong> to create a new Event.<br/><img  alt="approvals1.png" class="image-0 jive-image" src="03f95842db5c17041dcaf3231f9619f6.iix" style="height: auto;"/></li><li>Enter your event information.<br/><img  alt="Approvals2.png" class="image-1 jive-image" src="b849373ddb545704ed6af3231f96191a.iix" style="height: 178px; width: 620px;"/></li></ol><h3>Create Your Scheduled Job</h3><ol><ol><li>Go to <strong>System Definition | Scheduled Jobs</strong>.<br/><img  alt="Approvals3.png" class="jive-image image-2" height="438" src="81f5a906dbd0df048c8ef4621f96195d.iix" style="height: 438px; width: 169.352px;" width="169"/></li><li>Click <strong>New</strong> to launch the Automation Creator.</li><li>Click <strong>Automatically run a script of your choosing</strong>.<br/><img  alt="Approvals4.png" class="jive-image image-3" src="62510d42db50130468c1fb651f9619c7.iix" style="height: 187px; width: 620px;"/></li><li>Enter a name and when you want the script to run. For this example, we'll go with daily at 8:00 a.m.<br/><img  alt="Approvals5.png" class="jive-image image-4" src="2fafdc0edb5c1f048c8ef4621f961954.iix" style="height: 231px; width: 620px;"/></li><li>Enter the following script:</li></ol></ol><p>var arrUtil = new ArrayUtil();                                                                   //set up array to find all pending approvals for users</p><p>var answer = [];</p><p>var app = new GlideRecord('sysapproval_approver');                           //set up variable to retrieve approvals that are pending</p><p>app.addQuery('state','requested');                                                           //only retrieve approvals if they are pending (in requested state)</p><p>app.addQuery('sysapproval.sys_class_name', 'change_request');     //only retrieve approvals for change records</p><p>app.orderBy('approver');</p><p>app.query(); //retrieve all approvals that meet our query</p><p>while(app.next()){ // step through the approvals one by one</p><p>if (arrUtil.indexOf(answer, app.approver.sys_id)==-1) {                 //if the approver is not currently in our list, add them (next line adds them)</p><p>answer.push(app.approver.sys_id);</p><p>}</p><p>}</p><p></p><p>for (var i = 0; i &lt; answer.length; i++) {                                             //have array that lists each user who has open change approvals We'll step through each</p><p>gs.eventQueue('open.approval.reminders', app, answer[i]);             //and fire off the event for each user, passing their sys_id as parm1</p><p>}</p><p></p><ol><li>Click <strong>Submit</strong>.</li></ol><h3>Create Your Notification</h3><ol><ol><ol><ol><li>Go to <strong>System Policy|Notifications</strong>.</li><li>Click New to create a new notification.<br/><img  alt="Approvals6.png" class="jive-image image-5" src="78608846db58d3049c9ffb651f9619d7.iix" style="height: 110px; width: 620px;"/></li><li>In Eureka, I needed to click the Advanced view Related Link to see all the options I needed.<br/><img  alt="Approvals7.png" class="jive-image image-6" src="e892650edb9c13043eb27a9e0f96194a.iix" style="height: 374px; width: 620px;"/></li><li>Enter your information for the notification.<br/><img  alt="Approvals8.png" class="jive-image image-7" src="9fe0018edb9c9344e9737a9e0f96199b.iix" style="height: 104px; width: 620px;"/></li><li>Enter when to send the notification.<br/><img  alt="Approvals9.png" class="jive-image image-8" src="da9c108edb1c9fc068c1fb651f9619a4.iix" style="height: 119px; width: 620px;"/></li><li>Parm1 contains the person who should receive the email, so on the Who will receive tab, check that option.<br/><img  alt="Approvals10.png" class="jive-image image-9" src="3cdd77f5db14db048c8ef4621f961950.iix" style="height: 171px; width: 620px;"/></li><li>Finally, you will use a mail script to retrieve the current user, then browse through all the changes for that person and list the relevant information for them. If you are using Dublin (or earlier) the mail script goes on the Message HTML field, enclosed by &lt;mail_script&gt;…&lt;/mail_script&gt;<br/>If you are on Eureka, you will create a mail script, then put the link in the form ${mail_script:scriptname} in the Message HTML field.</li><li>e="margin: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt;"&gt;Here is the script:</li></ol></ol></ol></ol><p></p><p>//First, we need to locate our current user's approvals (the parm1 variable contains the current approver)</p><p>var app = new GlideRecord('sysapproval_approver');<span style="mso-spacerun: yes;">                           //create a query to retrieve open approvals</span></p><p>app.addQuery('state','requested');                                                                             //only retrieve approvals that are pending</p><p>app.addQuery('approver',event.parm1);                                                             //only find approvals for the current approver</p><p>app.addQuery('sysapproval.sys_class_name','change_request');                     //only find approvals for change reqeusts</p><p>app.query();</p><p>while(app.next()){</p><p>//now that we have an approval for that user, we are going to look up the change tickets they need to approve and print out the data</p><p>var chg = new GlideRecord('change_request');                                     //find the first related Change approval and print info</p><p>chg.get(app.sysapproval);</p><p>template.print('&lt;p&gt;You have an open change approval for ' + chg.number + '&lt;/br&gt;');</p><p>template.print('Change Short Description ' + chg.short_description + '.&lt;/p&gt;');</p><p>}</p><p></p><p></p><p>Here are the previews of the resulting emails:</p><p><img  alt="email1.png" class="image-10 jive-image" src="70b0618edb9c1b04ed6af3231f96191b.iix" style="height: auto;"/></p><p><img  alt="email2.png" class="jive-image image-11" src="0f4df40adb1013043eb27a9e0f9619a1.iix" style="height: auto;"/></p>