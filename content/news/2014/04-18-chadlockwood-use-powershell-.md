---
title: "Use PowerShell to unblock all files in the MID server agent folder"
date: 2014-04-17T23:09:26.000Z
authors: ["chadlockwood"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=53bd2ea9dbd0dbc01dcaf3231f96198b"
---
<p class="p1"><span class="s1">Suppose you downloaded the MID server zip file on a Windows Server 2008 R2 or earlier that was running PowerShell version 2(aka, <em>NOT version 3 or 4</em>). Now I would never make this mistake, but suppose you forgot to right-click that zip file, go to Properties, then click Unblock. Then suppose you extracted all the files, made changes to config files and installed your shiny new MID server, without unblocking all the files; also <em>NOT</em> a mistake I would make but for the sake of argument… Since the MID server service will run and the MID server will appear in your instance as Up/Green, you might not notice until you run Discovery or Orchestration. PowerShell will see those blocked PS1 files and stop cold. Fortunately, included in PowerShell version 3 and later is a cmdlet called Unblock-File. You can simply get a file or a group of files, pipe to Unblock-File, and Viola!</span></p><p class="p1"><span class="s1"><br/></span></p><p class="p2"></p><p class="p3"><span style="font-family: 'courier new', courier;">Get-ChildItem C:\temp -Recurse | Unblock-File</span></p><p class="p3"><span style="font-family: 'courier new', courier;"><br/></span></p><p class="p2"></p><p class="p1"><span class="s1"><strong>But…</strong>You don't have version 3 or later, so no Viola for you. Fear not! There is still hope and not in the form of right-clicking and unblocking all 895 files in the agent folder individually.</span></p><p class="p1"><span class="s1"><br/></span></p><p class="p2"></p><p class="p1"><span class="s1">Quickly get to your real admin machine that <strong>IS</strong> running PowerShell version 3 or later.</span></p><p class="p1"><span class="s1">Create a new PSDrive to the remote machine</span></p><p class="p1"><span class="s1"><br/></span></p><p class="p2"></p><p class="p3"><span style="font-family: 'courier new', courier;">PS C:\Windows\system32&gt; New-PSDrive -Root \\remoteserver\c$\SN_Dev\agent -Name blockedfiles -PSProvider FileSystem</span></p><p class="p4"></p><p class="p1"><span class="s1"><br/></span></p><p class="p1"><span class="s1">Change your directory to the new PSDrive</span></p><p class="p1"><span class="s1"><br/></span></p><p class="p2"></p><p class="p3"><span style="font-family: 'courier new', courier;">PS C:\Windows\system32&gt; cd blockedfiles:</span></p><p class="p4"></p><p class="p1"><span class="s1"><br/></span></p><p class="p1"><span class="s1">You should now be able to list the PSDrive contents</span></p><p class="p1"><span class="s1"><br/></span></p><p class="p2"></p><p class="p3"><span style="font-family: 'courier new', courier;">PS blockedfiles:\&gt; ls</span></p><p class="p4"></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">       Directory: \\remoteserver\c$\SN_Dev\agent</span></p><p class="p4"></p><p class="p4"></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">Mode                               LastWriteTime         Length Name                                                                   </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">----                               -------------         ------ ----                                                                   </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">d----                 4/10/2014     3:03 PM                       bin                                                                     </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">d----                 4/10/2014     3:03 PM                       conf                                                                   </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">d----                 4/10/2014     3:03 PM                       etc                                                                     </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">d----                 4/10/2014     3:31 PM                       extlib                                                               </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">d----                 4/10/2014     3:03 PM                       jre                                                                     </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">d----                 4/10/2014     3:04 PM                       lib                                                                     </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">d----                 4/10/2014     3:04 PM                       licenses                                                           </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">d----                 4/16/2014   10:52 AM                       logs                                                                   </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">d----                 4/10/2014     3:03 PM                       package                                                             </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">d----                 4/10/2014     3:03 PM                       properties                                                       </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">d----                 4/10/2014     3:32 PM                       work                                                                   </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">-a---                 4/10/2014     3:49 PM             5899 config.xml                                                       </span></p><p class="p3"><span class="s1" style="font-family: 'courier new', courier;">-a---                 4/10/2014     3:03 PM                 17 start.bat                                                         </span></p><p class="p3"><span style="font-family: 'courier new', courier;">-a---                 4/10/2014     3:03 PM                 16 start.sh                                                           </span></p><p class="p1"><span style="font-family: 'courier new', courier;">-a---                 4/10/2014     3:03 PM                 16 stop.bat                                                           </span></p><p class="p1"><span style="font-family: 'courier new', courier;">-a---                 4/10/2014     3:03 PM                 15 stop.sh</span></p><p class="p2"></p><p class="p3"><span class="s1"><br/></span></p><p class="p3"><span class="s1">Use Get-ChildItem to get the contents of the agent folder and pipe those files to the Unblock-File cmdlet</span></p><p class="p2"></p><p class="p1"><span class="s1"><br/></span></p><p class="p1"><span style="font-family: 'courier new', courier;">PS blockedfiles:\&gt; Get-ChildItem -Recurse | Unblock-File</span></p><p class="p2"></p><p class="p3"><span class="s1"><br/></span></p><p class="p3"><span class="s1">And now you get your very own <strong>Viola!</strong></span></p><p class="p3"><span class="s1"><strong><br/></strong></span></p><p class="p2"></p><p class="p3"><span class="s1">Make sure to change drives and remove your PSDrive when you are finished</span></p><p class="p3"><span class="s1"><br/></span></p><p class="p2"></p><p class="p1"><span style="font-family: 'courier new', courier;">PS blockedfiles:\&gt; cd c:</span></p><p class="p1"><span style="font-family: 'courier new', courier;">PS C:\Windows\system32&gt; Remove-PSDrive -Name blockedfiles</span></p>