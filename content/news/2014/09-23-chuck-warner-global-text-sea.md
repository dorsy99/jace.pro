---
title: "Global Text Search Suggestions"
date: 2014-09-23T01:06:51.000Z
authors: ["chuck.warner"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=9cac2225dbd0dbc01dcaf3231f9619e4"
---
<p>Ever wonder how ServiceNow decides what <a class="jive-link-external-small" href="http://wiki.servicenow.com/index.php?title=Using_Global_Text_Search#Search_Suggestions" rel="nofollow" target="_blank"><span style="color: #4297cb;">search items are suggested in the </span><span style="color: #4297cb;">global text search</span></a> field when you start typing? There are a couple of prevailing theories. The first is that data elves appear at midnight and begin furiously cobbling statistics together and then infuse them with pixie dust so that they are magically attached to the search box. Or it could just be a simple ol' scheduled job.</p><p><a _jive_internal="true" href="/servlet/JiveServlet/showImage/38-3481-13953/data_search.png"><img  alt="data_search.png" class="image-0 jive-image" height="99" src="433e7ccedb501b04ed6af3231f9619c1.iix" style="height: auto; display: block; margin-left: auto; margin-right: auto;" width="297"/></a></p><p style="min-height: 8pt; height: 8pt; padding: 0px;">  </p><p>To begin, every text search a user does is captured in a table called text_search. And yes, this really is EVERY search; including those overly colorful search terms that your users think they are being funny with, or perhaps the user was having one of those slightly disgruntled sort of days and decide to take it out on your instance. Each night the "TS Search Stats" scheduled job (sys_trigger record) then calls our TSSearchStatistician java code to populate the ts_search_stats table. Now while you can take a look at the records that are in the text_search table you will not be able to see the records in ts_search_stats. We do that on purpose because we want to keep the magic alive. If we let you see all our secrets where would the mystery be?</p><p style="min-height: 8pt; height: 8pt; padding: 0px;">  </p><p>The scheduled job begins by looking at all the records that fall into the stat search window, which is controlled by the glide.ts.search_stat_window system property. If there is no property in the instance or no value is specified for that property it defaults to 365 days. The job does an aggregate query within the date range and orders the results by search term and then adds records to the ts_search_stats table accordingly.</p><p style="min-height: 8pt; height: 8pt; padding: 0px;">  </p><h5>When your users type into the text search box it runs a search against the ts_search_stats table as follows:</h5><p style="min-height: 8pt; height: 8pt; padding: 0px;">  </p><ul><li>The search_term column starts with the characters the user entered</li><li>The mean_hits column value is greater than zero</li></ul><p style="min-height: 8pt; height: 8pt; padding: 0px;">  </p><p>The results are then ordered by:</p><ul><li>search_count</li><li>mean_hits</li><li>search_term</li><li>Listed by what the maximum # of choices is set to (glide.xmlhttp.max_choices system property).</li></ul><p style="min-height: 8pt; height: 8pt; padding: 0px;">  </p><p>And voila: search suggestions aplenty!. I still have not completely ruled out data elves but am waiting for the first ServiceNow system admin to post a selfie with one of them to the internet. Until then, I am going with dull scheduled job theory. Perhaps one of your admins will camp out by your instance overnight and make the discovery and join the ranks of those pursuing Big Foot, the Loch Ness Monster, and Elvis sightings. Nessie lives!</p>