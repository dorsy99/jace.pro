---
title: "After upgrading to ADFS  this option does not work internally and externally"
date: 2014-11-03T21:45:17.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=0b8de669dbd0dbc01dcaf3231f9619f7"
---
<p><span style="color: #544436; background: white; font-size: 10pt; font-family: arial, helvetica, sans-serif;">Working for 2 years with ADFS 2.0 and ServiceNow and trying to upgrade to ADFS 2012 R2 (alias ADFS 3.0) and currently running fine internally and externally. </span><span style="color: #544436; font-size: 10pt; font-family: arial, helvetica, sans-serif;"><span style="background: white;">We chose this option as we had a third party product with ADFS to allow email as logon ID.</span><br/> <br/> Â  <span style="background: white;">Now, </span><span style="background: white;">After upgrading to ADFS 3.0 this option does not work internally and externally. This is now a pure vanilla Microsoft only environment as ADFS 3 allows email as logon ID. </span></span></p><p><span style="font-size: 10pt; font-family: arial, helvetica, sans-serif;"><span style="color: #544436; background: white;"><br/></span></span></p><p><span style="font-size: 10pt; font-family: arial, helvetica, sans-serif; color: #544436;"><span style="background: white;"> If we try .</span> <br/> <span style="background: white;"><strong>setAuthnContextClassRef("urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport") </strong></span><br/> <br/> <span style="background: white;">it works externally but not internally, and </span> <br/> <span style="background: white;">- If we try . </span> <br/> <span style="background: white;"><strong>setAuthnContextClassRef("urn:federation:authentication:windows") </strong></span><br/> <br/> <span style="background: white;">it works internally but not externally </span> <br/> <span style="background: white;">We need some option set that will work both ways and since ADFS 3.0 is nearly 10 months old this hopefully is not a new problem </span></span></p><p><span style="color: #544436; font-size: 10pt; background: white; font-family: arial, helvetica, sans-serif;"><br/></span></p><p><span style="color: #544436; font-size: 8.0pt; background: white; font-family: 'Arial','sans-serif';"><span style="font-size: 10pt; font-family: arial, helvetica, sans-serif;">Has anyone experienced this issue with ADFS 3.0 and ServiceNow, and does anyone know of a solution or work around? Thanks for any assistance you can provide!</span><br/></span></p>