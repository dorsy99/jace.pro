---
title: "Resolving ODBC driver and Microsoft SQL Linked Server issues"
date: 2014-11-26T03:17:52.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=e6cca265dbd0dbc01dcaf3231f961972"
---
<p><span style="color: #485563; font-family: arial;">You can use the ServiceNow ODBC driver in SQL Server (2008 and 2012) as a linked server. This enables the SQL Server to query tables from a ServiceNow instance directly using the ODBC driver. However, if you i</span><span style="color: #485563; font-family: arial; font-size: 10pt; line-height: 1.5em;">ntegrate the ODBC driver with Microsoft SQL Linked Server, you may receive an error containing<span style="color: #485563; font-family: arial;"> "MSDASQL" and </span>related to one of the following:</span></p><ul><li><span style="color: #485563; font-family: arial; font-size: 10pt; line-height: 1.5em;"> obtaining the required interface</span></li><li><span style="color: #485563; font-family: arial; font-size: 10pt; line-height: 1.5em;">creating an instance of OLE DB provider</span></li><li><span style="color: #485563; font-family: arial; font-size: 10pt; line-height: 1.5em;">initializing the data source object</span></li></ul><p><span style="color: #485563; font-family: arial; font-size: 10pt; line-height: 1.5em;">T</span><span style="color: #485563; font-family: arial; font-size: 10pt; line-height: 1.5em;">he result is that the ODBC driver is unable to access the application logs or file cache. <span style="color: #485563; font-family: arial;">For a list of exact error message text, see </span><a class="jive-link-external-small" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0546265" rel="nofollow" target="_blank"><span style="color: #0000ff; text-decoration: underline;">Resolving Linked Server Access Errors with ODBC Driver</span></a><span style="color: #485563; font-family: arial;">. </span></span></p><p><span style="color: #485563; font-family: arial;"><br/></span></p><p><span style="color: #485563; font-family: arial;">T<span style="color: #485563; font-family: arial;">he </span><span style="color: #485563; font-family: 'courier new', courier;">%LOCALAPPDATA%</span><span style="color: #485563; font-family: arial;"> environment variable is used by the ODBC driver to specify the location of log files and cache. When using the iSQL console, t<span style="color: #485563; font-family: arial;">he </span><span style="color: #485563; font-family: 'courier new', courier;">%LOCALAPPDATA%</span><span style="color: #485563; font-family: arial;"> variable</span> is replaced with the user home directory, for example </span><span style="color: #485563; font-family: arial;"><em>C:\Users\&lt;user&gt;\AppData\Local</em></span><span style="color: #485563; font-family: arial;">. However, when running Microsoft SQL Server, </span></span><span style="font-size: 10pt; line-height: 1.5em; color: #485563; font-family: arial;">this variable is replaced with </span><span style="font-size: 10pt; line-height: 1.5em; color: #485563; font-family: arial;"><em>C:\Windows\System32\config\systemprofile\AppData\Local.</em></span><span style="font-size: 10pt; line-height: 1.5em; color: #485563; font-family: arial;"> Unlike the user local directory, the System32 local directory requires elevated privileges to access.</span></p><p style="min-height: 8pt; height: 8pt; padding: 0px;"> Â </p><h3>Resolving the issue</h3><p><span style="color: #485563; font-family: arial;"><br/></span></p><ol><li><span style="color: #485563; font-family: arial;"><span style="color: #485563; font-family: arial;">Modify the </span><span style="color: #485563; font-family: arial;"><strong>ServiceDebugLogPath</strong></span><span style="color: #485563; font-family: arial;"> ODBC driver configuration property to replace </span><span style="color: #485563; font-family: arial;"><strong>%LOCALAPPDATA%</strong></span><span style="color: #485563; font-family: arial;"> with </span><span style="color: #485563; font-family: arial;"><strong>${user.home} </strong></span><span style="color: #485563; font-family: arial;">as shown in the following screenshot</span>:<br/><a _jive_internal="true" href="/servlet/JiveServlet/showImage/38-3668-15894/ODBC_Microsoft_issue2.png"><img  alt="ODBC_Microsoft_issue2.png" class="image-1 jive-image" height="506" src="1b8eb7bddb141304b322f4621f96192b.iix" style="height: 370px; width: 620px;" width="849"/></a></span></li><li><span style="color: #485563; font-family: arial;"><span style="color: #485563; font-family: arial;">Modify the </span><span style="color: #485563; font-family: arial;"><strong>ServicesSQLDiskCachePath</strong></span><span style="color: #485563; font-family: arial;"> ODBC driver configuration property to replace </span><span style="color: #485563; font-family: arial;"><strong>%LOCALAPPDATA%</strong></span><span style="color: #485563; font-family: arial;"> with </span><span style="color: #485563; font-family: arial;"><strong>${user.home} </strong></span><span style="color: #485563; font-family: arial;">as shown in the following screenshot</span>:<br/><a _jive_internal="true" href="/servlet/JiveServlet/showImage/38-3668-15893/ODBC_Microsoft_issue1.png"><img  alt="ODBC_Microsoft_issue1.png" class="image-0 jive-image" height="506" src="01c1e842db1457041dcaf3231f961998.iix" style="height: 370px; width: 620px;" width="849"/></a></span></li></ol><p><span style="color: #485563; font-family: arial;"><br/></span></p><p><span style="color: #666666; font-family: arial, sans-serif;">ServiceNow offers more information about the ODBC driver and SQL Server:<br/></span></p><p><span style="color: #0000ff; font-family: arial, sans-serif; text-decoration: underline;"><a title="k-external-small" class="jive-link-external-small" href="http://wiki.servicenow.com/index.php?title=Using_ODBC_Driver_in_SQL_Server_2008_and_2012" rel="nofollow" target="_blank">Using ODBC Driver in SQL Server 2008 and 2012</a></span></p><p><span style="color: #485563; font-family: arial;"><a class="jive-link-external-small" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0546265" rel="nofollow" target="_blank"><span style="color: #0000ff; text-decoration: underline;">Resolving Linked Server Access Errors with ODBC Driver</span></a></span></p><p><span style="font-family: arial; text-decoration: underline;"><a class="jive-link-external-small" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0538992" rel="nofollow" target="_blank"><span style="color: #0000ff; text-decoration: underline;">Troubleshooting Linked Server</span></a></span></p><p><span style="font-family: arial; text-decoration: underline;"><span style="color: #0000ff; text-decoration: underline;"><a title="" _jive_internal="true" data-containerid="2927" data-containertype="37" data-objectid="3480" data-objecttype="38" href="/community?id=community_blog&sys_id=865da629dbd0dbc01dcaf3231f961935">Linked Server ODBC Driver Fix</a></span></span></p>