---
title: "Duplicate Record Scripts"
date: 2012-07-23T22:54:10.000Z
authors: ["mkaufman"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=446caaa1dbd0dbc01dcaf3231f961945"
---
<p><p><img src="http://i.imgur.com/iNZay.jpg" alt="Groups" width="150px" align='right' /><br /><br />Use a script to find any "duplicate" records within your ServiceNow application.<br /><!--break--><br /><br /><strong>Why would you need this?</strong><br /><br />One example might be duplicate user ids. Users may have duplicate user ids if the Transform Map is coalesced off another field other than User ID. This happens in corporate environments with multiple company mergers/partnerships where AD directories and user name rules are not combined or determined yet.<br /><br />Other times there might be a mistake in an import, customization mistake, or maybe you just need to find this out for a report. Regardless of the reason to find a "duplicate" record, these scripts may assist you.</p><br /><br /><strong>Find Duplicate Records with a Background Script</strong><br /><br />What I do to check for "duplicate" records most often is just to run a quick background script. This works great for testing your imports or helping find a permanent fix to an existing issue.<br /><br /><ol><li>Scripts â€” Background Example 1<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />getDuplicates();<br />function getDuplicates() {<br />   var dupRecords = [];<br />   var gaDupCheck1 = new GlideAggregate('sys_user');<br />   gaDupCheck1.addQuery('active','true');<br />   gaDupCheck1.addAggregate('COUNT', 'user_name');<br />   gaDupCheck1.addNotNullQuery('user_name');<br />   gaDupCheck1.groupBy('user_name');<br />   gaDupCheck1.addHaving('COUNT', '&gt;', 1);<br />   gaDupCheck1.query();<br />   while (gaDupCheck1.next()) {<br />      dupRecords.push(gaDupCheck1.user_name.toString());<br />   }<br />   gs.print(dupRecords);<br />}<br /></pre><br /></li><li>Scripts - Background Example 2<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />getDuplicates();<br />function getDuplicates() {<br />   var dupRecords = [];<br />   var gaDupCheck1 = new GlideAggregate('grc_control');<br />   gaDupCheck1.addQuery('active','true');<br />   gaDupCheck1.addAggregate('COUNT', 'control_id');<br />   gaDupCheck1.addNotNullQuery('control_id');<br />   gaDupCheck1.groupBy('control_id');<br />   gaDupCheck1.addHaving('COUNT', '&gt;', 1);<br />   gaDupCheck1.query();<br />   while (gaDupCheck1.next()) {<br />      dupRecords.push(gaDupCheck1.control_id.toString());<br />   }<br />   gs.print(dupRecords);<br />}<br /></pre><br /></li></ol><br /><strong>Find Duplicate Records with a Left Navigation Bar Link or Report</strong><br /><br />If you have a reoccuring duplicate record issue in your system, you can add a Left Navigation Bar link or a Report<br /><ol><li>Script Includes<br />Name: getDuplicateUsers<br />Client Callable: true<br />Return an array of<br />Script:<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />function getDuplicateUsers() {<br />   var dupRecords = [];<br />   var gaDupCheck1 = new GlideAggregate('sys_user');<br />   gaDupCheck1.addQuery('active','true');<br />   gaDupCheck1.addAggregate('COUNT', 'user_name');<br />   gaDupCheck1.addNotNullQuery('user_name');<br />   gaDupCheck1.groupBy('user_name');<br />   gaDupCheck1.addHaving('COUNT', '&gt;', 1);<br />   gaDupCheck1.query();<br />   while (gaDupCheck1.next()) {<br />      dupRecords.push(gaDupCheck1.user_name.toString());<br />   }<br />   return dupRecords;<br />}<br /><br /></pre></li><li>Module<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />Name: Active Duplicate User IDs<br />Application: user admin<br />Roles: admin<br />Order: 1200<br />Link Type: URL from Arguments<br />Arguments: sys_user_list.do?sysparm_query=user_name=javascript:getDuplicateUsers()<br /></pre><br /></li><li>Report<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />Name: Active Duplicate User IDs<br />Type: List<br />Visible to: Admin Group<br />Table: User [sys_user]<br />User ID is javascript:getDuplicateUsers()<br /></pre><br /></li></ol></p>