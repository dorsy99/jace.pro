---
title: "Managing Glide Lists"
date: 2012-03-11T08:13:38.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=a84daee5dbd0dbc01dcaf3231f96198e"
---
<p>A colleague of mine recently asked for some assistance in managing Glide List (glide_list) fields. I had written some scripts that were fairly task specific so I rewrote them as generic as possible and share them here.<br/><br/><br/><br/>Glide List fields are a field that can hold many reference values at a time (as opposed a reference field that holds just one value.) The most familiar example of a glide list is the Watch list field on the task table (incident, problem, change, etc.) However, this script works on any glide_list.<br/><img   alt="" class="jive-image" src="4a51990adb989f048c8ef4621f96193b.iix"/><br/><br/>Behind the scenes, the system is storing these values as comma separate sys_ids. Occasionally, it becomes necessary to manage the data in that field. For example, one might want to:</p><ul><li>Know if a user exists in the list</li><li>Add a new user to the list</li><li>Delete a user from the list</li></ul><p></p><p></p><p>For that, I created the following script include I call ListUtil. This is based on an example given at Knowledge 11. I added a _debug function and a generous amount of comments to describe each function.</p><p></p><p>To use the ListUtil class, create a new object and pass the field (values) you want to manage:</p><pre __default_attr="plain" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14628022962434701 jive_text_macro" data-renderedposition="571.2000122070312_8_1161_48" jivemacro_uid="_14628022962434701"><br/><br/>var lu = new ListUtil(current.watch_list);</pre><p><br/><br/>Here is a summary of the functions (methods) available:</p><ul><li>isInList(id) - returns true/false if id is in the list</li><li>addToList(id) - adds id to the list if it doesn't already exist</li><li>removeFromList(id) - removes id from the list</li><li>getList() - returns the comma separated string of the current list (e.g. to save back to current.watch_list)</li></ul><p></p><p></p><p></p><pre __default_attr="plain" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14628022962389833" data-renderedposition="843.2000122070312_8_1161_1760" jivemacro_uid="_14628022962389833" modifiedtitle="true"><br/><br/>var ListUtil = Class.create();<br/>ListUtil.prototype = {<br/><br/>       initialize: function(list) {<br/><br/>               this.debug = gs.getProperty('debug.ListUtil') == 'true';<br/><br/>               if (JSUtil.notNil(list)) {<br/>                       this._list = list.split(',');<br/>               } else {<br/>                       this._list = [];<br/>               }<br/>       },<br/><br/>/*<br/> * isInList - check if an id is in the list<br/> *<br/> * @param id - sys_id to look for<br/> * @return - boolean<br/> * @uses - this._list<br/> *<br/> */<br/>       isInList : function(id) {<br/><br/>               var i = this._getIndex(id);<br/><br/>               this._debug('isInList(' + i + '): looking for ' + id + ' in ' + this.getList());<br/>               return (i &gt; -1);<br/>       },<br/><br/>/*<br/> * addToList - add an id to the list<br/> *<br/> * @param id - sys_id of the id to add<br/> * @return - NA<br/> * @uses - this._list<br/> *<br/> */<br/>       addToList : function(id) {<br/><br/>               if (!this.isInList(id))<br/>                       this._list.push(id);<br/>       },<br/>/*<br/> * removeFromList - remove a id from the list<br/> *<br/> * @param id - sys_id to remove<br/> * @return - NA<br/> * @uses - this._list<br/> *<br/> */<br/>       removeFromList : function(id) {<br/><br/>               var index = this._getIndex(id);<br/><br/>               if (index &gt; -1)<br/>                       this._list.splice(index, 1);<br/>       },<br/><br/>/*<br/> * getList - display the list as CSV<br/> *<br/> * @param - NA<br/> * @return - string of CSV<br/> * @uses - this._list<br/> *<br/> */<br/>       getList : function() {<br/><br/>               return this._list.join(',');<br/>       },<br/><br/>/*<br/> * _getIndex - return the index of an element in list<br/> *<br/> * @param id - id to look for<br/> * @return - position of id in list (0..n/-1 = not found)<br/> * @uses - this._list<br/> *<br/> */<br/>       _getIndex : function(id) {<br/><br/>               for (var i = 0; i &lt; this._list.length; i++) {<br/><br/>                       if (this._list[i] == id)<br/>                               return i;<br/>               }<br/><br/>               return -1;<br/>       },<br/><br/>/*<br/> * _debug - print a message to the debug log<br/> *<br/> * @param s - string to print<br/> * @return - NA<br/> * @usrs - this._debug<br/> *<br/> */<br/>       _debug : function(s) {<br/><br/>               if (this.debug)<br/>                       gs.print('&gt;&gt;&gt;DEBUG: ListUtil: ' + s);<br/>       },<br/><br/>       type: 'ListUtil'<br/>}<br/><br/></pre><p></p><p></p><p>Here's an sample script that demonstrates the various functions:</p><pre __default_attr="plain" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14628022962321688" data-renderedposition="2666.199951171875_8_1161_480" jivemacro_uid="_14628022962321688"><br/><br/>var inc = '04b28ae2c0a8016600c8f3d86e3278f4'; // INC0000066<br/>var usr1 = '46d44a23a9fe19810012d100cca80666'; // Beth Anglin<br/>var usr2 = '5137153cc611227c000bbd1bd8cd2005'; // Fred Luddy<br/>var usr3 = '62826bf03710200044e0bfc8bcbe5df1'; // Abel Tuter<br/>var gr = new GlideRecord('incident');<br/><br/>if (!gr.get(inc)) {<br/>       gs.print('Error reading record.');<br/><br/>} else {<br/>       var lu = new ListUtil(gr.watch_list);<br/><br/>       gs.print('Fred is in the list: ' + lu.isInList(usr2));<br/><br/>       lu.removeFromList(usr2); // Take Fred out of the list<br/>       gs.print('Removed Fred: list=' + lu.getList());<br/><br/>       lu.addToList(usr3); // Add Abel to the list<br/>       gs.print('Added Abel: list=' + lu.getList());<br/><br/>       lu.addToList(usr2); // add Fred back in<br/>       lu.addToList(usr3); // add Abel (again)<br/>       gs.print('Final: list=' + lu.getList());<br/><br/>       // Save the current list to the record and update<br/>       gr.watch_list = lu.getList();<br/>       gr.update();<br/>}</pre>