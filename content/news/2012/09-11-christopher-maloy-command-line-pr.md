---
title: "Command Line Probe Script Include"
date: 2012-09-11T03:24:58.000Z
authors: ["Christopher.Maloy"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=85bc6a25dbd0dbc01dcaf3231f9619e9"
---
<p>There is a concept of executing command line (DOS and shell) scripts on the MID server (triggered by something on the instance server). I got sick of inserting the ECC queue record every time I wanted to run a command, so i created a script include that does it all for you. <br /><br />Install this update set (attached to this blog). It is an update set with only one Script Include called CommandProbeES. You can call it from any business rule, UI Action, or other script in the following way:<br /><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />var commandprobe = new CommandProbeES("YOUR_MIDSERVER_NAME");<br />commandprobe.setCommand("dir"); // you can put ls -l here or ipconfig - your command goes here depending on OS mid server is running on.<br />commandprobe.create();<br /></pre><br /><br />The above usage puts a record in the ECC queue table and will get a return input with the following XML<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />&lt;result command="dir"&gt;<br />&lt;stdout&gt;<br />Volume in drive C is OS Volume Serial Number is 2C1A-1398 Directory of C:\ServiceNow\MID Server1\mid.2012-07-18-1833.windows.x86-32\agent 09/10/2012 12:26 PM &lt;DIR&gt; . 09/10/2012 12:26 PM &lt;DIR&gt; .. 09/10/2012 12:25 PM &lt;DIR&gt; bin 09/10/2012 12:25 PM &lt;DIR&gt; conf 09/10/2012 12:29 PM 5,776 config.xml 09/10/2012 12:25 PM &lt;DIR&gt; etc 09/10/2012 12:29 PM &lt;DIR&gt; extlib 09/10/2012 12:25 PM &lt;DIR&gt; jre 09/10/2012 12:26 PM &lt;DIR&gt; lib 09/10/2012 12:29 PM &lt;DIR&gt; logs 09/10/2012 12:25 PM &lt;DIR&gt; package 09/10/2012 12:25 PM &lt;DIR&gt; properties 09/10/2012 12:25 PM 17 start.bat 09/10/2012 12:25 PM 16 stop.bat 09/10/2012 12:29 PM &lt;DIR&gt; work 3 File(s) 5,809 bytes 12 Dir(s) 714,052,411,392 bytes free<br />&lt;/stdout&gt;<br />&lt;stderr/&gt;<br />&lt;/result&gt;<br /></pre><br /><br />You can also call any batch process or executable this way as well.</p>