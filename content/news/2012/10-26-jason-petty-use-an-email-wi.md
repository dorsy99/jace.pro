---
title: "Use an email with an attachment to create a Data Source Load Data and Run Transform"
date: 2012-10-26T01:46:35.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=0d3daae5dbd0dbc01dcaf3231f961902"
---
<hr/><pre __default_attr="info" __jive_macro_name="alert" alert="info" class="jive_text_macro jive_macro_alert" data-renderedposition="31.23333740234375_8_1191_78" modifiedtitle="true"><p><span style="font-size: 14pt;"><span style="color: #e23d39;">The method below was originally published on Oct 25, 2012, is an outdated process</span> <br/></span></p><p><span style="font-size: 14pt;">Please see the following post for help! &gt;   <a title="Loading data from an email attachment" __default_attr="6454" __jive_macro_name="blogpost" class="jive_macro jive_macro_blogpost" data-orig-content="Loading data from an email attachment" data-renderedposition="73.18333435058594_384.48333740234375_346_22" href="/community?id=community_blog&sys_id=908c26e1dbd0dbc01dcaf3231f9619c4">Loading data from an email attachment</a> </span></p></pre><hr/><p></p><p>I had a number of people respond to this post with the same problem and together with my colleague I re-wrote the instructions to make it work.</p><p></p><p>I had a customer that wanted to have IBM Maximo product send an email to ServiceNow and have a CSV/XLS file attached to the email automatically create a new Data Source, load the data, then transform it all automatically just from receiving the email. Here is what I did to get that to work:</p><p></p><p><br/> 1. Create a Data Source Manually first so you can set up the Import Set Table and the Transform Map that you will use later. This is necessary since you need a Transform Map defined before you send the email inbound to ServiceNow. This Data Source can be deleted after creating the Import Set Table and Transform Map.<br/> 2. Get a sample CSV/XLS file and attach it to the Data Source and load the data at least once.<br/> 3. Define your Transform Map and set it up so the data is getting transformed into the right table in the format that you need.<br/> 4. Create a user that you will use for basic authentication with no roles and has a password.<br/><span> 5. Create a REST Message that points to your own instance for the REST endpoint: </span><a title="" _jive_internal="true" href="https://instancename/sys_import.do" rel="nofollow" target="_blank">https://instancename/sys_import.do</a><span> as the url named "Inbound Import Set Poster"</span><br/> 6. Check the box for "Use basic auth" and set the username and password from step #4<br/> 7. Edit the "get" function and add the following function parameters:<br/><img height="100" src="http://www.hobbycache.com/images/servicenow/rest_params.png" width="800"/><br/> 8. Create an Inbound Email Action with the following settings:<br/><img height="400" src="http://www.hobbycache.com/images/servicenow/screenshot.png" width="800"/><br/>HERE IS THE CODE TO COPY:</p><pre __default_attr="plain" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14877014196301932 jive_text_macro" data-renderedposition="989.7000122070312_8_1191_288" jivemacro_uid="_14877014196301932"><br/><br/>if (current.getTableName() == "sys_data_source") {<br/><br/>       current.name = email.subject.substring(3);<br/>       current.import_set_table_label = email.body.import_set_table_label;<br/>       current.import_set_table_name = email.body.import_set_table_name;<br/>       current.file_retrieval_method = email.body.file_retrieval_method;<br/>       current.format = email.body.format;<br/><br/>       current.update();<br/><br/>var r = new RESTMessage('Inbound Import Set Poster', 'get');<br/>r.setStringParameter('tableLabel', encodeURIComponent(current.name));<br/>r.setStringParameter('customDataSource', current.sys_id);<br/>               r.setStringParameter('tableName', current.import_set_table_name);<br/>r.execute();<br/>}</pre><p><br/> 9. The Condition can be anything you want but the Target table needs to be sys_data_source.<br/><span> 10. Enable the inbound email settings in your instance to receive email and process them. See WIKI </span><a title="" _jive_internal="true" href="http://wiki.servicenow.com/index.php?title=Configuring_Email" rel="nofollow" target="_blank">http://wiki.servicenow.com/index.php?title=Configuring_Email</a><span> for this.</span><br/> 11. Now send an email like this to the email <em><a title="k-email-small" class="jive-link-email-small" href="mailto:instancename@unix.service-now.com">instancename@unix.service-now.com</a></em> (The "unix" part of this avoids any email formatting issues with email clients):</p><ol><li><strong>To:</strong> <em><a title="k-email-small" class="jive-link-email-small" href="mailto:instancename@unix.service-now.com">instancename@unix.service-now.com</a></em></li><li><strong>Subject:</strong> DS:Test Data Source 1</li><li><strong>Body:</strong></li></ol><p><br/>               import_set_table_label:Test Import Set Table<br/>               import_set_table_name:u_test_import_set_table<br/>               file_retrieval_method:Attachment<br/>               format:CSV</p><p></p><p><strong>NOTE:</strong> CSV would be Excel if you are using an XLS file</p><p></p><p>12. Wait until the email is processed and it should have created your Data Source with whatever is after the "DS:" in the subject<br/> 13. Make sure the import_set_table_name is set to whatever you named your import set table when you created your Data Source in step 1 (This is very important since the Transform Map is linked to this table)<br/> 14. The format is set to either Excel or CSV.<br/> 15. You need to attach the file you want to attach to the Data Source.</p><p>&gt;</p><hr/><pre __default_attr="info" __jive_macro_name="alert" alert="info" class="jive_text_macro jive_macro_alert" data-renderedposition="1755.4000244140625_8_1191_78" modifiedtitle="true"><p><span style="font-size: 14pt;"><span style="color: #e23d39;">The method above <span style="color: #e23d39; font-size: 14pt;">was originally published on Oct 25, 2012, is</span> an outdated process</span> </span></p><p><span style="font-size: 14pt;">Please see the following post for help! &gt;   <a title="Loading data from an email attachment" __default_attr="6454" __jive_macro_name="blogpost" class="jive_macro jive_macro_blogpost" data-orig-content="Loading data from an email attachment" data-renderedposition="1797.3499755859375_384.48333740234375_346_22" href="/community?id=community_blog&sys_id=908c26e1dbd0dbc01dcaf3231f9619c4">Loading data from an email attachment</a> </span></p></pre><hr/>