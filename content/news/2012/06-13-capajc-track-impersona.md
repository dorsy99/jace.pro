---
title: "Track impersonations with just a new table and two Script Actions"
date: 2012-06-12T23:13:43.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=582de2e5dbd0dbc01dcaf3231f961990"
---
<p>After reading a recent post, I realized how easy it would be to track impersonations.<br /><br />Create a custom table: u_impersonation<br />Add the following fields: u_impersonator (String), u_impersonated (String), u_when (date/time), u_type (choice)<br />Add two choices to u_type: start, end<br /><br />Import the attached Script Actions. I'll include the script contents below. That's it! You'll get an easy to read list of subsequent impersonations.<br /><br />You *could* make u_impersonated and u_impersonator reference fields, doing a GlideRecord lookup of the user with the user_name in the parm1 and parm2 of the event, but you'd lose visibility of impersonations by users who aren't in your database (specifically if someone from ServiceNow is accessing your instance and impersonating one of your users to help troubleshoot an issue). Better to use the user_name as a String.<br /><br />Script Action 1:<br />Name: Impersonation Start<br />Event name: impersonation.start<br />Script:<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />auditImpersonationStart();<br /><br />function auditImpersonationStart() {<br />var gr = new GlideRecord("u_impersonation");<br />gr.u_impersonator = event.parm1;<br />gr.u_impersonated = event.parm2;<br />gr.u_when = event.sys_created_on;<br />gr.u_type = "start";<br />gr.insert();<br />}<br /></pre><br /><br /><br />Script Action 2:<br />Name: Impersonation End<br />Event name: impersonation.end<br />Script:<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />auditImpersonationEnd();<br /><br />function auditImpersonationEnd() {<br />var gr = new GlideRecord("u_impersonation");<br />gr.u_impersonator = event.parm1;<br />gr.u_impersonated = event.parm2;<br />gr.u_when = event.sys_created_on;<br />gr.u_type = "end";<br />gr.insert();<br />}<br /></pre></p>