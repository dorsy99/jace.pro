---
title: "Writing Attachments out to a MID server and calling overloaded Java methods in Javascript"
date: 2012-06-12T20:50:48.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=63ec22a5dbd0dbc01dcaf3231f96191b"
---
<p>I spent all night trying to figure out why what I know works in Java code can't be used in a MID server script includes. I mean this is basic IO stuff -- kind of. <br /><br />I am doing an integration where I take the attachments associated with an incident and send them to an FTP server. I will share how that all works in my next blog, as you can use the same idea to send XML, database query results, reports, etc.<br /><br />For this blog I have to share a major sticky point with Rhino and Javascript. The scripting engine has a hard time with overloaded Java methods and can't distinguish what method you are calling based on the parameters passed in. This article was helpful in understanding the issue (but not fixing it) :<br />http://www.mozilla.org/rhino/ScriptingJava.html<br /><br />After working through the night trying every data stream I could possibly think of, I finally consulted the Oracle of all oracles this morning, John Andersen on my team. He mentioned that he had struggled through that same issue a while back and that you had to call an overloaded Java method differently, than the normal way, by explicitly having to identify which method you are executing. I owe you a lunch friend. I have a great Don Chuy's burrito coming your way when you visit next week.<br /><br />So in the case of FileOutputStream I needed to write a byte[] like this:<br /><b>fos["write(byte[])"](this.payloadBytes);</b><br /><br />You can see I have to specify the byte[] as the param type I am passing in. Hopefully my blog will show up on someones Google search some troubled night for them. If you don't call the overloaded method as above you will see an error similar to this:<br /><br />06/11/12 23:30:22 (510) Probe: JavascriptProbe:OpenTextAttachmentCopy WARNING *** WARNING *** org.mozilla.javascript.EvaluatorException: The choice of Java method java.io.FileOutputStream.write matching JavaScript argument types (byte[]) is ambiguous; candidate methods are: void write(byte[]), void write(int) (script_include:OpenTextAttachmentCopy; line 55)<br /><br />Another tip that I picked up on my own while surviving on a diet of Cheese-Its and black tea last night is that you can get the byte[] from any base64 encoded string (like one you would send if you are passing attachments via web service) like this:<br />this.StringUtil = Packages.com.glide.util.StringUtil;<br /><b>this.StringUtil.base64DecodeAsBytes(probe.getParameter("attachmentPayload"));</b><br /><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />this.payloadBytes = this.StringUtil.base64DecodeAsBytes(probe.getParameter("attachmentPayload"));<br />this.fileName = probe.getParameter("attachmentFileName");<br /><br />if(this.fileName.length() &gt; 0 &amp;amp;&amp;amp; this.payloadBytes) {<br />     var file = new this.File(this.MIDSERVER_FILE_PATH + "/" + this.MIDSERVER_FILE_NAME);<br />     var fos = new this.FileOutputStream(file);<br /><br />     try {<br />          fos["write(byte[])"](this.payloadBytes);<br />     } catch (e) {<br />          this.log("Error in writing the file: " + e);<br />    } finally {<br />         fos.flush();<br />         fos.close();<br />    }<br />}<br /></pre><br /><br />Anyway, happy coding all. I have a day full of meetings and miles to go before I sleep. Cheers.</p>