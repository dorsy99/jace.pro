---
title: "Glide List Differ"
date: 2012-04-11T19:33:00.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=a7cce265dbd0dbc01dcaf3231f96195a"
---
<p>Last week I needed a way to take two lists of comma separated values and determine what the differences were. A customer was looking for a way to do approvals based on values added or removed from a proposed change to a glide_list on a CI. For example, if SOX was added to the glide_list field, they wanted a group approval based on SOX. If PCI was removed, then a different group was required to approve. With a little XML parsing, I was able to get the old and new list values. My script is written to work equally well on any list of comma separated values. I offer to you, free of charge, as-is my GlideListDiffer script include for your use.<br /><!--break--><br /><br />GlideListDiffer takes two lists of comma separated values and returns an array of objects indicating which have been added (not found in the first list) and which have been removed (not found in the second list.) Here's an example use case:<br /><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />var list1 = "1,2,3,4,5";<br />var list2 = "2,4,6,8,10";<br />var ld     = new GlideListDiffer();<br /><br />var o = ld.listChanges(list1, list2);<br /><br />gs.print(o.length + ' changes found');<br />for (var i = 0; i &lt; o.length; i++)<br />    gs.print('action=' + o&lt;i&gt;.action + ' value=' + o&lt;i&gt;.value);<br /></pre><br /><br />The above example wil produce the following output.<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />*** Script: 6 changes found<br />*** Script: action=delete value=1<br />*** Script: action=delete value=3<br />*** Script: action=delete value=5<br />*** Script: action=add value=6<br />*** Script: action=add value=8<br />*** Script: action=add value=10<br /></pre><br /><br />Do yourself a favor and don't call your lists "old" and "new"! "new" is a reserved word in JavaScript and it cost me about 30 minutes. :-)<br /><br /><hr /><br />Name: GlideListDiffer<br />Active: true<br />Client callable: false<br />Description: Take two lists (comma separate values - glide_list values) and determine what was added and what was removed.<br />Returns: array of objects<br />- properties<br />-- action: add/delete<br />-- value: list item added or removed<br /><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />var GlideListDiffer = Class.create();<br /><br />GlideListDiffer.prototype = {<br /><br />    initialize: function() {<br />       this.debug = gs.getProperty('debug.GlideListDiffer') == 'true';<br />    },<br /><br />/*<br /> * listChanges - go through each list to find what's been added/delete<br /> *<br /> * @parm - list1/list2: comma separated list values<br /> * @return - array of objects with properties<br /> *         action: "add" or "delete"<br /> *         value: list value added or removed<br /> *<br /> */<br />    listChanges : function(list1, list2) {<br /><br />       var answer = [];<br />       var a1     = [];<br />       var a2     = [];<br />       var au     = new ArrayUtil();<br /><br />       if (list1 != '')<br />           a1 = list1.split(',');<br /><br />       if (list2 != '')<br />           a2 = list2.split(',');<br /><br />       this._debug('listChanges(): a1.length=' + a1.length + ' a2.length=' + a2.length);<br /><br />       this._debug('listChanges(): pass1...');<br />       // Pass 1 - go through old list to see what's been removed<br />       for (var i = 0; i &lt; a1.length; i++) {<br /><br />           if (!au.contains(a2, a1&lt;i&gt;)) {<br />               var o = {'action' : 'delete', 'value' : a1&lt;i&gt;};<br />               answer.push(o);<br />               this._debug('listChanges(): ' + a1&lt;i&gt; + ' deleted');<br />           }<br />       }<br /><br />       this._debug('listChanges(): pass2...');<br />       // Pass 2 - go through new list and see what's been added<br />       for (var i = 0; i &lt; a2. length; i++) {<br /><br />           if (!au.contains(a1, a2&lt;i&gt;)) {<br />               var o = {'action' : 'add', 'value' : a2&lt;i&gt;};<br />               answer.push(o);<br />               this._debug('listChanges(): ' + a2&lt;i&gt; + ' added');<br />           }<br />       }<br /><br />       this._debug('listChanges(): answer.length=' + answer.length);<br />       return answer;<br />    },<br /><br />/*<br /> * _debug - dump a debug to the log<br /> *<br /> * @parm - s: string to send<br /> * @returns - NA<br /> * @uses - this.debug<br /> *<br /> */<br />    _debug : function(s) {<br /><br />        if (this.debug)<br />           gs.print('&gt;&gt;&gt;DEBUG: GlideListDiffer: ' + s);<br />    },<br /><br />    type: 'GlideListDiffer'<br />}<br /></pre></p>