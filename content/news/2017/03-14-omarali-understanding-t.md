---
title: "Understanding tasks table closed states"
date: 2017-03-14T02:05:00.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=264d6229dbd0dbc01dcaf3231f96195a"
---
<p><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/task-table/concept/c_TaskTable.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/task-table/concept/c_TaskTable.html" style="line-height: 1.5;">Task [task]</a><span style="line-height: 1.5;"> is one of the core tables provided with the base system. It provides a series of standard fields used on each of the tables that extend it, such as the Incident [incident] and Problem [problem] tables. In addition, any table which extends task can take advantage of task-specific functionality for driving tasks. Out of the box, there are over 30 <a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=077da269dbd0dbc01dcaf3231f961966">tables that extend</a></span> the task table, some of the most famous ones are:</p><ul><li>incident</li><li>change_request</li><li>sc_req_item, sc_request</li><li>sc_task and change_task</li></ul><p></p><p>Understanding the different parts that control the task table "close" state and active values is very important and can save a lot of troubleshooting time.</p><p></p><h1>A typical scenario where custom "close" state seems not to work</h1><p>Let's pretend you have defined some additional Choices for the State field (see <a href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/field-administration/concept/c_ChoiceLists.html" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/field-administration/concept/c_ChoiceLists.html">Choice lists</a> for details) of a task table like 'Implemented successfully' or 'Implementation failed' etc. Now the state is 'Closed' and it no longer has the default value of 3. Rather, the default value is some other value like 9. You then create a new workflow, business rule, or any other script that runs on the task table (or a table that extends it). You're trying to set a particular task's state to Closed (9). You find that the action was completed successfully but to your surprise, the task's state is set to the default value (3).</p><p></p><p><img   alt="blog-default-state-screenshot.jpg" class="image-1 jive-image" src="15cea402db58dfc068c1fb651f961932.iix" style="width: 620px; height: 155px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p>Understanding how the state value is determined and the relation between the active flag and the state value is crucial to solving this issue. You also need to understand which business rules are involved in this process to help you properly customize you task "close" states.</p><p></p><h2>Understanding the relation between the inactive and the "close" task states</h2><p>The <span style="color: #55901b;"><strong>'mark closed'</strong></span> business rule sets the task's active flag to false when the task's state changes to an inactive state. An inactive state is a state that is assigned to a given task when it is no longer active (ie closed or cancelled) In the base system, there are three task states that are considered inactive states.These are:</p><ul><li>Closed Complete (3)</li><li>Closed Incomplete (4)</li><li>Closed Skipped (7)</li></ul><pre __default_attr="info" __jive_macro_name="alert" alert="info" class="jive_text_macro jive_macro_alert" data-renderedposition="946.9033813476562_7.997159004211426_1134_15"><p>These values can be overridden by the close_states attribute of the task's state field.</p></pre><p>The <span style="color: #55901b;"><strong>'mark closed'</strong> </span>business rule runs on the task table before insert and update and it has the following condition:</p><pre __default_attr="java" __jive_macro_name="code" class="_jivemacro_uid_14893638257507417 jive_macro_code jive_text_macro" data-renderedposition="1012.5283813476562_7.997159004211426_1134_15" jivemacro_uid="_14893638257507417"><p>new TaskStateUtil(current).runMarkClosed()</p></pre><p></p><p>Which will return true and executes the following code if the state is one of the default inactive states above or one of the states defined by the <span style="color: #666666; font-family: arial, sans-serif;">close_states attribute:</span></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14893638400307573 jive_macro_code jive_text_macro" data-renderedposition="1113.2386474609375_7.997159004211426_1134_15" jivemacro_uid="_14893638400307573"><p>current.active = false;</p></pre><p></p><h2>Understanding why your custom task "close" state value being overridden</h2><p>The short answer to this is that it is due to the <span style="color: #55901b;"><strong>'Task closer' </strong></span>business rule. Out of the box, the default closed state has the value 3 (Closed Complete) which can be overridden by the default_close_state attribute of the task's state field.</p><p></p><p>Now, the task's state is set to the system default 3 (Closed Complete) or the User default (set by the default_close_state attribute) by the 'Task closer' business rule which has the following condition:</p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14893642525988470 jive_text_macro" data-renderedposition="1369.772705078125_7.997159004211426_1134_15" jivemacro_uid="_14893642525988470"><p>new TaskStateUtil(current).runTaskCloser() </p></pre><p></p><p>This will return <strong>true</strong> and executes the following code if the task's active flag is set to false, state is still in an open state (any state that is not considered an inactive state) and is in a supported table, which, out of the box, is task table or any table extending task table except 'dmn_demand', 'idea' tables:</p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14893642652312603" data-renderedposition="1487.755615234375_7.997159004211426_1134_15" jivemacro_uid="_14893642652312603"><p>current.state = new TaskStateUtil(current).getDefaultCloseState();</p></pre><p></p><p>This will set the state to the system default value for "Closed" which is 3. or the dictionary override value for default_close_state on the task's table.</p><p></p><h2>How to set the close_states and default_close_state attributes</h2><p>In order for you to be able to use a different close state than the default of the box one you will need to use dictionary overrides (see <a href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/data-dictionary-tables/concept/c_DictionaryOverrides.html" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/data-dictionary-tables/concept/c_DictionaryOverrides.html">Dictionary override)</a>which will enable you to set to different values of these attributes for each task table:</p><ol><li>Open the Dictionary Entry for the state field of the task table.</li><li>Add a new Dictionary override and use the following<ul><li>Table: change request[change_request] (use any other table as needed)</li><li>Override attributes &gt; checked</li><li>Attributes &gt; default_close_state=5 (use any other value as needed), or</li><li>Attributes &gt; close_states=7;8;9 (use any other value as needed), or</li><li>Attributes &gt; default_close_state=5, close_states=7;8;9</li></ul></li><li>Click submit.</li></ol><p></p><p>Understanding how the active and state values of your task table is set and overridden is crucial for creating successful workflows and scripts. It will enable you to successfully manage your tasks active and close states when the out-of-the-box settings do not satisfy your business requirements saving you a lot of troubleshooting time otherwise.</p>