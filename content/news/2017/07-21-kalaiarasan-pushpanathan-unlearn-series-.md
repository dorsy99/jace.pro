---
title: "Unlearn Series  Auto Populate List Collectors"
date: 2017-07-20T14:23:19.000Z
authors: ["Kalaiarasan Pushpanathan"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=1bdd6ae9dbd0dbc01dcaf3231f96194a"
---
<p><span style="font-family: verdana, geneva; font-size: 12pt;">This blog presents a quick way to auto populate list collectors when they are dependent on other variables of the form. This is especially useful when list collectors have numbers of records that is greater than the default record count allowed in the UI.</span></p><p></p><p><span style="font-family: verdana, geneva; font-size: 12pt;">Let's say that you have a form with a reference variable pointed towards groups tables and on selection of group, you want to display the members of the group in a list collector.</span></p><p></p><p><span style="font-family: verdana, geneva; font-size: 12pt;">A simple way to do this is using a On-Change Client Script on the Groups variables and have a Script Include function to do the heavy lifting. Below is a sample Script Include function that queries the group membership table and retrieves all the members that are part of the selected group.</span></p><p></p><p><em>   var Common_Utilities = Class.create();</em></p><p><em>   Common_Utilities.prototype = Object.extendsObject(AbstractAjaxProcessor, {</em></p><p><em>   getGroupMembers : function(){</em></p><p><em>   var group = this.getParameter('sysparam_groupID');</em></p><p><em>   var user_array = [];</em></p><p></p><p><em>   var getMembers = new GlideRecord('sys_user_grmember');</em></p><p><em>   getMembers.addQuery('group',group);</em></p><p><em>   getMembers.query();</em></p><p><em>   while(getMembers.next())</em></p><p><em>   {</em></p><p><em>   var user_Obj = {};</em></p><p><em>   user_Obj.key=getMembers.user.getDisplayValue();</em></p><p><em>   user_Obj.value=getMembers.getValue('user');</em></p><p><em>   user_array.push(user_Obj);</em></p><p><em>   }</em></p><p></p><p><em>   return (new JSON()).encode(user_array); //JSON formatted string</em></p><p></p><p><em>   }</em></p><p><em>});</em></p><p></p><p><span style="font-family: verdana, geneva; font-size: 12pt;">The script also shows how JSON can be used to return multiple values from Script Include function to Client Side functions for further manipulation.</span></p><p></p><p><span style="font-family: verdana, geneva; font-size: 12pt;">Since we now have the details of the group members, we can call this script using GlideAjax from a On-change Client Script and populate the list collector variable. Below is the sample On-Change Client Script.</span></p><p></p><p><em>   var varName = 'group_members'; //list collector variable name</em></p><p><em>   var glideAjax = new GlideAjax('Common_Utilities');</em></p><p><em>   glideAjax.addParam('sysparm_name','getGroupMembers');</em></p><p><em>   glideAjax.addParam('sysparam_groupID',newValue);</em></p><p><em>   glideAjax.getXMLWait();</em></p><p></p><p><em>   var leftBucket = gel(varName + '_select_0');</em></p><p><em>   var rightBucket = gel(varName + '_select_1');</em></p><p><em>   rightBucket.options.length = '0'; //This will clear the right side bucket of list collector.</em></p><p></p><p><em>   var response =(glideAjax.getAnswer());</em></p><p><em>   var jsonData = (response.evalJSON());</em></p><p><em>   for(var i=0 ; i &lt; (jsonData.length) ; i++) //Loop through all the members </em></p><p><em>   addOption(rightBucket,jsonData[i].value, jsonData[i].key); //Add the values to the right side bucket.</em></p><p></p><p><em>   sortSelect(rightBucket); //Sort the bucket </em></p><p><em>   leftBucket.onchange(); //This removes the values from left bucket that was added above</em></p><p></p><p><span style="font-family: verdana, geneva; font-size: 10pt;"><em>If you liked the content, please share, like, bookmark or leave your valuable comments.</em></span></p>