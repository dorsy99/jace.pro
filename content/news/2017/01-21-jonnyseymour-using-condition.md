---
title: "Using conditions with catalog variables on email notifications"
date: 2017-01-21T02:57:10.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=dacd62e9dbd0dbc01dcaf3231f9619ba"
---
<p>Developed by top engineers, the <a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/reference/notifications.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/reference/notifications.html">email notification</a> is robust and elegant, a clean-line construction released from the late 2011 with top specifications. Email notifications are now mature and reliable.   It is characterised by the easy-to-use interface. Email notifications are used to notify users by email, SMS text message, or push notifications of events that concern them. On the conditions, you can use most elements on the tables without the need for scripting. Wishful thinking would be to be able to use the <a title="ocs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/task/t_CreateAVariableForACatalogItem.html" href="https://docs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/task/t_CreateAVariableForACatalogItem.html">catalog variables</a> as we can use them on the searches. However, if you need to <a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/task/t_CreateANotification.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/task/t_CreateANotification.html">create email notifications</a> and use service catalog variables on the conditions you will need to script them. Wishful thinking is one thing, and reality another.</p><p></p><p>Email notifications can be triggered from tables that contains variables like <strong>sc_req_item </strong>and<strong> sc_task tables</strong>. Whilst the searches on the table allows you to search on the variables and the request item shows the <a title="ocs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/task/t_CreateAVariableForACatalogItem.html" href="https://docs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/task/t_CreateAVariableForACatalogItem.html">variables</a>, the actual variables data is stored in different form. For that reason, email conditions will simply ignore the variables conditions. This is tricky to spot.</p><p></p><p><img   alt="email-lego.png" class="image-15 jive-image" height="115" src="a0f423fddbd093049c9ffb651f9619ee.iix" style="width: 119px; height: 115.281px; display: block; margin-left: auto; margin-right: auto;" width="119"/></p><p></p><h1>Create a notification on <strong>sc_req_item</strong> that uses the advanced conditions</h1><p>For this example, I will show you how to create a notification on <strong>sc_req_item</strong> (also applies to sc_task) that uses the <a title="ocs.servicenow.com/bundle/istanbul-it-business-management/page/product/compliance/concept/c_DefiningAdvancedConditions.html" href="https://docs.servicenow.com/bundle/istanbul-it-business-management/page/product/compliance/concept/c_DefiningAdvancedConditions.html">advanced conditions</a> to filter on the variables. I have used a "Standard Laptop" Service Catalog and I created a notification that triggers when "Adobe Acrobat" is selected.</p><p></p><p><img   alt="2017-03-24_2037-variables.png" class="image-16 jive-image" src="912e4942db14d304b322f4621f9619ac.iix" style="width: 620px; height: 430px;"/></p><p></p><p></p><h2>Creating the email notification with variables</h2><p>When creating an email notification, use the 'Advanced condition' to match the variables by scripting. Use current.variables.&lt;name of the variable&gt; to retrieve the value, and getDisplayValue() to retrieve the display value of it. Alternatively, use current.variables["name of the variable"]</p><p></p><p>Below is an example of a notification that will trigger when the variables "acrobat" is set to "true" (checked).</p><p><img   alt="catalog variable conditions.jpg" class="image-8 jive-image" src="32e44dc6db10d344e9737a9e0f9619da.iix" style="width: 620px; height: 444px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p>Here is the advanced condition used on the example:</p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14796889404721075 jive_text_macro" data-renderedposition="1618.2833251953125_8_917_32" jivemacro_uid="_14796889404721075"><p>var v=current.variables.acrobat;</p><p>answer=v?"true"==v.getDisplayValue():!1;</p></pre><p></p><p>The code will return answer = true if the acrobat is selected ON (checked).</p><p></p><pre __default_attr="warning" __jive_macro_name="alert" alert="warning" class="jive_text_macro jive_macro_alert" data-renderedposition="1727.2833251953125_8_917_64"><p>Use current.variables.&lt;name of the variable&gt; to retrieve the value, and getDisplayValue() to retrieve the display value of it. Alternatively, use current.variables["name of the variable"]</p></pre><p>To validate the email notification, I have created a new catalog request for a Standard Laptop.</p><p><img   alt="standard laptop request.jpg" class="image-9 jive-image" src="bcc3a48edb9c5304b322f4621f96195b.iix" style="width: 620px; height: 483px; display: block; margin-left: auto; margin-right: auto;"/></p><p>Once you have submitted an item, the order status will show the request items. In this case. my Lenovo - Carbon x1 is in the beginning stages of the request.</p><p><img   alt="requested item.jpg" class="image-10 jive-image" src="c8920c4adbd41304b322f4621f961984.iix" style="width: 620px; height: 250px; display: block; margin-left: auto; margin-right: auto;"/></p><p>When you review the request item and the variables, it shows as follows:</p><p><img   alt="request item variables.jpg" class="image-11 jive-image" src="0171e3f9db585b048c8ef4621f9619ff.iix" style="width: 620px; height: 457px; display: block; margin-left: auto; margin-right: auto;"/></p><p>On the example provided, as "Adobe Acrobat" is selected on the "Standard Laptop" request item, the notification will be sent because the condition "current.variables.acrobat.getDisplayValue()" is true, and the condition Item = "Standard Laptop" is true.</p><p></p><h2>How to manipulate the variables<span style="color: #eb7a3d;"><br/></span></h2><p>You would like to print or manipulate the catalog variables when the data passed to the catalog items are required. To validate the information on the variables, I have created an email script to print all the variables available values. For that, I will loop on the <a title="ocs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/task/t_CreateAVariableForACatalogItem.html" href="https://docs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/task/t_CreateAVariableForACatalogItem.html">variables</a> array.</p><p><img   alt="standard laptop variables.jpg" class="image-12 jive-image" src="a5ac4d86dbd0d304b322f4621f961905.iix" style="width: 620px; height: 230px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p>The email script contains a loop on the variables (array) on the current record as follow:</p><p><img   alt="array email script.png" class="image-13 jive-image" src="ab2c20c2db149344e9737a9e0f96197d.iix" style="width: 620px; height: 257px; display: block; margin-left: auto; margin-right: auto;"/></p><p>Here is the text on the script</p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14796889001684209 jive_text_macro" data-renderedposition="3884.283447265625_8_917_176" jivemacro_uid="_14796889001684209"><p>// function (current, template, email, email_action, event)</p><p>(function (c, b, a, d, e) {</p><p>       b.print("&lt;UL&gt;");</p><p>       for (key in c.variables) a = c.variables[key], "" != a.getGlideObject() </p><p>               .getQuestion()</p><p>               .getLabel() &amp;&amp; b.print("&lt;LI&gt;variable name: " + key + " (" +</p><p>                       a.getGlideObject()</p><p>                       .getQuestion()</p><p>                       .getLabel() + ") = " + a.getDisplayValue() + "&lt;/LI&gt;");</p><p>       b.print("&lt;/UL&gt;")</p><p>})(current, template, email, email_action, event);</p></pre><p></p><pre __default_attr="info" __jive_macro_name="alert" alert="info" class="jive_text_macro jive_macro_alert" data-renderedposition="4095.283447265625_8_917_43"><p>Use "<em>for (key in current.variables)</em> then, <em>variable_value = current.variables[key]</em> to loop though the variables.</p></pre><p></p><p>Here is one example of the email generated:</p><p><img   alt="request item email.jpg" class="image-14 jive-image" src="905ac8cadb9017049c9ffb651f961961.iix" style="width: 620px; height: 375px; display: block; margin-left: auto; margin-right: auto;"/></p><p>Whilst not natively supported, <a title="ocs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/task/t_CreateAVariableForACatalogItem.html" href="https://docs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/task/t_CreateAVariableForACatalogItem.html">service catalog variables</a> can be used in and out with the help of scripting. Who knows, variables may back on the normal conditions in the near future (cross fingers). This could be very useful if you need to generate different notifications based on the answers provided on a catalog item.</p><p></p><p>I have tested this example using Helsinki, with Google Chrome as the browser.</p><p></p><p>More information can be found here:</p><ul><li><a title="i.service-now.com/kb_view.do?sysparm_article=KB0540674" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0540674">Email Resources Page (KB0540674)</a></li><li><a title="Adding cat item variables to email notification" __default_attr="167903" __jive_macro_name="thread" class="jive_macro_thread jive_macro" data-orig-content="Adding cat item variables to email notification" data-renderedposition="4769.13330078125_38_304_17" href="/community?id=community_question&sys_id=31b447e9dbd8dbc01dcaf3231f9619b1">Adding cat item variables to email notification</a></li><li><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=bc7c22e1dbd0dbc01dcaf3231f961996">Incoming email classified as reply to 'null' via watermark</a></li><li><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=3a8c2ae1dbd0dbc01dcaf3231f9619fc">Two watermarks in incoming Email messages</a></li><li><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=ae9caee1dbd0dbc01dcaf3231f96193c">3 steps to determine if and why the event processor is unable to start</a></li><li><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=f0dc6665dbd0dbc01dcaf3231f961955">Diagnosing and remedying stuck event processes</a></li><li><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/reference-pages/reference/r_AdditionalProperties.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/reference-pages/reference/r_AdditionalProperties.html">Docs: Additional email properties</a></li><li><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/reference-pages/reference/r_AvailableSystemProperties.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/reference-pages/reference/r_AvailableSystemProperties.html">Docs: Available system properties</a></li><li><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/wizards/task/t_CreateTheEmailNotification.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/wizards/task/t_CreateTheEmailNotification.html">Docs: Create an email notification</a></li><li><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/concept/c_NotificationExamples.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/concept/c_NotificationExamples.html">Docs: Notification examples</a></li><li><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/script/server-scripting/concept/c_ScriptingForEmailNotifications.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/script/server-scripting/concept/c_ScriptingForEmailNotifications.html">Docs: Notifications</a></li><li><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/script/server-scripting/concept/c_ScriptingForEmailNotifications.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/script/server-scripting/concept/c_ScriptingForEmailNotifications.html">Docs: Scripting for email notifications</a></li><li><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/reference/notifications.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/reference/notifications.html">Troubleshooting email notifications - Send to the Event Creator</a></li><li><a title="i.service-now.com/kb_view.do?sysparm_article=KB0547784" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0547784">Troubleshooting Outbound Email (KB0521382)</a></li><li><a title="i.service-now.com/kb_view.do?sysparm_article=KB0547784" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0547784">Troubleshooting stuck event process (KB0547784)</a></li><li><a title="i.service-now.com/kb_view.do?sysparm_article=KB0528669" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0528669">Verifying the recipient has an email address (KB0528669)</a></li><li><a title="i.service-now.com/kb_view.do?sysparm_article=KB0528671" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0528671">Verifying the recipient's email address is properly formatted (KB0528671)</a></li><li><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=932e6a6ddbd0dbc01dcaf3231f961953">Speed up your email delivery by validating recipients</a></li><li><a title="" _jive_internal="true" href="/people/jonnyseymour/content?filterID=contentstatus%5Bpublished%5D%7Eobjecttype%7Eobjecttype%5Bblogpost%5D">My other blogs</a></li></ul>