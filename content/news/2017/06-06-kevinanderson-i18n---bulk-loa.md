---
title: "in  bulk loading translation data"
date: 2017-06-06T00:59:44.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=6a0deaa5dbd0dbc01dcaf3231f9619c7"
---
<p>So,</p><p></p><p>We just got done implementing Spanish in our instance, and I want to share with you something that took us many hours to get working correctly - transform maps for sys_translated_text, sys_choice, sys_documentation, sys_translated, and sys_ui_message.</p><p></p><p>According to SN, the out of box transform maps that come with the language pack plugins are not for use by customers, and are only intended for use by the plug-in process.</p><p></p><p>So, we had to copy and modify these transform maps to work correctly. We had thousands of records related to our translation data, and using XML export / import was not practical as the files were very large and took many hours to import into the target instance ( we had to break them into 2k row 'chunks' to get them to process at all without timing out ).</p><p></p><p>I spent several hours on the phone with HI support building these transform maps, and I would like to present them to the community, so that others shall not suffer the same pain we did migrating language data manually.</p><p></p><p>After building these transform maps, we were able to move ~65k records in only a few minutes.</p><p></p><p>The key to this is:</p><p></p><p>1. copy the oob transform maps, and disable the scripts - instead do a direct field mapping</p><p>2. copy the coalesce field settings from the oob transform maps fields to the custom transform maps</p><p>3. when exporting the data, ensure all the fields in the transform map are in the export</p><p>4. add the document key sys_id to the sys_translated_text table to accommodate the transform map (done in attached update set)</p><p>5. convert the XLSX to XLS before importing to target system for the transform ( I hear this will be fixed in Jakarta )</p><p>6. use the following onbefore script for the document key field on sys_translated text (Thanks to Chris Beltran @snc / Rod Godfrey @ snc for providing this basis for this script)</p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14966924971323490" data-renderedposition="486.3999938964844_8_1192_880" jivemacro_uid="_14966924971323490" modifiedtitle="true"><p>(function runTransformScript(source, map, log, target /*undefined onStart*/ ) {</p><p></p><p></p><p>   // validate the document key can be built - table exists and target record can be found in the table</p><p></p><p>   gs.include('j2js');</p><p></p><p>   var isValidTable = function(table_name) {</p><p>                       result = false;</p><p>                     </p><p>                       if (JSUtil.notNil(table_name)) {</p><p>                               var gr = new GlideRecord('sys_db_object');</p><p>                               if (gr.get('name', table_name)) {</p><p>                                       result = true;</p><p>                               }</p><p>                       }</p><p>                       //gs.log('isValidTable for '+table_name+': '+result, 'transform map - sys_tanslated');</p><p>                       return result;</p><p>               };</p><p></p><p></p><p>               </p><p></p><p></p><p>   // string trim polyfill</p><p>               String.prototype.trim || (String.prototype.trim = function() {</p><p>                       return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");</p><p>               });</p><p></p><p></p><p>               var _doc = source.u_document.toString();</p><p>               var _tbl = source.u_table_name.toString();</p><p>                             </p><p>               var table_name = (_tbl).trim();</p><p></p><p>   var process_record = false;</p><p></p><p>   if (isValidTable(table_name)){</p><p>   if (JSUtil.notNil(source.u_document_key_sysid)){</p><p>   // search for the document key sys_id in the target table</p><p>   var _gr = new GlideRecord(table_name);</p><p>   if (_gr.get(source.u_document_key_sysid)) {</p><p>   process_record = true;</p><p>   }</p><p>   else{</p><p>   gs.log('Warning: unable to find matching record with sys_id: ' + source.u_document_key_sysid+' in table '+table_name, 'transform map - sys_tanslated');</p><p>   }</p><p>   }</p><p>   else{</p><p>   gs.log('Warning: invalid document key sys_id for record: ' + _doc, 'transform map - sys_tanslated');</p><p>   }</p><p></p><p>   }</p><p>         else{</p><p>   gs.log('Warning: invalid table: '+table_name,'transform map - sys_tanslated');</p><p>   }</p><p></p><p>         // if the document key sysid or the target table not found, skip this record</p><p>         if (!process_record){ </p><p>   ignore = true;</p><p>   }</p><p></p><p>})(source, map, log, target);</p></pre>