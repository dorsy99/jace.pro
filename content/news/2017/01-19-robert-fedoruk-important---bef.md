---
title: "IMPORTANT  Before you build long lifecycle tasks with Workflow"
date: 2017-01-18T22:23:23.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=763deae5dbd0dbc01dcaf3231f961993"
---
<p>There once was a customer that had tasks with unusually long lifecycles.   These tasks would frequently be open and relevant between 6 months and 1 year.   The tasks were associated with a complex approval / data population workflow that was, by comparison, very short.   The effect looks like this...</p><p><img  class="image-1 jive-image" src="a4ce6406db949344e9737a9e0f96194a.iix" style="max-width: 1200px; max-height: 900px;"/></p><h2></h2><h2><strong>THE FIRST HINT THAT SOMETHING WAS WRONG</strong></h2><p>For the first few months, the customer was elated at the business value being provided by this solution (it helped them ace a government audit).   But suddenly a large number of tickets mysteriously "started over".   A second set of approvals launched.   Data overwritten.   Notifications sent.   On further inspection, it appears the workflow had launched a second time.   Digging deeper, a large number of older Tasks simply had no workflow.   Some of you may remember this from my <a title="The mysterious case of the disappearing workflows" __default_attr="246261" __jive_macro_name="thread" class="jive_macro_thread jive_macro" data-orig-content="The mysterious case of the disappearing workflows" data-renderedposition="264_678.890625_343_16" href="/community?id=community_question&sys_id=ea11d7e9dbdcdbc01dcaf3231f96195a">The mysterious case of the disappearing workflows</a> thread.</p><p></p><h2>WORKFLOWS ARE FLUSHED ON OLD INSTANCES!!</h2><p>The horrifying root cause to this issue is that on older instances of ServiceNow, completed workflows are flushed after a few months.   Take a look at the visualization above.   That workflow completes in a couple days.   Here's the culprit.   Workflow context table flushes "ended" workflows after 15 million seconds.</p><p><img  class="image-2 jive-image" height="237" src="d961d042dbd01f048c8ef4621f96192b.iix" style="height: 237px; width: 727.426px;" width="727"/></p><p>The extra scary fact is those workflows are GONE.   There is *no* hope of repair.   So imagine a large, complex task, which is critical for audits, that instantly has months of history wiped out.   No joke people, this is the kind of thing that mobilizes whole teams of lawyers.     The good news is that this only appears to exist on OLD instances of ServiceNow.   On fresh instances of Geneva or Helsinki, this auto-flush record does not appear to exist.</p><p></p><h2>HARDENING YOUR SOLUTIONS</h2><p>After discovering the issue, our intrepid customer took two courses of action to harden their long-lifecycle Tasks against workflow flush/reset</p><p></p><p><strong>1)   De-activate sys_auto_flush records for wf_context</strong></p><p>This appears to be a safe option, since later versions of ServiceNow don't even have the record.</p><p></p><p><strong>2)   Place a "now" condition on your Workflow conditions</strong></p><p>Since de-activating the sys_auto_flush record only prevented new context flushing, the customer still had a terrifying problem of plentiful tasks with no workflow.   They still had to prevent new workflow launches on existing Tasks with purged contexts!   To accomplish this, they added a condition to the Workflow's triggering:   created = Now.   Since the tasks in question would already be months old, this condition would be false, and no new workflow would be run.   It guarantees that a workflow "only runs once ever" no matter what other legacy issues exist.</p><p></p><p></p><p></p><h2>TL;DR</h2><p>- Sometimes tasks outlive their wf_contexts</p><p>- workflow contexts get flushed on old instances</p><p>- Check your sys_auto_flush table for a wf_context record, and deactivate it.</p>