---
title: "Client Script Best Practices"
date: 2017-05-02T04:54:25.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=f27ce2e1dbd0dbc01dcaf3231f961912"
---
<p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt; color: #303030;"><span lang="EN-GB">In my previous post on </span><span style="color: #303030;"><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=e25ce6a1dbd0dbc01dcaf3231f9619dc">Coding Best Practices</a></span>, we reviewed some Best Practice tips for scripting in general. The ServiceNow platform allows Administrators to enhance the standard functionality by adding scripting to various system components. These components can be separated into two categories: Client-side and Server-side. Now, we'll review some of the Best Practices for Client-side Scripting in ServiceNow.</span></p><p class="Normal1"></p><p class="Normal1"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">For reference, Client-side scripts are loaded into a user's Web Browser when a page is loaded. Some of these scripts execute automatically after the form is loaded (e.g. onLoad), while others only execute based on a user interaction (e.g. onChange or onSubmit). These scripts are written in <a title="ww.w3schools.com/js/js_intro.asp" href="https://www.w3schools.com/js/js_intro.asp">JavaScript</a> and can easily fail if not implemented correctly. If this occurs, the page will most likely not function as intended, resulting in corrupted values and a bad user experience. To avoid this, here are my Best Practice recommendations:</span></p><p></p><p style="padding-left: 60px;"><span style="color: #303030; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong><span lang="EN-GB">Avoid global Client Scripts</span></strong></span></p><p style="padding-left: 60px;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt; color: #303030;"><span lang="EN-GB"></span></span><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Client Scripts configured on the <em>Global</em> Table will be loaded on every single table form in the system, regardless of whether any of the code is actually needed. This can seriously impact system performance and therefore should be avoided. Client Scripts should be configured to load/execute on specific tables only. Consideration should also be given to whether the script should be inherited by any extended tables, and which views it should apply to. If functions are needed to be loaded on every form, a <em>UI Script</em> could be created.</span></p><p style="padding-left: 60px;"></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"></span><strong><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Avoid using DOM (manipulating elements via the Document Object Model)</span></strong></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"></span><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">This is a bold statement I know, but it really is just the tip of an iceberg full of potential issues. So why is DOM manipulation such an issue? Well let's take a simple example. Let's say you want to hide a field element. You could inspect the HTML source and identify which element represents the field. Once you know the <em>id</em> value, you could call a standard <em>JavaScript</em> function called <em>document.getElementById()</em> to return the element as a <em>JavaScript</em> Object. Then, you could dot-walk to its <em>style.display</em> property and update its value ("none" for hide, "block" or "inline" for show etc). This would be perfectly fine if the HTML never changed. However, the HTML in ServiceNow's table forms is maintained by <span style="text-decoration: underline;">ServiceNow</span>, and could (and likely will) change with future releases. If the <em>id</em> value changed, our scenario would fail. Some DOM calls go further than just targeting a specific element by <em>id</em> and could return elements based on their position in the form. Once again, if this position changes, the code would likely fail. Because of this, ServiceNow recommends avoid using DOM where possible, and if you do need to access one of the out-of-box elements, use the <em>GlideForm</em> (g_form) API instead (e.g. use the <em>getElement()</em> function to return the applicable element as an Object). Because ServiceNow maintain both the HTML structure and the <em>GlideForm</em> API, we can rely on their code to return the correct HTML element each time. Another tip is to always check that an Object was returned by the <em>getElement()</em> or <em>document.getElementById()</em> functions, <span style="text-decoration: underline;">before</span> proceeding to dot-walk to other properties down the tree. This is important because if the element cannot be found, the value returned will be <em>null</em>. If you attempt to dot-walk and access non-existent properties or functions on a <em>null</em> object, the <em>JavaScript</em> processor will fail and produce an error, and in some cases prevent further processing. This usually causes the page to not function as intended, and creates a poor user experience. Even <a title="ocs.servicenow.com/bundle/geneva-servicenow-platform/page/administer/form_administration/task/t_CreateAUIPolicy.html" href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/administer/form_administration/task/t_CreateAUIPolicy.html">UI Policies</a> can stop working if a page encounters a <em>JavaScript</em> error during the form load.</span></p><p style="padding-left: 60px;"></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"></span><strong><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Use <em>UI Policies</em> instead of <em>Client Scripts</em></span></strong></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"></span><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Often times, we need to make a field read only, mandatory or hidden. For these cases, it is Best Practice to use <em>UI Policies</em> to perform these actions instead of calling functions from the <em>GlideForm</em> (g_form) API in Client Scripts. <em>UI Policies</em> also have the added advantage of being triggered by multiple conditions (e.g. field value changes), instead of just a single field value change (like an <em>onChange</em> Client Script). Additionally, <em>UI Policies</em> can be executed in a specific order, as well as execute further <em>JavaScript</em> functions if required.</span></p><p style="padding-left: 60px;"></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"></span><strong><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Use Asynchronous calls via <em>getReference()</em> or <em>GlideAjax</em></span></strong></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"></span><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt; color: #303030;"><span lang="EN-GB">In my earlier post on </span><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=57cce265dbd0dbc01dcaf3231f961901">Client-Server Communication</a>, I discussed examples of using <em>getReference()</em> and <em><a title="ocs.servicenow.com/bundle/geneva-servicenow-platform/page/script/server_scripting/reference/r_GlideAjax.html" href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/script/server_scripting/reference/r_GlideAjax.html">GlideAjax</a></em> to request data from the Server. Both of these examples used <span style="text-decoration: underline;">Asynchronous</span> AJAX calls because that is the <em><span>ServiceNow Best Practice</span></em>. Using Asynchronous AJAX calls (e.g. using <em>Callback</em> functions) will avoid freezing the web browser while the data transfer occurs, and results in a much nicer user experience.</span></p><p style="padding-left: 60px;"></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"></span><strong><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Use <em>g_scratchpad</em> to </span><span style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"><a title="ocs.servicenow.com/bundle/geneva-servicenow-platform/page/app-store/good_practices/client_script/concept/c_MinimizeServerLookups.html" href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/app-store/good_practices/client_script/concept/c_MinimizeServerLookups.html">minimise server calls</a></span></strong></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Often, we need to use data in our <em>Client Scripts</em>, which is available on the Server, but not readily available on the Client. If these values are known when the form is loaded, they can be retrieved by a <em>Display Business Rule</em>, and made available to Client Scripts by storing them on a global JavaScript Object called g_<em>scratchpad</em>. Such examples include System Properties or field values from Database records. By first storing them on the g_scratchpad object when the form is loaded, it avoids the need to use an AJAX call to request and receive the required data.</span></p><p style="padding-left: 60px;"></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"></span><strong><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Set the <em>Display Value</em> as well as the <em>Value</em> on Reference fields</span></strong></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"></span><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">When setting the value of a <em>Reference</em> field via script, we need to use (at minimum) the <em>sys_id</em> value of the record we want to select. When this happens, ServiceNow will automatically make a <span style="text-decoration: underline;">Synchronous</span> AJAX call to the Server to determine the <em>Display Value</em> for the record we've selected, and then display this value on the form. As per my previous points on Client-Server communication and Asynchronous vs Synchronous AJAX calls, it is Best Practice to avoid Synchronous calls altogether, and to minimise server calls in general. With this in mind, the Best Practice when setting a value into a <em>Reference</em> field is to also set the <em>Display Value</em> at the same time, as this will prevent the additional Synchronous call to the Server. This can be achieved by adding an additional argument to the <em>setValue()</em> function. For example:</span></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"><img   class="image-1 jive-image" src="751940c6dbdc5fc068c1fb651f96193a.iix" style="width: 620px; height: 87px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p style="padding-left: 60px;"></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"></span><strong><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Never use GlideRecord in Client Scripts</span></strong></p><p style="padding-left: 60px;"><span lang="EN-GB" style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"></span><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt; color: #303030;"><span lang="EN-GB">Although the <em>GlideRecord</em> Class is available on the Client-side, ServiceNow recommends using <em>GlideAjax</em> instead. First of all, unlike the Server-side equivalent, the Client-side version of the <em>GlideRecord</em> Class will not provide the same functionality (e.g. no dot-walking and associated function calls). Second, whenever the <em>next()</em> or <em>get()</em> functions are called, a Synchronous AJAX call will be made to the Server and this will momentarily freeze the web browser until the data is returned. Using the Client-side <em>GlideRecord</em> Class is actually very similar to using <em>getReference()</em> with no <em>Callback</em> function, and as discussed in my earlier post on <a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=57cce265dbd0dbc01dcaf3231f961901">Client-Server Communication</a></span>, the data returned will contain <span style="text-decoration: underline;">every field</span> value for the selected record. In the case of records with many fields (or large field lengths) this will take longer to return, and could therefore cause performance issues and create a poor user experience.</span></p><p class="Normal1"></p><p class="Normal1"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt; color: #303030;"><span lang="EN-GB">In this article we've covered some of the principles behind Client Script Best Practices in ServiceNow. In my next article, we'll discuss Server Side Scripting Best Practices and how they apply specifically to ServiceNow.</span> <span style="background: white;">For further information on the topics covered in this article, please see the following pages on the ServiceNow Wiki:</span></span></p><ul><li><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=e25ce6a1dbd0dbc01dcaf3231f9619dc" style="font-family: arial, helvetica, sans-serif; font-size: 16px;">Coding Best Practices</a></li><li><span style="color: #303030; background: white; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><a title="ki.servicenow.com/index.php?title=Technical_Best_Practices#gsc.tab=0" href="http://wiki.servicenow.com/index.php?title=Technical_Best_Practices#gsc.tab=0">Technical Best Practices</a></span></li><li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><a title="ocs.servicenow.com/bundle/geneva-servicenow-platform/page/script/server_scripting/reference/r_GlideAjax.html" href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/script/server_scripting/reference/r_GlideAjax.html">GlideAjax</a></span></li><li><span style="color: #303030; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><a title="eveloper.servicenow.com/app.do#!/api_doc?v=istanbul&id=c_GlideFormAPI" href="https://developer.servicenow.com/app.do#!/api_doc?v=istanbul&amp;id=c_GlideFormAPI">GlideForm</a></span></li><li><span style="color: #303030; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><a title="eveloper.servicenow.com/app.do#!/api_doc?v=istanbul&id=c_GlideRecordClientSideAPI" href="https://developer.servicenow.com/app.do#!/api_doc?v=istanbul&amp;id=c_GlideRecordClientSideAPI">Client Side GlideRecord</a></span></li><li><span style="color: #303030; background: white; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><a title="ww.w3schools.com/js/js_intro.asp" href="https://www.w3schools.com/js/js_intro.asp">W3Schools: JavaScript Introduction</a></span></li><li><span style="color: #303030; background: white; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><a title="ww.w3schools.com/php/php_ajax_intro.asp" href="https://www.w3schools.com/php/php_ajax_intro.asp">W3Schools: AJAX Introduction</a></span></li></ul><p></p><p><span style="color: #303030; background: white; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="font-weight: bold; font-family: 'Times New Roman'; color: #666666;">NOTE</span><span style="font-family: Arial; color: #666666;">: </span><span style="font-family: 'Times New Roman'; color: #666666;">MY POSTINGS REFLECT MY OWN VIEWS AND DO NOT NECESSARILY REPRESENT THE VIEWS OF MY EMPLOYER. </span></span></p><p></p>