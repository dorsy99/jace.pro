---
title: "Improved events processing on the ServiceNow platform"
date: 2017-05-17T10:15:52.000Z
authors: ["Lucas Vieites"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=528c2ae1dbd0dbc01dcaf3231f961925"
---
<p>A large part of &#34;under the hood&#34; communications and notifications in the ServiceNow platform are managed by events. These are triggered by specific actions, such as: an incident being created or updated, a requested item that needs an approval, an SLA that has surpassed a predefined threshold, and many more. All these events need to be processed for the needed actions, such as sending out emails and SMS, updating a Live Feed, etc. are performed. The mechanism responsible for this is the &#34;events processor.&#34;</p>
<p>Starting with the Fuji release we have made some changes to improve events processing (not to be confused with the ITOM &#34;<a title="ITOM Event Management application" href="https://docs.servicenow.com/bundle/kingston-it-operations-management/page/product/event-management/concept/c_EM.html" target="_blank" rel="nofollow">Event Management</a>&#34; application). The way in which the platform generates events and the logic behind their processing has not been changed, but we have introduced several improvements in the manner in which &#34;ready events&#34; are picked up and processed. This method reduces the possibility of a single event being the bottleneck for the processing of other events behind it.</p>
<h2>One events processor per node</h2>
<p>Starting with the Fuji release, we have one events processor (Scheduled Job) available <strong>on each active node</strong> of the instance. This only applies to the &#34;<em>default</em>&#34; event queue; the &#34;<em>text_index</em>&#34;, &#34;<em>metric_update</em>&#34; and any other custom queues will continue to be processed by their respective processors.</p>
<p>On a <em><strong>pre-Fuji</strong></em> instance (Aspen, Berlin, Calgary, Dublin, and Eureka) you would typically see the following default Scheduled Job:</p>
<p><img class="image-1 jive-image" style="float: none; border: 2px solid #cecece; display: block; margin-left: auto; margin-right: auto; width: 805.023px; height: 380.493px;" src="0f64908adb1817041dcaf3231f96192a.iix" alt="The events processor in Eureka" width="805.02272" height="381.02272" /></p>
<p>This processor job would pick up <strong>all the events</strong> in &#34;<em>ready</em>&#34; state and queue them for processing. If there had been a contention in the previous run of the job (due to a stuck event, or a bunch of long-running events), there could easily be a backlog of several thousand events which will cause the next run of the job to also be delayed. It would take several runs of the events processor to return to normality. On an instance that generates very many events, it could easily take a day or more to return to normality. </p>
<p>The biggest difference you will see as an administrator of an instance on the Fuji release or newer are the following scheduled jobs named &#34;<strong>events process <em>n</em></strong>&#34; (where <strong><em>n</em></strong> is a number) with the corresponding <em>master</em> job.</p>
<p><img class="image-2 jive-image" style="border: 2px solid #cecece; display: block; margin-left: auto; margin-right: auto; width: 827.023px; height: 189.995px;" src="d484bbb5db5c9b048c8ef4621f9619ac.iix" alt="The Events processors in Fuji and later" width="827.02272" height="191.02272" /></p>
<p>You will also notice that the method in the <em>Job Context</em> section is now &#34;<span style="font-family: andale mono,times;">gs.processDelegatedEvents()</span>&#34;, which depends on the <em>Event Delegator</em>.</p>
<p><img class="image-3 jive-image" style="border: 2px solid #cecece; display: block; margin-left: auto; margin-right: auto;" src="2d1b958edbd813043eb27a9e0f961950.iix" alt="The method of the master job is now gs.processDelegatedEvents()" /></p>
<h2>Event Delegator</h2>
<p>The Event Delegator is an internal process that runs on one of the active nodes and checks every 10 seconds for events it can delegate to the processors. By default, each processor will not be assigned more than 3,000 events (in previous releases, the job would claim all events in &#34;<em>ready</em>&#34; state) and will process them sequentially, in order of creation. </p>
<p>This new mechanism helps handle load and bursts of events in a more robust way. In the example above, the contention scenario would have had a minor impact as the &#34;stuck&#34; queue would not have caused a large backlog of events.</p>
<h2>Resources:</h2>
<p><a title="Scheduled Script Executions and Events" href="https://developer.servicenow.com/app.do#!/training/article/app_store_learnv2_automatingapps_istanbul_scheduled_script_executions_and_events/app_store_learnv2_automatingapps_istanbul_scheduled_script_executions_and_events_objectives?v&#61;istanbul" target="_blank" rel="nofollow">Scheduled Script Executions and Events (Developer Training Module)</a></p>
<p><a title="Events and script actions" href="https://developer.servicenow.com/app.do#!/training/article/app_store_learn_coding_istanbul_c_Module8EventsAndScriptActions/app_store_learn_coding_istanbul_c_BusinessRequirementsAttendees?v&#61;istanbul" rel="nofollow">Events and script actions (Developer Training Module)</a></p>