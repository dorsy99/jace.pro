---
title: "MiniLab Converting a UI Script Library From Global to Scoped  Part "
date: 2017-03-28T01:04:44.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=649d6a69dbd0dbc01dcaf3231f9619a9"
---
<p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-size: 10.5pt; font-family: inherit; font-style: inherit; background-position: initial;"><strong>NOTE</strong></span><span style="font-weight: inherit; font-style: inherit; font-size: 10.5pt; font-family: Arial, sans-serif; background-position: initial;">: MY POSTINGS REFLECT MY OWN VIEWS AND DO NOT NECESSARILY REPRESENT THE VIEWS OF MY EMPLOYER, ACCENTURE.</span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 11pt; font-family: Arial, sans-serif; background-position: initial;">DIFFICULTY LEVEL:   </span><span style="color: #7f6000; font-weight: inherit; font-size: 14.6667px; font-family: inherit; font-style: inherit; background-position: initial;"><strong>INTERMEDIATE</strong></span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 11pt; font-family: Arial, sans-serif; background-position: initial;">Assumes basic knowledge and/or familiarity of Client and Server-Side Scripting in ServiceNow.</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 10.5pt; font-family: Arial, sans-serif; background-position: initial;">____________________________________________________________________________</span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">In my previous article (<a title="Mini-Lab: Converting a UI Script Library From Global to Scoped - Part 1" __default_attr="6432" __jive_macro_name="blogpost" class="jive_macro jive_macro_blogpost" data-orig-content="Mini-Lab: Converting a UI Script Library From Global to Scoped - Part 1" data-renderedposition="137.9971466064453_168.9204559326172_524_18" href="/community?id=community_blog&sys_id=6fdcaa65dbd0dbc01dcaf3231f961913">Mini-Lab: Converting a UI Script Library From Global to Scoped - Part 1</a>) I described the whys and wherefores of using the Scoped environment and the Studio versus the old Global environment.   In this article I will present how to convert my old global UI Script function library into a Scoped UI Script library.<br/></span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt; font-family: inherit; font-style: inherit;"><strong>Pre-requisite:</strong></span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">The old UI Script library: </span><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;"><a title="Mini-Lab: Using Ajax and JSON to Send Objects to the Server" __default_attr="5148" __jive_macro_name="blogpost" class="jive_macro jive_macro_blogpost" data-orig-content="Mini-Lab: Using Ajax and JSON to Send Objects to the Server" data-renderedposition="277.0880432128906_184.0482940673828_458_18" href="/community?id=community_blog&sys_id=cd1eae2ddbd0dbc01dcaf3231f9619df">Mini-Lab: Using Ajax and JSON to Send Objects to the Server</a> </span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">The purpose of this UI Script is to provide a generic AJAX interface between client side (sic. browser) code and server-side functions.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 14pt;"><strong>Lab 1.1: Using JSON and AJAX to Transmit a Complex Object to the Server</strong></span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">Based on the design from my Using Ajax and JSON article; we re-work it slightly to indicate the scoped components.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;"><img   class="jive-image image-14" src="664e8086db9c1344e9737a9e0f961970.iix" style="width: auto; height: auto; display: block; margin-left: auto; margin-right: auto;"/></span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p><span style="color: #666666; font-size: 12pt; font-family: arial, helvetica, sans-serif;">We will be working the application from the bottom-up.   Building from the Script Include function class to finally the UI Action that will be calling the whole chain.   This entire lab was written on my personal developer instance that has been upgraded to Istanbul Patch 1.</span></p><p></p><p></p><p><span style="color: #666666; font-size: 18pt; font-family: arial, helvetica, sans-serif;"><strong>The Scoped Application</strong></span></p><p></p><p></p><p><span style="color: #666666; font-size: 14pt; font-family: arial, helvetica, sans-serif;"><strong>The Studio, and the UI Script</strong></span></p><p></p><p><span style="color: #666666; font-size: 16px; font-family: arial, helvetica, sans-serif;">So, let's get started.   First we will need to create a scoped application.</span></p><p></p><p><span style="color: #666666; font-size: 16px; font-family: arial, helvetica, sans-serif;">1. Navigate to System Applications -&gt; Studio.   The Load Application form will be displayed.</span></p><p></p><p><img   class="image-7 jive-image" height="283" src="6a07888adb9cd3041dcaf3231f961912.iix" style="max-width: 1200px; max-height: 900px; height: 283px; width: 284.59px;" width="285"/></p><p></p><p><span style="font-size: 12pt;">2. Click on the Create Application Button.   The Create Application choice form will be displayed.</span></p><p><span style="font-size: 12pt;">3. We will be using the Start from scratch option.   Click on the Create button.   The Create Application property form will be displayed.</span></p><p></p><p><span style="font-size: 12pt;"><img   class="jive-image image-8" height="275" src="75d233bddb105704ed6af3231f9619c7.iix" style="max-width: 1200px; max-height: 900px; height: 275px; width: 652.474px;" width="653"/></span></p><p></p><p><span style="font-size: 12pt;">4. Fill in the form with the following:</span></p><p></p><p><span style="font-size: 12pt;"><strong>Name</strong>: Using Ajax and JSON to Send Objects to the Server</span></p><p><span style="font-size: 12pt;"><strong>Scope</strong>: x_1234_using_ajax</span></p><p></p><p><span style="font-size: 12pt;"><strong>Note</strong>:   The Scope field will auto-fill using your "company code".   This will be different than the 1234 in my example above.</span></p><p><span style="font-size: 12pt;"><img   class="image-9 jive-image" height="211" src="2910110edb94130468c1fb651f9619ff.iix" style="max-width: 1200px; max-height: 900px; height: 211px; width: 676.049px;" width="676"/></span></p><p></p><p></p><p><span style="font-size: 12pt;">5. Click on the Create button.   The Studio form will be displayed.</span></p><p></p><p><span style="font-size: 12pt;">6. Click on the Create Application File button.   The Create Application File choice form will be displayed.</span></p><p></p><p><img   class="jive-image image-10" height="402" src="b87dec46db9857049c9ffb651f96196d.iix" style="max-width: 1200px; max-height: 900px; height: 402px; width: 683.286px;" width="684"/></p><p></p><p><span style="font-size: 12pt;">7. Enter Script Include in the search filter text box.   The Filter Results will show Script Include.</span></p><p></p><p><span style="font-size: 12pt;">8. Click on the Create button.   The new Script Include form will be displayed.</span></p><p></p><p><span style="font-size: 12pt;"><img   class="image-11 jive-image" height="422" src="e14e0ccadb101f048c8ef4621f9619ea.iix" style="max-width: 1200px; max-height: 900px; width: 681px; height: 421.917px;" width="681"/></span></p><p></p><p><span style="font-size: 12pt;">9. Fill in the form with the following:</span></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Name</strong>: JavascriptUtils</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Accessable from:</strong> All application scopes</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Active</strong>: checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Description</strong>: Various useful utilities. Note: These were adapted from the JSUtil library</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Protection Policy</strong>: -- None -- (automatically set for personal instances)</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Script</strong>: </span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14906287028133568 jive_text_macro" data-renderedposition="3853.337890625_7.997159004211426_1192_386" jivemacro_uid="_14906287028133568"><p><span style="font-size: 12pt;">var JavascriptUtils = Class.create();</span></p><p></p><p><span style="font-size: 12pt;">// This nil check works for Scoped applications</span></p><p><span style="font-size: 12pt;">JavascriptUtils.nil = function(item) {</span></p><p><span style="font-size: 12pt;">   var nilCheck = true;</span></p><p><span style="font-size: 12pt;">   try {</span></p><p><span style="font-size: 12pt;">       nilCheck = !item </span></p><p><span style="font-size: 12pt;">           || (item == null) </span></p><p><span style="font-size: 12pt;">           || (typeof item == 'undefined') </span></p><p><span style="font-size: 12pt;">           || ('' == '' + item) </span></p><p><span style="font-size: 12pt;">           || (item == 'undefined');</span></p><p><span style="font-size: 12pt;">   }</span></p><p><span style="font-size: 12pt;">   catch(err) {</span></p><p><span style="font-size: 12pt;">       gs.error('---&gt; [{1}-{2}] \n{0}', </span></p><p><span style="font-size: 12pt;">           [err, new GlideDateTime().getNumericValue()], 'SI:' + this.type + '.nil');</span></p><p><span style="font-size: 12pt;">   }</span></p><p></p><p><span style="font-size: 12pt;">   return nilCheck;</span></p><p><span style="font-size: 12pt;">};</span></p><p></p><p><span style="font-size: 12pt;">JavascriptUtils.notNil = function(item) {</span></p><p><span style="font-size: 12pt;">   return !this.nil(item);</span></p><p><span style="font-size: 12pt;">};</span></p><p></p><p></p></pre><p></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">10. Click the submit button to save your work.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><img   class="image-12 jive-image" height="360" src="aa7a63b5dbd09b048c8ef4621f961967.iix" style="max-width: 1200px; max-height: 900px; width: 660px; height: 360px;" width="660"/></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;"><strong>Note</strong>:   This is our "bottom-most" library.   We will be using this in our other Script Includes.   Since JSUtil does not work in the scoped environment (it contains a Packages.Java.String call), we needed to have an analog that would work.   This is a good, not best, but good workaround.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">11. Now repeat this step and create another Script Include.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">12. Fill out the form with the following:</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Name</strong>: ArrayHandlingUtils</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Accessable from:</strong> All application scopes</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Active</strong>: checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Description</strong>: </span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">Various array utilities</span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">Contains:</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">getEmailsFromSysIDs - retrieve all user records in the list of sys_ids </span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Protection Policy</strong>: -- None -- (automatically set for personal instances)</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Script</strong>: </span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14906296069422622" data-renderedposition="5168.79248046875_7.997159004211426_1192_881" jivemacro_uid="_14906296069422622"><p><span style="font-size: 12pt;">var JSUtil = JavascriptUtils;</span></p><p></p><p><span style="font-size: 12pt;">var ArrayHandlingUtils = Class.create();</span></p><p></p><p><span style="font-size: 12pt;">ArrayHandlingUtils.prototype = {</span></p><p><span style="font-size: 12pt;">       initialize: function() {},</span></p><p><span style="font-size: 12pt;">               </span></p><p><span style="font-size: 12pt;">       //retrieve all user records in the list of sys_ids</span></p><p><span style="font-size: 12pt;">       getEmailsFromSysIDs : function(listInfo) {</span></p><p><span style="font-size: 12pt;">               </span></p><p><span style="font-size: 12pt;">       try {</span></p><p><span style="font-size: 12pt;">       </span></p><p><span style="font-size: 12pt;">               var sysIDList = listInfo.list;</span></p><p><span style="font-size: 12pt;">               gs.info('---&gt; [{1}-{2}] \n{0}', </span></p><p><span style="font-size: 12pt;">                       [sysIDList.length, </span></p><p><span style="font-size: 12pt;">                         new GlideDateTime().getNumericValue(), </span></p><p><span style="font-size: 12pt;">                         this.type + '.getEmailsFromSysIDs']);</span></p><p></p><p><span style="font-size: 12pt;">               var userRecords = new GlideRecord('sys_user');</span></p><p><span style="font-size: 12pt;">               userRecords.addQuery('sys_id', 'IN', sysIDList);</span></p><p><span style="font-size: 12pt;">               userRecords.query();</span></p><p></p><p><span style="font-size: 12pt;">               var userList = [];</span></p><p></p><p><span style="font-size: 12pt;">               while (userRecords.next()) {</span></p><p><span style="font-size: 12pt;">                       var user = {};</span></p><p><span style="font-size: 12pt;">                       user.name = userRecords.name + '';</span></p><p><span style="font-size: 12pt;">                       var email = userRecords.email + '';</span></p><p><span style="font-size: 12pt;">                       user.email = JSUtil.notNil(email) ? email : 'no email found';</span></p><p></p><p><span style="font-size: 12pt;">                       userList.push(user);</span></p><p><span style="font-size: 12pt;">               }</span></p><p><span style="font-size: 12pt;">       </span></p><p><span style="font-size: 12pt;">               var message = '';</span></p><p><span style="font-size: 12pt;">               message += 'Location: ' + listInfo.location + '\n';</span></p><p></p><p><span style="font-size: 12pt;">               for (var i=0; i &lt; userList.length; i++) {</span></p><p><span style="font-size: 12pt;">                       message += 'EMail[' + i + ']: '</span></p><p><span style="font-size: 12pt;">                               + userList[i].name + ' - '</span></p><p><span style="font-size: 12pt;">                               + userList[i].email + '\n';</span></p><p><span style="font-size: 12pt;">               }</span></p><p></p><p><span style="font-size: 12pt;">               gs.info('---&gt; [{1}-{2}] \n{0}', </span></p><p><span style="font-size: 12pt;">                       [message, </span></p><p><span style="font-size: 12pt;">                         new GlideDateTime().getNumericValue(), </span></p><p><span style="font-size: 12pt;">                         this.type + '.getEmailsFromSysIDs']);</span></p><p><span style="font-size: 12pt;">               }</span></p><p><span style="font-size: 12pt;">               catch(err) {</span></p><p><span style="font-size: 12pt;">                       gs.error('---&gt; [{1}-{2}] \n{0}', </span></p><p><span style="font-size: 12pt;">                               [err, </span></p><p><span style="font-size: 12pt;">                                   new GlideDateTime().getNumericValue(), </span></p><p><span style="font-size: 12pt;">                                   this.type + '.getEmailsFromSysIDs']);</span></p><p><span style="font-size: 12pt;">               }</span></p><p><span style="font-size: 12pt;">       },</span></p><p><span style="font-size: 12pt;">       </span></p><p><span style="font-size: 12pt;">       type: 'ArrayHandlingUtils'</span></p><p><span style="font-size: 12pt;">};</span></p></pre><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;"><strong>Note: </strong>We do not have to use a qualified call to the JavascriptUtils function to include it since it is already in our namespace.   No need to do gs.include() either.<strong>   </strong></span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">13. Click on the Submit button to save your work.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">14. Ok, repeat one last time to create our Ajax Script Include that will be called from the client.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">15. Fill out the form with the following:</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Name</strong>: AjaxUtilsServer</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Accessable from:</strong> All application scopes</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Active</strong>: checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Client callable</strong>: checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Description</strong>: Description: Method for decoding the passed JSON object and writing it to the system log</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Protection Policy</strong></span><span style="font-size: 12pt;">: -- None -- (automatically set for personal instances)</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Script</strong></span><span style="font-size: 12pt;">:</span></p><p></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14906298962064542" data-renderedposition="6461.51953125_7.997159004211426_1192_185" jivemacro_uid="_14906298962064542"><p>var AjaxUtilsServer = Class.create();</p><p>AjaxUtilsServer.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {</p><p>       </p><p>       pushListToSysLog: function() {</p><p>               var listInfo = global.JSON.parse(this.getParameter('sysparm_listInfo'));</p><p>               </p><p>               new ArrayHandlingUtils().getEmailsFromSysIDs(listInfo);</p><p>       },</p><p>       </p><p>       type: 'AjaxUtilsServer'</p><p>});</p><p></p></pre><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;"><strong>NOTE:</strong> Write down the API Name. You will be using this name to call into this Script Include from your UI Script.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">16. Click the Submit button to save your work.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;"><strong><img   class="image-13 jive-image" height="366" src="627d49cadbd0d304b322f4621f961958.iix" style="max-width: 1200px; max-height: 900px; width: 721px; height: 366.508px;" width="721"/></strong></span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">17. Click on Create Application File, and create a new UI Script.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">18. Fill out the form with the following:</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Script Name</strong>: AjaxUtilsClient</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Description</strong>: Transmits a list of sys_ids to the server to be pushed to the System Log.   </span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Use Scoped Format</strong>: unchecked.</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Script</strong>:</span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14906316405203590 jive_text_macro" data-renderedposition="7376.06494140625_7.997159004211426_1192_325" jivemacro_uid="_14906316405203590"><p>var utils = Class.create();</p><p></p><p>utils.sendListToSysLog = function(list, location) {</p><p>       try {</p><p>               var infoOnList = {};</p><p>               infoOnList.location = location;</p><p>               infoOnList.list = list.split(',');</p><p></p><p>               var systemLogger = new GlideAjax('x_1234_using_ajax.AjaxUtilsServer');</p><p>               systemLogger.addParam('sysparm_name','pushListToSysLog');</p><p>               systemLogger.addParam('sysparm_listInfo', JSON.stringify(infoOnList));</p><p></p><p></p><p>               systemLogger.getXML(function(result){ });   // no callback action</p><p>       }</p><p>       catch(err) {</p><p>               alert('---&gt; ERROR: ' + err);</p><p>       }</p><p>};</p><p></p><p></p></pre><p></p><p><span style="font-size: 16px;"><strong>NOTE</strong></span><span style="font-size: 16px;">: Replace the x_1234 in line 6 with your own ServiceNow company code. </span></p><p></p><p><img   class="image-15 jive-image" height="358" src="62a0d08edb5417041dcaf3231f9619f2.iix" style="max-width: 1200px; max-height: 900px; width: 637px; height: 358.313px;" width="637"/></p><p><span style="font-size: 12pt;"><strong>NOTE</strong>: When you save the system will throw an error and tell you that the script is missing the Immediately Invoked code.   Ignore this error, and continue with the save.   The error is bogus.   It appears that the system does not want or like you to use this type of script which is nonsense.</span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">19. Lastly, let's create a UI Action to drive the entire chain.   <span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">Click on Create Application File, and create a new UI Action.</span></span></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="color: #666666; font-size: 16px; font-family: arial, sans-serif;"><strong>NOTE</strong>: We will build this as part of our scoped application, but it does not necessarily have to be part of it.   It could be built in the Global namespace.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="color: #666666; font-size: 16px; font-family: arial, sans-serif;">20. Fill out the form with the following:</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="padding-left: 30px;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="font-style: inherit; font-family: inherit;"><strong>Name</strong></span>: Transfer Watchlist</span></p><p style="padding-left: 30px;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="font-style: inherit; font-family: inherit;"><strong>Table:</strong></span> Incident</span></p><p style="padding-left: 30px;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="font-style: inherit; font-family: inherit;"><strong>Active</strong></span>: checked</span></p><p style="padding-left: 30px;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="font-style: inherit; font-family: inherit;"><strong>Show Insert</strong></span>: checked</span></p><p style="padding-left: 30px;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="font-style: inherit; font-family: inherit;"><strong>Show Update</strong></span>: checked</span></p><p style="padding-left: 30px;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="font-style: inherit; font-family: inherit;"><strong>Client</strong></span>: checked</span></p><p style="padding-left: 30px;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="font-style: inherit; font-family: inherit;"><strong>Form Button</strong></span>: checked</span></p><p style="padding-left: 30px;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="font-style: inherit; font-family: inherit;"><strong>OnClick</strong></span>: sendWatchList()</span></p><p style="padding-left: 30px;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;">Form Action: Checked (done automatically).</span></p><p style="padding-left: 30px;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="font-style: inherit; font-family: inherit;"><strong>Script</strong></span>:</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14906329476587560 jive_macro_code jive_text_macro" data-renderedposition="8586.974609375_7.997159004211426_1192_355" jivemacro_uid="_14906329476587560"><p>function sendWatchList() {</p><p>       </p><p>       try {</p><p>               // this is the only way to load a UI Script Library into a scoped Client Script!</p><p>               // loads the utils library</p><p>               ScriptLoader.getScripts('x_0462_using_ajax.AjaxUtilsClient.jsdbx', followup);</p><p>       }</p><p>       catch (err) {</p><p>               alert(err);</p><p>       }</p><p>       </p><p>       // After the UI Script Library has been loaded then continue</p><p>       function followup(result) {</p><p>               try {</p><p>     <span style="color: rgba(0, 0, 0, 0); font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px;">   </span><span style="color: rgba(0, 0, 0, 0); font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px;">   </span><span style="color: rgba(0, 0, 0, 0); font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px;">   </span> utils.sendListToSysLog(g_form.getValue('watch_list'), 'UIA:Transfer Watch List');</p><p>               }</p><p>               catch (err) {</p><p>       <span style="color: rgba(0, 0, 0, 0); font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px;">   </span><span style="color: rgba(0, 0, 0, 0); font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px;">   </span><span style="color: rgba(0, 0, 0, 0); font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px;">   </span>alert('---&gt; ERROR: ' + err);</p><p>               }</p><p>       }</p><p>}</p><p></p><p></p></pre><p style="font-family: arial, sans-serif; color: #666666;"></p><p><span style="font-size: 12pt;"><strong>NOTE</strong>: Replace the x_1234 in line 6 with your own ServiceNow company code.   Also, notice how much this script differs from how it would be done in the Global environment.   In addition see that there is now a loader step that occurs prior to being able to use the library.   This is done via an asynchronous (async) call-back that loads the script from the server (the on-demand bit).</span></p><p></p><p><span style="color: #666666; font-size: 12pt; font-family: arial, helvetica, sans-serif;">21.   Click the Submit button to save your work.   We are now done with our Scoped application, and it is time to do some testing!</span></p><p></p><p><span style="color: #666666; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><img   class="image-16 jive-image" height="348" src="c59e6f79db1c1fc03eb27a9e0f9619ad.iix" style="max-width: 1200px; max-height: 900px; height: 348px; width: 684.59px;" width="685"/></span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-size: 18.6667px; font-family: inherit; font-style: inherit;"><strong>Unit Test</strong></span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;">Our unit test will be what we had in the previous article.<br/></span></p><p></p><ol style="font-family: arial, sans-serif; color: #666666;"><li><span style="font-weight: inherit; font-style: inherit; font-family: arial, helvetica, sans-serif; font-size: 12pt;">First go and in-activate the original UI Action; if you did the previous article.   We will only be using the new (same named) UI Action we created in the Studio.</span></li><li><span style="font-weight: inherit; font-style: inherit; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Navigate to Incidents -&gt; Open.   The list view of open Incidents will be displayed.</span></li><li><span style="font-weight: inherit; font-style: inherit; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Open one of the Incidents.   You should have a new button labeled: <span style="font-style: inherit; font-family: inherit;"><strong>Transfer Watchlist</strong></span>.<br/><br/><a _jive_internal="true" href="/servlet/JiveServlet/downloadImage/38-5148-71013/pastedImage_51.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img   class="image-9 jive-image" height="37" src="dd0f688edb98d704ed6af3231f961950.iix" style="margin: 10px 10px 10px 0px; border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; height: 37px; width: 694.411px;" width="695"/></a><br/></span></li><li><span style="font-weight: inherit; font-style: inherit; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Make sure there are four or five people on the watchlist.   Add some if you have to.<br/><br/><a _jive_internal="true" href="/servlet/JiveServlet/downloadImage/38-5148-71009/pastedImage_46.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img   class="jive-image image-8" height="152" src="1cff8402db505304b322f4621f961959.iix" style="margin: 10px 10px 10px 0; border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit;" width="407"/></a><br/></span></li><li><span style="font-weight: inherit; font-style: inherit; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Click on the Transfer Watchlist button.   Observe that the spinner (activity indicator) in the upper right of the form activates for a second or two then goes away.   That is your only indicator that something happened.   I guess we could always go back and put in an alert that things have finished, but this is supposed be a lab that emulates something you might do for real!   </span><br/><br/><span style="font-size: 12pt;"><a _jive_internal="true" href="/servlet/JiveServlet/downloadImage/38-5148-71007/pastedImage_44.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img   class="image-7 jive-image" height="52" src="9ed23f31db1c9b048c8ef4621f9619b6.iix" style="margin: 10px 10px 10px 0; border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit;" width="205"/></a></span><br/><br/></li><li><span style="font-weight: inherit; font-style: inherit; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Navigate to System Log -&gt; All.   Filter on Message starts with ---&gt;.   Order by Message descending.   Note how I placed milliseconds into the gs.info messages?   This allows me to sort by true date descending.   This is REALLY important if you are trying to figure out exactly in which order things occurred in your code!</span></li><li><span style="font-weight: inherit; font-style: inherit; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Expected Result:   A list of names and emails matching the watchlist should be present as a log entry.</span></li></ol><p></p><p><img   class="image-17 jive-image" height="186" src="cb669902dbd81b04ed6af3231f9619ed.iix" style="max-width: 1200px; max-height: 900px; height: 186px; width: 746.488px;" width="746"/></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-family: arial, helvetica, sans-serif; font-size: 12pt;">And there you have it!   Conversion of a Global UI Script and all of it's call chain into a Scoped application.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;">Steven Bell</span></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><a _jive_internal="true" href="/servlet/JiveServlet/downloadImage/38-6432-261212/Combined Logo Graphic_Operations.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img   alt="Combined Logo Graphic_Operations.png" class="image-5 jive-image" height="92" src="84a96486db9857041dcaf3231f961968.iix" style="margin: 10px 10px 10px 0; border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit;" width="340"/></a></p><p dir="ltr"></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: bold; font-style: inherit; font-family: Arial;">For a list of all of my articles:   </span><a _jive_internal="true" href="/groups/servicenow-user-group-us-tx-north-texas/blog/2015/10/23/community-code-snippets-articles-list-to-date" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><span style="font-weight: bold; font-style: inherit; font-family: Arial;">Community Code Snippets: Articles List to Date</span></a></p><p dir="ltr"></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 14.6667px; font-family: Arial; color: #eb7a3d;">Please Share, Like, Bookmark, Mark Helpful, or Comment this blog if you've found it helpful or insightful.</span></p><p dir="ltr"></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 14.6667px; font-family: Arial; color: #eb7a3d;">Also, if you are not already, I would like to encourage you to become a member of our blog!</span></p>