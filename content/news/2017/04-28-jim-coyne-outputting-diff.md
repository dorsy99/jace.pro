---
title: "Outputting Different Information From One Email Script"
date: 2017-04-27T22:23:08.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=387c22e1dbd0dbc01dcaf3231f961994"
---
<p>It's always a good idea to write and maintain the minimum amount of code as possible, so minimizing the number of <a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/script/server-scripting/concept/c_UseJavaScriptInEmails.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/script/server-scripting/concept/c_UseJavaScriptInEmails.html">Email Scripts</a> is helpful.   But can we have just one script AND output different content based on the target audience of the notification?   You want to stay away from writing different scripts to output slightly different text, like an additional field for example, based on the target audience.   Email Scripts do not support passing parameters, which would be helpful in this scenario, but we can get around that by adding the parameter on the Notification record instead, which is where you define your target audience anyways.</p><p></p><p>First, add a new field on the Notification form:</p><p><img  class="image-1 jive-image" src="5e6461c2db105b04ed6af3231f96199f.iix" style="max-width: 1200px; max-height: 900px;"/></p><p>It can be as simple as a string field or you can create a Choice List for it as well.</p><p></p><p>Create the Mail Script that will contain the text you want to output as well as the logic for supporting slightly different text:</p><p><img  class="image-3 jive-image" src="2a3f3cc2db9c9344e9737a9e0f961968.iix" style="max-width: 1200px; max-height: 900px;"/></p><p>My example is not very useful, but you get the idea.</p><p></p><p>And lastly, in the Notification record, call the Mail Script from within the HTML field:</p><p><img  class="jive-image image-4" src="efb48442dbd41344e9737a9e0f9619da.iix" style="max-width: 1200px; max-height: 900px;"/></p><p>Depending on your own use case, you could even create an Email Template that contains the default text and the call to the Mail Script to really keep maintenance to a minimum.</p><p></p><p>So when the Email Script is run, it will check the field on the Notification record and output different text based on that value.   Here's a <a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/task/t_PreviewingNotifications.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/task/t_PreviewingNotifications.html">preview</a> of 3 different Notifications I created, all using the same Email Script, but with different values in the Custom parameter field.   They all output something different from that 1 script.</p><p></p><p>First Notification:</p><p><img  class="jive-image image-8" src="1eb26042dbd057049c9ffb651f9619b6.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p>Second:</p><p><img  class="image-6 jive-image" src="13d22739db141fc03eb27a9e0f961929.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p>Third:</p><p><img  class="image-7 jive-image" src="a893818edb50130468c1fb651f9619ce.iix" style="max-width: 1200px; max-height: 900px;"/></p>