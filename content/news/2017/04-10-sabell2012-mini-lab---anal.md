---
title: "MiniLab  Analysis Example Chasing Down Hidden Data  Part "
date: 2017-04-09T18:18:45.000Z
authors: ["sabell2012"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=9f0d6ea5dbd0dbc01dcaf3231f961908"
---
<p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-size: 10.5pt; font-family: inherit; font-style: inherit; background-position: initial;"><strong>NOTE</strong></span><span style="font-weight: inherit; font-style: inherit; font-size: 10.5pt; font-family: Arial, sans-serif; background-position: initial;">: MY POSTINGS REFLECT MY OWN VIEWS AND DO NOT NECESSARILY REPRESENT THE VIEWS OF MY EMPLOYER, ACCENTURE.</span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 11pt; font-family: Arial, sans-serif; background-position: initial;">DIFFICULTY LEVEL:   </span><span style="color: #7f6000; font-weight: inherit; font-size: 14.6667px; font-family: inherit; font-style: inherit; background-position: initial;"><strong>INTERMEDIATE</strong></span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 11pt; font-family: Arial, sans-serif; background-position: initial;">Assumes basic knowledge and/or familiarity of the ServiceNow platform, and Scripting in ServiceNow.</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-size: 10.5pt; font-family: Arial, sans-serif; font-style: inherit; background-position: initial;">____________________________________________________________________________</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">Have you ever wondered how a senior developer, in the ServiceNow platform, comes up with the application information that they do?   What process do they follow?   How is it they chase down information in the platform?</span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">Sometimes it is necessary to really dig, into the platform, to find the information you are wanting to display for the user.   In this two-part article you will investigate where certain system information is stored, how to interpret what you have found, and then script it to retrieve the data.   </span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 14pt;"><strong>Scenario</strong></span></p><p style="margin-bottom: .0001pt;"></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">As an Admin it is possible to retrieve system information via the <strong>stats.do</strong> page.   This page is not to be found in the UI Pages or UI Macros list views.   So it appears to be built-in, or constituted on-the-fly.   But where is the information found on this page actually stored?   And, how can we access it and turn it to our own purposes?</span></p><p></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-size: 14pt;"><strong>Pre-Requisites</strong></span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">There are a couple of areas that we will be working with that we will be using in the following labs.   You might want to brush up on them before continuing:</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;">Fix Scripts - <span style="font-size: 16px; font-family: arial, helvetica, sans-serif; color: #666666;"><strong><a title="" _jive_internal="true" data-containerid="1007" data-containertype="37" data-objectid="5416" data-objecttype="38" href="/community?id=community_blog&sys_id=e81eae2ddbd0dbc01dcaf3231f96194f" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;">ServiceNow Scripting 101: Two Methods for Code Development</a></strong></span></span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-size: 12pt;"><a href="https://docs.servicenow.com/bundle/istanbul-application-development/page/build/applications/concept/c_ServiceNowStudio.html" title="https://docs.servicenow.com/bundle/istanbul-application-development/page/build/applications/concept/c_ServiceNowStudio.html">ServiceNow Studio</a> </span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><span style="font-size: 14pt;"><strong>Analysis &amp; Investigation</strong></span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">First let's go take a look at the page in question.</span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">1. Type <strong>stats</strong> in the Navigation Filter</span></p><p style="margin-bottom: .0001pt;"></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">2. In the navigator click on the System Diagnostics &gt; Stats &gt; Stats.   The Stats.do form will be displayed.   </span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><img   class="image-19 jive-image" height="345" src="0b1f140edb1057049c9ffb651f9619d6.iix" style="width: 620px; height: 443px;" width="485"/></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">You will notice at the top that there is a lot of useful information here.   Build name, build patch, build date, url, and a lot more.   This is the "cluster" information.   There are typically two servers clustered together for each ServiceNow instance.   This allows for fail-over in case something should happen to the "active" node of the cluster.   This will give us something to focus our search on where this information lives:   cluster.</span></p><p></p><p style="margin-bottom: .0001pt;"><span style="font-size: 10pt;">NOTE:   If you are ever interested in what open source software is being used by the ServiceNow platform just click on the link: Open Source Software.   This contains all of the various open source titles AND their current versions.   It makes for interesting reading.</span></p><p></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">3. In looking for "hidden" information like this it is sometimes fruitful to go and see what applications are not active. Since we are interested in anything that might have the title "<strong>cluster</strong>".   First we see if there is perhaps something already available in the nav menu.   </span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 10pt;">NOTE: Another place to look would be to search out the UI Pages, UI Macros, or Script Includes to see if there is any reference to "cluster".   This would be my usual search order for something like this.</span></p><p></p><p><span style="font-size: 12pt;">4. Type <strong>cluster</strong> in the nav filter.</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"><img   class="image-20 jive-image" height="571" src="792b5002db9c17049c9ffb651f961974.iix" style="width: 277px; height: 570.294px;" width="277"/></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">You will see that there are only entries under Configuration (CMDB), and MID Server.   Neither of these are pertinent to our quest!</span></p><p></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">Next let's see if perhaps there is something we could use that just isn't turned on in the menu.</span></p><p></p><p><span style="font-size: 12pt;">4. Type <strong>Application Menus </strong>in the nav filter.</span></p><p></p><p><span style="font-size: 12pt;">5. Navigate to <strong>System Definition &gt; Application Menus</strong></span></p><p></p><p><span style="font-size: 12pt;">6. Modify the filter to search for everything with the word <strong>Cluster</strong> in the Name field, and make sure that active is true or false (default is true). We notice that there is an application listed by the name of System Cluster.   And it is not active!   Looks promising.</span></p><p></p><p><img   class="jive-image image-21" height="115" src="c8da3ff1db90db048c8ef4621f9619f2.iix" style="width: 620px; height: 113px;" width="625"/></p><p></p><p><span style="font-size: 12pt;">7. Click on <strong>System Cluster</strong>.   You will note that there are five modules contained here.   Since we know what is being displayed in stats.do is the current cluster node status, the link Node States looks promising.   It shows there is a table called: sys_cluster_state.</span></p><p></p><p><img   class="image-22 jive-image" height="423" src="4cbaa182dbd0d7049c9ffb651f96192f.iix" style="width: 620px; height: 424px;" width="617"/></p><p></p><p><span style="font-size: 12pt;">8. In the nav filter type in <strong>sys_cluster_state.list</strong>.   The list view for that table will be displayed.   This is where the cluster node state information lives!   Ah, better and better!   Only one cluster node is displayed (the one we are logged into), and it has a system id that looks like the one we saw in the stats.do page.</span></p><p></p><p><img   class="image-23 jive-image" height="114" src="f9c58586db9897041dcaf3231f9619aa.iix" style="width: 617px; height: 113.631px;" width="617"/></p><p></p><p><span style="font-size: 12pt;">9. Click on the <strong>Info button </strong>for that one record.   The Node State form should appear.   And this contains the patch info under the Assigned version field.   Okay, we are cooking with gas now!</span></p><p></p><p><img   class="image-26 jive-image" height="267" src="bd53808adb18db048c8ef4621f961905.iix" style="width: 620px; height: 268px;" width="619"/></p><p></p><p><span style="font-size: 12pt;">10. Right-click on the <strong>Assigned version</strong> label.   You will find that there is NO field there!   Right-clicking on Additional details does not show us a field either.   This is generated information that is tacked onto the end of the form.   So let's go find out what is actually being referenced for this information to be displayed.   Whenever you see something like this you will need to suspect it is actually a UI Macro that is being referenced and not a field.</span></p><p></p><p><span style="font-size: 12pt;">11. Right-click on the <strong>form header</strong> to the display the <strong>context menu</strong> for the form.</span></p><p></p><p><span style="font-size: 12pt;">12. Navigate to <strong>Configure &gt; Form Layout</strong>.   The form layout form will be displayed.   </span><span style="font-size: 12pt;"> </span></p><p></p><p><img   class="jive-image image-25" height="356" src="df742c82db90dfc068c1fb651f961950.iix" style="width: 620px; height: 349px;" width="635"/></p><p></p><p><span style="font-size: 16px;">13. Notice that there is an oddly named field: <strong>Cluster State Summary</strong> at the end of the "Selected" list.   This is not a real field (column); you won't find it in the "Available" fields.   It is more likely to be a UI Macro.   To be sure, we will check the table dictionary for this table (sys_cluster_state).</span></p><p></p><p><img   class="image-27 jive-image" height="399" src="1434e9cedbd4d7041dcaf3231f961941.iix" style="width: 620px; height: 377px;" width="658"/></p><p></p><p><span style="font-size: 12pt;">14. Click on the <strong>Cancel</strong> button.</span></p><p></p><p><span style="font-size: 12pt;">15. Navigate back to sys_cluster_state.list.</span></p><p></p><p><span style="font-size: 12pt;">16. Right-Click on the <strong>list view header bar</strong> to get the list view context menu.</span></p><p></p><p><span style="font-size: 12pt;">17. Choose <strong>Configure &gt; Dictionary</strong>. The Dictionary Entries for the table will be displayed.</span></p><p></p><p><img   class="image-28 jive-image" height="475" src="622b50c6db981f048c8ef4621f9619ff.iix" style="width: 620px; height: 470px;" width="626"/></p><p></p><p><span style="font-size: 12pt;">18. Order the list by Column name ascending, and l</span><span style="font-size: 12pt;">ook through the list for the field: <strong>Cluster State Summary</strong>.   Not there.   That pretty much clinches it.   It has to be a <strong><a href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/script/server-scripting/concept/c_UIMacros.html" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/script/server-scripting/concept/c_UIMacros.html">UI Macros</a></strong>.   UI Macros provide a way of creating your own container to build a specialized display like this and tack it into a form.   Thus such a container would be my first guess.   </span></p><p></p><p><span style="font-size: 12pt;"><img   class="jive-image image-29" src="b8dabff1db90db048c8ef4621f961956.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;">19.   Alright, time to go look.   In the nav menu type <strong>UI Macro</strong>.</span></p><p></p><p><span style="font-size: 12pt;">20. Navigate to <strong>System UI &gt; UI Macros</strong>.   The UI Macros list will appear.</span></p><p></p><p><span style="font-size: 12pt;">21. Change the list filter to look for all names that contain the word: <strong>cluster</strong>.   Bingo! There is one: <strong>cluster_state_summary</strong>!</span></p><p></p><p><img  class="jive-image image-32" src="62c5898adbd013043eb27a9e0f961983.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p><span style="font-size: 12pt;">22. Click on the <strong>cluster_state_summary</strong> info button. The Macro form will be displayed.</span></p><p></p><p><span style="font-size: 12pt;">23. In the XML section of the macro we observe that there is a section of code that actually shows where the information is being retrieved from!   </span></p><p></p><p><span style="font-size: 12pt;">Ah ha!   We notice that this information is being kept in the sys_cluster_state table in a field named stats.   It was there all along!   The UI Macro just takes some of the data and formats it nicely for display.   So it appears we may have our code example to retrieve the patch information we want!   </span></p><p></p><p><span style="font-size: 12pt;">We shall, um, appropriate it for our own uses.   </span><span style="font-size: 12pt;">BTW, this code is not scope safe.   The "$" and XMLDocument are not allowed.   So, we will have to find another way to do the same thing in our code.</span></p><p></p><p><img   class="image-31 jive-image" height="308" src="20ba254edb5053043eb27a9e0f9619f2.iix" style="width: 620px; height: 311px;" width="612"/></p><p></p><p><span style="font-size: 12pt;">24. Copy ALL of the code inside the <strong>&lt;g2:evaluate&gt;</strong> tag (to the end of &lt;/g2:evaluate&gt;). Just the code, and not the tags. Paste this in your favorite editor for safe-keeping (we will look at it now, and reference it as we construct our code).</span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14920377326351006 jive_text_macro" data-renderedposition="7048.90576171875_7.997159004211426_1176_294" jivemacro_uid="_14920377326351006"><p>           var g_xmlDoc = null;</p><p>           var g_url = "";</p><p></p><p></p><p>           var g_baseRecord = new GlideRecord('sys_cluster_state');</p><p>           if (g_baseRecord.get('$[sys_id]')) {</p><p>                   g_xmlDoc = new XMLDocument(g_baseRecord.stats + '');</p><p><span>                   g_http_url = '</span><a title="k-external-small" class="jive-link-external-small" href="http://" rel="nofollow" target="_blank">http://</a><span>' + g_xmlDoc.getNodeText('//servlet.hostname') + ':' + g_xmlDoc.getNodeText('//servlet.port');</span></p><p></p><p></p><p>                   var ngr = new GlideRecord('sys_trigger');</p><p>                   ngr.addQuery('system_id', g_baseRecord.system_id);</p><p>                   ngr.query();</p><p></p><p></p><p>                   g_jobs_assigned = ngr.getRowCount();</p><p>           }</p><p></p><p></p></pre><p></p><p><span style="font-size: 12pt;">And that is it for our investigation/analysis stage of things!</span></p><p></p><p><span style="font-size: 12pt;">Obviously when you get comfortable with where information might be stored in the platform you can skip some of these steps.   What I endeavored to show here were the exhaustive steps so that you would get the idea on what is involved to actually track the desired data down.</span></p><p></p><p><span style="font-size: 12pt;">In my next article I will be showing how to utilize the material we have located, and incorporate it into something for our own use!</span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;">Steven Bell</span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><a _jive_internal="true" href="/servlet/JiveServlet/downloadImage/38-6574-262081/Combined Logo Graphic_Operations.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img   alt="Combined Logo Graphic_Operations.png" class="jive-image" height="92" src="3796a546db501744e9737a9e0f96191b.iix" style="margin: 10px 10px 10px 0; border-width: 0px; font-weight: inherit; font-style: inherit; font-family: inherit;" width="340"/></a></span></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><a _jive_internal="true" data-containerid="-1" data-containertype="-1" data-objectid="261212" data-objecttype="111" href="/servlet/JiveServlet/downloadImage/38-6432-261212/Combined Logo Graphic_Operations.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><span style="font-weight: bold; font-style: inherit; font-family: Arial; color: #666666;">For a list of all of my articles:   </span></a><a _jive_internal="true" href="/groups/servicenow-user-group-us-tx-north-texas/blog/2015/10/23/community-code-snippets-articles-list-to-date" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><span style="font-weight: bold; font-style: inherit; font-family: Arial;">Community Code Snippets: Articles List to Date</span></a><a _jive_internal="true" data-containerid="-1" data-containertype="-1" data-objectid="261212" data-objecttype="111" href="/servlet/JiveServlet/downloadImage/38-6432-261212/Combined Logo Graphic_Operations.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><br/></a></p><p dir="ltr"></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 14.6667px; font-family: Arial; color: #eb7a3d;">Please Share, Like, Bookmark, Mark Helpful, or Comment this blog if you've found it helpful or insightful.</span></p><p dir="ltr"></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 14.6667px; font-family: Arial; color: #eb7a3d;">Also, if you are not already, I would like to encourage you to become a member of our blog!</span></p>