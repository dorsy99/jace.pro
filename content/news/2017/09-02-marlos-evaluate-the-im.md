---
title: "Evaluate the impact on business services by tracking configuration file changes in Jakarta"
date: 2017-09-02T01:16:35.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=c48c26e1dbd0dbc01dcaf3231f96198d"
---
<p>Service outages are often a result of changes made in application configuration. Starting with Jakarta, information on application configuration files can now be collected. This feature uses Horizontal discovery patterns to gather information on configuration files. Changes made to those files will be tracked and seen in the service timeline or in the CI timeline. This feature is useful in determining if changes in the configuration files affected application performance or led to a potential service outage. Since the configuration files are tracked for changes, the system administrator can easily check what changes were made and, after proper evaluation, revert part of these changes or fully roll them back in order to restore critical business services.</p><p></p><h1>How does Configuration file tracking work?</h1><p><a title="ocs.servicenow.com/bundle/jakarta-it-operations-management/page/product/discovery/concept/c-UsingPatternsForHorizontalDiscovery.html" href="https://docs.servicenow.com/bundle/jakarta-it-operations-management/page/product/discovery/concept/c-UsingPatternsForHorizontalDiscovery.html">Horizontal patterns</a> offer an alternative to using probes and sensors to discover devices and applications in your infrastructure. Base system horizontal patterns define which configuration files are used by the application. A horizontal pattern included in the trigger probe of the process classifier will be launched during discovery to retrieve information about these files, such as file name and its content. The name and file content are then stored in the CMDB as CIs in the <strong>cmdb_ci_config_file_tracked</strong> table and can be used for tracking changes that happened at each discovery.</p><p></p><p>In many cases, problems that affect applications, outages, and incidents are somehow a result of changes made in the application configuration file. Before the Jakarta release, <a title="ocs.servicenow.com/bundle/jakarta-it-operations-management/page/product/service-mapping/concept/service-mapping-get-started.html" href="https://docs.servicenow.com/bundle/jakarta-it-operations-management/page/product/service-mapping/concept/service-mapping-get-started.html">Service Mapping</a> or horizontal discovery was able to detect changes in applications such as version, installation directory, or configuration filename. However, these attributes typically do not change frequently, or they may change only when the application is upgraded or not change at all. Changes that affect the business service may occur when modifications are made into the application configuration files when some parameters need to be set such as timeouts, port numbers, IPs, etc.</p><p></p><p>Starting in Jakarta, in order to mitigate the impact of these changes, the horizontal discovery patterns can now collect information from configuration files, including what changes were made in the files over time.</p><p></p><p>In Jakarta, the pattern designer can now be provided with the application configuration file information that needs to be tracked for changes.</p><p></p><p>For example, in the "MySQL" pattern below:</p><p></p><p><strong>Discovery Patterns &gt; My SQL server On Windows and Linux Pattern</strong></p><p>There is a new tab called "Tracked Files":</p><p style="text-align: center;"><img   alt="Tracked+files.png" class="image-79 jive-image" src="f0dd3779dbd4d3041dcaf3231f961929.iix" style="width: 620px; height: 176px;"/></p><p></p><p>In this section you define what files are important to your application and you want to track configuration changes for.</p><p></p><p>The definition can be based on attributes that are collected by the pattern itself (for example, <strong>$config_file)</strong>.</p><p></p><p>The other thing you can also define is whether you would like to save the content of the file itself. This is important because in some cases the configuration file is in binary format or contains passwords that you don't want to disclose.</p><p></p><p>Before you run a horizontal discovery, make sure that the proper <a title="ocs.servicenow.com/bundle/jakarta-it-operations-management/page/product/discovery/concept/c_ProcessClassification.html#c_ProcessClassification" href="https://docs.servicenow.com/bundle/jakarta-it-operations-management/page/product/discovery/concept/c_ProcessClassification.html#c_ProcessClassification">process classifier</a> for your application is configured. In this example, the MySQL Server process classifier triggers the launch of the "My SQL server On Windows and Linux Pattern" Horizontal Pattern Probe:</p><p></p><p><strong>Discovery Definition &gt; CI Classification &gt; Processes</strong></p><p>Find the "MySQL Server" process classifier and make sure that the horizontal pattern probe is active:</p><p style="text-align: center;"><img   alt="MySQL+pattern.png" class="image-80 jive-image" src="2ff02d4edb9cd344e9737a9e0f9619d2.iix" style="width: 620px; height: 278px;"/></p><p>Once you define this and the horizontal pattern runs, the system will create a CI per each configuration file tracked and this CI will be related to its parent application via contains relation.</p><p></p><p>You can see the tracked configuration file from several places as illustrated below:</p><p></p><p><strong>Service Mapping &gt; Business Services &gt; View map</strong></p><p style="text-align: center;"><img   alt="service+mapping+configuration+file.png" class="image-81 jive-image" src="2fdb300edb5497041dcaf3231f9619f1.iix" style="width: 620px; height: 266px;"/></p><p>Select the MySQL Server icon, and on the right-hand pane click the link under<strong> Tracked Configuration Files</strong>. This will drill into the configuration file content.</p><p></p><p>If we click on <strong>Detailed Properties</strong>, we can also gather the same information by looking at the application form. Under Related Items look up for Tracked Configuration files under [Contains] relation:</p><p style="text-align: center;"><img   alt="configuration+file+detailed+properties.png" class="image-82 jive-image" src="d87bd0c2db9c17049c9ffb651f96190a.iix" style="height: auto;"/></p><p style="text-align: center;"></p><p>This drills into the configuration file form again. In this form under Related Links, we can also track the versions for each change that occurred in the configuration file. This history file is maintained by using the <strong>sys_history</strong> table just like others CIs. As usual we can compare different versions of configuration files we are tracking. Changes in the file content are audited and can be compared. File content is stored in the CMDB.</p><p style="text-align: center;"><img   alt="configuration+log+update.png" class="image-83 jive-image" src="da2bfff5db90db048c8ef4621f9619ad.iix" style="width: 620px; height: 157px;"/></p><p>As seen from the example above, the general-log parameter was changed from 0 to 1, thus enabling the MySQL general query log and potentially cause performance issues on the MySQL server.</p><p></p><p>You can also run a comparison to some point in time by clicking the expand button in the Business Service map and dragging the timeline as shown below:</p><p style="text-align: center;"><img   alt="compare+configuration+file+1.png" class="image-84 jive-image" src="0b2bb779db54d3049c9ffb651f961944.iix" style="width: 620px; height: 371px;"/></p><p>Then from the right-hand pane, click in the updated file link to drill into the file content page.</p><p style="text-align: center;"><img   alt="compare+configuration+file+2.png" class="image-85 jive-image" src="bffaa986db9cd304b322f4621f96190a.iix" style="width: 620px; height: 229px;"/></p><h2>Create a custom horizontal pattern to track configuration file changes</h2><p>As mentioned, in order to track configuration file changes a horizontal discovery needs to be run first. A horizontal pattern probe that gathers information on the configuration file must be included in the trigger probe. Configuration file tracking is not available for discoveries performed by traditional probes and sensors. If the horizontal pattern is not defined or enabled and you run Service Mapping discovery, then the tracked configuration link will not show up:</p><p style="text-align: center;"><img   alt="no+tracked+configuration+file.png" class="image-86 jive-image" src="9a380d0edbd0130468c1fb651f9619b5.iix" style="width: 620px; height: 274px;"/></p><p>In this case you need to create a horizontal pattern to collect the tracked configuration file information. In the example above we can check whether the trigger probe in the process classifier contains a horizontal pattern for Weblogic:</p><p></p><p><strong>Discovery Definition &gt; Processes &gt; Weblogic Server</strong></p><p style="text-align: center;"><img   alt="horizontal+pattern+weblogic.png" class="image-87 jive-image" src="94d4a44adbdc5304b322f4621f9619f2.iix" style="width: 620px; height: 174px;"/></p><p>As we can see, a horizontal probe is not available by default so we need to create one.</p><p></p><p><strong>Pattern Designer &gt; Discovery Patterns &gt; Weblogic</strong></p><p></p><p>Create a new identification section called<strong> Identification for horizontal discovery.</strong></p><p style="text-align: center;"><img   alt="create+horizontal+pattern.png" class="image-88 jive-image" src="5bb42fbddb50dfc0b322f4621f96191e.iix" style="width: 620px; height: 115px;"/></p><p>Save the form and click on the newly created identification section to add the pattern identification steps. This pattern needs to identify the location of the Weblogic configuration file. Make sure you select <strong>Horizontal in Debug</strong> Type when editing the pattern. After you create the pattern, click on the setting indicated below to include the "Tracked Configuration File" CI. Make sure Debug Mode is disabled to enable this feature. Save the pattern. Once you complete, the right pane should look like this:</p><p style="text-align: center;"><img   alt="tracked+configuration+file+settings.png" class="image-89 jive-image" src="38184d46dbd897041dcaf3231f9619f1.iix" style="height: auto;"/></p><p>Go back to the process classification for Weblogic Server, Related Links, Trigger Probes &gt; Edit. Under Collection, search for "Horizontal Pattern" and move it to the slushbucket on right and click <strong>Save</strong>. Now that the horizontal pattern probe has been added, double-click on the <strong>Pattern</strong> field for the horizontal pattern probe and search/add the Weblogic pattern. The Trigger probes list should look like this:</p><p style="text-align: center;"><img   alt="horizontal+pattern+probe+added.png" class="image-90 jive-image" src="74c6ec02db14dfc03eb27a9e0f96197f.iix" style="width: 620px; height: 207px;"/></p><p><span style="text-align: center;">Save the form and return to the Weblogic pattern page. You will notice that "Tracked Files" tab has been added. Create a new entry to specify the File Path field. The </span><span style="text-align: center;"><strong>$config_file</strong></span><span style="text-align: center;"> is the variable we defined in the pattern steps that tells us the configuration file path. When you are done, click </span><span style="text-align: center;"><strong>Save </strong>and<strong> Publish </strong></span><span style="text-align: center;">so that the pattern becomes available for use.</span></p><p style="text-align: center;"><img   alt="weblogic+tracked+files.png" class="image-91 jive-image" src="9cc68c86db9cd3041dcaf3231f9619bd.iix" style="width: 620px; height: 161px;"/></p><p>Run a horizontal discovery. The ECC input should contain the configuration file name we are going to track for changes:</p><p style="text-align: center;"><img   alt="horizontal discovery.png" class="image-93 jive-image" src="36758902db549f048c8ef4621f961916.iix" style="width: 620px; height: 94px;"/></p><p>Next, load the Business Service map and the tracked configuration file should now be available:</p><p style="text-align: center;"><img   alt="business discovery tracked configuration file.png" class="image-92 jive-image" src="62f327fddb9093049c9ffb651f9619dc.iix" style="width: 620px; height: 162px;"/></p><p></p><h2>Troubleshooting configuration file tracking</h2><p>You can troubleshoot the tracked configuration feature by navigating to <strong>Pattern Designer &gt; Discovery Pattern Log</strong>.</p><p></p><p>There is an extra step called "File Tracking" under the identification section as shown below. This not really a step in the pattern but it shows the commands used in order to track the configuration files:</p><p style="text-align: center;"><img   alt="horizontal discovery log file tracking.png" class="image-94 jive-image" src="04e460cadb9457041dcaf3231f961928.iix" style="width: 620px; height: 316px;"/></p><p></p><h2>Configuration file tracking flags</h2><p>Configuration parameters are predefined that control the limits applied to this feature.</p><p></p><p>System Properties:</p><p></p><table border="1" class="jiveBorder" jive-data-cell="{&quot;color&quot;:&quot;#000000&quot;,&quot;textAlign&quot;:&quot;left&quot;,&quot;padding&quot;:&quot;2&quot;}" jive-data-header="{&quot;color&quot;:&quot;#505050&quot;,&quot;backgroundColor&quot;:&quot;#F2F2F2&quot;,&quot;textAlign&quot;:&quot;left&quot;,&quot;padding&quot;:&quot;6&quot;,&quot;fontFamily&quot;:&quot;Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif&quot;,&quot;verticalAlign&quot;:&quot;baseline&quot;}" style="border: 1px solid #c6c6c6; width: 100%;"><tbody><tr><th style="text-align: left; background-color: #f2f2f2; color: #505050; padding: 6px; width: 273px;" valign="middle"><strong>Property</strong></th><th style="text-align: left; background-color: #f2f2f2; color: #505050; padding: 6px; width: 599px;" valign="middle"><strong>Description<br/></strong></th><th style="text-align: left; background-color: #f2f2f2; color: #505050; padding: 6px; width: 65px;" valign="middle"><strong>Default value<br/></strong></th></tr><tr><td style="padding: 6px;"><p>glide.discovery.enable_file_tracking</p></td><td style="padding: 6px;">Enable configuration file tracking as part of the Pattern based Horizontal Discovery</td><td style="padding: 6px;">true</td></tr><tr><td style="padding: 6px;"><p>glide.discovery.file_tracking.change_limit_count</p></td><td style="padding: 6px;">Number of changes allowed on a tracked configuration file in the defined time window</td><td style="padding: 6px;">4</td></tr><tr><td style="padding: 6px;"><p>glide.discovery.file_tracking.change_limit_days</p></td><td style="padding: 6px;">Time window in days for limiting the number changes on a tracked configuration file</td><td style="padding: 6px;">7</td></tr><tr><td style="padding: 6px;"><p>glide.discovery.file_tracking.max_files_per_ci</p></td><td style="padding: 6px;">Maximal number of tracked configuration files per CI</td><td style="padding: 6px;">50</td></tr><tr><td style="padding: 6px;"><p>glide.discovery.file_tracking.max_file_size</p></td><td style="padding: 6px;">Maximal file size for tracked configuration file content (B)</td><td style="padding: 6px;">500000</td></tr><tr><td style="padding: 6px;"><p>glide.discovery.file_tracking.min_file_size_for_simplified_comparison</p></td><td style="padding: 6px;">Minimal file size for comparison by file size and last modification time instead of content (B)</td><td style="padding: 6px;">50000</td></tr><tr><td style="padding: 6px;"><p>glide.discovery.file_tracking.top_limit_max_file_size</p></td><td style="padding: 6px;">Top limit for the max tracking file size configuration (B)</td><td style="padding: 6px;">800000</td></tr></tbody></table><p></p><p><span style="color: #303030;">By tracking configuration file changes, the ServiceNow instance acts as a repository of these files along with their change history information. This feature helps you to quickly evaluate the impact of configuration changes made to your mission-critical applications and aid in the restoration of the associated business services.<br/></span></p><p></p><p>More information can be found in the product documentation:</p><p></p><p><a title="ocs.servicenow.com/bundle/jakarta-it-operations-management/page/product/discovery/concept/tracked-config-files.html" href="https://docs.servicenow.com/bundle/jakarta-it-operations-management/page/product/discovery/concept/tracked-config-files.html">Configuration file tracking</a></p>