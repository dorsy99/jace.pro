---
title: "Scripts in user criteria"
date: 2019-12-19T09:17:28.000Z
authors: ["Subha V"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=925219751b358850d01143f6fe4bcb7b"
---
<p><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">Using a script in user criteria poses a lot of ca</span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">ching issu</span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">es. </span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">Scripts are dynamic in nature and cannot be cached. </span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">So, there</span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0"> is a tradeoff between the </span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">performance </span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">and </span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">consistent output of script. </span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">In</span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0"> a few scenarios</span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">, </span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">instead</span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0"> of using a script in user criteria, </span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">you can extend the user criteria by adding fields to the User Criteria [</span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SpellingErrorV2 SCXW198800089 BCX0">user_criteria</span></span><span class="TextRun SCXW198800089 BCX0" lang="EN-US"><span class="NormalTextRun SCXW198800089 BCX0">] table.</span></span><span class="EOP SCXW198800089 BCX0"> </span></p>
<h2><span class="EOP SCXW198800089 BCX0"><span class="TextRun Highlight MacChromeBold SCXW246258221 BCX0" lang="EN-US"><span class="NormalTextRun SCXW246258221 BCX0">Common scenario for using a script in user criteria</span></span><span class="EOP SCXW246258221 BCX0"> </span></span></h2>
<p><span>A script is generally used in user criteria to get the column value from a user record and compare that value with the required value.</span><span> </span></p>
<p><span>For example, the following script can be used to create a group for managers who are system administrators. Assume that the sys_id of the system administrator is </span><span>6816f79cc0a8016401c5a33be04be441.</span><span> </span></p>
<p><span>var </span><span>udc</span><span>&#61;</span><span>gs.getUser</span><span>().</span><span>getRecord</span><span>().</span><span>getValue</span><span>(&#39;manager&#39;);</span><span> </span><span> </span></p>
<p><span>if (</span><span>udc</span><span>&#61;&#61;&#34;6816f79cc0a8016401c5a33be04be441</span><span>&#34;)</span><span> </span></p>
<p><span>{</span><span> </span></p>
<p><span>answer &#61; true;</span><span> </span></p>
<p><span>} </span><span> </span></p>
<p><span>else {</span><span> </span></p>
<p><span>answer &#61; false;</span><span> </span></p>
<p><span>}</span><span> </span></p>
<p><span> </span></p>
<p><span>In the script, we get the manager column value from a user record and compare it with the sys_id of a system administrator.</span><span> </span></p>
<p><span>However, since using a script in user criteria poses caching issues, you can remove the script and extend the user criteria by adding the required field from the User [</span><span>sys_user</span><span>] table. In this example, you can remove the script from the user criteria and add the manager column from the </span><span>User [</span><span>sys_user</span><span>] table</span><span> and set its value as System Administrator.</span><span> </span></p>
<h2><span class="EOP SCXW198800089 BCX0"><span class="TextRun MacChromeBold SCXW190996509 BCX0" lang="EN-US"><span class="NormalTextRun SCXW190996509 BCX0">How to extend user criteria?</span></span><span class="EOP SCXW190996509 BCX0"> </span></span></h2>
<p>Instead of adding a script to user criteria using a field on the User [sys_user] table, you can <a href="https://docs.servicenow.com/bundle/newyork-it-service-management/page/product/service-catalog-management/task/t_ExtendUserCriteria.html" rel="nofollow">add a field</a> to the User Criteria [user_criteria] table. </p>
<p>Here are a few rules for adding a field: </p>
<ul><li>The field type must be Reference or List in the User [sys_user] table. </li><li>The field type must be List in the User Criteria [user_criteria] table. </li><li>The fields must have matching names in the User [sys_user] and User Criteria [user_criteria] table. </li></ul>
<h2><span class="TextRun MacChromeBold SCXW10565807 BCX0" lang="EN-US"><span class="NormalTextRun SCXW10565807 BCX0">Best practices for </span></span><span class="TextRun MacChromeBold SCXW10565807 BCX0" lang="EN-US"><span class="NormalTextRun SCXW10565807 BCX0">using a script in </span></span><span class="TextRun MacChromeBold SCXW10565807 BCX0" lang="EN-US"><span class="NormalTextRun SCXW10565807 BCX0">user criteria</span></span><span class="EOP SCXW10565807 BCX0"> </span></h2>
<p>In case it is inevitable to use a script in user criteria, you can follow these best practices: </p>
<ul><li>The global object user_id points to the logged-in user. Use user_id in the script to get values for the logged-in user instead of performing a query or getting the corresponding values from the session. </li><li>Do not use scoped APIs in scripts since they can fail as they are accessed from a different scope.<span class="TextRun Highlight  BCX0 SCXW169874155" lang="EN-US"><span class="NormalTextRun  BCX0 SCXW169874155">If scoping is required, d</span></span><span class="TextRun Highlight  BCX0 SCXW169874155" lang="EN-US"><span class="NormalTextRun  BCX0 SCXW169874155">efine a script includes in the required scope and call the script includes from the user criteria script.</span></span><span class="TextRun  BCX0 SCXW169874155" lang="EN-US"><span class="NormalTextRun  BCX0 SCXW169874155"> <span class="TextRun Highlight SCXW94583374 BCX0" lang="EN-US"><span class="NormalTextRun SCXW94583374 BCX0">This practice is not recommended. Use only when it is inevitable for the business.</span></span></span></span></li><li>If you have a script that can impact performance, for example, GlideRecord queries, then use gs.putClientData(name,value) to store result as a name value pair in the session. You can later in the session retrieve this data using gs.getClientData(name). The result is then cached at the session level for a user. </li></ul>
<p> </p>