---
title: "How to launch Catalog Items from Email"
date: 2016-05-27T19:37:55.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=c25da629dbd0dbc01dcaf3231f961933"
---
<h1>But... but... #KillEmail</h1><p>Yes, kill email <em>when you can.</em> In reality, Some systems and processes may still have components depending on an email initiation.   Here are some examples from my own history.</p><p><span>- </span><a title="k-email-small" class="jive-link-email-small" href="mailto:support@company.com">support@company.com</a><span>, </span><a title="k-email-small" class="jive-link-email-small" href="mailto:service@company.com">service@company.com</a><span>, </span><a title="k-email-small" class="jive-link-email-small" href="mailto:contactus@company.com">contactus@company.com</a><span> etc addresses that are externally facing need workflow driven responses.   (this is common in the hospitality space)</span></p><p>- legacy system is a starting point and has no rest/soap integration capabilities</p><p>- highly specialized staff that, for cultural or practical reasons, only uses email + 1 or 2 specialized tools (traders, field service staff, doctors, lawyers, etc)</p><p></p><p>Sometimes we have no choice in our inputs, and its better to win small than not win.</p><p></p><h1>Before We Begin</h1><ul><li>Understand <a href="http://wiki.servicenow.com/?title=Inbound_Email_Actions#gsc.tab=0" title="http://wiki.servicenow.com/?title=Inbound_Email_Actions#gsc.tab=0">Inbound Email Actions</a>, especially Section 6, which outlines how to handle email variables.</li><li>Understand <a href="http://wiki.servicenow.com/index.php?title=Service_Catalog_Script_API#gsc.tab=0" title="http://wiki.servicenow.com/index.php?title=Service_Catalog_Script_API#gsc.tab=0">Service Catalog Script API</a>.   For further research, you can look at the Script Include "Cart" on your dev instance.</li><li><span>It is advised that you create your own email address in your environment to handle the intake.   In my example I created "</span><a title="k-email-small" class="jive-link-email-small" href="mailto:term@company.com">term@company.com</a><span>".   We ended up creating this such that anyone emailing the address was also sending to </span><a title="k-email-small" class="jive-link-email-small" href="mailto:company@servicenow.com">company@servicenow.com</a><span> without realizing it.   In this fashion both the original sender &amp; </span><a title="k-email-small" class="jive-link-email-small" href="mailto:term@company.com">term@company.com</a><span> are retained.   A further benefit is you can make separate addresses per workflow you wish to trigger.   </span></li><li>Text analysis is your enemy.   As much as possible ensure that your sender automated, not a person.   If that's not possible, resist attempts to make programatic decisions based on user entered email text.</li></ul><p></p><h1>Example:   Email initiated Termination</h1><p>I've already created a Catalog Item with 3variables: terminee, subject, emailbody (HTML)</p><p>I'm assuming that whatever person / system sending will include in the body "priority:high" if priority needs adjustment.</p><p>Its also important to note that I don't generally use the request layer, so I will *also* want to modify the sc_req_item</p><p></p><h2>Inbound Action</h2><p><strong>Name</strong>:   Email Based Term</p><p><strong>Target</strong> Table:   Requested Item [sc_req_item]</p><p><strong>Type</strong>: New</p><p><strong>Order</strong>:   Anything lower (numerically) than your existing Incident items</p><p><strong>Condition</strong><span>: email.recipients.toLowerCase().indexOf("</span><a title="k-email-small" class="jive-link-email-small" href="mailto:term@company.com">term@company.com</a><span>") &gt; -1   </span><span style="color: #7ed529;"> (checks to ensure its coming to the controlling email address)</span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14643594737156089" data-renderedposition="731.984375_8_1102_368" jivemacro_uid="_14643594737156089"><p>createRequest();</p><p>function createRequest() {</p><p>   var cart = new Cart();   //calling the cart API</p><p>   var item = cart.addItem('eb89a3b937e7d200a2982863b3990eab');   //sys_id of the catalog item I want to fire</p><p>   cart.setVariable(item, 'subject', email.subject) //sets catalog variable to the email's subject</p><p>   cart.setVariable(item, 'emailbody', email.body_html);   //sets catalog variable to email's body</p><p>     var rc = cart.placeOrder();   //this launches the catalog item, and creates a request object.   rc = the request object</p><p>   updateRITM(rc.sys_id);   //call a function immediately to update the ritm.   This must be a nested function, otherwise inbound actions get weird.</p><p>           //also, we're passing the sys_id of the request so we know what RITM to grab.</p><p>}</p><p></p><p>function updateRITM(req){</p><p>   var ritm = new GlideRecord('sc_req_item');</p><p>   ritm.addQuery('request', req);   //req is what we passed from the previous function. the sys_id of the request.</p><p>   ritm.query();</p><p>   while (ritm.next()){</p><p>       ritm.u_customer = gs.getUserID();   //my ritm table separately tracks its own customer, since I don't use Request</p><p>       ritm.description = email.body_text;   //we're still in the inbound action so why not exploit?</p><p>       ritm.priority = email.body.priority;     //good example of how to exploit email body variables</p><p>       ritm.update();</p><p>   }</p><p>}</p><p>event.state="stop_processing";   //stop evaluating inbound actions. This is why I keep this record's order lower than my incident from email rules.</p></pre><p></p><h1>Key Take-Aways</h1><ul><li>It is possible, and even handy to trigger workflow from email</li><li>if you want to modify RITM post insert, use a nested function where-ever you're calling the Cart API</li><li>Make sure inbound action(s) evaluate before your Incident creation inbound actions</li><li>Use stop processing once the script is complete.</li><li>Don't be afraid to exploit email.body.variables... especially if the email source is automated.</li></ul>