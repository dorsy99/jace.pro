---
title: "Community Code Snippets Where Does All The Code Hide  Revisited"
date: 2016-07-18T18:01:59.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=58ac6225dbd0dbc01dcaf3231f9619bd"
---
<p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: bold; font-style: inherit; font-family: 'Times New Roman';">NOTE</span><span style="font-weight: inherit; font-style: inherit; font-family: Arial;">: </span><span style="font-weight: inherit; font-style: inherit; font-family: 'Times New Roman';">MY POSTINGS REFLECT MY OWN VIEWS AND DO NOT NECESSARILY REPRESENT THE VIEWS OF MY EMPLOYER, ACCENTURE.</span></p><p dir="ltr"></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-family: 'Times New Roman';">DIFFICULTY LEVEL:   </span><span style="font-weight: bold; font-style: inherit; font-family: 'Times New Roman'; color: #e23d39;">ADVANCED</span></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-family: 'Times New Roman';">Assumes good knowledge and/or familiarity of scripting in ServiceNow.</span></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial;">____________________________________________________________________________</span></p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">Some time ago I wrote on this topic (<a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=63ecee65dbd0dbc01dcaf3231f9619a2" style="font-size: 15px; font-family: arial, sans-serif; color: #266fc8;">Where Does All The Code Hide?</a>), where I attempted to identify all of the possible places that code could reside inside of the ServiceNow platform.   That was three years ago, and the platform has come a long way since then.   At that time I used a somewhat manual process to pull together a list of variables that were of a particular type:</span></p><p></p><ul><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">Script</span></li><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">XML</span></li><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">HTML</span></li><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">Condition</span></li></ul><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">and so on.   It took me a bit to assemble the whole thing, but I found that the result was remarkable.   At that time there were 187 possible locations!</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif;"><span style="font-size: 12pt;">I have become somewhat more sophisticated in my approach these days.   Here is a coding example of how to </span><span style="font-size: 16px; line-height: 24px;">dissect</span><span style="font-size: 12pt;"> the sys_dictionary table to obtain the list.   I thought I would share a bit of that to give you an idea where this could be taken.   </span></span></p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">I have included several interesting techniques and best practices while working with the GlideRecord object that you might find of interest.</span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14688455015585899" data-renderedposition="519.984375_8_1192_1280" jivemacro_uid="_14688455015585899"><p>var listOfFieldsToCheck = ['script', 'xml', 'html', 'html_script', 'script_plain', 'html_script', 'conditions', 'variable_conditions', 'condition_string'];</p><p>var listOfDoesNotContain = ['var__', 'bsm_', 'log', 'metric', 'ecc', 'clone', 'content_', 'sys_update_', 'u_'];</p><p></p><p>var message = '---&gt;Script Location List\n';</p><p>var scriptLocationList = buildScriptLocationList(listOfFieldsToCheck, listOfDoesNotContain);</p><p>message += '---&gt; scriptLocationList.length: ' + scriptLocationList.length + '\n';</p><p></p><p>for (var i=0; i &lt; scriptLocationList.length; i++) {</p><p>   message += scriptLocationList[i].table + ' - ' + scriptLocationList[i].column_name + ' - ' + scriptLocationList[i].type + '\n';</p><p>}</p><p>gs.print(message);</p><p></p><p>message = '\n\n---&gt;Exception Location List\n';</p><p>var exceptionLocationList = buildExceptionLocationList(listOfDoesNotContain);</p><p>message += '---&gt; exceptionLocationList.length: ' + exceptionLocationList.length + '\n';</p><p></p><p>for (var i=0; i &lt; exceptionLocationList.length; i++) {</p><p>   message += exceptionLocationList[i].table + ' - ' + exceptionLocationList[i].column_name + ' - ' + exceptionLocationList[i].type + '\n';</p><p>}</p><p>gs.print(message);</p><p></p><p></p><p>function buildScriptLocationList(listOfFieldsToCheck, listOfDoesNotContain) {</p><p></p><p>   var scriptLocations = new GlideRecord('sys_dictionary');</p><p>   // what fields do we want to check for?</p><p>   scriptLocations.addQuery('internal_type.name', 'IN', listOfFieldsToCheck);</p><p>   // tables we want to exclude</p><p>   for (var j=0; j &lt; listOfDoesNotContain.length; j++) {</p><p>   scriptLocations.addQuery('name', 'DOES NOT CONTAIN', listOfDoesNotContain[j]);</p><p>   }</p><p>   // this is how you do multiple order bys with a gliderecord</p><p>   scriptLocations.orderBy('name').orderBy('element');</p><p>   scriptLocations.query();</p><p></p><p>   scriptLocList = [];</p><p></p><p>   while(scriptLocations.next()) {</p><p>   var scriptLocation = {};</p><p>   scriptLocation.table = scriptLocations.getValue('name');</p><p>   scriptLocation.column_name = scriptLocations.getValue('element');</p><p>   scriptLocation.type = scriptLocations.getValue('internal_type');</p><p>   scriptLocList.push(scriptLocation);</p><p>   }</p><p>   return scriptLocList;</p><p>}</p><p></p><p>function buildExceptionLocationList(listOfDoesNotContain) {</p><p></p><p>   // this is a best practice for allowing your encoded query to be easier to maintain</p><p>   var sql = 'internal_type=string' +</p><p>   '^elementNOT LIKEdescript' +</p><p>   '^elementNOT LIKEsubscript' +</p><p>   '^elementNOT LIKEjavascript' +</p><p>   '^elementNOT LIKEcondition_type' +</p><p>   '^elementLIKEscript' +</p><p>   '^ORelementLIKEcondition' + </p><p>   '^ORelementLIKEhtml' + </p><p>   '^ORelementLIKExml';</p><p></p><p></p><p>   var exceptionLocations = new GlideRecord('sys_dictionary');</p><p>       exceptionLocations.addEncodedQuery(sql);</p><p>   for (j=0; j &lt; listOfDoesNotContain.length; j++) {</p><p>   exceptionLocations.addQuery('name', 'DOES NOT CONTAIN', listOfDoesNotContain[j]);</p><p>   }</p><p>   exceptionLocations.orderBy('name').orderBy('element');</p><p>   exceptionLocations.query();</p><p></p><p>   exceptionLocList = [];</p><p></p><p>   while(exceptionLocations.next()) {</p><p>   var exceptionLocation = {};</p><p>   exceptionLocation.table = exceptionLocations.getValue('name');</p><p>   exceptionLocation.column_name = exceptionLocations.getValue('element');</p><p>   exceptionLocation.type = exceptionLocations.getValue('internal_type');</p><p>   exceptionLocList.push(exceptionLocation);</p><p>   }</p><p>   return exceptionLocList;</p><p>}</p></pre><p></p><p><span style="font-size: 12pt;"><strong>Some GlideRecord Notes</strong>:</span></p><p></p><p><span style="font-size: 12pt;">You can:</span></p><p><span style="font-size: 12pt;">1. Use an array with the IN statement to act as an "OR" condition.</span></p><p><span style="font-size: 12pt;">2. Dynamically add extra conditions based on an array.</span></p><p><span style="font-size: 12pt;">3. Stack .orderBy statements to do more sophisticated ordering of the data <span style="color: #e23d39;"><strong>(&lt;--- this should have worked and did not - investigating)</strong></span></span></p><p></p><p><span style="font-size: 12pt;">And:</span></p><p><span style="font-size: 12pt;">4. Demonstration of how an Encoded Query can be ordered to provide better maintenance.</span></p><p></p><p><span style="font-size: 12pt;">I created a Fix Script to execute the code.   Executing brought back the following results:</span></p><p></p><p><img  class="image-1 jive-image" src="601ac1c6db90d304b322f4621f9619bc.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p><span style="font-size: 12pt;">359!   Wow!   ServiceNow has significantly grown their coding presence in the last three years!</span></p><p></p><p><span style="font-size: 12pt;">If you scroll further down you will see that there were 59 results in the Exception List.   These are worthy of investigating, if you want, to see if they truly contain script.   These will be string fields that contain code.   <span style="color: #e23d39;"><strong style="text-decoration: underline;">Ugly</strong></span>.   The ones labeled with Script should probably be Script fields as, at the very least, to be able to utilize the Script editor.</span></p><p></p><p><img  class="image-2 jive-image" src="6a79e4c6db545f048c8ef4621f961956.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p><span style="font-size: 12pt;">This, overall,   is probably not a comprehensive list, and is worthy of extra exploring, but you get the general idea: There are a LOT of different places where code can exist inside the ServiceNow platform!</span></p><p></p><p><span style="font-size: 12pt;">I have attached my Fix Script for your perusal.   :-)</span></p><p></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial; color: #000000;">I want to highly recommend taking the </span><a _jive_internal="true" href="/www.servicenow.com/services/training-and-certification/scripting-in-servicenow-training.html" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial; color: #1155cc; text-decoration: underline;">ServiceNow Scripting</span></a><span style="font-weight: inherit; font-style: inherit; font-family: Arial; color: #000000;"> training class should you get the opportunity. </span></span></p><p dir="ltr"></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 16px; font-family: Arial; color: #000000;">Steven Bell</span></p><p></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 16px; font-family: Arial; color: #000000;"><a _jive_internal="true" href="/lh4.googleusercontent.com/eZtmYidOgxWPvdM4OTgO-LZvH8Sr7r5MGCyEG7cecdsNxz4EE3u486EcFyAaNaeRQHSgcUajyQb3w5edtAkg5WIYeKAJlrUjfO0glzI9AIWDoPtKz6plvkpLyJFCxXWqxOt-yyYN" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img alt="accenture logo small.jpg" class="jive-image" height="65" src="https://lh4.googleusercontent.com/eZtmYidOgxWPvdM4OTgO-LZvH8Sr7r5MGCyEG7cecdsNxz4EE3u486EcFyAaNaeRQHSgcUajyQb3w5edtAkg5WIYeKAJlrUjfO0glzI9AIWDoPtKz6plvkpLyJFCxXWqxOt-yyYN" style="margin: 10px 10px 10px 0; border: 0px none; font-weight: inherit; font-style: inherit; font-family: inherit;" width="243"/></a></span><span style="font-weight: inherit; font-style: inherit; font-size: 16px; font-family: Arial; color: #000000;"><a _jive_internal="true" href="/lh5.googleusercontent.com/yfIiLmOSmiLJa5fvC1IMoyagAf-Afh2nagyOq9H_7Lwuc04We7HOK1oqoit-lzFCmj0w0NGCxvWBLjQR2rwL7FtRd45V0FQ9VAOVsVlkKNbXXP-F5XLYblwXKxY0V7k4f3UkIN8i" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img class="jive-image" height="48" src="https://lh5.googleusercontent.com/yfIiLmOSmiLJa5fvC1IMoyagAf-Afh2nagyOq9H_7Lwuc04We7HOK1oqoit-lzFCmj0w0NGCxvWBLjQR2rwL7FtRd45V0FQ9VAOVsVlkKNbXXP-F5XLYblwXKxY0V7k4f3UkIN8i" style="margin: 10px 10px 10px 0; border: 0px none; font-weight: inherit; font-style: inherit; font-family: inherit;" width="135"/></a></span><span style="font-weight: inherit; font-style: inherit; font-size: 16px; font-family: Arial; color: #000000;"><a _jive_internal="true" href="/lh3.googleusercontent.com/-vcVKTADxWBUg4JH7l-VRDfdGAGMIUUnEz4x4BMFA7io5wGBvjySnxZX5UvxqOyURFVSFVjZrsBVpmInR9bQ5w3GlyRx3celd9WKwEcmhzF5b-dwfu71AoIkk55y-RMX023m3PXm" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img class="jive-image" height="48" src="https://lh3.googleusercontent.com/-vcVKTADxWBUg4JH7l-VRDfdGAGMIUUnEz4x4BMFA7io5wGBvjySnxZX5UvxqOyURFVSFVjZrsBVpmInR9bQ5w3GlyRx3celd9WKwEcmhzF5b-dwfu71AoIkk55y-RMX023m3PXm" style="margin: 10px 10px 10px 0; border: 0px none; font-weight: inherit; font-style: inherit; font-family: inherit;" width="135"/></a></span></p><p></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: bold; font-style: inherit; font-family: Arial;">For a list of all of my articles:   </span><a _jive_internal="true" data-containerid="1027" data-containertype="37" data-objectid="4821" data-objecttype="38" href="/groups/servicenow-user-group-us-tx-north-texas/blog/2015/10/23/community-code-snippets-articles-list-to-date" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><span style="font-weight: bold; font-style: inherit; font-family: Arial;">Community Code Snippets: Articles List to Date</span></a></p><p></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 16px; font-family: Arial; color: #eb7a3d;">Please Share, Like, Bookmark, Mark Helpful, or Comment this blog if you've found it helpful or insightful.</span></p><p></p><p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 16px; font-family: Arial; color: #eb7a3d;">Also, if you are not already, I would like to encourage you to become a member of our blog!</span></p>