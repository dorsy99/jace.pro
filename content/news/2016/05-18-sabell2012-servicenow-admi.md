---
title: "ServiceNow Admin  You Too Can Do DISTINCT Queries Using GlideRecord"
date: 2016-05-17T22:19:54.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=412d26e5dbd0dbc01dcaf3231f96198e"
---
<p style="font-family: arial, sans-serif; color: #666666;"><span style="font-style: inherit; font-family: inherit;"><strong>NOTE</strong></span>: ON APRIL 1, 2016 ACCENTURE COMPLETED THE ACQUISITION PROCESS OF CLOUDSHERPAS.   AT THAT TIME THE CLOUDSHERPAS BLOG SITES WERE DOWNED FOREVER.</p><p></p><p style="font-family: arial, sans-serif; color: #666666;">THIS IS THE RE-PUBLICATION OF MY ARTICLE FROM <span style="font-style: inherit; font-family: inherit;"><strong>November 11, 2014</strong></span> ON THE CLOUDSHERPAS SERVICENOW ADMIN 101 BLOG.</p><p style="font-family: arial, sans-serif; color: #666666;">____________________________________________________________________________</p><p style="font-family: arial, sans-serif; color: #666666;"></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">I teach several different ServiceNow classes, and, invariably, I get a lot of questions about how to do DISTINCT queries. De-duplicating data in a result set is important, and there is no feature in GlideRecord that covers this purpose. So, the big question is: I can do a DISTINCT in SQL, but I can't do one with GlideRecord? What gives?   </span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">GlideRecords are designed to bring back all fields for each record. SQL has the flexibility to bring back one or more fields and to make any one of those fields unique.</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">For example, in SQL a simple query could be written thus:</span></p><p></p><p style="padding-left: 30px;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><span style="color: #000000;">SELECT </span><span style="color: #ff0000; font-weight: bold;">DISTINCT</span><span style="color: #000000;"> caller_id </span></span></p><p style="padding-left: 30px;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">FROM incident </span></p><p style="padding-left: 30px;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">WHERE active = true</span></p><p style="padding-left: 30px;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">AND caller_id IS NOT NULL</span></p><p style="padding-left: 30px;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">ORDER BY caller_id</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">This would produce a list of unique caller sys_id's that are active and that are not empty from the Incident table.</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">In this article, I will show a few methods I use to accomplish this using GlideRecord.</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">Starting with the SQL example, let's render the query into a GlideRecord script.</span></p><p></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14635049481516033 jive_macro_code jive_text_macro" data-renderedposition="590_8_1192_176" jivemacro_uid="_14635049481516033"><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">var incidents = new GlideRecord('incident');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.addQuery('active', true);</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.addNotNullQuery('caller_id.name');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.orderBy('caller_id.name');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.query();</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">gs.print(incidents.getRowCount());</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">while(incidents.next()) {</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     gs.print(incidents.caller_id.name + '');   // get the real english name</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">}</span></p></pre><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><br/></span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">When run from Scripts — Background, this produces the following list (63 records):</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;"><img alt="C:\Users\User 1\Desktop\1. duplicates problem.jpg" class="jive-image" height="293" src="https://lh6.googleusercontent.com/ILuXZJpqjyBcF2QxQT2ssTzpNetrZ4fMi0pGdNXooQ5gE_pJg7HQhPhsJEloAlzowRL4tSeaLLr8IFS1auFBmSSEhYI0pd2eobntMLHsHWwgglQ25HDmY54WRu2IRM3-fp8ZB2LgzN5QvVxY" style="border-style: none; display: block; margin-left: auto; margin-right: auto;" width="282"/></span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><span style="color: #000000;">You can see the need for some sort of method to get these down to one entry per name. By introducing an array in which to store the names, we can make use of the ArrayUtil library in ServiceNow. ArrayUtil contains several really great array utilities. Check it out </span><a href="http://wiki.servicenow.com/index.php?title=ArrayUtil"><span style="color: #1155cc; text-decoration: underline;">here</span></a><span style="color: #000000;">.</span></span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">One of these array utilities is .unique(..), which allows us to take a simple, one-dimensional array and remove all the duplicate entries.</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">So, revisiting our original example, the .unique(..) array utility reduces the original list of 63 records to just seven! Nifty, huh?</span></p><p></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14635049707722050 jive_macro_code jive_text_macro" data-renderedposition="1377_8_1192_336" jivemacro_uid="_14635049707722050"><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">var incidents = new GlideRecord('incident');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.addQuery('active', true);</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.addNotNullQuery('caller_id.name');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.orderBy('caller_id.name');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.query();</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">gs.print(incidents.getRowCount());</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #ff0000; font-size: 12pt;">var callerIdList = [];</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">while(incidents.next()) {</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #ff0000; font-size: 12pt;">     callerIdList.push(incidents.caller_id.name.trim());</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">}</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #0070c0; font-size: 12pt;">var arrayUtil = new ArrayUtil();</span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><span style="color: #ff0000;">callerIdList = </span><span style="color: #0070c0;">arrayUtil.</span><span style="color: #0070c0; font-weight: bold;">unique</span><span style="color: #ff0000;">(callerIdList);</span></span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">gs.print(callerIdList.length);</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">for (var i = 0; i &lt; callerIdList.length; i++) {</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     gs.print(callerIdList[i]);</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">}</span></p></pre><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><br/></span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;"><img alt="C:\Users\User 1\Desktop\2. unique list.jpg" class="jive-image" height="192" src="https://lh5.googleusercontent.com/4emZl7hY_l5-nDUfJKgJEo5gIBkIFuNhaI2O-JrzowCjFjnPTyic0KfKHMQf8dbxZh9AnS-S5Wu0CyHBak8bl6kflCuOQChnmE6P_CY6NONsM1CDzXrZovWD-or32OG9r8INtLluEIH2-Fa4" style="border-style: none; display: block; margin-left: auto; margin-right: auto;" width="293"/></span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">You now have your DISTINCT GlideRecord query. All done, right? Well, no. Actually, this solution is only good for simple, one-dimensional arrays. So what if you want to get a unique list based on several values in the record?   </span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">Let's say we want the caller id name AND category to be unique. If we go back to the original query and expand it a little, you'll see the problem.</span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14635049880049520 jive_macro_code jive_text_macro" data-renderedposition="2112_8_1192_192" jivemacro_uid="_14635049880049520"><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">var incidents = new GlideRecord('incident');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.addQuery('active', true);</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.addNotNullQuery('caller_id.name');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.orderBy('caller_id.name');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.query();</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">gs.print(incidents.getRowCount());</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">while(incidents.next()) {</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     gs.print(incidents.caller_id.name.trim() + ' - ' + incidents.category.trim());</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">}</span></p></pre><p></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">This produces:</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;"><img alt="C:\Users\User 1\Desktop\3. multiple field dup problem.jpg" class="jive-image" height="414" src="https://lh6.googleusercontent.com/FE7Ec9pQ1Kso7aQNi8Kylvp1L7n12ftNNP2efh-BLVCGCREJK-1lNDjPJ7_uj_V22V8riNoD6bO5ZxvGYHLhz7JCqBOM86cGJpS-1X-saFqHAJe83lVtOVtUlT2JUgtk8ic3D3x5ZbcJUwKh" style="border-style: none; display: block; margin-left: auto; margin-right: auto;" width="340"/></span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">Turns out there is a pretty easy way to clean this up: create a "key" field out of the various fields you want de-dup'd. This key is created simply by concatenating two (or more) of the fields together with a separator like the bar ("|"), caret ("^") or something that would not normally be used in a description or name. I would avoid ampersands, commas, hyphens, etc. as they can appear in names and descriptions. You want something that, when you bust it apart, will give you back exactly what you started with. So, how does it work?</span></p><p></p><ol><li><span dir="ltr" style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">In the while concatenate your two fields together with your separator of choice.</span></li><li><span dir="ltr" style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Push the key onto your array.</span></li><li><span dir="ltr" style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Do the unique against the array.</span></li></ol><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="color: #000000;">This creates a unique list that you can bust apart using the .split function against the bar to retrieve your values:</span></span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14635051064061187 jive_text_macro" data-renderedposition="3119.1875_8_1192_448" jivemacro_uid="_14635051064061187"><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="margin-left: 36pt; color: #000000;">var incidents = new GlideRecord('incident');</span></span></p><p><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">incidents.addQuery('active', true);</span></p><p><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">incidents.addNotNullQuery('caller_id.name');</span></p><p><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">incidents.orderBy('caller_id.name');</span></p><p><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">incidents.orderBy('category');</span></p><p><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">incidents.query();</span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="margin-left: 36pt; color: #000000;">gs.print(incidents.getRowCount());</span></span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="margin-left: 36pt; color: #000000;">var callerIdList = [];</span></span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="margin-left: 36pt; color: #000000;">while(incidents.next()) {</span><span style="margin-left: 36pt; color: #000000;">     </span></span></p><p style="padding-left: 30px;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><span style="margin-left: 36pt; color: #000000;">       var key = incidents.caller_id.name.trim() + '|' + incidents.category.trim();</span><span style="margin-left: 36pt; color: #000000;">     </span></span></p><p style="padding-left: 30px;"><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">       callerIdList.push(key);</span></p><p><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">}</span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="margin-left: 36pt; color: #000000;">var arrayUtil = new ArrayUtil();</span></span></p><p><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">callerIdList = arrayUtil.unique(callerIdList);</span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="margin-left: 36pt; color: #000000;">gs.print(callerIdList.length);</span></span></p><p></p><p><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">for (var i = 0; i &lt; callerIdList.length; i++)   {</span><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">     </span></p><p style="padding-left: 60px;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><span style="margin-left: 36pt; color: #000000;">       var callerIdListSplit = callerIdList[i].split('|');</span><span style="margin-left: 36pt; color: #000000;">     </span></span></p><p style="padding-left: 60px;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><span style="margin-left: 36pt; color: #000000;">       var callerId = callerIdListSplit[0];</span><span style="margin-left: 36pt; color: #000000;">     </span></span></p><p style="padding-left: 60px;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><span style="margin-left: 36pt; color: #000000;">       var category = callerIdListSplit[1];</span><span style="margin-left: 36pt; color: #000000;">   </span></span></p><p style="padding-left: 60px;"><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">       gs.print(callerId + ' - ' + category);</span></p><p style="padding-left: 60px;"><span style="margin-left: 36pt; color: #000000; font-size: 12pt; font-family: arial, helvetica, sans-serif;">}</span></p></pre><p></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="color: #000000;">Ultimately, this results in:</span><br/><span style="color: #000000; text-align: center;"><img alt="C:\Users\User 1\Desktop\4.multiple field dup solution.jpg" class="jive-image" height="280" src="https://lh4.googleusercontent.com/QVpLBh1_k48C6B67-7m0kfbjJHOb8BNEceKh8hyTmP-Ef7EUH7bPwnEZXJbakjn-jbuUKHEaCd_MinK291qGUHY8YD6dcWnFYooUmQaaMqF9yidpcH8mkQpr-ZZ8uebobJXaLrfrnKBlX_m8" style="border-style: none; display: block; margin-left: auto; margin-right: auto;" width="345"/></span><br/><span style="color: #000000;">You can expand this to include as many fields as you want. </span></span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="color: #000000;">So now we have pushed our ArrayUtil unique function to its limit. Well, what if you want to bring along values that you don't want uniqued, but would like made available? You have to move into the realm of objects to accomplish this, as it requires a different way of finding and removing duplicates. You don't want all the fields, just specific ones. Further, you want to remove any duplicates based on one or more of those fields, and you want to bring along fields that will give you information and won't be used in the duplication check.</span></span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="color: #000000;">The best mechanism for this is an Object. You need to place all of your desired fields from a record into an object and then store that object onto an array. The final result is a list of objects.</span></span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="color: #000000;">I didn't want to have to reinvent the wheel, so I fished around on the web and found several examples that gave me an idea of what I wanted:   A function that would remove duplicated entries from a list of objects. The best examples used the JavaScript array function "splice" to remove an array value.   </span></span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="color: #000000;">Using the key field idea from the previous example allows us to "tag" each object with a value. That allows us to do a DISTINCT and bring along extra fields too.</span></span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><br/><span style="color: #000000;">So here is the process for de-duping an object array:</span></span></p><p></p><ol><li><span dir="ltr" style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">In the while concatenate your two fields together with your separator of choice (I used the bar and stored it in a field named "key" in the object).</span></li><li><span dir="ltr" style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Push the object onto the array.</span></li><li><span dir="ltr" style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">With the new unique function, loop through all of the records in the array. Using each object's key field, compare against all of the other records in the array and remove any duplicates (adjusting the array size down each time one is removed).</span></li><li><span dir="ltr" style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Loop through what is left of the original array and you will see that all of the duplicates are gone and you have your extra fields too.</span></li></ol><p></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14635051819065856 jive_text_macro" data-renderedposition="4545.171875_8_1192_736" jivemacro_uid="_14635051819065856"><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">var incidents = new GlideRecord('incident');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.addQuery('active', true);</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.addNotNullQuery('caller_id.name');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.orderBy('caller_id.name');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.orderBy('category');</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">incidents.query();</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">gs.print('---&gt; Before unique: ' + incidents.getRowCount());</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">var callerIdList = [];</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">while(incidents.next()) {</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #ff0000; font-size: 12pt;">     var incident = {};</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #ff0000; font-size: 12pt;">     incident.caller_id = incidents.caller_id.name.trim();</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #ff0000; font-size: 12pt;">     incident.category = incidents.category + '';</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #ff0000; font-size: 12pt;">     incident.priority = incidents.priority.getDisplayValue();</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #ff0000; font-size: 12pt;">     incident.description = incidents.short_description + '';</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #ff0000; font-size: 12pt;">     incident.key = incident.caller_id + '|' + incident.category + '|' + incident.priority;</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     callerIdList.push(incident);</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">}</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><span style="color: #000000;">callerIdList = </span><span style="color: #0070c0; font-weight: bold;">uniqueObjectList</span><span style="color: #000000;">(callerIdList);</span></span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">gs.print('---&gt; After unique: ' + callerIdList.length);</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">for (var caller in callerIdList) {</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     var callerId = callerIdList[caller].caller_id;</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     var category = callerIdList[caller].category;</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     var priority = callerIdList[caller].priority;</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     var description = callerIdList[caller].description;</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     gs.print(callerId + ' - ' + category + ' - ' + priority + ' - ' + description);</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">}</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><span style="color: #000000;">function </span><span style="color: #0070c0; font-weight: bold;">uniqueObjectList</span><span style="color: #000000;">(callerList) {</span></span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     for( var i = 0; i &lt; callerList.length; i++){</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">             for( var j = i + 1; j &lt; callerList.length; j++){</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">                     if( callerList[j].key == callerList[i].key ) {</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">                             callerList.splice(j, 1);   // delete the duplicate</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">                             --j;   // reduce the array length by one</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">                     }</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">             }</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     }</span></p><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">     return callerList;</span></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">}</span></p></pre><p></p><p><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">This produces:</span></p><p></p><p><span style="font-size: 14pt; font-family: arial, helvetica, sans-serif; color: #000000;"><img alt="C:\Users\User 1\Desktop\5.object array dedup.jpg" class="jive-image" height="294" src="https://lh3.googleusercontent.com/HZVNUgIOjoZTm5No0dWw5vy17QhspA3Czi0ijLo_HRZI3_2vsDfJMFetskKTsKcXeo0k1I1nGAsjHvuIvWcGZjRFeXi1fv3FGcXG_wriqOQn2JURh2MQ1PdtdGHb4YbQCJXVUVS2jybiFFVZ" style="border-style: none; display: block; margin-left: auto; margin-right: auto;" width="623"/></span></p><p><span style="font-family: arial, helvetica, sans-serif; font-size: 14pt;"><br/><span style="color: #000000; font-size: 12pt;">That is pretty much the sum of the techniques you will find me using to do a DISTINCT with GlideRecord. Now it's your turn!</span></span></p><p></p><p><span style="font-weight: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif; font-style: inherit;">Steven Bell</span></p><p></p><p style="font-weight: inherit; font-style: inherit;"><span style="color: purple; font-weight: inherit; font-size: 12pt; font-family: inherit; font-style: inherit;"><strong>If you find this article helps you, don't forget to log in and "like" it!</strong></span></p><p></p><p style="font-weight: inherit; font-style: inherit;"><span style="color: purple; font-weight: inherit; font-size: 12pt; font-family: inherit; font-style: inherit;"><strong>Also, if you are not already, I would like to encourage you to become a member of our blog!</strong></span></p><p></p><p style="font-weight: inherit; font-style: inherit;"><span style="color: purple; font-weight: inherit; font-size: 12pt; font-family: inherit; font-style: inherit;"><strong><a _jive_internal="true" data-containerid="-1" data-containertype="-1" data-objectid="103434" data-objecttype="111" href="/servlet/JiveServlet/downloadImage/38-5354-103434/accenture technology logo.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img   alt="accenture technology logo.png" class="image-1 jive-image" height="52" src="e47fff71db185fc03eb27a9e0f9619e0.iix" style="margin: 10px 10px 10px 0; border: 0px; font-weight: inherit; font-style: inherit; font-family: inherit;" width="277"/></a><a _jive_internal="true" data-containerid="-1" data-containertype="-1" data-objectid="103435" data-objecttype="111" href="/servlet/JiveServlet/downloadImage/38-5354-103435/sn-community-mvp.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img   alt="sn-community-mvp.png" class="image-2 jive-image" height="48" src="76526dc6dbdcd344e9737a9e0f961969.iix" style="margin: 10px 10px 10px 0; border: 0px; font-weight: inherit; font-style: inherit; font-family: inherit;" width="135"/></a></strong></span></p><p style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #666666;"></p><p style="font-weight: inherit; font-style: inherit; font-family: inherit;"><strong style="font-style: inherit; font-family: inherit;">For a list of all of my articles:   <a title="" _jive_internal="true" data-containerid="1027" data-containertype="37" data-objectid="4821" data-objecttype="38" href="/groups/servicenow-user-group-us-tx-north-texas/blog/2015/10/23/community-code-snippets-articles-list-to-date" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;">Community Code Snippets: Articles List to Date</a></strong></p>