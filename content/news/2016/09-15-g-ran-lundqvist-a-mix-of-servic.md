---
title: "A mix of Service Portal public pages and SSO"
date: 2016-09-15T02:12:42.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=606e6eaddbd0dbc01dcaf3231f96193a"
---
<p>This is going to be a story of a problem I had myself.</p><p></p><p>First, I would like to do a shoutout to <a title="fschuster" __default_attr="9624" __jive_macro_name="user" _jive_internal="true" class="jive_macro jive_macro_user" data-orig-content="fschuster" data-renderedposition="52_241_77_16" href="/community?id=community_user_profile&user=b93352e5db1c1fc09c9ffb651f9619f6">fschuster</a> and <a title="patrick.wilson" __default_attr="32811" __jive_macro_name="user" _jive_internal="true" class="jive_macro jive_macro_user" data-orig-content="patrick.wilson" data-renderedposition="52_350_104_16" href="/community?id=community_user_profile&user=2d3352e5db1c1fc09c9ffb651f961923">patrick.wilson</a> for helping me out here, without their ideas I probably would still be banging my head against a wall.</p><p></p><p>Now, here comes the scenario...</p><p></p><p>Our instance had its birth in Eureka and have gone through Fuji, Geneva and now it's the time to hit Helsinki.</p><p>We started to use SSO with Eureka, connected to our ADFS service.</p><p>We also have a CMS site(portal) that we use where some pages are public(for example the start page) and doesn't require a logged in user while some other pages does. So when you click on a link and isn't logged it you should be redirected to SSO and then back to the page you wanted to reach.</p><p></p><p>So for Helsinki we wanted to build our first Service Portal with pretty much a 1:1 relationship when it comes to the functionality etc. And my problem here will be focused how to get some pages as public and when the user hits the other pages, they should be redirected to the SSO.</p><p></p><h3>1. First try, Use the Public field</h3><p>My first thought was that this might be solved with just using the "public" field and check the ones that are public and then ones that isn't would be redirected automagic to SSO. But it didn't work like that. I only got to the page and it had the top menu visible since the user which wasn't logged in didn't had access the page.</p><p></p><h3>2. Perhaps use a login page as well?</h3><p>Well, next step... Hmm, I might need a login page then. Since if I have a login page, the user will be redirected to that page for login. Sound logic.. And since I already got SSO installed, they should get to the SSO instead. But nope. The user got only to the login page and the login widget.</p><p></p><h3>3. Does my SSO still work?</h3><p>Now I began to doubt things. does the SSO still work? I knew it work when I wanted to logon to the "normal UI" for users. But what is the problem... I then made so the startpage wasn't public anymore. And TADA, trying to enter the Service Portal and I got redirected to SSO... WTH... so if the whole portal required logged in users, it would point to the SSO and work, but if some pages were public, I only got to the first internal login page of the portal.</p><p></p><h3>4. Hmm.. Why dont I have these properties</h3><p>Then I was asked to set some values on two system properties. "glide.authenticate.multisso.enabled" &amp; "glide.authenticate.sso.redirect.idp". I realized that I don't have these from the beginning... Hmm, should I just create them? Before doing that I thought I would try to find out what they did and took a trip to <a title="ocs.servicenow.com/bundle/helsinki-servicenow-platform/page/integrate/single-sign-on/reference/r_InstalledWithMultiProviderSSO.html" href="https://docs.servicenow.com/bundle/helsinki-servicenow-platform/page/integrate/single-sign-on/reference/r_InstalledWithMultiProviderSSO.html">documentation</a>. First line there was "The following items are installed with the Integration - Multiple Provider SIngle Sign-On Installer plugin". And after checking, that plugin wasn't active. Should I activate this? I started to hesitate since we don't have Multiple Providers... We only have one.. And we all know, once you activated the plugin, there is no turning back. Naa, I don't wanna do that. Not yet at least.</p><p></p><h3>5. Let's go to the SAML 2 properties and see</h3><p>I wasn't involved with the configuration of SAML 2 and since it has been working, I haven't spend so much time on it. It has just been on my list to look at more when times comes by. So perhaps there is something I can click on or change? =)</p><p></p><p>But look here, this is what ServiceNow threw at my face when I clicked on the properties module.</p><p><img   class="image-1 jive-image" height="150" src="0c5a2f39db581fc03eb27a9e0f96193f.iix" style="width: 514px; height: 150.055px;" width="513"/></p><p>Well.. It suddenly sounded like a good idea to activate that plugin =)</p><p></p><h3>6. Finally the solution</h3><p>So now it's time to tell you what I did to make it work.</p><p></p><ul><li>I activated the plugin "Integration - Multiple Provider SIngle Sign-On Installer plugin". That wasn't so hard =)</li><li>I changed the value to true on "glide.authenticate.multisso.enabled" and verified that "glide.authenticate.sso.redirect.idp" had the sys_id of the IDP record.</li></ul><p><br/>After this, it worked. I clicked on a page that wasn't public, I got to the login page for like 1 sec, then I was redirected to the SSO login.</p><p></p><p>A bit of background how it work. Since I have the login widget on the login page, ServiceNow knows that it's a login thingie and mixed together with the properties above it will redirect to the IDP. Now, going with this, I can put a login widget on the nonpublic pages and get the same result, but it wouldn't look so good since I would need to all those pages public as well, otherwise the login widget wont load and the redirect wont work.</p><p></p><p>What I would like to see is an improvement on the login page. Atm, I get like a 1 sec flash of the login page before the redirect and it doesn't really look good since I see the widget etc. Will probably need to clean it up with some CSS in the start.</p><p></p><p>I also noticed some weird stuff when I activated the plugin and ServiceNow migrated the old values. It for example changed which field on my user records it should compare with the result from the SSO and that resulted that I couldn't log in to the instance through SSO since it couldn't find a matching user record.</p><p></p><p>I hope you learned something from my journey and hopefully this will help someone with the same problem as I.</p>