---
title: "Single page app on Service Portal  Part   UIRouter"
date: 2016-11-19T08:39:52.000Z
authors: ["arthuroliveira"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=081e6e2ddbd0dbc01dcaf3231f9619da"
---
<p dir="ltr" style="margin-left: 144pt; padding-left: 360px; text-align: right;"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">"Single-Page Applications are Web apps that load a single HTML page and dynamically update that page as the user interacts with the app. "</span></p><p dir="ltr" style="margin-left: 144pt; text-align: right;"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">Microsoft Magazine</span></p><p dir="ltr" style="margin-left: 72pt;"></p><p dir="ltr" style="margin-left: 72pt;"></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">For this example we will be using ui-router to manage state and what is displayed to the user but with this approach you could use any state manager.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Let's call our project </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Hello World</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Some information about our project</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Portal:</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Title: Hello World</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Url suffix: helloworld</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Homepage: helloworld_homepage (an empty page that we creating the portal)</span></p><p dir="ltr"><img   class="image-6 jive-image" src="a471ebb1db5c9f04e9737a9e0f961995.iix" style="max-width: 1200px; max-height: 900px;"/></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Step 1</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">First let's download the library (</span><a href="https://github.com/angular-ui/ui-router"><span style="font-size: 14.6667px; font-family: Arial; color: #1155cc; text-decoration: underline;">https://github.com/angular-ui/ui-router</span></a><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">) and create a UI Script with its content . The minified version is recommended.</span></p><p dir="ltr"><img   class="image-7 jive-image" src="78accd86dbd41b04ed6af3231f9619f6.iix" style="max-width: 1200px; max-height: 900px;"/></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Step 2</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Let's create a UI Script that our application will rely on. That UI Script can be used to create factories, services, filter, etc. Basically any angular 1 component.</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">I'll name our UI Script</span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;"> helloworld-uiscript. </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">I find that appending uiscript to the name makes it easier to identify it later on when we start working with widgets as well.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">In our UIScript I'll start creating an angular module called helloworld and adding ui.router as dependency. This is pure angular code and it should look   very familiar to angular developers</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">(function (angular) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">       angular.module('helloworld', ['ui.router'])</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">})(angular);</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Next let's define our states. For this demo we are creating 2 states. I'll try to keep it simple naming it </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">homepage</span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;"> and </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">detail</span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;"> but for your application make sure your state name reflect the state of your application.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold; font-style: italic;">IMPORTANT </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">Please note some states are already being used by service portal and it will break if you try to create a state with the same name, that's why I avoided using state1 and state2 and used homepage and detail instead</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Lets add a configuration block to our helloworld application. We will also inject </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">$stateProvider </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">which is provided by uiRouter and define our states.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">(function(angular) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">       angular.module('helloworld', ['ui.router'])</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">               .config(function($stateProvider) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">                       $stateProvider</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">                               .state('homepage', {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">                               })</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">                               .state('detail', {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">                               })</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">               })</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">}])(angular);</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Next we need to define what content (template) we will display for each state. We have couple options here.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Option 1:</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">We can define our template inline using the template property. It would look somewhat like this:</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">.state('homepage', {</span></p><p dir="ltr" style="text-indent: 36pt;"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">template: "&lt;h1&gt;Hello World Title - Homepage&lt;/h1&gt;"</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">})</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">This template property could become massive depending on what our state would display, so let's take a look at some other options</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Option 2:</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">UI Pages!</span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;"> As alternative to option 1, we could use the property templateUrl to point each state to a UI Page. It would look like this:</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">.state('homepage', {</span></p><p dir="ltr" style="text-indent: 36pt;"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">templateUrl: "homepage.do"</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">})</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Option 3:</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">TemplateCache!</span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;"> We can also use templateCache to point to a template ID that we will define later on. IT would look like this</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">.state('homepage', {</span></p><p dir="ltr" style="text-indent: 36pt;"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">templateUrl: "homepage"</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">})</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Since option 1 and 2 is pretty straightforward I'll implement our helloworld demo using Option 3.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Your UI Script should look like this at the end</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">(function (angular) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">       angular.module('helloworld', ['ui.router'])</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">               .config(function ($stateProvider) {</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">                       $stateProvider</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">                               .state('homepage', {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">                                       templateUrl: "homepage"</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">                               })</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">                               .state('detail', {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">                                       templateUrl: "detail"</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">                               })</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">               })</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">})(angular);</span></p><p dir="ltr"></p><p dir="ltr"><strong>UPDATE:   SP ng-template might be a better solution for a production application but the concept is the same</strong></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Step 3:</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Now lets create our custom widget that will wrap our application, add the proper dependencies and add it to our homepage.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">You can create the widget using the widget editor view or servicenow form. I'll use the widget editor by going to /sp_config?id=widget_editor but we will need to switch to the form view to add the dependencies</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">For this widget I'm going to name it </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">helloworld-uiview</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">HTML</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Let's start creating our cached templates defined in the uiscript (state1 and state2) then we will add a ui-view directive provided by ui router. Your code should look like this</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">&lt;script&gt;</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">&lt;h1&gt;Homepage View&lt;/h1&gt;</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">&lt;a ui-sref="detail" class="btn btn-primary"&gt;Go To Detail View&lt;/a&gt;</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">&lt;/script&gt;</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">&lt;script&gt;</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">&lt;h1&gt;Detail View&lt;/h1&gt;</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">&lt;a ui-sref="homepage" class="btn btn-primary"&gt;Go To Homepage View&lt;/a&gt;</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">&lt;/script&gt;</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">&lt;ui-view&gt;&lt;/ui-view&gt;</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">CLIENT SCRIPT</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">In the client script we need to define our default state AKA home state. For this we need to inject $state, provided by ui router</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">IMPORTANT: </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Later in the process we are going to access a page called $spd.do . This page relies on $state to work, so we need to write some work around to stop $state manipulation   for when accessing this page</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Your code should look like this:</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">function ($state,$location) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">if ($location.path().indexOf('editor') != -1) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">return;</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">}</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">$state.go('homepage');</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">}</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">No Server side script, SCSS and link function are needed for this example, now let's switch to the platform view by clicking on the hamburger menu on the top right</span></p><p dir="ltr"><img   class="jive-image image-8" src="7e2cec4adbd45f048c8ef4621f9619b3.iix" style="max-width: 1200px; max-height: 900px;"/></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Setting up Dependencies</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Scroll down to Dependencies and let's create a new dependency (sp_dependency)</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Name: helloworld Dependency</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Include on page load: yes</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Portals for pageload: helloworld</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Angular module name: helloworld (defined in our ui script)</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Save </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">instead of submitting so we stay on the same page and we can add the files dependency</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Now lets create 2 new JS Includes. One for our helloworld-uiscript and another for ui router. It's important that the Order field for UI router is smaller than helloworld-uiscript since our uiscript injects uirouter as dependency</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Display Name: UI Router</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Source: UI Script</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">UI script: ui router</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Display Name: UI Router</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Source: UI Script</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">UI script: helloworld uiscript</span></p><p dir="ltr"><img   class="image-9 jive-image" src="aa4a4806db109fc068c1fb651f9619cf.iix" style="max-width: 1200px; max-height: 900px;"/></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Step 4</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">The alst step is adding our helloworld-uiview to the homepage.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">We can do this by going to /$spd.do</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Final Result</span></p><p dir="ltr"></p><p dir="ltr"><img   alt="gif-generated.gif" class="image-10 jive-image" src="4fe4e3b9dbdc9f04e9737a9e0f9619c0.iix" style="width: auto; height: auto;"/></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">You can view a live demo here:</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #1155cc; text-decoration: underline;"><a title="mpaoliveira.service-now.com/helloworld" href="https://empaoliveira.service-now.com/helloworld">https://empaoliveira.service-now.com/helloworld</a></span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">I hope it helped!</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Soon I'll post a part 2 where I'll explain how to develop single page app with deep linking so you can use the history tab to go back or send a user to a specific state.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Thank you</span></p>