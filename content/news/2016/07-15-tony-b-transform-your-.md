---
title: "Transform Your Way to Better Alerts"
date: 2016-07-14T08:43:43.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=bacca265dbd0dbc01dcaf3231f961975"
---
<p>My family has a fairly mixed cultural heritage so there are times when I hear the same message being said in different ways:</p><p></p><p>My daughter practicing her Mandarin "<span style="color: #000000; font-family: Calibri, sans-serif;">ç�¯æ³¡å��äº†</span>"</p><p>My mother: "Sviatlo nie pracuje"</p><p>My father-in-law: "De gloeilamp is doorgebrand"</p><p>My son: "Dad! Dad! There was a flash in the room and now it's dark!!</p><p></p><p>Despite the fact that each of these family members can speak fluent English, I'm a nerd and I'm determined to use a high-tech solution to this vexing problem.   I reach for my phone and tap on the Google Translate app.   After translating each message I apply deductive powers Sherlock Holmes would be proud of to determine that everyone's telling me the same thing.</p><p></p><p>Managing events sent from different monitoring tools or sources presents a similar problem, albeit without the crankiness of an 80-year old Dutch father-in-law.   Events are sent in a variety of formats, sometimes containing different messages but potentially reporting the same thing.   You might be thinking that a Rosetta stone could come in quite handy right now - strangely, stone tablets and hieroglyphics were never adopted in IT.   Indeed, what's needed is a way of translating these events into a consistent format - a process known as normalisation.</p><p></p><p>Fortunately ServiceNow Event Management allows you to normalise events fairly easily using <em>Event Rules</em>.   Event Rules can be used to Ignore, Transform and Threshold incoming events allowing them to be processed into alerts.   Behold the Transform function!   (cue heraldic music and a shaft of light bathing an orb-like shiny object).</p><p></p><p>Let's look at a sample event sent from a Zabbix monitoring tool and received in a ServiceNow instance for the Acme Corporation:</p><p><img   alt="Rosetta-01.png" class="image-1 jive-image" src="5225ec0edbdc5304b322f4621f96191c.iix" style="width: 620px; height: 280px;"/></p><p>You might think this event looks OK, but the <em>Type</em> field's value is a potential problem since the Windows service name might change.   Also, note that the <em>Resource</em> field value is blank.   Let's assume that what we want to do is set the Type to "Windows Service Stopped" and we want to set Resource to the name of the affected Windows service.   We start by creating an Event Rule that will be applied to events sent from Zabbix <em>and</em> where the Type is: <span style="font-family: 'andale mono', times;">WindowsService "NetBackup Agent Request Server"</span>.   But what if another event arrives from Zabbix for the <em>same</em> node but a <em>different</em> service name?   We want an Event Rule flexible enough to accommodate <em>any</em> service name and we can achieve this by using a regular expression (regex) e.g.: <span style="font-family: 'andale mono', times;">WindowsService "(.+)"</span>.   Let's take a look at the Event Rule:</p><p><img   alt="Rosetta-02.png" class="image-2 jive-image" src="8904cc8edbd85fc068c1fb651f9619ed.iix" style="width: 620px; height: 500px;"/></p><p>We've set the <em>Filter</em> condition to choose any Zabbix events that match the regex, and we've used the same regex to match the text in the event's <em>type</em> field and mapped the regex portion to the <em>resource</em> field.   Then we've composed the <em>type</em> field to set a value of "Windows Service Stopped".   When the Event Rule is applied, the resulting <em>alert</em> now has the desired field values:</p><p><img   alt="Rosetta-03.png" class="image-3 jive-image" src="701405cadb5897041dcaf3231f96191d.iix" style="width: 620px; height: 277px;"/></p><p>Acme's Monitoring Administrator who we will now refer to as "William" spent two weeks vacationing in the Maldives.   Standing in for William was a trainee known as "Trevor", an expert snowboarder who thought Zabbix was a new totally awesome snowboard binding.   Asked to setup monitoring of a Windows service on a new server, Trevor configured a new - albeit duplicate - monitor.   Unfortunately the events generated by this new monitor did not set a Type field and only included the following text in the Description field: <span style="font-family: 'andale mono', times;">"Apache2" service entered the stopped state</span>.</p><p></p><p>Missing the sun, white-sand beaches and mojitos, William returns to find that he can't remove the new monitor from Zabbix and needs a solution.   He decides to create a new Event Rule in ServiceNow Event Management similar to the one in the previous example, but referencing the <em>description</em> field and use the following regex: <span style="font-family: 'andale mono', times;">"(.+)" service entered the stopped state</span>.   The Event Rule ends up looking like the one below:</p><p><img   alt="Rosetta-04.png" class="image-4 jive-image" src="c11a8106db1c97041dcaf3231f961919.iix" style="width: 620px; height: 584px;"/></p><p>Now events that have a matching <em>node</em> and transformed <em>type</em> and <em>resource</em> fields can be matched to a consolidated alert:</p><p><img   alt="Rosetta-05.png" class="image-5 jive-image" src="1b796002db94dfc03eb27a9e0f96192c.iix" style="width: 620px; height: 371px;"/></p><p>William does a fist pump and shouts "I came, I saw, I <strong>transformed</strong>!".   Trevor thinks about shredding snow at Powder Mountain.</p><p></p><p>Event Rules and some knowledge of regex can be powerfully applied to transform events to drive higher event to alert consolidation ratios, and reduce the number of incidents that may be created by alerts.</p><p></p><p>Finally, we return to the message from my family members - letting me know that a light bulb had blown.   Unfortunately the severity of this message wasn't conveyed until I heard from my wife: "Did you know that it's been <em>three</em> <em>days</em> since the light blew in our room?".   Unless I'm very much mistaken <em>that's</em> an SLA breach.</p>