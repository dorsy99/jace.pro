---
title: "Speed up your email delivery by validating recipients"
date: 2016-03-28T05:01:47.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=932e6a6ddbd0dbc01dcaf3231f961953"
---
<p>An extremely practical and well presented<a title="ocs.servicenow.com/administer/reference_pages/concept/c_EmailConfiguration.html" href="https://docs.servicenow.com/administer/reference_pages/concept/c_EmailConfiguration.html"> email relay system</a>, is comprised of a fast cloud SMTP server. It furthers the ability to integrate with external SMTP servers that it is suitable for most business needs. You can reduce the number of invalid emails and speed up delivery of your emails by ensuring to validate the recipients. To ensure flexibility, you can add the possibility to unsubscribe from an email notification. I will try to focus on identifying invalid email addresses. However, ensuring valid email addresses is like trying to eradicate a virus, it requires an efficient and regular intervention. Note, this is just the tip of the iceberg on outbound email performance as several other factors count as well.</p><p></p><p><img   alt="speed-up-emails.png" class="image-12 jive-image" height="128" src="f0b98d4adb9497049c9ffb651f9619c1.iix" style="width: 313px; height: 127.625px; display: block; margin-left: auto; margin-right: auto;" width="313"/></p><p></p><h2>Here are 6 tips reduce the number of invalid emails and speed up delivery:</h2><ol><li>Educate your users and include information on the notification about how to unsubscribe.</li><li>Validate that the target emails are valid.</li><li>Regularly execute email verification and check the list of incorrect or undelivered emails.</li><li>Prepare for emails that bounce back (e.g. out of the office, undelivered, etc.).</li><li>Plan delivery of bulk emails during non-busy times.</li><li>Ensure the target email servers have white-listed the relay SMTP server.</li></ol><p></p><p>For these examples, I have set the following emails for testings:</p><table border="1" cellpadding="0" cellspacing="0" height="210" style="border: 1pt solid #ed7d31; height: 159px; width: 542px;"><tbody><tr><td style="border: solid #ed7d31 1.0pt; background: #ED7D31;" width="159"><p><span style="color: white;"><strong>Email</strong></span></p></td><td style="border: solid #ed7d31 1.0pt; background: #ED7D31;" width="45"><p><span style="color: white;"><strong>Syntax</strong></span></p></td><td style="border: solid #ed7d31 1.0pt; background: #ED7D31;" width="45"><p><span style="color: white;"><strong>Valid</strong></span></p></td><td style="border: solid #ed7d31 1.0pt; background: #ED7D31;" width="80"><p><span style="color: white;"><strong>Reason</strong></span></p></td></tr><tr><td style="border: solid #ed7d31 1.0pt;" width="159"><p>abel.t uter@exa mple.com</p></td><td style="border: solid #ed7d31 1.0pt;" width="45"><p>Error</p></td><td style="border: solid #ed7d31 1.0pt;" width="45"><p>No</p></td><td style="border: solid #ed7d31 1.0pt;" width="80"><p>Space on example</p></td></tr><tr><td style="border: solid #ed7d31 1.0pt;" width="159"><p>adela.cervantszexample.com</p></td><td style="border: solid #ed7d31 1.0pt;" width="45"><p>Error</p></td><td style="border: solid #ed7d31 1.0pt;" width="45"><p>No</p></td><td style="border: solid #ed7d31 1.0pt;" width="80"><p>No @</p></td></tr><tr><td style="border: solid #ed7d31 1.0pt;" width="159"><p>aileen.mottern@ example.NOEXISTANT</p></td><td style="border: solid #ed7d31 1.0pt;" width="45"><p>Error</p></td><td style="border: solid #ed7d31 1.0pt;" width="45"><p>No</p></td><td style="border: solid #ed7d31 1.0pt;" width="80"><p>NOEXISTANT is not a domain</p></td></tr><tr><td style="border: solid #ed7d31 1.0pt;" width="159"><p>'alejandra.prenatt@ example.com'</p></td><td style="border: solid #ed7d31 1.0pt;" width="45"><p>Error</p></td><td style="border: solid #ed7d31 1.0pt;" width="45"><p>No</p></td><td style="border: solid #ed7d31 1.0pt;" width="80"><p>single quotes ' at beginning and end</p></td></tr><tr><td style="border: solid #ed7d31 1.0pt;" width="159"><p><a href="mailto:test@gmail.com"><span style="color: windowtext;">test@gmail.com</span></a></p></td><td style="border: solid #ed7d31 1.0pt;" width="45"><p>OK</p></td><td style="border: solid #ed7d31 1.0pt;" width="45"><p>Yes</p></td><td style="border: solid #ed7d31 1.0pt;" width="80"><p>Email is valid</p></td></tr></tbody></table><p></p><p>I added the recipients to an incident Assigned to and Watch list and added additional comments.</p><p><img   alt="assigned watch list.jpg" class="image-7 jive-image" src="72b4a00edbd0d704ed6af3231f961984.iix" style="width: 620px; height: 258px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><h3>1. Educate your users and allow the option to unsubscribe.</h3><p>It is difficult to know the user that need to read an email notification before many implementations. For flexibility, our system allows your to <a title="ocs.servicenow.com/administer/notification/concept/c_GettingStarted.html" href="https://docs.servicenow.com/administer/notification/concept/c_GettingStarted.html">enable or disable your email notification as part of the user preferences.</a> Provide information for how your users can disable the unwanted notifications.</p><p></p><pre __default_attr="info" __jive_macro_name="alert" alert="info" class="jive_text_macro jive_macro_alert" data-renderedposition="1161.2333984375_8_1121_43"><p>Valid emails addresses are the recipients that will receive and potentially read the email notification.</p></pre><p></p><table border="1" cellpadding="0" cellspacing="0" style="border: solid #ed7d31 1.0pt;"><tbody><tr><td style="border: solid #ed7d31 1.0pt; background: #ED7D31;" width="111"><p><span style="color: white;">Target recipient</span></p></td><td style="border: solid #ed7d31 1.0pt; background: #ED7D31;" width="111"><p><span style="color: white;">Correct syntax</span></p></td><td style="border: solid #ed7d31 1.0pt; background: #ED7D31;" width="111"><p><span style="color: white;">Target exist</span></p></td><td style="border: solid #ed7d31 1.0pt; background: #ED7D31;" width="111"><p><span style="color: white;">User read email</span></p></td></tr><tr><td style="border: solid #ed7d31 1.0pt;" width="111"><p>Valid</p></td><td style="border: solid #ed7d31 1.0pt;" width="111"><p>Yes</p></td><td style="border: solid #ed7d31 1.0pt;" width="111"><p>Yes</p></td><td style="border: solid #ed7d31 1.0pt;" width="111"><p>Yes</p></td></tr><tr><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>Invalid</p></td><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>Yes</p></td><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>Yes</p></td><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>No</p></td></tr><tr><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>Invalid</p></td><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>Yes</p></td><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>No</p></td><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>No</p></td></tr><tr><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>Invalid</p></td><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>No</p></td><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>No</p></td><td style="border: solid #ed7d31 1.0pt; background: #DBDBDB;" width="111"><p>No</p></td></tr></tbody></table><p></p><p>In addition, to ensure flexibility, your <a title="ocs.servicenow.com/administer/notification/task/t_CreateANotification.html" href="https://docs.servicenow.com/administer/notification/task/t_CreateANotification.html">email notification</a> Â  can have an unsubscribe link on the notification itself or to the user notification preference settings.This will avoid users marking your emails as spam on the target email, or triggering unwanted emails back, allow the sense of agreement with the target user, etc. Less emails means less time to deliver future notifications.</p><p></p><p>e.g On your notifications, you can add a mail script to include an unsubscribe link:</p><pre __default_attr="java" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14590968652192744 jive_text_macro" data-renderedposition="1507.2333984375_8_1121_48" jivemacro_uid="_14590968652192744"><p>&lt;mail_script&gt;</p><p>template.print('&lt;a href="' + gs.getProperty("glide.servlet.uri") + "unsubscribe.do?sysparm_notification=" + email_action.sys_id + '"&gt;Unsubscribe&lt;/a&gt;&lt;br/&gt;\n');</p><p>&lt;/mail_script&gt;</p></pre><p></p><p>Alternatively, an email script that will allow you to unsubscribe.</p><p><img   alt="email script unsubscribe.jpg" class="image-8 jive-image" src="23930482db1cd3049c9ffb651f961912.iix" style="width: 620px; height: 231px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><h3>2. Validate that the target emails are correct</h3><p>This is one of the most important steps. Check and double check that the email syntax and a basic domain are correct. This is target to the users that have incorrectly written emails.</p><p>Ensure your email addresses lists is tuned, and the syntax is correct. Below is a sample <em>findInvalidEmailAddresses</em> script the checks if the email address is valid. To validate the domain, you could use the instance search queries. e.g. emails that ends with "@acme.com", etc.</p><pre __default_attr="warning" __jive_macro_name="alert" alert="warning" class="jive_text_macro jive_macro_alert" data-renderedposition="1995.2333984375_8_1121_43"><p>Invalid emails are all those emails that will never get delivered (email is incorrect) or read on by the user the email address was provided (e.g. email account is abandoned)</p></pre><p>In our examples:</p><p><img   alt="validate target email.jpg" class="image-9 jive-image" src="6981e779dbd01fc03eb27a9e0f9619f7.iix" style="width: 620px; height: 207px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p>The email system will perform a basic syntax check and will pick very few emails as follow:</p><pre __jive_macro_name="quote" class="jive_macro_quote jive_text_macro" data-renderedposition="2356.2333984375_8_1121_62"><p>&gt;Notification 'Incident commented' (0d51edbac0a80164006963b000ff644e) excluded recipients because user's device contains an empty or invalid email address (see "cmn_notif_device.email_address"): 'Adela Cervantsz' (0a826bf037102000e0bfc8bcbe5d7a)</p></pre><p>Any other user which email were accepted will show on the email logs as:</p><pre __jive_macro_name="quote" class="jive_macro_quote jive_text_macro" data-renderedposition="2459.2333984375_8_1121_83"><p>&gt; Notification 'Incident commented' (0d51edbac0a80164006963b000ff644e) included recipients via notification's "Users/Groups in fields" (e.g., watchlist, assigned_to, etc): 'Alejandra Prenatt' (22826bf03710200044e0bf8bcbe5dec), 'Jonny Seymour' (b6392da30f1856146cce1050efd), 'Aileen Mottern' (71826bf03710200044ebfc8bcbe5d3b), 'Abel Tuter' (62826bf037100044e0bfc8bcbe5df1)</p></pre><p><span>On the email itself the recipients will look like: <strong>aileen.mottern@example.NOEXISTANT, abel.t uter@exa mple.com, </strong></span><strong><a title="k-email-small" class="jive-link-email-small" href="mailto:test@gmail.com">test@gmail.com</a>, <a title="k-email-small" class="jive-link-email-small" href="mailto:'alejandra.prenatt@example.com">'alejandra.prenatt@example.com</a>'</strong></p><p><img   alt="email recipients.jpg" class="image-10 jive-image" src="07b84482db981344e9737a9e0f96196f.iix" style="width: 620px; height: 119px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p>To validate the syntax of emails stored on the sys_user table, here is a <a title="ocs.servicenow.com/script/debugging/task/t_WatchingAHiddenField.html" href="https://docs.servicenow.com/script/debugging/task/t_WatchingAHiddenField.html">background script</a> that can help you find the some of those emails with the incorrect syntax:</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14591228175236056 jive_text_macro" data-renderedposition="2779.2333984375_8_1121_368" jivemacro_uid="_14591228175236056"><p>findInvalidEmailAddresses(!1); // false !1 to NOT set notification off automatically Â  </p><p>function findInvalidEmailAddresses(setnotifyoff) { Â  </p><p> Â  Â  Â  var a = [], // holds the message back Â  </p><p> Â  Â  Â  Â  Â  Â  Â  b = [], // holds the sys_id's for the link Â  </p><p> Â  Â  Â  Â  Â  Â  Â  f = "emailISNOTEMPTY^active=true^locked_out!=true^notification=2", Â  </p><p> Â  Â  Â  Â  Â  Â  Â  h = 10000, // max results for the query to avoid unlimited queries Â  </p><p> Â  Â  Â  Â  Â  Â  Â  e = setnotifyoff == !0; // check if want to set notification off on the user Â  </p><p> Â  Â  Â  a.push("*** Scripts findInvalidEmailAddresses ***"); Â  </p><p> Â  Â  Â  a.push("-----Searching for invalid email addresses: ----- setting notification off: " + e + "\nsys_user query: " + f); Â  </p><p> Â  Â  Â  // c is the regex to validate the email is valid. Note this is a guide Â  </p><p> Â  Â  Â  var c = /^\b[a-z0-9!#$%&amp;'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[A-Z]{2}|com|org|net|gov|tv|biz|info|mobi|name|aero|jobs|museum)\b$/i, Â  </p><p> Â  Â  Â  Â  Â  Â  Â  d = new GlideRecord("sys_user"); Â  </p><p> Â  Â  Â  // query for relevant users. Â  </p><p> Â  Â  Â  d.addEncodedQuery(f); Â  </p><p> Â  Â  Â  d.setLimit(h); // do not query more than 10K records Â  </p><p> Â  Â  Â  for (d.query(),g=1; d.next();) { Â  </p><p> Â  Â  Â  Â  Â  Â  Â  d.email &amp;&amp; !c.test(d.email) &amp;&amp; (b.push(d.sys_id + ""), a.push("User #"+ g +" Found: " + d.sys_id + ' - email = "' + d.email + '"')) &amp;&amp; g++ &amp;&amp; Â  e &amp;&amp; (d.notification = 1) &amp;&amp; d.update(); Â  </p><p> Â  Â  Â  } Â  </p><p> Â  Â  Â  (d.getRowCount() &gt;= h) Â  &amp;&amp; a.push("\n**** WARNING results are higher or equal than the limit "+ h +" set for the query"); Â  </p><p> Â  Â  Â  b.length ? a.push("\n**** Found "+ b.length + " possible invalid email(s) of " + d.getRowCount() + " emails checked. Run 'findInvalidEmailAddresses(!0)' to disable them" + "\nTo list them use the following link:\n"+ gs.getProperty('glide.servlet.uri') + "sys_user_list.do?sysparm_query=sys_idIN" + b.join(",") ): a.push("\n**** All emails compliant: " + d.getRowCount() + " emails checked." ); Â  </p><p> Â  Â  Â  // print the message for the background script Â  </p><p> Â  Â  Â  gs.print(a.join("\n")) Â  </p><p>}; </p></pre><p>For our examples, it will discover the following problematic emails:</p><pre __jive_macro_name="quote" class="jive_macro_quote jive_text_macro" data-renderedposition="3178.2333984375_8_1121_335"><p>---background script result-----</p><p>*** Script: *** Scripts findInvalidEmailAddresses ***</p><p>-----Searching for invalid email addresses: ----- setting notification off: false</p><p>sys_user query: emailISNOTEMPTY^active=true^locked_out!=true^notification=2</p><p>User #1 Found: 0a826bf03710200044e0bf10bcbe5d7a - email = "adela.cervantszexample.com"</p><p><span>User #2 Found: 22826bf03710200044e0bf10bcbe5dec - email = "</span><a title="k-email-small" class="jive-link-email-small" href="mailto:'alejandra.prenatt@example.com">'alejandra.prenatt@example.com</a><span>'"</span></p><p>User #3 Found: 62826bf03710200044e0bf10bcbe5df1 - email = "abel.t uter@exa mple.com"</p><p>User #4 Found: 71826bf03710200044e0bf10bcbe5d3b - email = "aileen.mottern@example.NOEXISTANT"</p><p></p><p></p><p>**** Found 4 possible invalid email(s) of 527 emails checked. Run 'findInvalidEmailAddresses(!0)' to disable them</p><p>To list them use the following link:</p><p>&lt;instance&gt;/sys_user_list.do?sysparm_query=sys_idIN0a826bf03710200044e0bfc8bc5d7a,22826bf037102044e0bfc8bcbe5dec,628bf03710200044e0b8bcbe5df1,71826bf030200044e0bfc8bcbe5d3b</p><p></p><p>---background script -----</p></pre><p>You will need to search for those users and then set the notification = Disable. After that, you may need to contact the users to correct their email addresses.</p><p></p><p><span style="font-size: 16px; font-weight: bold; line-height: 1.5;">3. Regularly execute email verification and check the list of incorrect or undelivered emails</span></p><p><a title="n.wikipedia.org/wiki/Regular_expression" href="https://en.wikipedia.org/wiki/Regular_expression">Regular expressions</a> and email checks will not filter all invalid emails. Even if your email syntax is correct and validated by regular expressions, you do not really know whether an address is valid until you send an email to it. Even if the email arrives in the inbox, that doesn't mean it has been read.</p><p></p><p>Invalid emails could cause delays to the overall email delivery.</p><ul><li>Invalid email could cause SMTP retries event if only ONE email of 100 on the recipient list does not exit.</li><li>Bounced emails can execute inbound actions and potentially create email loops that cause some email outage, than bounce back, then again.</li><li>Extra processing for the irrelevant emails could be relevant.</li><li>Target email systems could black-list the SMTP relay, delaying the delivery even further.</li></ul><p></p><p>To avoid those problems, there are several email validations that can be performed. The automatic validation is not available on ServiceNow yet: if you have an external email provider that can test the target emails, you can provide them with your email list and they will validate if they exist on the final exchange or not. They will extract the MX records from the email address and connect to mail server (over SMTP and also simulates sending a message) to make sure the mailbox really exist for that user/address. Â  If you do not have those services, you can still review the bounced emails on your instance to manually validate those emails. For those emails that bounced back, set the notification = disable on the sys_user form to avoid further unwanted emails. Then, contact the user owners for the correct addresses.</p><p></p><p>Even then, you will need to regularly check for incoming bounced back emails as users leave companies, email changes, etc. There are several other cases some where email will not get delivered. e.g. Emails bounced back because the target email has full mailboxes could indicates that no ones read that mailbox.</p><p></p><p>This is important as your instance will retry to send on certain cases, even if it is an invalid email depending on the SMTP response.</p><p></p><pre __default_attr="info" __jive_macro_name="alert" alert="info" class="jive_text_macro jive_macro_alert" data-renderedposition="4037.2333984375_8_1121_43"><p>You will need to search your skipped emails regularly to fix the problematic emails manually. To avoid them, set the notification - disable on the related sys_user record.</p></pre><p></p><p>This is an example email:</p><pre __jive_macro_name="quote" class="jive_macro_quote jive_text_macro" data-renderedposition="4146.2333984375_8_1121_272"><p>&gt;Subject:Undelivered Mail Returned to Sender</p><p>&gt;From:MAILER-DAEMON (Mail Delivery System)</p><p>&gt;Auto-Submitted:auto-replied</p><p>State: Ignored</p><p>Mailbox: Junk</p><p>User: MAILER-DEAMON</p><p>Body = [ This is the mail system at host bulk.service-now.com. I'm sorry to have</p><p>to inform you that your message could not be delivered to one or more recipients.</p><p>It's attached below. For further assistance, please send mail to postmaster.</p><p>If you do so, please include this problem report. You can delete your own text</p><p>from the attached returned message. <strong>The mail system &lt;aileen.mottern@example.NOEXISTANT&gt;:</strong></p><p><strong>Host or domain name not found. Name service error for name=example.NOEXISTANT type=A: Host not found</strong></p></pre><p>You will need to search for email aileen.mottern@example.NOEXISTANT, and set the notification = Disabled for the associated user.</p><h4></h4><p></p><h3>4. Be prepared for emails bounced back (e.g. out of the office, undelivered, etc)</h3><p>Each email you send is potentially one email back to be received. Be prepared. To ignore emails, you either configure your email filters on the email configuration or install the <a title="ocs.servicenow.com/administer/notification/concept/c_EmailFilters.html" href="https://docs.servicenow.com/administer/notification/concept/c_EmailFilters.html">"Email Filters" plugin</a>. If using <a title="ocs.servicenow.com/administer/reference_pages/concept/c_EmailConfiguration.html" href="https://docs.servicenow.com/administer/reference_pages/concept/c_EmailConfiguration.html">email configuration</a>, ensure the properties to ignore unwanted emails are set to cover all your bounced email cases.</p><p></p><p>For example: glide.pop3.ignore_headers, glide.pop3.ignore_subjects, glide.pop3.ignore_senders</p><p></p><p>For most sophisticated filters, use the<a title="ocs.servicenow.com/administer/notification/concept/c_EmailFilters.html" href="https://docs.servicenow.com/administer/notification/concept/c_EmailFilters.html"> "Email Filters" plugin</a>. Email filters take over the email configuration filter. Once enabled, administrators can configure specific email filtering preferences by using a condition builder or a condition script.</p><pre __default_attr="warning" __jive_macro_name="alert" alert="warning" class="jive_text_macro jive_macro_alert" data-renderedposition="4676.2333984375_8_1121_43"><p>With Email filters enabled, glide.pop3.ignore_headers, glide.pop3.ignore_subjects and glide.pop3.ignore_senders Â  will get ignored.</p></pre><p>See <a title="i.service-now.com/kb_view.do?sysparm_article=KB0549426" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0549426">Email Spam Scoring and Filtering</a> (will need to login to HI to view) to know how to use the Email Filters plugin to filter emails which have been scored as spam, when using the ServiceNow email infrastructure.</p><p></p><p>If your email does Â  meet the filters/Email filters conditions, you will receive a message "ignored by filter" on the logs, an the email will get skipped.</p><pre __jive_macro_name="quote" class="jive_macro_quote jive_text_macro" data-renderedposition="4827.2333984375_8_1121_41"><p>* Information Â  Â  Â  - Skipping 'Create Incident', <span style="color: #e23d39;"><strong>ignored by filter</strong></span></p></pre><pre __default_attr="warning" __jive_macro_name="alert" alert="warning" class="jive_text_macro jive_macro_alert" data-renderedposition="4882.2333984375_8_1121_43"><p>If your email filters are NOT configured correctly, the bounced emails will execute your inbound actions</p></pre><h3></h3><h3>5. Plan delivery of bulk emails on non-busy times</h3><p>Emails sent by bulk may delay critical business emails. Many of those emails will get rejected by the target SMTP server and resend once again. Validate with your administrator the best times to send bulk emails. If it's the first time you will send a bulk, ensure you monitor the bounce-back emails to disable the notification on the related users for those problematic email addresses.</p><p></p><p>You can also trigger some notification at an specific time using our <strong>gs.eventQueueScheduled(event, record, parm1, param2, date-time)</strong> function that could trigger your notification at the required date-time. For example: gs.eventQueueScheduled("incident.reminder", current, gs.getUserID(), gs.getUserName(), current.u_reminder);</p><p></p><pre __default_attr="info" __jive_macro_name="alert" alert="info" class="jive_text_macro jive_macro_alert" data-renderedposition="5148.2333984375_8_1121_64"><p>Keep in mind, there are <a title="ocs.servicenow.com/administer/reference_pages/reference/r_OutboundMailConfiguration.html" href="https://docs.servicenow.com/administer/reference_pages/reference/r_OutboundMailConfiguration.html">five (5) email properties</a><a title="ocs.servicenow.com/administer/reference_pages/reference/r_OutboundMailConfiguration.html" href="https://docs.servicenow.com/administer/reference_pages/reference/r_OutboundMailConfiguration.html"> </a>that will potentially add a relevant delay on email delivery because of invalid emails causing defer retries:</p><p><strong>glide.smtp.default_retry, glide.smtp.defer_retry_ids, glide.smtp.fail_message_ids, glide.email.smtp.max_recipients and glide.email.smtp.max_send<br/></strong></p></pre><p>Please set the properties to to meet your business requirements. The emails will be queued and re-queued several times for the problematic email addresses.</p><p></p><p><span style="color: #3334ca;"><strong>#1 glide.smtp.default_retry:</strong></span> Enables (true) or disables (false) resending email when an unknown SMTP error code is encountered.</p><p>The instance only recognizes the SMTP error codes defined in the glide.smtp.defer_retry_ids property. Default value: true</p><p></p><p><span style="color: #3334ca;"><strong>#2 glide.smtp.defer_retry_ids:</strong></span> Specifies the comma-separated list of SMTP error codes that force the instance to resend email.</p><p>Default value: 421,450,451,452</p><p>421 - Â  Â  Â  &lt;domain&gt; Service not available, closing transmission channel-</p><p>450 - Â  Â  Â  Requested mail action not taken: mailbox unavailable- e.g. SMTP server could not access a mailbox to deliver your message</p><p>451 - Â  Â  Â  Requested action aborted: local error in processing- e.g. This error is usually SMTP relaying service from too many messages.</p><p>452 - Â  Â  Â  Requested action not taken: insufficient system storage-</p><p></p><p><span style="color: #3334ca;"><strong>#3 glide.smtp.fail_message_ids</strong></span>: Specifies the comma-separated list of SMTP error codes that prevent the instance from resending email.</p><p>Default value: 500,501,502,503,504,550,551,552,553,554</p><p></p><p>500 - Â  Â  Â  Â  Syntax error, command unrecognised - e.g. Your antivirus/firewall interfering with incoming and/or outgoing SMTP communications</p><p>501 - Â  Â  Â  Â  Syntax error in parameters or arguments - e.g. Invalid email addresses or an invalid domain name recipient. Error can indicate bad connection</p><p>502 - Â  Â  Â  Â  Command not implemented</p><p>503 - Â  Â  Â  Â  Bad sequence of commands - e.g. Error, particularly if repeated, indicates bad connection. Verify authentication settings</p><p>504 - Â  Â  Â  Â  Command parameter not implemented</p><p>551 - Â  Â  Â  Â  User not local; please try &lt;forward path&gt;</p><p>552 - Â  Â  Â  Â  Requested mail action aborted: exceeded storage allocation - e.g. The recipient's mailbox has reached its maximum allowed size.</p><p>553 - Â  Â  Â  Â  Requested action not taken: mailbox name not allowed - e.g. Invalid email address.</p><p>554 - Â  Â  Â  Â  Transaction failed - e.g. when its anti-spam firewall does not like the sender's email address, or the sender's IP address, or the sender's ISP server</p><p></p><p><span style="color: #3334ca;"><strong>#4 glide.email.smtp.max_recipients</strong></span>: Specifies the maximum number of recipients the instance can list in the To: line for a single email notification. Notifications that would exceed this limit instead create duplicate email notifications addressed to a subset of the recipient list. Each email notification has the same maximum number of recipients. Default value: 100. This is ONLY valid for recipients created by the email notification system (it does not include emails added by scripts or email client).</p><p></p><p>On each duplicated email, email logs will show:</p><table class="data_list_table list_table table table-hover" data-list_id="sys_email.REL:b045856dc0a8006f0033127fe250c9e7" style="color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13px; font-style: normal; font-weight: normal; text-align: start; text-indent: 0px;"><tbody class="list2_body"><tr class="list_even hover list_row" data-list_id="sys_email.REL:b045856dc0a8006f0033127fe250c9e7" data-title-value="" data-type="list2_row"><td class="vt" colspan="1" data-original-title="" style="padding: 6px 6px 6px 7px; color: #343d47; border-top-width: 1px; border-top-style: solid; border-top-color: #bdc0c4; text-align: left; background-color: #f5f5f5;" title="">Information</td><td class="vt" colspan="1" data-original-title="" style="padding: 6px 6px 6px 7px; color: #343d47; border-top-width: 1px; border-top-style: solid; border-top-color: #bdc0c4; text-align: left; background-color: #f5f5f5;" title="">Email with 4 recipients is split into 4 separate emails because property glide.email.smtp.max_recipients=1 (Email 4 of 4)</td></tr></tbody></table><p></p><p>On our example, the final emails look as follow:</p><p><img   alt="email properties.jpg" class="image-11 jive-image" src="bdfa23b1db14df04e9737a9e0f9619ad.iix" style="width: 620px; height: 213px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p><span style="color: #3334ca;"><strong>#5 glide.email.smtp.max_send</strong></span>: Specifies how many emails to send through each new SMTP connection. The instance establishes a new SMTP connection if there are more emails to send than the specified value. Default value: 100</p><p></p><p><a title="ocs.servicenow.com/administer/reference_pages/reference/r_AvailableSystemProperties.html" href="https://docs.servicenow.com/administer/reference_pages/reference/r_AvailableSystemProperties.html">#4 and #5</a> can be used to set email throttling. e.g 100 email with 50 recipients max each vs 100 emails with 1 recipient max each. It completely depend on your target emails and email capacity of the target exchanges.</p><p></p><p>In a nutshell, plan your email delivery, set the resend properties accordingly with a reasonable to email throttling to protect system performance.</p><p></p><h3>6. Ensure the target email servers have white-listed the relay SMTP server.</h3><p>If your SMTP server is not white-listed, spam system could penalize it by adding transaction time to the relay or delaying delivery. This is VERY common. If the number of emails bounced back or the delivery time increases after bulk emails, check the target email address SMTP servers have white-listed the relay SMTP server on your instance. If you are using our SMTP relay system, ServiceNow highly recommends that you configure your target mail exchange systems to retrieve our <a title="w.openspf.org/FAQ" href="http://www.openspf.org/FAQ">Sender Policy Framework (SPF) </a>records dynamically, to white-list our Email servers. See <a href="https://hi.service-now.com/kb_view_customer.do?sysparm_article=KB0535456" title="https://hi.service-now.com/kb_view_customer.do?sysparm_article=KB0535456">Allowing email delivery from ServiceNow to your mail servers </a>for more information.</p><p></p><p></p><p></p><p></p><p></p><p>A final word. Less is better. Less email recipients means you spend less, you need less storage on the target, you need a smaller processes and</p><p>you sent them faster. To make it less, you need to regularly validate your target emails even if it means donkey work. If you do not check regularly, as more invalid emails populate your system, the more time your email will take to get delivered.</p><p></p><p>Hope it helps. I have performed the tests on Geneva, using Chrome as browser.</p><p></p><p>Additional information can be found here:</p><ul><li><a title="Speed up email delivery by disabling notifications for users with bounced emails" __default_attr="7282" __jive_macro_name="blogpost" class="jive_macro jive_macro_blogpost" data-orig-content="Speed up email delivery by disabling notifications for users with bounced emails" data-renderedposition="6723.783203125_38_520_17" href="/community?id=community_blog&sys_id=9c1d6ea5dbd0dbc01dcaf3231f9619ea">Speed up email delivery by disabling notifications for users with bounced emails</a> </li><li><p><a href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0540674" title="https://hi.service-now.com/kb_view.do?sysparm_article=KB0540674">Email Resources Page (KB0540674)</a></p></li><li><p><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=ae9caee1dbd0dbc01dcaf3231f96193c">3 steps to determine if and why the event processor is unable to start</a></p></li><li><p><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=f0dc6665dbd0dbc01dcaf3231f961955">Diagnosing and remedying stuck event processes</a></p></li><li><p><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=c8edaae9dbd0dbc01dcaf3231f96199b">Docs: Additional email properties</a></p></li><li><p><a title="" _jive_internal="true" href="https://docs.servicenow.com/administer/reference_pages/reference/r_AvailableSystemProperties.html">Docs: Available system properties</a></p></li><li><p><a _jive_internal="true" href="/community?id=community_blog&sys_id=ae9caee1dbd0dbc01dcaf3231f96193c" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/task/t_CreateANotification.html">Docs: Create an email notification</a></p></li><li><p><a href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/concept/c_NotificationExamples.html" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/concept/c_NotificationExamples.html">Docs: Notification examples</a></p></li><li><p><a href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/script/server-scripting/concept/c_ScriptingForEmailNotifications.html" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/reference/notifications.html">Docs: Notifications</a></p></li><li><p><a _jive_internal="true" href="/people/jonnyseymour/content?filterID=contentstatus%5Bpublished%5D%7Eobjecttype%7Eobjecttype%5Bblogpost%5D" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/script/server-scripting/concept/c_ScriptingForEmailNotifications.html">Docs: Scripting for email notifications</a></p></li><li><p><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/reference/notifications.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/reference/notifications.html">Troubleshooting email notifications - Send to the Event Creator</a></p></li><li><p><a title="i.service-now.com/kb_view.do?sysparm_article=KB0547784" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0547784">Troubleshooting Outbound Email (KB0521382)</a></p></li><li><p><a title="" _jive_internal="true" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0528671">Troubleshooting stuck event process (KB0547784)</a></p></li><li><p><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/task/t_CreateANotification.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/notification/task/t_CreateANotification.html">Verifying the recipient has an email address (KB0528669)</a></p></li><li><p><a title="" _jive_internal="true" href="https://docs.servicenow.com/administer/reference_pages/reference/r_AdditionalProperties.html">Verifying the recipient's email address is properly formatted (KB0528671)</a></p></li><li><p><strong><a title="" _jive_internal="true" href="/people/jonnyseymour/content?filterID=contentstatus%5Bpublished%5D%7Eobjecttype%7Eobjecttype%5Bblogpost%5D">My other blogs</a></strong></p></li></ul>