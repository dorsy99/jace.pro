---
title: "Scripting  Script Includes  Class vs Classless"
date: 2016-10-23T07:25:31.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=88bce625dbd0dbc01dcaf3231f9619be"
---
<p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Have you ever written a Script Include that you thought was truly amazing? Reusable.. concise.. adheres to best practices.. dare I say, has some <em>class</em> about it? In this article we'll discuss the difference between a <em>classy</em> Script Include, and one lacking in class. That is, Script Includes containing <em>Class</em> definitions vs Script Includes with standalone function definitions.</span></p><p></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">For those new to ServiceNow, Script Includes are Javascript definitions which can be called from any server side script, and in some cases from the client side too. They are most commonly used as an alternative to <em>Global Business Rules</em>, since they are only loaded upon request. For example, Script Includes are most frequently called from:</span></p><ul style="list-style-type: disc;"><li><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Business Rules</span></li><li><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">UI Actions</span></li><li><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Reference Qualifiers</span></li><li><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Transform Maps</span></li><li><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Other Script Includes</span></li></ul><p></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">From the <em>Fuji</em> release onwards, Script Includes are created in reference to an <em>Application Scope</em>. This means that you can configure whether your Script Include is available globally to <span style="text-decoration: underline;">all applications</span>, or only to a specific application. This helps to manage script functionality and to promote application independence. Any Script Includes created prior to the <em>Fuji</em> release are automatically assigned to the <em>Global</em> scope.</span></p><p></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">To identify whether a Script Include defines a <em>Class</em> or a function, we need to look at the script itself. Let's take a specific example:</span></p><p style="margin-left: 36.0pt;"><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;"><em>Define a function that returns the current user's job title.</em></span></p><p></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">As you can see in the image below, function definitions are actually quite simple. It should be noted that the Script Include name must also be the same as the function name.</span></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;"><em><img   alt="1.png" class="image-1 jive-image" src="f201f3f5db9c93049c9ffb651f96198c.iix" style="width: 620px; height: 240px; display: block; margin-left: auto; margin-right: auto;"/><br/></em></span></p><p><span style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"><span style="background: white;"><em>Classless</em></span><span style="background: white;"> Script Includes will generally contain a single function definition, as shown above for the function <em>getMyTitle()</em>. However it is possible to define multiple functions within the same Script Include.</span></span></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;"><img   alt="2.png" class="image-2 jive-image" src="635d0986db9413043eb27a9e0f9619c3.iix" style="width: 620px; height: 297px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">As shown above, this is essentially the same Script Include as before, but with an additional function definition called <em>getMyEmail()</em>. As with the previous example, the first function name must be the same as the Script Include name. It should also be noted that the latter functions are only available for use <span style="text-decoration: underline;">after</span> the first function has been called at least once. This means you won't be able to access <em>getMyEmail()</em> until after <em>getMyTitle()</em> has been called at least once prior. This process is cumbersome to say the least, and it demonstrates why it is far better to define a Class when multiple functions are required.</span></p><p></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Defining a Script Include with a <em>Class</em> may seem more complex at first, but ServiceNow actually provides the initial code stub upon naming the record. Shown below is a basic <em>Class</em> definition.</span></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;"><img   alt="3 v2.png" class="image-8 jive-image" src="0283ddc6db9897049c9ffb651f96194d.iix" style="width: 620px; height: 254px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Once you have the <em>Class</em> definition, you just need to define your functions, however the syntax is slightly different to the standalone function definitions shown earlier. Let's take a look:</span></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;"><img   alt="5 v2.png" class="image-7 jive-image" src="dd5e23f1dbd81fc068c1fb651f961959.iix" style="width: 620px; height: 326px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Note that each function definition begins with the function name followed by a colon, and then the function keyword and parentheses. Function arguments could be added inside these parentheses as per any standalone function definition. Finally, the function definition is closed with a comma after the closing curly brace. To call <em>getMyTitle()</em> using the above <em>Class</em>, you could simply use:</span></p><p><span style="color: #303030; font-family: arial, helvetica, sans-serif; font-size: 12pt;"><img   alt="4 ver2.png" class="image-5 jive-image" src="04be6c82dbd857049c9ffb651f9619ee.iix" style="width: 620px; height: 144px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Thanks to the wonders of dot-notation and object-oriented programming, any of the functions defined in the <em>Class</em> can be called as required using the above syntax. In technical terms, the <em>new MyUserUtil()</em> part is known as the Constructor, while the <em>getMyTitle()</em> part is known as a Method, referring to a function defined in the <em>Class</em>. </span></p><p></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Another advantage to using a <em>Class</em>, is that you can define global properties (variables or objects etc). These are activated when the <em>Class</em> is first instantiated into an <em>Object</em>. Why is this important? Let's take a look at an expanded version of the same <em>Class</em> from before.</span></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;"><img   alt="6 v2.png" class="image-6 jive-image" src="21cc4806db5c1344e9737a9e0f9619a5.iix" style="width: 620px; height: 305px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">In this version you'll notice a few subtle changes. Firstly, we've added the User record query to the <em>initialize()</em></span><span style="background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;"> </span><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">function, and secondly the <em>getMyTitle()</em> and <em>getMyEmail()</em> functions have been trimmed down. When an <em>initialize()</em> function is present, it will be executed as soon as the <em>Class</em> is instantiated. In our example, we're retrieving the current User record within this function, and then storing it as a global property. This means that only 1 GlideRecord query is required, since the User record is then available for all functions to use (e.g <em>getMyTitle()</em> and <em>getMyEmail()</em>). This is more efficient than the previous example, which ran a GlideRecord query every time the <em>getMyTitle()</em> or <em>getMyEmail()</em> functions were called. Note that to maintain this efficiency, you will need to use the <em>multi-line</em> method of instantiation shown earlier.</span></p><p></p><p><span style="color: #303030; background: white; font-family: arial, helvetica, sans-serif; font-size: 12pt;">Well there you have it, the pros and cons of using Script Includes, with and without a <em>Class</em>. For further information on the topics covered in this article, please see the following ServiceNow Documentation pages:</span></p><ul style="list-style-type: disc;"><li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><a href="http://wiki.servicenow.com/index.php?title=Script_Includes"><span style="color: #1155cc; background: white;">Script Includes</span></a></span></li><li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><a href="http://wiki.servicenow.com/index.php?title=Scripting_in_Scoped_Applications#Application_Scope"><span style="color: #1155cc; background: white;">Scripting in Scoped Applications</span></a></span></li><li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><a href="http://wiki.servicenow.com/index.php?title=Coding_Best_Practices"><span style="color: #1155cc; background: white;">Coding Best Practices</span></a></span></li></ul><p></p><p><span style="color: #1155cc; background: white; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="font-weight: bold; font-family: 'Times New Roman'; color: #666666;">NOTE</span><span style="font-family: Arial; color: #666666;">: </span><span style="font-family: 'Times New Roman'; color: #666666;">MY POSTINGS REFLECT MY OWN VIEWS AND DO NOT NECESSARILY REPRESENT THE VIEWS OF MY EMPLOYER. </span></span></p>