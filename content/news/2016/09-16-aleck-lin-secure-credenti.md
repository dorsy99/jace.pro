---
title: "Secure credentials with CyberArk"
date: 2016-09-15T05:51:09.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=e8ad22a9dbd0dbc01dcaf3231f9619ba"
---
<p style="font-family: 'Helvetica Neue';">About a month ago, my good colleague, <a __default_attr="61440" __jive_macro_name="user" _jive_internal="true" class="jive_macro jive_macro_user" data-orig-content="Angelo Nappi" data-renderedposition="9.815340995788574_263.18182373046875_103_16" href="/community?id=community_user_profile&user=e6629a69dbd81fc09c9ffb651f9619c0" modifiedtitle="true" title="Angelo Nappi">Angelo Nappi</a>, wrote a great post on the <a title="Importance of Credential Management" __default_attr="5758" __jive_macro_name="blogpost" class="jive_macro jive_macro_blogpost" data-orig-content="Importance of Credential Management" data-renderedposition="9.815340995788574_534.9431762695312_260_16" href="/community?id=community_blog&sys_id=b7bcae25dbd0dbc01dcaf3231f9619ac">Importance of Credential Management</a> outlining some important points around managing credentials securely. It got me thinking about my own experiences working in the field of Discovery... sometimes I do come across customers who do not want to store credentials in the ServiceNow cloud instance due to compliance or internal security policies. In such occasions, I'd offer <a href="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/concept/c_ExternalCredentialStorage.html" title="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/concept/c_ExternalCredentialStorage.html">External credential storage</a> feature to the rescue. Unfortunately, it would require custom integration with any vault or keystore. Over time, however, we did notice a trend... CyberArk was the name that kept coming up! After some internal discussion, our great folks in Development have done it! It is now supported as a native integration starting in the Geneva release! Hooray! </p><p style="font-family: 'Helvetica Neue';"></p><div><div><span style="color: #3d3d3d;">Without further ado, Let's dive right into it. Here's a reference diagram for the CyberArk integration. </span><p></p><p><img   alt="FB4C4BFA-A9BB-4906-B01B-5763FAF59052.png" class="image-1 jive-image" src="334e4142db181b04ed6af3231f9619f3.iix" style="width: auto; height: auto;"/></p><p>The entire integration is built upon the <a href="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/concept/c_ExternalCredentialStorage.html" rev="en_rl_minimal" title="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/concept/c_ExternalCredentialStorage.html">External storage credential</a> framework that I had mentioned earlier, so the mechanism to operate it remains the same, but we've essentially got ourselves a turn-key solution for CyberArk. Here are some details on how this works...</p><p></p><p>You would create stub credential records from the instance in the external storage view. Notice you wouldn't need to fill in the username and password. Instead, you would check the "External Storage" checkbox and specify a "credential ID" attribute, which becomes the marker to specify which credential from the vault should be retrieved. The "name" attribute, as always, is used for human manageability so that one could easily understand the purpose of the credential. </p><p><img   alt="76C20274-D4EC-41ED-9173-7ECD87D930F5.png" class="image-2 jive-image" src="0edba842dbd4dfc068c1fb651f9619dc.iix" style="width: 620px; height: 180px;"/></p><p>This also means that you have the choice to specify which credentials should come from the vault; this comes in handy when you need something quickly verified without having to go through the complete setup with the vault. Now let's talk about how the MID server uses the credentials.</p><p></p><p>The MID server downloads the credentials when it needs them for the purpose of Discovery, Service Mapping or Orchestration; and resolves the credentials that requires username/password from the vault at run time. From the standpoint of how MID severs communicate with various IP targets through different protocols like SSH, SNMP, WMI etc, credential retrieval is really orthogonal in that process. The MID server is simply deciding where to get the actual values for the credentials and that's the only difference. I have come across some customers who are hesitant in going forward with playing with ITOM products simply because the vault was not ready yet; Now, barring strong compliance issues, there's no technical reason to wait because it's literally just moving the credentials details from one one place to another (cloud to vault); everything else stays the same. Anyways, let's get back to CyberArk...</p><p></p></div><p><span style="color: #3d3d3d;">With this being a native integration, you can configure it fairly easily; I won't go through all the nitty gritty details of setting this up because it's outlined in our <a href="https://docs.servicenow.com/bundle/geneva-it-operations-management/page/product/discovery/concept/c_CyberArkIntegrationConfiguration.html" rev="en_rl_minimal" title="https://docs.servicenow.com/bundle/geneva-it-operations-management/page/product/discovery/concept/c_CyberArkIntegrationConfiguration.html">CyberArk integration configuration</a></span><span style="color: #3d3d3d;">, but let me talk about some of the key things to pay attention to as you look at the reference diagram above.</span></p><p></p><p><span style="color: #3d3d3d;">         1. <strong><a title="ocs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/task/t_ActivateExtrnlCredStoragePlugIn.html" href="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/task/t_ActivateExtrnlCredStoragePlugIn.html">Enable the "External Credential Storage"</a> plugin by contacting HI</strong>. You'll need to enable this plugin to use it, but don't worry, it's free! </span></p><p><span style="color: #3d3d3d;">         2. <strong>CyberArk AIM agent is required for each MID server</strong>. This means that you must have purchased the AIM module and have enough licenses to install them on all the MID servers that require the integration. </span></p><p><span style="color: #3d3d3d;">         3. <strong>MID sever automatically takes care of the rotated password</strong>. Since</span> <span style="color: #3d3d3d;">the AIM agent takes cares of the actual communication to the vault; this also ensures that when the password is rotated in the CyberArk vault, the MID server will always get the updated password since it never caches the password it gets from CyberArk. </span></p><p></p><p>That's pretty much what I can think of at the moment, please feel free to comment or post questions. One thing I do want to mention is that SNMPv3 credential will not work with CyberArk. This isn't on us (ServiceNow); we absolutely support SNMPv3 credentials. This is due to CyberArk doesn't have support for SNMPv3 credential type. We're hoping this will change in the future so we can provide the proper support. </p><p></p><p>Lastly, if you're interested in creating your own external storage credential integration to other vault/keystores, my great colleague <a __default_attr="3071" __jive_macro_name="user" _jive_internal="true" class="jive_macro jive_macro_user" data-orig-content="Anders Henriksson" data-renderedposition="1786.178955078125_819.8295288085938_136_16" href="/community?id=community_user_profile&user=44ae422ddbd41fc09c9ffb651f961957" modifiedtitle="true" title="Anders Henriksson">Anders Henriksson</a> recently wrote about his experience in <a title="How to implement Thycotic Secret Server as an External Credential Store" __default_attr="5822" __jive_macro_name="blogpost" class="jive_macro jive_macro_blogpost" data-orig-content="How to implement Thycotic Secret Server as an External Credential Store" data-renderedposition="1807.0880126953125_195.9658966064453_476_16" href="/community?id=community_blog&sys_id=de6dea29dbd0dbc01dcaf3231f9619e3">How to implement Thycotic Secret Server as an External Credential Store</a>. Check it out!</p></div>