---
title: "A beginners guide to discovering SNMP devices"
date: 2016-08-18T03:09:43.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=eead26a9dbd0dbc01dcaf3231f9619a7"
---
<p>An SNMP device is a device that is managed using the Simple Network Management Protocol (SNMP). This includes routers, switches, printers, PDUs, UPSs, Netware servers, load balancers and various other network-enabled devices. Discovery uses an <a title="n.wikipedia.org/wiki/Simple_Network_Management_Protocol" href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol">SNMP</a><a title="n.wikipedia.org/wiki/Simple_Network_Management_Protocol" href="https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol"> scan</a> to get device-specific MIBs and OIDs.</p><p></p><p>To ensure proper discovery of an SNMP device, there are three essential prerequisites:</p><p></p><table border="1"><tbody><tr><td><h4>Access</h4></td><td><p>The platform also requires the ability to make port 161 SNMP requests from the MID Server to the target. If Access Control Lists (ACLs) are in place (on the target) to control the IP addresses that can make these queries, ensure that the IP address of the MID Server is in the ACL. ServiceNow Discovery supports SNMP versions 1 and 2c.</p></td></tr><tr><td><h4>SNMP Version</h4></td><td><p>ServiceNow Discovery supports SNMP versions 1, 2c, and 3. Discovery uses version 1 and 2c by default. You must enable support for version 3. MID Servers support all SNMP protocol versions by default. You can set a MID Server to only support specific versions of SNMP. So, make sure you are using the correct SNMP version.</p></td></tr><tr><td><h4>Credentials (SNMP community credentials)</h4></td><td><p>Many devices by default have a community string of "public" which Discovery uses when querying a target. Define additional community strings in the Credentials module which are tried in succession, along with public, until a successful query returns, in addition to the credentials. For how to define those strings see <a href="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/reference/r_SNMPCommunityCredentialsForm.html" style="line-height: 1.5;" title="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/reference/r_SNMPCommunityCredentialsForm.html">SNMP community credentials</a><span style="line-height: 1.5;"> <span style="color: #e23d39;"><br/></span></span></p></td></tr></tbody></table><p></p><h4>How an SNMP Device is discovered in the base system</h4><ol><li>Shazzam runs and the SNMP port 161 is open</li><li>The 'SNMP - Classify' probe is triggered as configured under <strong>Discovery Definition &gt; <a title="ocs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/reference/r_PortProbes.html" href="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/reference/r_PortProbes.html">Port Probes </a></strong></li><li>The 'SNMP - Classify' triggers the 'SNMP - Classify' sensor as configured in the 'SNMP - Classify' probe definition under Discovery Definition &gt; Probes &gt; SNMP - Classify.</li><li>The 'SNMP - Classify' sensor will try to determine "classify" what type of SNMP device is this, using industry standards. For example, a device can be classified as printer if one of the SnmpObjectId of the hrDeviceEntry ends with .5 which is the ID value for <a title="w.oid-info.com/get/1.3.6.1.2.1.25.3.1.5" href="http://www.oid-info.com/get/1.3.6.1.2.1.25.3.1.5">printers</a> , as seen at line 3 in the following input payload of the 'SNMP - Classify' probe:<pre __default_attr="xml" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14710239131104505 jive_text_macro" data-renderedposition="466.1875_38_1162_112" jivemacro_uid="_14710239131104505"><pre class="_jivemacro_uid_1470967767594586 jive_macro_code jive_text_macro" data-renderedposition="466.1875_97_1103_112"><p>&lt;hrDevice oid="1.3.6.1.2.1.25.3"&gt;</p><p>&lt;hrDeviceEntry instance=".1"&gt;</p><p><span style="text-decoration: underline;">&lt;hrDeviceType type="SnmpObjectId"&gt;.1.3.6.1.2.1.25.3.1.5&lt;/hrDeviceType&gt;</span></p><p>&lt;hrDeviceDescr type="SnmpOctetString"&gt;</p><p>FUJI XEROX ApeosPort-V C3374 v 40. 73. 0 Multifunction System</p><p>&lt;/hrDeviceDescr&gt;</p><p>&lt;/hrDeviceEntry&gt;</p></pre></pre><p>Or the prtGeneralEntry's prtGeneralSerialNumber has a value, as seen at line 4 in the following input payload of the 'SNMP - Classify' probe:</p><pre __default_attr="xml" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14710239204313667 jive_text_macro" data-renderedposition="599.1875_38_1162_112" jivemacro_uid="_14710239204313667"><pre class="jive_macro_code _jivemacro_uid_14709681397889325 jive_text_macro" data-renderedposition="599.1875_97_1103_112"><p>&lt;printmib oid="1.3.6.1.2.1.43"&gt;</p><p>&lt;prtGeneral oid="1.3.6.1.2.1.43.5"&gt;</p><p>&lt;prtGeneralEntry instance=".1"&gt;</p><p>&lt;prtGeneralSerialNumber type="SnmpOctetString"&gt;TC100985512273&lt;/prtGeneralSerialNumber&gt;</p><p>&lt;/prtGeneralEntry&gt;</p><p>&lt;/prtGeneral&gt;</p><p>&lt;/printmib&gt;</p></pre></pre><pre __default_attr="info" __jive_macro_name="alert" alert="info" class="jive_text_macro jive_macro_alert" data-renderedposition="725.1875_38_1162_43"><p>Note: you can review the code with the logic behind this in the 'SNMP - Classify' sensor's code in your instance.</p></pre></li><li>The 'SNMP - Classify' sensor will set the capabilities of the SNMP device accordingly and additional identification and exploration probes will be launched against the SNMP device as per the SNMP Classification of which the <span style="color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13px;">Classification Criteria is met. </span> (Hint: sometimes you may need to change the order of the SNMP classifiers to ensure the correct SNMP classifier is launched first)</li></ol><p></p><h2>Common issues with SNMP devices discovery</h2><p>Sometimes, it is inevitable to run into issues when discovering an SNMP device for a number of reasons, here are the most common ones along with some tips to fix them:</p><ul><li>Conflicting open ports</li><li>Failing to classify a device</li><li>Missing information</li></ul><p></p><h4>Conflicting open ports</h4><p>There are ports other than the default SNMP port 161 open on a device, such as the default SSH port 22, are required to be open on an SNMP device for management, this can cause classification issues. You will need to create a new discovery schedule with SNMP only behavior. A <a title="ocs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/concept/c_DiscoveryBehaviors.html?cshalt=yes" href="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/concept/c_DiscoveryBehaviors.html?cshalt=yes">Discovery Behavior</a> determines what probes Shazzam launches and from which MID Servers these probes are launched. As an alternative to specifying a single MID server, a Behavior can assign different tasks to multiple MID Servers on the same IP address segment or on different network segments.</p><p></p><h4>Failing to classify a device</h4><p>The 'SNMP - Classify' sensor failed to classify the device, for various reasons the out of box 'SNMP - Classify' sensor might not be able to classify the SNMP device. In that case, you can manually add the sysObjectID's SnmpObjectId to the SNMP OID Classifications [discovery_snmp_oid] table by navigating to <strong>Discovery Definition &gt; CI Classification &gt; <span class="s1">SNMP System OIDs</span>.</strong></p><p></p><p>Example from our network printer:</p><p><img   alt="snmp classification.jpg" class="image-1 jive-image" src="39aa1c42dbd89fc03eb27a9e0f961996.iix" style="width: 620px; height: 93px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p>Note that the OID used is the sysObjectID's SnmpObjectId as seen at line 7 in the following input payload of the 'SNMP - Classify' probe:</p><pre __default_attr="xml" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14710244133379919 jive_text_macro" data-renderedposition="1427.171875_8_1192_128" jivemacro_uid="_14710244133379919"><pre class="jive_macro_code _jivemacro_uid_14709762481238210 jive_text_macro" data-renderedposition="1427.171875_67_1133_128"><p><span style="font-size: 12pt;">&lt;system oid="1.3.6.1.2.1.1"&gt;</span></p><p><span style="font-size: 12pt;">&lt;sysName oid="1.3.6.1.2.1.1.5" type="SnmpOctetString"&gt;Service Now Scanner&lt;/sysName&gt;</span></p><p><span style="font-size: 12pt;">&lt;sysUpTime oid="1.3.6.1.2.1.1.3" type="SnmpTimeTicks"&gt;17469300&lt;/sysUpTime&gt;</span></p><p><span style="font-size: 12pt;">&lt;sysDescr oid="1.3.6.1.2.1.1.1" type="SnmpOctetString"&gt;</span></p><p><span style="font-size: 12pt;">FUJI XEROX ApeosPort-V C3374;ESS1.1.2,IOT 40.73.0,ADF 12.8.0,FAX 1.1.14,PANEL 10.16.4,IPS 13.10.0,BOOT 1.0.34,SJFI3.7.0,SSMI1.25.0,CNTS 2.0.3,Plugin 1.0.1</span></p><p><span style="font-size: 12pt;">&lt;/sysDescr&gt;</span></p><p><span style="font-size: 12pt;">&lt;sysObjectID oid="1.3.6.1.2.1.1.2" type="SnmpObjectId"&gt;.1.3.6.1.4.1.297.1.11.93.1.35.31.3.1&lt;/sysObjectID&gt;</span></p><p><span style="font-size: 12pt;">&lt;/system&gt;</span></p></pre></pre><p>You can also use this method to:</p><ol><li>Manually set the Manufacturer and Model of the SNMP device.</li><li>Select which CMDB table you want the SNMP device to be stored in.</li><li>Select an existing classifier or a custom classifier to classify that device.</li></ol><p></p><h4>Missing information from the base system probes</h4><p>If the information you are looking for isn't extracted using the base system probes you will probably need to Import the SNMP's device manufacturer's MIB module, (please see <a href="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/reference/r_SNMPProbeMIBModules.html" title="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/reference/r_SNMPProbeMIBModules.html">SNMP probe MIB modules</a> for details). Don't forget to restart the MID Server agent as MIBs are only loaded during MID Server startup. It might be a good idea to also monitor the MID Server's agent log for MIB loading errors.</p><p></p><p>When you import manufacturer's MIB modules the extra information you are looking for won't be readily available, you will also need to create a custom classifiers, probes and sensors to extract that information and put it in the right place. SNMP probe uses the SNMP protocol to query a particular device for a list of OIDs, which are then traversed and the results passed back to the sensor for further processing. (Please see <a href="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/concept/c_SNMPProbe.html" title="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/concept/c_SNMPProbe.html">SNMP probe</a> for details)</p><p></p><table border="1"><tbody><tr><td><h1>FAQ about discovering SNMP devices</h1><h4>Do we need to keep MIBs updated?</h4><p>There are two MIB modules that the MID Server loads when it starts up:</p><ul><li>Modules that are bundled with the MID Server software. These MIBs are defined industry standards. (There is no need to update these as they are industry standards)</li><li>Modules that are included in each instance. These MIBs are provided by manufacturers for Discovery to extract specific information from a device. These MIB modules are occasionally updated to add new functionality, remove ambiguities and to fix defects. (You need to keep these updated so the MID Server is able to discover SNMP devices that they describe).</li></ul><p></p><h4>How we understand that there is requirement to install new MIBs</h4><p>When discovery of the SNMP devices that are described by those MIBs fails or is missing information that you are expecting about the SNMP device being discovered.</p><p></p><h4>How can we install latest MIBs? where we get latest MIB files</h4><p>To install the latest MIBs, kindly follow the steps outlined in the following wiki article: <a href="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/reference/r_SNMPProbeParameters.html" title="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/reference/r_SNMPProbeParameters.html">SNMP probe parameters</a>   <span style="color: #eb7a3d;"><br/></span></p><p>Normally, you can get the latest MIBs from the manufacturer's website, for example visit <a title="w.juniper.net/techpubs/en_US/junos-space15.1/topics/task/operational/junos-space-servicenow-mibs.html" href="http://www.juniper.net/techpubs/en_US/junos-space15.1/topics/task/operational/junos-space-servicenow-mibs.html">Juniper</a>. Additionally, if you believe that an existing MIB module needs to be updated, you can check the source field of the particular MIB module in ServiceNow by navigating to <strong>MID Server &gt; SNMP</strong> MIBs.</p><p></p><h4>Where can i find information on the latest MIB downloads?</h4><p>You can refer to the following wiki article for more information about MIB Modules: <a href="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/reference/r_SNMPProbeMIBModules.html" title="https://docs.servicenow.com/bundle/helsinki-it-operations-management/page/product/discovery/reference/r_SNMPProbeMIBModules.html">SNMP probe MIB modules.</a><span style="color: #7ed529;"> </span>There is no one link that provides information about the latest MIB downloads as MIBs belong to different manufacturers.</p></td></tr></tbody></table><p></p><p>SNMP discovery can seem overwhelming at first especially if you're not an SNMP expert, but once the logic behind it is demystified you will find it very useful. I hope this blog adds a little bit more information to this not-so-much documented subject.</p><p></p><p>Cheers,</p><p>Omar.</p>