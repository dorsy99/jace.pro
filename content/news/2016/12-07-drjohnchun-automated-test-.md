---
title: "Automated Test Framework Part  Form Submit"
date: 2016-12-07T02:52:07.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=fd9c2ee1dbd0dbc01dcaf3231f9619d7"
---
<p><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=00ecaa65dbd0dbc01dcaf3231f961970">Last time</a>, we ran a simple read-only demo test named "Verify That Form Defaults Are As Expected" that had only three test steps. This time, we'll continue running more demo tests and see how the Automated Test Framework (ATF) works.</p><p></p><p><img __jive_macro_name="toc" class="jive_macro_toc jive_macro" data-renderedposition="71_8_61_72" src="/8.0.4.21bdc7e/images/tiny_mce3/plugins/jiveemoticons/images/spacer.gif"/></p><h3>FORM SUBMISSION</h3><p></p><p>After logging in with the <span style="font-family: arial, sans-serif; color: #666666;"><strong>atf_test_designer</strong></span> role (not impersonating since the test runs impersonating another user) using Internet Explorer 11, I chose to run the simplest write test among the demo tests called "<strong>Basic UI Test</strong>". This test has only four steps, opening a new '<strong>Catalog Task</strong>' form, set some fields, and submit. Below is the screenshot of the test:</p><p></p><p><img   class="image-1 jive-image" src="df24a882dbdc5304b322f4621f9619d0.iix" style="border: 1px solid #ccc; max-width: 1200px; max-height: 900px;"/></p><p></p><h3>TEST EXECUTION</h3><p></p><p>I clicked <strong>Run Test</strong> and switched over to the <strong>Client Test Runner</strong> window (labeled as <strong>UI Test Runner</strong> in the window header) to watch the test in action as shown below. The three field values set are highlighted in red rectangles:</p><p></p><p><img   class="image-5 jive-image" src="ac456102db5cd304b322f4621f96193a.iix" style="border: 1px solid #ccc; max-width: 1200px; max-height: 900px;"/></p><p></p><p>When the test was completed, the status dialog box was updated indicating successful completion as below:</p><p></p><p><img   class="image-6 jive-image" src="a8fe7c86dbd497041dcaf3231f961924.iix" style="border: 1px solid #ccc; max-width: 1200px; max-height: 900px;"/></p><p></p><h3>TEST RESULTS</h3><p></p><p>When clicked on <strong>Go to Result</strong>, the results were shown as below:</p><p></p><p><img   class="jive-image image-4" src="27f2048edbd41304b322f4621f9619ec.iix" style="border: 1px solid #ccc; max-width: 1200px; max-height: 900px;"/></p><p></p><p>In the <strong>Step Results</strong> tab, all four steps showed <strong>Success</strong> with summary output for each step. In the <strong>Test Log</strong> tab, it showed more detailed output with 92 entries.</p><p></p><h3>SCREENSHOTS</h3><p></p><p>The results included three screenshots attached:</p><p></p><ol><li>When the form first opened<br/><img   class="image-7 jive-image" src="70da14cadbd89fc068c1fb651f9619f0.iix" style="border: 1px solid #ccc; max-width: 1200px; max-height: 900px;"/></li><li>After the field values were set<br/><img   class="jive-image image-8" src="2c7a7ff9db14d3041dcaf3231f9619a5.iix" style="border: 1px solid #ccc; max-width: 1200px; max-height: 900px;"/></li><li>After the form was submitted<br/><img   class="image-9 jive-image" src="c35a6dcadb5053043eb27a9e0f9619fd.iix" style="border: 1px solid #ccc; max-width: 1200px; max-height: 900px;"/></li></ol><p>This time, I'm not only seeing the form header obscuring the top portion of the form and some missing elements (buttons and icons) from the header, but also the third screenshot taken after the submission is malformed, with the misaligned field labels; you can compare this with an earlier screenshot from the <strong>Client Test Runner</strong> window above. As I noted in <a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=00ecaa65dbd0dbc01dcaf3231f961970">Part 1</a>, I believe this is a side effect of screenshots not being taken directly from the screen. Screenshots provide <strong>objective evidence</strong> for test results, thus the fidelity is an important prerequisite for regulated testing. I hope the ServiceNow team can address this issue.</p><p></p><h3>MISSING TEST RECORD, BY DESIGN</h3><p></p><p>Next, I impersonated "<strong>ATF User</strong>" and looked for the <strong>Service Catalog Task [sc_task]</strong> record <strong>SCTASK0010004</strong> that had just been created and assigned to "<strong>ATF User</strong>". I navigated to <strong>Service Desk &gt; My Work</strong>, but couldn't find it. I removed the filter to see all tasks for everyone, but still couldn't find it. I tried the same by navigating to <strong>Service Catalog &gt; Open Records &gt; Tasks</strong>, but no luck, even after removing the filter conditions. Then I logged in with the <strong>admin</strong> role and looked inside <strong>Sys Audits [sys_audit]</strong> and <strong>Audit Deleted Records [sys_audit_delete]</strong> but no trace. I then ran this <strong>Background Script</strong>:</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14810534130507018 jive_text_macro" data-renderedposition="6344.1875_8_1092_96" jivemacro_uid="_14810534130507018"><p>var gr = GlideRecord('sc_task');</p><p>gr.query();</p><p>while (gr.next()) gs.info(gr.number);</p><p></p><p>var gr = GlideRecord('task');</p><p>if (gr.get('number', 'SCTASK0010004')) gs.info(gr.number);</p></pre><p></p><p>but still no luck. The only trace of it was that the <strong>Number Counter</strong> for <strong>SCTASK</strong> was showing the next number as 10,005.</p><p></p><p>ATF provides data cleanup via <strong>Automated Test Framework &gt; Administration &gt; Table Cleanup</strong>. But it only applied to the <strong>Test Results [sys_atf_test_result]</strong> table and it was set to run after 2,592,000 seconds (30 days) since <strong>sys_created_on</strong>, so this would have nothing to do with the missing <strong>Service Catalog Task [sc_task]</strong> record.</p><p></p><p>I also inspected the test steps, especially the final step of "<strong>Submit a Form</strong>" and its <strong>Step Configuration</strong> under <strong>Administration</strong> to see if anything would delete the test record, but didn't see anything obvious. Looking through other settings under <strong>Administration</strong> didn't yield a clue either.</p><p></p><p>The ATF wiki <a href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/auto-test-framework/concept/atf-overview.html" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/auto-test-framework/concept/atf-overview.html">Automated Test Framework</a> does mention</p><pre __jive_macro_name="quote" class="jive_macro_quote jive_text_macro" data-renderedposition="6660.1875_8_1092_41"><p>The test framework automatically tracks and deletes any data created by running tests, automatically taking care of rolling back changes after testing.</p></pre><p>So I believe this feature must've deleted the record without a trace and I confirmed it. I do think it's a nice feature, but I can foresee cases where you want to inspect your test results, especially if tests fail, and also possibly take additional screenshots. It would be nice to give the user an option to delete test data later. I also like creating a large number of tickets for load testing, for which an automated tool is ideal (web services would be faster at creating a large number of records but they're not the same as UI tests). I didn't check it, but my thinking is this auto deletion feature would also take care of cascading deletes.</p><p></p><p>Further review revealed some log entries for rollback in <strong>Rollback Logs [sys_rollback_log]</strong> as shown below:</p><p></p><p><img   class="jive-image image-10" src="ee750902db5497049c9ffb651f96192c.iix" style="border: 1px solid #ccc; max-width: 1200px; max-height: 900px;"/></p><p></p><p><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=942de2e5dbd0dbc01dcaf3231f961987">Next time</a>, I'd like to take a look under the hood to see how ATF works.</p><p></p><h3>UPDATES</h3><p></p><p>2016-12-07 added rollback log and screenshot</p><p></p><p><em>Please feel free to connect, follow, post feedback / questions / comments, share, like, bookmark, endorse.</em></p><table><tbody><tr><td style="width: 172px;">John Chun, <span style="font-size: 8pt;">PhD PMP</span> <a href="http://linkedin.com/in/DrJohnChun"><img alt="see John's LinkedIn profile" class="image-2 jive-image" src="http://megaicons.net/static/img/icons_sizes/182/456/16/linkedin-icon.png" style="height: auto; vertical-align: -13px;" title="see John's LinkedIn profile"/></a><p><a href="http://snowaid.com/"><img alt="visit snowaid" class="image-1 jive-image" src="http://snowaid.com/images/signature.png" style="height: auto; margin-top: -9px;" title="visit snowaid"/></a></p></td><td><a _jive_internal="true" href="/people/drjohnchun/content"><img alt="ServiceNow Advocate" class="image-3 jive-image" src="http://snowaid.com/images/sn_advocate_135x48.png" style="margin-top: -3px;"/></a></td></tr></tbody></table><p><span style="font-size: 10pt;"><a title="" _jive_internal="true" href="/community?id=community_forum&sys_id=76299a2ddbd897c068c1fb651f96196a">Winner of November 2016 Members' Choice Award</a></span></p>