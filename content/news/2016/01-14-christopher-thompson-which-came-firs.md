---
title: "Which came first the Request or the Requested Item"
date: 2016-01-14T00:58:02.000Z
authors: ["christopher.thompson"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=735c6aa1dbd0dbc01dcaf3231f9619e1"
---
<p>When ordering an Item through our default <a title="ki.servicenow.com/index.php?title=Introduction_to_Service_Catalog" href="http://wiki.servicenow.com/index.php?title=Introduction_to_Service_Catalog">Service Catalog</a> process, you will see 2 different types of records get created.</p><ol><li>One "Request" record.</li><li>One or more "Requested Item" records (depending on how many Items you place in the order).</li></ol><p></p><p>Now, as you may want to modify the process and what data gets put into these records, it may be helpful to know which of these records actually gets created and processed first. For example, let's say you wanted to take a value from a Requested Item record and copy it to the work notes of your Request record? When and how would you do this?</p><p></p><p>Most likely, the logical answer would be to create a Business Rule when the Requested Item is created or updated to do a GlideRecord query for the parent Request it is tied to and then just copy the information over. But, what if the Request record has not yet been created when this Requested Item is created or when your Business Rule is ran?</p><p></p><p>Since most of the code that actually does this Catalog Checkout process is in our backend code, there is not much we can really look at code-wise to see what all is occurring. However, if you are an admin on your instance, you can do some <a title="ki.servicenow.com/index.php?title=Debugging_Tools_Best_Practices#Server-Side_Debugging" href="http://wiki.servicenow.com/index.php?title=Debugging_Tools_Best_Practices#Server-Side_Debugging">Server-Side debugging</a> which can help get you a picture of what happens once you order an item.</p><p></p><p>Below I will go through a very general process of what occurs when ordering a Catalog Item based on our default setup. I will run through some of the steps involved, including some of the Business Rules that control this behavior as well the role that Workflows and Execution Plans play in as well.</p><p></p><p></p><table border="1"><tbody><tr><td><p>First, once you click the "Order Now" or "Checkout" button for your order (depending on if you are using the one-step or two-step checkout), what you will see from the debugging is that the "Requested Item" records will start to get created first.</p><p></p><p>For example.</p><p></p><p class="debug_line debug_br" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #eeeeee; color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;"><span style="color: #00008b;">11:23:35.2: Execute before insert business rules on sc_req_item:RITM0010005 before engines (order &lt;1000)</span></p><p class="debug_line debug_br global" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #eeeeee; color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;"><span style="color: #00008b;">11:23:35.3: Global ==&gt; '<a title="emonightlygeneva.service-now.com/sys_script.do?sys_id=9782b8dac0a80a6d75bf2167f4ec8bc6" href="https://demonightlygeneva.service-now.com/sys_script.do?sys_id=9782b8dac0a80a6d75bf2167f4ec8bc6" style="color: #278efc; background: transparent;">Task Active State Management</a>' on sc_req_item:RITM0010005</span></p><p class="debug_line debug_br global" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #eeeeee; color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;"><span style="color: #00008b;">11:23:35.3: Global &lt;== '<a title="emonightlygeneva.service-now.com/sys_script.do?sys_id=9782b8dac0a80a6d75bf2167f4ec8bc6" href="https://demonightlygeneva.service-now.com/sys_script.do?sys_id=9782b8dac0a80a6d75bf2167f4ec8bc6" style="color: #278efc; background: transparent;">Task Active State Management</a>' on sc_req_item:RITM0010005</span></p><p></p><p>As the RITM is being created, if this Item is using a Workflow (based on the Catalog Item record), we don't link a workflow to this Requested Item yet (I will explain on this later). If you are using an Execution Plan, you will see the Tasks for the Execution Plan get created, but they will all be in a "Pending" state at first.</p><p></p><p>Next, once the Requested Items are all created, then we being creating the Request record.</p><p></p><p class="debug_line debug_br" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #eeeeee; color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;"><span style="color: #00008b;">11:23:35.220: Execute before insert business rules on sc_request:REQ0010005 before engines (order &lt;1000)</span></p><p class="debug_line debug_br global" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #eeeeee; color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;"><span style="color: #00008b;">11:23:35.220: Global ==&gt; '<a title="emonightlygeneva.service-now.com/sys_script.do?sys_id=9782b8dac0a80a6d75bf2167f4ec8bc6" href="https://demonightlygeneva.service-now.com/sys_script.do?sys_id=9782b8dac0a80a6d75bf2167f4ec8bc6" style="color: #278efc; background: transparent;">Task Active State Management</a>' on sc_request:REQ0010005</span></p><p class="debug_line debug_br global" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #eeeeee; color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;"><span style="color: #00008b;">11:23:35.221: Global &lt;== '<a title="emonightlygeneva.service-now.com/sys_script.do?sys_id=9782b8dac0a80a6d75bf2167f4ec8bc6" href="https://demonightlygeneva.service-now.com/sys_script.do?sys_id=9782b8dac0a80a6d75bf2167f4ec8bc6" style="color: #278efc; background: transparent;">Task Active State Management</a>' on sc_request:REQ0010005</span></p><p></p><p>During the process of creating this REQ record in the "Before" Business Rule phase, our Workflow engine will link a workflow (if existing) to this Request record and start running this workflow. This is different behavior than what occurs for the RITM records, but actually this behavior here is what you would expect for most tables when having a workflow linked to them (Incident, Change Request, etc.).</p><p></p><p>Below is an example of what a Request Workflow may look like.</p><p></p><p><img   alt="WF1.JPG" class="image-1 jive-image" height="264" src="de5eac0edb5c57041dcaf3231f961984.iix" style="height: 264px; width: 772.075471698113px;" width="772"/></p><p>Now, as the workflow runs for the REQ record, there may be some activity or activities in this workflow (ex. Wait for Condition, Approval, Task, etc.) that causes it to not get completed automatically and not mark the Request as "Approved." If not marked as approved, it will be left for the workflow to reach that activity and run any remaining Business Rules that would be left for this Request. This would pretty much be the end the Checkout process at that time until the Request gets approved.</p><p></p><p>However, in the case where you may have your workflow or a process setup where you just "auto-approve" this REQ record (like in the example above), then the following may occur.</p><p></p><p>If the "approval" field on the Request gets changed to "approved", then this will end up triggering a Business Rule by default called "Cascade Request Approval to Request Item."</p><p></p><p class="debug_line debug_br" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #eeeeee; color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;"><span style="color: #00008b;">11:23:36.154: Execute after insert business rules on sc_request:REQ0010005 after engines (order &gt;=1000)</span></p><p class="debug_line debug_br global" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #eeeeee; color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;"><span style="color: #00008b;">11:23:36.154: Global ==&gt; '<a title="emonightlygeneva.service-now.com/sys_script.do?sys_id=2d0885b4c61122840070856bf5994bca" href="https://demonightlygeneva.service-now.com/sys_script.do?sys_id=2d0885b4c61122840070856bf5994bca" style="color: #278efc; background: transparent;">Cascade Request Approval to Request Item</a>' on sc_request:REQ0010005</span></p><p class="debug_line debug_br" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #eeeeee; color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;"><span style="color: #00008b;">11:23:36.176: Execute before update business rules on sc_req_item:RITM0010005 before engines (order &lt;1000)</span></p><p></p><p>Now, depending on whether you are using a Workflow or Delivery/Execution Plan, the following will happen.</p><p></p><ul><li>Delivery Plan<ul><li>You will call this "getNextStage" function also within this Business Rule that will essentially start the first "Task" that was setup for each of your RITM records.</li></ul></li><li>Workflow<ul><li>This will mark each RITM record with these values below<ul><li>approval = "requested";</li><li>stage = "request_approved";</li></ul></li></ul></li></ul><p></p><p>If you are using a Delivery Plan, this is basically the end of this process, as the first task you have will get changed to an "Open" state, and then you would just proceed with working on those tasks as needed. However, if using a workflow, then once those values are set as mentioned above, another Business Rule will get called upon during the update of the RITM with those previously mentioned values called "Start Workflow".</p><p></p><p><span style="font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px; color: #00008b;">11:23:26.241: Execute before update business rules on sc_req_item:RITM0010005 after engines (order &gt;=1000)</span></p><p><span style="font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px; color: #00008b;">.....</span></p><p class="debug_line debug_br global" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #eeeeee; color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;"><span style="color: #00008b;"><span style="color: #00008b; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;">11:23:36.244</span>: Global       ==&gt; '<a title="emonightlygeneva.service-now.com/sys_script.do?sys_id=700cb3c9ac14657b005f7aaef70e1fc8" href="https://demonightlygeneva.service-now.com/sys_script.do?sys_id=700cb3c9ac14657b005f7aaef70e1fc8" style="color: #278efc; background-position: initial;">Start Workflow</a>' on sc_req_item:RITM0010005</span></p><p class="debug_line debug_br" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #eeeeee; color: #343d47; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;"><span style="color: #00008b;"><span style="color: #00008b; font-family: SourceSansPro, 'Helvetica Neue', Arial; font-size: 13.3333330154419px;">11:23:36.307</span>: Execute before insert business rules on wf_context:Procurement Process Flow - Mobile before engines (order &lt;1000)</span></p><p></p><p>In this Business Rule, we look up the "cat_item" value from the Requested Item record and find the workflow version linked to that Catalog Item, then we start a new workflow context from this version.</p><p>So, it is at this time that we then start to run the Requested Item's workflow to run the necessary activities.</p><p></p><p>Here is an example Requested Item Workflow and how it may look after ordering the item.</p><p></p><p><img   alt="WF2.JPG" class="image-2 jive-image" height="350" src="a1fe4086db105304b322f4621f961907.iix" style="height: 350px; width: 972.607260726073px;" width="973"/></p><p>Based on this example, the RITM workflow was able to run to this "Wait for condition" activity, and this is where our Checkout process completes at this time.</p></td></tr></tbody></table><p></p><p>Overall, the main takeaways from this article should be the following.</p><p></p><p>a) Requested Item records are created first before the parent Request record.</p><p>b) However, it is the Request record that needs to run its workflow or process to get approved before starting the Workflow or Delivery Plan of the respective RITM records.</p><p>c) If using workflows for your Requested Items, these workflows do not get associated to their records until after the parent Request record has been approved and the Business Rules that were mentioned have been ran.</p><p></p><p>I hope this information is helpful once you start customizing your Service Catalog process to know when to run certain Business Rules and how to configure your workflows accordingly.</p>