---
title: "Secure your data and perfect performance"
date: 2016-09-02T04:09:34.000Z
authors: ["iris.geist"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=f2cda2e9dbd0dbc01dcaf3231f96190d"
---
<p>We care deeply about keeping our data secure. Ensuring that you can only see what you are supposed to see, keeps us and your organization happy. The general perception about security and data is that the more secure you make your data, the slower your system will be. It's like having to choose to have your cake or eat it, when all you want to do is have it AND eat it.</p><p></p><h3>There are three general ways of limiting access to data:</h3><p>(In order of their potential database performance impact from lowest to highest)</p><ol><li>Limiting the applications and modules a user sees in their navigator</li><li>Limiting access through ACLs (Access Control Lists)</li><li>Limiting access through appending WHERE clauses to queries<ol><li>Two technologies use that method:<ul><li>Domain Separation (typically not a large impact, since the domain separator field is usually indexed)</li><li>Before query business rules</li></ul></li></ol></li></ol><p>Continue reading to see when you will use which one of these methods, and what their impact on your system's performance can be.</p><p></p><h2>Limit viewable applications and modules in the Navigator</h2><p>Application and module access is limited through assigning specific roles to these items that are not generally available, for example, the System Definition application modules are typically only available for administrators. For more information on administering applications and modules in Geneva, check out <a href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/administer/navigation_and_ui/task/t_EnDisableAppMenuOrMod.html" title="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/administer/navigation_and_ui/task/t_EnDisableAppMenuOrMod.html">Enable or disable </a></p><p><img   alt="module navigator.png" class="image-1 jive-image" height="415" src="f598733ddbd0d3049c9ffb651f961976.iix" style="width: 204px; height: 415.285714285714px; float: right;" width="204"/></p><p><a href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/administer/navigation_and_ui/task/t_EnDisableAppMenuOrMod.html" title="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/administer/navigation_and_ui/task/t_EnDisableAppMenuOrMod.html">an application menu or module</a> and <a href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/administer/navigation_and_ui/task/t_EnDisableAppMenuOrMod.html" style="text-decoration: underline;" title="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/administer/navigation_and_ui/task/t_EnDisableAppMenuOrMod.html">for the same on Fuji</a> or older, see Â  <a href="https://www.google.com/url?q=http://wiki.servicenow.com/index.php%3Ftitle%3DAdministering_Application_Menus_and_Modules&amp;sa=U&amp;ved=0ahUKEwiPmaPekKvOAhUBx2MKHccjDmIQFggFMAA&amp;client=internal-uds-cse&amp;usg=AFQjCNGqVd_BkhrWiU4FdGZOl4taHFcxMg" title="https://www.google.com/url?q=http://wiki.servicenow.com/index.php%3Ftitle%3DAdministering_Application_Menus_and_Modules&amp;sa=U&amp;ved=0ahUKEwiPmaPekKvOAhUBx2MKHccjDmIQFggFMAA&amp;client=internal-uds-cse&amp;usg=AFQjCNGqVd_BkhrWiU4FdGZOl4taHFcxMg">Administering Application Menus and Modules</a>. This is the fastest and easiest way to limit access, but it is also the<strong> least secure</strong>. Were it not for additional security methods such as ACLs, users who know the table names of the underlying tables could still access the data behind the modules hidden from their navigator.</p><p></p><p>Limiting the applications and modules in the navigator should be seen as a usability tool (a self-service user would be overwhelmed if they would see an administrator's option) rather than a security tool, but it also provides our first level of security by making access to unauthorized items harder to attain.</p><p></p><h2>Limit access through ACLs</h2><p>ACL stands for Access Control List. ACLs define access for records, UI pages, client callable scripts, and processors within ServiceNow. Against each one of these items, certain operations are available, such as create, read, write, delete on record level, or execute on a client callable script. ACLs define who can, under which circumstances, perform these operations against these items.</p><p></p><p>ACLs work after the records were retrieved from the database, so they usually do not add additional load on the database performance. There are three ways ACLs can limit access to operations:</p><ol><li>Conditions</li><li>Roles</li><li>Scripts</li></ol><p></p><h3>Conditions vs. Roles vs. Scripts</h3><p>Conditional and role ACLs have minimal impact on system performance. Scripted ACLs can get rather complex including programming involving loops and database queries. We sometimes find those scripts to be responsible for performance issues, and recommend to keep ACL scripts as simple as possible. Since ACLs are checked on every record, if an inefficient script is used, the performance impact is significant.</p><p></p><h3>Loops and queries causing performance issues</h3><p>If using for or while loop constructs in your code, ensure that the loop will stop at the earliest possible point. If using database queries, ensure that these queries are well indexed. See <a __default_attr="4715" __jive_macro_name="blogpost" class="jive_macro jive_macro_blogpost" data-orig-content="What index should it be? - OR - Slow Queries explained " data-renderedposition="934.23291015625_7.997159004211426_372_16" href="/community?id=community_blog&sys_id=8e9c6ee1dbd0dbc01dcaf3231f96197e" modifiedtitle="true" title="What index should it be? - OR - Slow Queries explained ">What index should it be? - OR - Slow Queries explained </a>for detail on how to determine a good index for any slow query.</p><p></p><h2>Limit access through WHERE clauses</h2><p>One side effect of using ACLs to limit access to data is the dreaded "Security constraints prevent access to requested page" or "Number of rows removed from this list by Security constraints:...". Especially the latter message leads to confusion and calls to the help desk. One way of preventing this message is to append a WHERE clause to your query, so that these records the user is not supposed to see are not even returned from the database.</p><p></p><p>We typically do this through "before query" business rules. Our WIKI has an example for such a before query business rule: <a href="http://wiki.servicenow.com/index.php?title=Scripting_in_Business_Rules#An_Example_Script:_A_Default_Before-Query_Business_Rule" title="http://wiki.servicenow.com/index.php?title=Scripting_in_Business_Rules#An_Example_Script:_A_Default_Before-Query_Business_Rule">Scripting in Business Rules - ServiceNow Wiki</a> This example though has one issue to be aware of:</p><table border="1"><tbody><tr><td><p><span class="kw2" style="color: #003366; font-weight: bold;">var</span> u <span class="sy0" style="color: #339933;">=</span> gs.<span class="me1" style="color: #660066;">getUserID</span><span class="br0" style="color: #009900;">(</span><span class="br0" style="color: #009900;">)</span><span class="sy0" style="color: #339933;">;</span></p><p><span class="kw2" style="color: #003366; font-weight: bold;">var</span> qc <span class="sy0" style="color: #339933;">=</span> current.<span class="me1" style="color: #660066;">addQuery</span><span class="br0" style="color: #009900;">(</span><span class="st0" style="color: #3366cc;">"caller_id"</span><span class="sy0" style="color: #339933;">,</span> u<span class="br0" style="color: #009900;">)</span>.<span class="me1" style="color: #660066;">addOrCondition</span><span class="br0" style="color: #009900;">(</span><span class="st0" style="color: #3366cc;">"opened_by"</span><span class="sy0" style="color: #339933;">,</span> u<span class="br0" style="color: #009900;">)</span>.<span class="me1" style="color: #660066;">addOrCondition</span><span class="br0" style="color: #009900;">(</span><span class="st0" style="color: #3366cc;">"watch_list"</span><span class="sy0" style="color: #339933;">,</span> <span class="st0" style="color: #3366cc;">"CONTAINS"</span><span class="sy0" style="color: #339933;">,</span> u<span class="br0" style="color: #009900;">)</span><span class="sy0" style="color: #339933;">;</span></p></td></tr></tbody></table><pre __default_attr="warning" __jive_macro_name="alert" alert="warning" class="jive_text_macro jive_macro_alert" data-renderedposition="1182.6845703125_7.997159004211426_1147_42"><p><span style="font-size: 10pt;"> The "CONTAINS" operator will translate to a LIKE "%xxx%" query on the database, which cannot be indexed. </span></p></pre><p></p><p><span style="font-size: 10pt;">When creating a before query business rule, it is very important to ensure that the resulting query can and will be indexed. Before query business rules are executed every time you search on this table. An inefficient query at this point will be responsible for higher load on your database as well as negatively impacted performance. </span></p><p></p><p><span style="font-size: 10pt;">Before query business rules are not allowed on the sys_app_module and sys_app_application tables in UI16. This is due to steps to make the navigator more efficient. Menus and applications in UI16 can only be limited through roles, not before query business rules.</span></p><p></p><p>As you can tell, each option has its use within ServiceNow to secure your data and to improve the user's experience. Each method is designed to allow for minimal performance impact, but any scripting that does not follow best practices can cause significant performance impact. You can read up on coding best practices here: <a href="http://wiki.servicenow.com/index.php?title=Coding_Best_Practices#gsc.tab=0" title="http://wiki.servicenow.com/index.php?title=Coding_Best_Practices#gsc.tab=0">Coding Best Practices.</a></p>