---
title: "Calculated value a pot of gold at the end of the rainbow or a devil in disguise"
date: 2016-06-23T15:56:13.000Z
authors: ["Göran Lundqvist"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=285e2aaddbd0dbc01dcaf3231f96193e"
---
<p>Just want to clarify that I've edited this post to include the more danger of calculated value and perhaps not being the pot of gold for me and more like a devil in disguise. I even thought that I might delete this post since afterwards other beloved community members pointed out their experience with this and there might be some not so good things about it.But then I came to the conclusion that there isn't so much info about this and I better keep this post to point out the good and bads with it and hopefully some other than me gets the knowledge of it.</p><p></p><p>So... Calculated value. This was something I didn't knew of before, but when I found out what I could do with it, I really start loving it, but it might have been a short term relationship</p><p></p><p>Lets tell the story from the start.</p><p></p><p>It all began when I was looking at a report that was going to tell me the average time of an SLA an it looked something like this:</p><p></p><p><img   class="image-1 jive-image" src="31bb144adb585304b322f4621f961954.iix" style="max-width: 1200px; max-height: 900px;"/></p><p>And I had 2 big problems with this...</p><p></p><ol><li>For example 2 days, 7 hours, 33 min, 20 sec. This doesn't mean 2 working days and 7 hours. This mean 2*24 hours + 7 hours and that is a total of 56 working hours, which is over one working week! *Not a single person I've talked to and showed this report thought it was like that. They all went for the 2 working days..</li><li>Having the average split up like this... "4 days 1 hour 13 min 20 sec" and "2 days 21 hours 26 min 40 sec" etc. It doesn't look good in my eyes at all. And this isn't the worst example of them all.</li></ol><p></p><p></p><p>So after some thinking we decided that we would like to have the same report, but instead of mixing it with days etc, we want it to just show hours. That is much easier to understand and grasp.</p><p></p><p>My first idea was to just put on some makeup on the field "Business elapsed time". So I went to the dictionary override and put in the follow attribute "max-unit=hours".</p><p></p><p><img   class="image-2 jive-image" src="12c873fddbd05fc068c1fb651f961986.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p>And from the start, it was looking good. Now days are gone and it sums up on hours like this:</p><p></p><p><img   class="image-3 jive-image" src="6ef8a502db9cd304b322f4621f9619e0.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p>But sadly, the report acted like it didn't know anything and still showed the report with days..</p><p></p><p>So I ended up with created a own field that I would put the hours in. So I created a decimal field on the task_sla table named "<span class="widget_body"><span>u_business_elapsed_in_hours".</span></span></p><p></p><p><span class="widget_body"><span>Now what is still to come is how to get the correct value in that field. And my first suggestion was a before business rule to calculate the correct value and put it in the field.</span></span></p><p><span class="widget_body"><span>so I made the following script:</span></span></p><p></p><p>var dur = new GlideDuration(current.business_duration.getDurationValue());</p><p>   var millisec = dur.getNumericValue();</p><p>   var hours = millisec/1000/60/60;</p><p>current.u_business_duration_in_hours = hours;</p><p></p><p>But then I was going to fill in this on all the already completed records, so I went into the script - background to test it out and I noticed it took quite a while to do it so I start looking for another way around to make this happening.</p><p></p><p>Then I came across the "calculated value". You reach this by right clicking on the field and choosing "configure dictionary". Then you got a tab called "Calculated value". If you don't see it you need to turn on "Advanced view". Check the box "Calculated" and a magic script editor appears.</p><p></p><p>Now if you take the script above and just adjust it a tiny bit to this:</p><p></p><p>(function calculatedFieldValue(current) {</p><p>   var dur = new GlideDuration(current.business_duration.getDurationValue());</p><p>   var millisec = dur.getNumericValue();</p><p>   var hours = millisec/1000/60/60;</p><p></p><p>   return hours.toFixed(1);   // return the calculated value</p><p></p><p>})(current);</p><p></p><p>And then you press update.</p><p></p><p>Now you don't need a business rule for to make the value and the best part is by doing this, all your already created records with this field is automatically without needed to do any scripting in the Script - background. And it goes fast =)</p><p></p><p>Now for example a report can look like this:</p><p></p><p><img   class="jive-image image-4" src="0f51c102db9013043eb27a9e0f961940.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p>Now I was all happy and thought I found the real pot of gold and a new good way to "calculate fields". But like for example <a title="jim.coyne" __default_attr="2899" __jive_macro_name="user" class="jive_macro jive_macro_user" data-orig-content="jim.coyne" data-renderedposition="2893.390625_780_79_16" href="/community?id=community_user_profile&user=8352da29dbd81fc09c9ffb651f9619c7">jim.coyne</a> in the comments below, this is a potential performance crasher.</p><p></p><p>These are the ways I would do it.</p><p></p><p>1. Using a Business rule to calculate the value when you update the record and by using this it will only be updated when you edit the record, but most often this will be good enough.</p><p>2. Using Calculated value will always calculate the value when the record is queried. Meaning that when you looking at a list with the records, all of the records will update the calculated field value. Now, when your instance is growing this might not be a problem in the beginning, but it can be in the future when your numbers is a lot bigger. Another thing that I came thinking of is that using calculated field might be harder to find in the future when your'e looking at the field. It's easier to find a business rule when looking at the field and trying to find out what is putting the numbers in the field.</p><p></p><p>3. last way would be running a scheduled job to update the fields, but I think I rather go for nr 1.</p><p></p><p></p><p>So rather that says wooo, here is a good new way. I rather say that really not use it and if you do, use it with caution.</p>