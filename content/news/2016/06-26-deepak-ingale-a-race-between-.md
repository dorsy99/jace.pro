---
title: "A Race between UI Policy and Client script"
date: 2016-06-25T18:05:00.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=512d26e5dbd0dbc01dcaf3231f9619ce"
---
<p align="center" style="text-align: center;"><span style="font-size: 24pt; color: #303030;">A Race between UI Policy and Client script</span></p><p></p><p><span style="font-size: 12pt;">I happened to work on one issue in past for debugging UI Policies and client scripts.</span></p><p></p><p><span style="font-size: 12pt;"><strong>Issue was something like: </strong> </span></p><p></p><p><span style="font-size: 12pt;">For one particular state, UI Policy was suppose to set some fields as Mandatory and it was not happening. This was happening when form was loading. </span></p><p><span style="font-size: 12pt;">I checked other UI policies as well which were of   higher order than the one which was not working as expected.   But I   could not find anything. </span></p><p></p><p><span style="font-size: 12pt;">I was under the perception that client scripts always run first and then the UI Policies. But, I figured out one exception to this case which is being documented in this blog.</span></p><p></p><p><span style="font-size: 12pt;">So let us start off with some test cases which I had built for this experiment. I have used multiple client scripts and UI Policies for this testing and used one global scratchpad variable to keep track of when particular script gets fired.</span></p><p></p><p><span style="font-size: 12pt;">Steps :</span></p><p></p><p><span style="font-size: 12pt;">1) Configure onLoad client script , you can use any table, In my experiment, I have used "Database Instance"</span></p><p></p><p><span style="font-size: 12pt;"><img   class="image-1 jive-image" src="a4626f3ddb5c9f04e9737a9e0f961961.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p><span style="font-size: 12pt;">Expected result : set "Description (short_description) " field as "Mandatory" when script is executed.</span></p><p><span style="font-size: 12pt;">I got my expected result when this script got executed, so far so good.</span></p><p></p><p><span style="font-size: 12pt;"><img   class="image-2 jive-image" src="dfa50942db5497049c9ffb651f961998.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;"><img   class="image-3 jive-image" src="6e46e486dbd0dfc068c1fb651f961934.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;">2) Now let us try to prove the fact that UI Policies are executed after the client script.</span></p><p><span style="font-size: 12pt;">So now let's configure the UI Policy as show below.</span></p><p><span style="font-size: 12pt;">I am now setting "Description" field to "Non Mandatory" to test if result of client script are applied in case 1 or result of this UI Policy is applied when form is loaded</span></p><p></p><p><span style="font-size: 12pt;"><img   class="jive-image image-4" src="6937cc0edb9cd3041dcaf3231f96194b.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;"><img   class="image-5 jive-image" src="8cc127f9db901fc068c1fb651f961903.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;">Once done, open any of the record form on "Database Instance".</span></p><p></p><p><span style="font-size: 12pt;">You will notice two alert messages, first alert message comes from onLoad client script which we built in step 1 and second message comes from UI Policy which we built in   this step.</span></p><p><span style="font-size: 12pt;">Now let's try to figure out what is happening</span></p><p><span style="font-size: 12pt;">a) Our onLoad client script when gets fired ahead of UI Policy, it tries to set "Description" field as mandatory. </span></p><p></p><p><span style="font-size: 12pt;"><img   class="image-6 jive-image" src="d9348d8edbdc9304b322f4621f96197e.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;">b) UI Policy when gets fired after onLoad client script, it then tries to set "Description" field as non mandatory.</span></p><p></p><p><span style="font-size: 12pt;"><img   class="image-7 jive-image" src="4dc1ec0adb5c5304b322f4621f96190c.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;">Now let's see what we get on the form.</span></p><p><span style="font-size: 12pt;">We see "Description" field is non mandatory. And this is the expected behavior as well since UI Policies are executed later than client script.</span></p><p><span style="font-size: 12pt;">3) Now configure onChange client script which gets fired when field "Operational Status" changes</span></p><p></p><p><span style="font-size: 12pt;"><img   class="jive-image image-8" src="fbb4440edb1cd3041dcaf3231f961940.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p></p><p><span style="font-size: 12pt;">Now intension is to set "Description" field as Mandatory.</span></p><p><span style="font-size: 12pt;">Note that, we expect this script should gets fired only when field value on "Operational Status" changes.</span></p><p><span style="font-size: 12pt;">Let's see what we get</span></p><p><span style="font-size: 12pt;">.</span></p><p><span style="font-size: 12pt;"><img   class="image-9 jive-image" src="d7c06371dbd01fc03eb27a9e0f9619ab.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;"><img   class="jive-image image-10" src="ea5f0d4edb9c97041dcaf3231f96196d.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;">4) Now, let's configure new UI Policy, lets make this UI Policy as conditional.</span></p><p><span style="font-size: 12pt;">Configure the condition when operation status is   "Non - Operational", this script should fire and set "Description" field is "Non Mandatory"</span></p><p></p><p></p><p><span style="font-size: 12pt;"><img   class="image-11 jive-image" src="8597e84edb109344e9737a9e0f961913.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p></p><p><span style="font-size: 12pt;"><img   class="image-12 jive-image" src="70994046db509704ed6af3231f961924.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p></p><p><span style="font-size: 12pt;">Now change the "Operational " to "Non Operational" and see what we get. You will notice first our "onChange" client script gets fired, and then our "Conditional UI Policy" which we have configured in this step</span></p><p></p><p></p><p><span style="font-size: 12pt;"> <img   class="image-13 jive-image" src="c1a52f35db541fc068c1fb651f961914.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p></p><p><span style="font-size: 12pt;"><img   class="jive-image image-14" src="29c1ac42db1457041dcaf3231f961935.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p></p><p><span style="font-size: 12pt;"><img   class="image-15 jive-image" src="60c4040edb5cd3049c9ffb651f961985.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p></p><p><span style="font-size: 12pt;">This is also an expected result since UI Policy is fired at the very last, so far so good.</span></p><p></p><p><span style="font-size: 12pt;">5) Configure onChange client script as per below screenshot. You will see there is an "isLoading" property which we have used in this script.</span></p><p></p><p></p><p><span style="font-size: 12pt;"><img   class="image-16 jive-image" src="48d0e371db901fc068c1fb651f961994.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p><span style="font-size: 12pt;">Reload the form and see observations.</span></p><p></p><p></p><p><span style="font-size: 12pt;"> <img   class="image-17 jive-image" src="ef5f89c6db181b04ed6af3231f9619a4.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;"><img   class="jive-image image-18" src="f597204adb9457049c9ffb651f96196f.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;"><img   class="image-19 jive-image" src="5999c046db509704ed6af3231f961915.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;"><img   class="image-20 jive-image" src="75a56f35dbd41704ed6af3231f961926.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 12pt;"><img   class="jive-image image-21" src="b181198adb5897049c9ffb651f961990.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p></p><p><span style="font-size: 12pt;">You will notice</span></p><p><span style="font-size: 12pt;">1) onLoad client script is executed first when form is loading</span></p><p><span style="font-size: 12pt;">2) UI Policy which has no condition is executed, it has a lower order compared to next UI Policy</span></p><p><span style="font-size: 12pt;">3) UI Policy which is conditional is executed</span></p><p><span style="font-size: 12pt;">4) onChange client script gets executed, but if you closely notice, it the "isLoading" part within a client script is getting executed. <span style="color: #e23d39;">This is really important and stood out to be the culprit which was causing field to alter its behavior since it is the part which got fired at very last. Someone has set the field action of mandatory is this portion of the script which was conflicting with the UI Policy.</span></span></p><p></p><p><span style="font-size: 14pt;">Some of the observations:</span></p><p></p><p><span style="font-size: 12pt;">1) onLoad client scripts are fired first</span></p><p><span style="font-size: 12pt;">2) UI Policy with increasing order are fired.</span></p><p><span style="font-size: 12pt;">3)onChange client scripts gets executed (onChange) if you put something into the isLoading portion when form is loaded irrespective of field is changed or not. Also it gets executed after the UI Policy.</span></p><p><span style="color: #e23d39; font-size: 12pt;"><strong>So make sure not to set fields as mandatory or read only or visible using isLoading property. If you encounter similar issue, that would be hard to debug. Make sure to use "UI Policies" for this case always.</strong></span></p><p><span style="font-size: 12pt;">4) onChange client script gets executed if field value is changed for which it is configured, also make sure to put return is true in isLoading portion. </span></p><p></p><p></p><p></p><p style="font-weight: inherit; font-style: inherit; font-family: inherit;"><span style="font-weight: inherit; font-style: inherit; font-size: 18pt; font-family: inherit; color: #e23d39;">Kindly do not forget to like or bookmark this post if it assists you.</span></p>