---
title: "ServiceNow Scripting  Retrieving All Dictionary Entries in a Table Hierarchy"
date: 2016-05-25T17:29:43.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=8fcda2e9dbd0dbc01dcaf3231f961991"
---
<p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-family: inherit; font-style: inherit;"><strong>NOTE</strong></span>: ON APRIL 1, 2016 ACCENTURE COMPLETED THE ACQUISITION PROCESS OF CLOUDSHERPAS.   AT THAT TIME THE CLOUDSHERPAS BLOG SITES WERE DOWNED FOREVER.</p><p></p><p style="font-family: arial, sans-serif; color: #666666;">THIS IS THE RE-PUBLICATION OF MY INAUGURAL CLOUDSHERPAS SCRIPTING 101 BLOG ARTICLE FROM <span style="font-weight: inherit; font-family: inherit; font-style: inherit;"><strong>February 4, 2015. </strong></span> </p><p style="font-family: arial, sans-serif; color: #666666;">____________________________________________________________________________</p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">Welcome to our new blog series, ServiceNow Scripting 101!   I have been writing this type of article under the ServiceNow Admin 101 series, but they really needed their own platform. Don't worry though: the Admin 101 series will still continue, but it will contain more Admin-ish articles from this point forward. Enjoy!</span></p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">Recently, our Web Service Integration team needed a method for looking up all of the fields belonging to a table and then displaying those fields in a pick list. This needed to be done for ALL of the fields in the table hierarchy. In other words, what was needed was a smart Dictionary Entry of Dictionary Entries for a given table!   While the solution turned out to be a little tricky, it wasn't too bad...honest!</span></p><p></p><p><span style="color: black; font-size: 14pt; font-family: arial, helvetica, sans-serif;"><strong>Requirements</strong></span></p><p style="margin-top: 5.0pt; margin-bottom: 5.0pt;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">What was needed?</span></p><ul><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">A short list of tables to drive a lookup of a list of available fields.</span></li><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">A lookup that could present the user with all fields available in the table hierarchy.</span></li><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">A way to determine the hierarchy table list in order to build a list of available fields.</span></li></ul><p style="margin-top: 5.0pt; margin-bottom: 5.0pt;"></p><p style="margin-top: 5.0pt; margin-bottom: 5.0pt;"><span style="color: black; font-size: 14pt; font-family: arial, helvetica, sans-serif;"><strong>Solution</strong></span></p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">1. <strong>Field</strong>: Table - a choice list of table names.</span></p><p style="margin-top: 5pt; margin-bottom: 5pt; padding-left: 30px;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">For example:</span></p><p style="margin-top: 5pt; margin-bottom: 5pt; padding-left: 30px;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;"><img   class="image-1 jive-image" src="25dfd546db9cd344e9737a9e0f96190f.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">2. <strong>Field</strong>:   Field - A lookup / reference field referencing Dictionary Entry and controlled by the Table field choice.</span></p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">3. The format should look something like this:</span></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;"><img   class="image-2 jive-image" src="42997c42db1097049c9ffb651f9619ef.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p style="margin-top: 5.0pt; margin-bottom: 5.0pt;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">Next, the Script Include will need to traverse a given table's hierarchy. This type of method is best done with a recursive routine. Incidentally I decided to do the groundwork for future Dictionary methods like this by creating a Dictionary Utility library. It is a good practice to attempt to group similar functions into a library format. You will find several examples of this with out-of-the-box Script Includes; just search for "Util" in the list view.</span></p><p style="margin-top: 5.0pt; margin-bottom: 5.0pt;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">Here is the Script Include:</span></p><ol start="1" style="list-style-type: decimal;"><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong>Name</strong>: DictionaryUtils</span></li><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong>Description</strong>:   Helper methods for Dictionary references</span></li><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong>Script</strong>:</span></li></ol><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">Here we would place our new recursive method:</span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14638465918499546" data-renderedposition="1253.203125_8_1192_592" jivemacro_uid="_14638465918499546"><p>var tableList = ''; // resultant lookup string that would be returned</p><p></p><p></p><p>var DictionaryUtils = Class.create();</p><p>DictionaryUtils.prototype = {</p><p></p><p>   initialize: function() {</p><p>   },</p><p></p><p></p><p>   //Recursive method for retrieving all Tables in the Hierarchy for a given table.</p><p>   //USAGE: new DictionaryUtils().getTableNameList('cmdb_ci_computer');</p><p>   //RETURNED: name='cmdb_ci_computer'^ORname='cmdb_ci_hardware'^ORname='cmdb_ci'</p><p>   getTableNameList : function(tableName) {</p><p></p><p>           // construct our lookup string</p><p>           tableList += "name=" + tableName + "^OR";</p><p></p><p>           // lookup the given table to retrieve our next super class name</p><p>           var tableLookup = GlideRecord('sys_db_object');</p><p>           tableLookup.addQuery('name', tableName);</p><p>           tableLookup.query();</p><p></p><p></p><p>           // chase each super class (i.e. parent) up the chain.</p><p>           // the topmost parent will NOT have a parent</p><p>           if (tableLookup.next() &amp;&amp; tableName != '') {</p><p>                   this.getTableNameList(tableLookup.super_class.name + '');</p><p>           }</p><p></p><p>           // peel off the last ^OR on the end of the lookup </p><p>           // string and return it to the calling method.</p><p>           return tableList.substring(0, tableList.length - 3) + '^element!=NULL';</p><p>   },</p><p></p><p>   type: 'DictionaryUtils'</p><p>};</p></pre><p></p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">So the magic is to work "up" the inheritance chain via the super_class reference field and build the list of tables accordingly.</span></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">The Script Include should look something like this:</span></p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;"><img   class="image-3 jive-image" src="16d71842dbd89704ed6af3231f961914.iix" style="width: 620px; height: 539px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p><span style="color: black; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong>NOTE</strong>: A good practice is to test this script from Scripts Background prior to implementing in your Dictionary Entry.</span></p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">Finally, modify the Dictionary Entry of the lookup/reference field on the original form.</span></p><p></p><ol start="1" style="list-style-type: decimal;"><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong>Reference</strong>: Dictionary Entry</span></li><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong>Reference qual</strong>: <span style="color: blue;"><strong>javascript:new DictionaryUtils().getTableNameList(current.u_table);</strong></span></span></li></ol><p style="margin-top: 5.0pt; margin-bottom: 5.0pt; margin-left: .5in;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">Where "u_table" is the table field that where we get our table name.</span></p><p style="margin-top: 5.0pt; margin-bottom: 5.0pt; margin-left: .5in;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">This will call the new Script Include method and construct an "OR" string of tables representing the table hierarchy for current.u_table.</span></p><p style="margin-top: 5.0pt; margin-bottom: 5.0pt; margin-left: .5in;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">This in turn will cause the lookup to pull up a list of fields based on those tables.   </span></p><p style="margin-top: 5.0pt; margin-bottom: 5.0pt; margin-left: .5in;"></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;"><img   class="jive-image image-4" src="30e8377ddb10db048c8ef4621f961971.iix" style="width: 620px; height: 370px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p style="margin-top: 5.0pt; margin-bottom: 5.0pt;"></p><p style="margin-top: 5.0pt; margin-bottom: 5.0pt;"><span style="color: black; font-size: 14pt; font-family: arial, helvetica, sans-serif;"><strong>Test</strong></span></p><ol start="1" style="list-style-type: decimal;"><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">Pick a table. I chose Incident.</span></li><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">Click on the "Fields" magnifying glass.</span></li><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;">Modify the list view (right-click / Personalize / List Layout) and your result should look something like this:</span></li></ol><p style="margin-top: 5.0pt; margin-bottom: 5.0pt;"><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;"><img   class="image-5 jive-image" src="c34dd1cedb9c97049c9ffb651f96192b.iix" style="width: 620px; height: 513px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black; background: white;">And that's all there is to it!</span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="color: black; font-size: 14pt; font-family: arial, helvetica, sans-serif;"><strong>Learn More</strong></span></p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;"><span style="color: black; background: white;">If you're interested in finding out more about Advanced Reference Qualifiers, check out </span><a href="http://wiki.servicenow.com/index.php?title=Reference_Qualifiers"><span style="color: #1155cc; background: white;">this Wiki article</span></a><span style="color: black; background: white;">. </span></span></p><p></p><p><span style="color: black; background: white; font-size: 12pt; font-family: arial, helvetica, sans-serif;">For more on JavaScript recursion, check out these resources:</span></p><ul style="list-style-type: disc;"><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;"><a href="http://msdn.microsoft.com/en-us/library/ie/wwbyhkx4%28v=vs.94%29.aspx"><span style="color: #1155cc; background-position: initial;">Recursion Example</span>             </a></span></li><li><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif; color: black;"><a href="http://www.codecademy.com/courses/javascript-lesson-205/0/1"><span style="color: #1155cc; background-position: initial;">Javascript Recursion Lesson</span></a></span></li></ul><p></p><p><span style="font-weight: inherit; font-size: 12pt; font-family: arial, helvetica, sans-serif; font-style: inherit;">Steven Bell</span></p><p></p><p style="font-weight: inherit; font-style: inherit;"><span style="color: purple; font-weight: inherit; font-size: 12pt; font-family: inherit; font-style: inherit;"><strong><a _jive_internal="true" data-containerid="-1" data-containertype="-1" data-objectid="110061" data-objecttype="111" href="/servlet/JiveServlet/downloadImage/38-5414-110061/accenture technology logo.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img   alt="accenture technology logo.png" class="image-1 jive-image" height="52" src="1cf6bc0edb989344e9737a9e0f9619bf.iix" style="margin: 10px 10px 10px 0; border: 0px; font-weight: inherit; font-style: inherit; font-family: inherit;" width="277"/></a><a _jive_internal="true" data-containerid="-1" data-containertype="-1" data-objectid="110062" data-objecttype="111" href="/servlet/JiveServlet/downloadImage/38-5414-110062/sn-community-mvp.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;"><img   alt="sn-community-mvp.png" class="image-2 jive-image" height="48" src="ab2994cadb1c17049c9ffb651f9619f6.iix" style="margin: 10px 10px 10px 0; border: 0px; font-weight: inherit; font-style: inherit; font-family: inherit;" width="135"/></a></strong></span></p><p></p><p style="font-weight: inherit; font-style: inherit; font-family: inherit;"><span style="font-weight: inherit; font-family: inherit; font-style: inherit;"><strong>For a list of all of my articles:   <a title="" _jive_internal="true" data-containerid="1027" data-containertype="37" data-objectid="4821" data-objecttype="38" href="/groups/servicenow-user-group-us-tx-north-texas/blog/2015/10/23/community-code-snippets-articles-list-to-date" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;">Community Code Snippets: Articles List to Date</a></strong></span></p><p></p><p style="font-weight: inherit; font-style: inherit; font-family: inherit;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit; color: #eb7a3d;">Please Share, Like, Bookmark, Mark Helpful, or Comment this blog if you've found it helpful or insightful.</span></p><p></p><p style="font-weight: inherit; font-style: inherit;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit; color: #eb7a3d;">Also, if you are not already, I would like to encourage you to become a member of our blog!</span></p><p></p><hr/><p style="font-weight: inherit; font-style: inherit; font-family: inherit;"><span style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #303030;">Click for <a title="" _jive_internal="true" href="/community?id=community_forum&sys_id=a6299a2ddbd897c068c1fb651f961926" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;">More Expert Blogs </a>and also Find <a title="" _jive_internal="true" class="jivecontainerTT-hover-container jive-link-community-small" data-containerid="2059" data-containertype="14" data-objectid="2037" data-objecttype="14" href="/community?id=community_forum&sys_id=d6295a2ddbd897c068c1fb651f9619f1" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;">Expert Events</a>!</span></p><hr/>