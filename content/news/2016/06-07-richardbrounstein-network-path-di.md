---
title: "Network Path Discovery in ServiceNow Service Mapping"
date: 2016-06-06T05:03:23.000Z
authors: ["richardbrounstein"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=63cda2e9dbd0dbc01dcaf3231f9619eb"
---
<p>One great feature of ServiceNow Service Mapping discovery is the ability to discovery network devices between servers that depend on each other.   In a resulting service map, it provides the ability to right mouse click on a relationship link between two servers and select the option "Show network path" as shown in the attached image im1.png.</p><p></p><p>The resulting network path provides a list of the Layer 3 network devices that make it possible for one server to communicate with another as shown here:</p><p><span style="line-height: 1.5;"><img   class="image-1 jive-image" src="d4913379db9c1fc03eb27a9e0f961937.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p><span style="line-height: 1.5;"><img   class="image-3 jive-image" src="cfdd454adb9413043eb27a9e0f9619ca.iix" style="max-width: 1200px; max-height: 900px;"/>The devices listed are the network switches and routers of Layer 3 on the OSi network model.   Go to this link for a description of the OSi network model: </span><a title="w.webopedia.com/quick_ref/OSI_Layers.asp" href="http://www.webopedia.com/quick_ref/OSI_Layers.asp" style="line-height: 1.5;">http://www.webopedia.com/quick_ref/OSI_Layers.asp</a><span style="line-height: 1.5;">.</span></p><p>These network devices are all related to the Business Service, which means they can now be part of an impact analysis report for change and incident management in ServiceNow. This provides a very important impact analysis since the network devices are not generally known for their relationship to business applications.   It is unfortunately too common for a network engineer to not know the effect a particular switch or router has on the business.   These maps provide this important insight to help prevent outages.</p><p></p><p><strong>HOW DO WE COLLECT THIS NETWORK INFORMATION?</strong></p><p></p><p>For details on Service Mapping, read the documentation here: <a title="ocs.servicenow.com/bundle/geneva-it-operations-management/page/product/service_mapping/concept/c_ServiceMappingOverview.html" href="https://docs.servicenow.com/bundle/geneva-it-operations-management/page/product/service_mapping/concept/c_ServiceMappingOverview.html">https://docs.servicenow.com/bundle/geneva-it-operations-management/page/product/service_mapping/concept/c_ServiceMappingOverview.html</a></p><p></p><p>During a service-mapping discovery, when a connection is made between two servers, Service Mapping runs a trace route network command from one server to the other server IP Address. The trace route reveals each layer 3 network device that must be passed through to get from one server to the other. Layer 3 devices include routers and smart switches.   Layer 2 switches will not show up on a trace route. Here is a typical trace route output:</p><p><span style="line-height: 1.5;"><img   class="jive-image image-4" src="8b7b200adb18d704ed6af3231f961962.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p>During service mapping discovery, these IP Addresses are stored in the table <strong>sa_network_paths</strong>.   Here is a sample of that captured information where the Layer 3 Path field stores the path information:</p><p></p><p></p><p></p><p>If the "State" is set to "Waiting for Discovery", then the internal process is triggered to calculate the network path.   Once it is calculated, the "State" is set to "Completed".   If you want to force the network path to calculate, then change the "State" to "Waiting for Discovery".</p><p>For the calculated network path to be available from the service map, the full information on the devices on the IP Addresses still need to be discovered.   This happens with standard horizontal discovery as documented here:</p><p></p><p></p><p><strong>Layer 2 Devices</strong></p><p>Starting with the Helsinki release, Service Maps will now include layer 2 network switches in the maps. These devices IP Addresses do not show up on a trace route.   However, they can still be discovered using standard ServiceNow Discovery.   During SN Discovery, when a layer 2 switch is classified in an IP Range, Discovery will collect information on the forwarding tables in the Switches.   Here is an example of a Switch forwarding table. Service Mapping will use this information to determine the network path in a Service Map:</p><p></p><p></p><p></p><p><strong>Discovery of Network Devices</strong></p><p>For either Layer2 or Layer3 network devices, standard discovery must be run against the individual IP Addresses of the devices or the IP Ranges that include the devices.   Here is information on how to run network discovery:</p><p><a title="ocs.servicenow.com/bundle/geneva-it-operations-management/page/product/discovery/concept/c_NetworkDiscovery.html" href="https://docs.servicenow.com/bundle/geneva-it-operations-management/page/product/discovery/concept/c_NetworkDiscovery.html">https://docs.servicenow.com/bundle/geneva-it-operations-management/page/product/discovery/concept/c_NetworkDiscovery.html</a></p><p>An SNMP credential must be defined which has the rights to connect to each network device and discover the detailed information for those devices.</p>