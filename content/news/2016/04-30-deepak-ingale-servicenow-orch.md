---
title: "ServiceNow Orchestration and Powershell Setup and test network communication"
date: 2016-04-29T23:56:38.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=c31d62e5dbd0dbc01dcaf3231f9619e2"
---
<p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">In continuation to previous <span style="font-weight: inherit; font-style: inherit; font-size: 11pt;">blog post <a title="" _jive_internal="true" data-containerid="3138" data-containertype="37" data-objectid="5369" data-objecttype="38" href="/blogs/deepakingale/2016/04/23/servicenow-orchestration-and-powershell-setup-your-virtual-ad-server" style="font-weight: inherit; font-style: inherit; font-size: 14.6667px; font-family: inherit; color: #3778c7;">ServiceNow Orchestration and Powershell :   Setup your virtual AD server</a></span></span><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;"><a title="" _jive_internal="true" data-containerid="3138" data-containertype="37" data-objectid="5369" data-objecttype="38" href="/blogs/deepakingale/2016/04/23/servicenow-orchestration-and-powershell-setup-your-virtual-ad-server" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #3778c7;">ServiceNow Orchestration and Powershell :   Setup your virtual AD server</a> in a series of Orchestration and Powershell, we are now going to set-up and test communication between our</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"></p><ul><li><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">ServieNow instance</span></li><li><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Host machine (laptop or desktop) where MID server is installed</span></li><li><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">guest machine where Server 2008 R2 is installed on VMware workstation.</span></li></ul><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">I have windows 7 installed with Powershell 4.0 on my host machine.</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">You can check what version of Powershell you are running by executing   "<span style="font-style: inherit; font-family: inherit;"><strong>Get-PSsnapin</strong></span>" command.</span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Also, MID server is installed on host machine, which runs Powershell commands or scripts on all network windows machines, hence we require to enable "<span style="font-style: inherit; font-family: inherit;"><strong>RSAT</strong></span>" (Remote Server Administration Tools") first so that we can run our "Active Directory" commands on remote server (Guest Active Directory Server).</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;"><a title="" _jive_internal="true" href="/www.microsoft.com/en-us/download/details.aspx?id=7887" rel="nofollow" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #3778c7;" target="_blank">RSAT</a> setup is available here.</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Steps to install RSAT are documented on below link.</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;"><a title="" _jive_internal="true" href="/4sysops.com/archives/how-to-install-the-powershell-active-directory-module" rel="nofollow" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #3778c7;" target="_blank">https://4sysops.com/archives/how-to-install-the-powershell-active-directory-module/</a></span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Turn on your virtual <span style="font-style: inherit; font-family: inherit;"><strong>guest</strong></span> machine if not done already.</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Once done, run <span style="font-style: inherit; font-family: inherit;"><strong>"Import-Module ActiveDirectory"</strong></span> command on <span style="font-style: inherit; font-family: inherit;"><strong>host</strong></span> machine.</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">You might observe some warning message related to PSDrive, you can ignore it.</span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-size: 18pt; font-family: Arial, sans-serif;">Test connection between host and guest machines</span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Now, test the connection between MID Server and Windows AD server.</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Open command prompt on MID Server, type <span style="font-style: inherit; font-family: inherit;"><strong>"ping IPAdressOfADServer".</strong></span></span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">You should see the ping response, this ensures that <span style="font-style: inherit; font-family: inherit;"><strong>MID Server host</strong></span> is connected to <span style="font-style: inherit; font-family: inherit;"><strong>guest AD Server</strong></span></span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Perform the same test on AD Server, replace IP address with MID Server IP address. You should see the ping response, this ensures AD server is connected to MID Server.</span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-size: 18pt; font-family: Arial, sans-serif;">Test connection between ServiceNow, host and guest machine.</span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Now, configure the "Credentials" in ServiceNow to authenticate against "Active directory domain" as shown. Remember, you need to supply AD server login ID details here.</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;"><img   class="jive-image image-8" src="87973379db90d3041dcaf3231f9619f2.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Configure Test workflow with "Run Powershell" activity.</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;"><img   class="image-9 jive-image" src="4d69110adbd8d344e9737a9e0f961919.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">In hostname activity, put IP address of the "AD Server"</span></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Put command "<span style="font-style: inherit; font-family: inherit;"><strong>whoami</strong></span>" (Who am I?)</span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><img   class="jive-image image-10" src="c4e141c2db9013043eb27a9e0f961998.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Run the workflow by using "Start Workflow" workflow action and notice the output of the command in "ecc queue".   Also, output should be available in "system logs"</span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><img   class="image-11 jive-image" src="a8be5c06db9c9fc068c1fb651f9619e3.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"></p><p style="font-family: arial, sans-serif; color: #666666;"><img   class="image-12 jive-image" src="5ebbfb79db545fc03eb27a9e0f961920.iix" style="max-width: 1200px; max-height: 900px;"/></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><img   class="image-13 jive-image" src="2c7e91c2db10df048c8ef4621f96198f.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-family: Arial, sans-serif;">Now, run the same command again by changing hostname to "localhost". This command will be executed on MID Server, your host machine. In the output of ecc queue or logs, you should see your login ID printed out.</span></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><img   class="jive-image image-14" src="bbab308adb5497041dcaf3231f961941.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;">Successful output in both cases indicates there is a network connectivity, authentication has been established and we are ready to move ahead.</p><p></p><p style="margin-bottom: 0.0001pt; font-family: arial, sans-serif; color: #666666; background: white;"><span style="font-weight: inherit; font-style: inherit; font-size: 18pt; font-family: inherit, serif; color: #fa5223;">Kindly do not forget to like or bookmark this article if it helps you.</span></p>