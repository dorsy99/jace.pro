---
title: "Catch a dropped user or group when doing a LDAP Import through the MID Server"
date: 2016-09-16T01:45:44.000Z
authors: ["martygrinstead"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=87aca625dbd0dbc01dcaf3231f96193b"
---
<p><a title="ocs.servicenow.com/bundle/helsinki-servicenow-platform/page/integrate/ldap/concept/c_LDAPIntegration.html" href="https://docs.servicenow.com/bundle/helsinki-servicenow-platform/page/integrate/ldap/concept/c_LDAPIntegration.html" style="line-height: 1.5;">LDAP Imports</a><span style="line-height: 1.5;"> allow administrators to keep ServiceNow users and groups sync'ed with the corporate "single-source of truth", the company LDAP Server.   The use of a MID server may be required to be able to access the LDAP server from the ServiceNow instance.</span></p><p></p><p>LDAP imports performed through a MID server can leave you looking for a<a title="i.service-now.com/kb_view.do?sysparm_article=KB0596908" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0596908"> lost user or group</a> in certain patches of Geneva and Helsinki. In this round of testing, I'll do a "Group" import using the MID Server.     Looking at the Groups in the sys_user_group table, one group from the import set will be gone. If you track back through the process, checking the ECC queue, you will see that all of the groups are there. The remaining table to check is the import set (staging) table. Sure enough, this is where we find the mix-up. The import set table will have the correct number of records; however, one will be<a title="i.service-now.com/kb_view.do?sysparm_article=KB0596908" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0596908"> missing and one will be duplicated</a>.</p><p></p><h2>How you know if your LDAP import is missing a user or group:</h2><ol><li>Configure LDAP server with the MID server.</li><li>Load all groups in LDAP   (this can happen with any LDAP imported records through a MID server, not just with Groups).</li><li>Check the ECC queue records, which show the correct data.</li><li>In the staging table, note that one of the records is omitted and a duplicate of another record is created.</li></ol><p></p><p>For this testing, I setup a simple LDAP group OU.   The LDAP Server requires the use of a MID Server (to reproduce this PRB).   When "Browsing" from the OU, we can see 4 groups, Group1-Group4:</p><p><img   alt="LDAP_Group_Browse.jpg" class="image-6 jive-image" src="8c887b71db9cdf04e9737a9e0f9619d9.iix" style="height: auto; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p>The data source used for the import:</p><p><img   alt="LDAP_DataSource.jpg" class="image-7 jive-image" src="ea30214adb1c130468c1fb651f9619c5.iix" style="width: 620px; height: 348px; display: block; margin-left: auto; margin-right: auto;"/></p><p>After loading the records (either <a title="" _jive_internal="true" href="/community/service-automation-platform/scripting/blog/2016/07/05/test-load-25-records-will-not-transform" target="_blank">Test load 20 Records, or Load All Records</a>):</p><p><img   alt="TestLoad20.jpg" class="image-8 jive-image" src="8af97806db109f048c8ef4621f9619aa.iix" style="width: 620px; height: 314px; display: block; margin-left: auto; margin-right: auto;"/></p><p>We can see that four records were processed and inserted; however, when we check the "Loaded data", we see the issue:</p><p><img   alt="ImportSetTable.jpg" class="image-9 jive-image" src="dd389c8adb545344e9737a9e0f9619c5.iix" style="width: 620px; height: 294px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p>Group4 was loaded 2 times, and Group2 was missed.</p><p></p><p>This shows that the LDAPProbeResult (in the ECC queue) correctly shows all 4 groups (including Group2).</p><p><img   alt="4GroupRecords.jpg" class="image-10 jive-image" src="3439b7f1db501304b322f4621f96195c.iix" style="width: 620px; height: 374px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p>Between the ECC queue and the loading of the import set table, we can see that we have<a title="i.service-now.com/kb_view.do?sysparm_article=KB0596908" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0596908"> lost one record and doubled-up on another</a>. This has been classified as a regression. The fix is available in <a title="ocs.servicenow.com/bundle/helsinki-release-notes/page/release-notes/r_Helsinki-Patch-4.html" href="https://docs.servicenow.com/bundle/helsinki-release-notes/page/release-notes/r_Helsinki-Patch-4.html">Helsinki Patch 4</a>, but if you don't want to upgrade there is a workaround you can use.</p><p></p><h2>Retrieving a missing user or group when doing a LDAP Import through the MID Server</h2><p>The workaround is to create and set the following property to a value of 0 (zero):</p><p><span style="color: #000000; font-size: 10pt; font-family: Verdana, Arial, Helvetica, sans-serif;"><em><strong>com.glide.loader.max_sample_size</strong></em></span></p><p></p><p>For steps on <a title="ocs.servicenow.com/bundle/helsinki-servicenow-platform/page/administer/reference-pages/concept/c_AddingAProperty.html" href="https://docs.servicenow.com/bundle/helsinki-servicenow-platform/page/administer/reference-pages/concept/c_AddingAProperty.html">how to add a new system property (in Helsinki),</a> see the docs.</p>