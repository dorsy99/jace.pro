---
title: "ServiceNow ACLs and Security  Understanding rootrule"
date: 2016-11-12T12:33:30.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=cadde6e9dbd0dbc01dcaf3231f961975"
---
<p dir="ltr" style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: bold; font-style: inherit; font-size: 12px; font-family: 'Times New Roman';">NOTE</span><span style="font-weight: inherit; font-style: inherit; font-size: 12px; font-family: Arial;">: </span><span style="font-weight: inherit; font-style: inherit; font-size: 12px; font-family: 'Times New Roman';">MY POSTINGS REFLECT MY OWN VIEWS AND DO NOT NECESSARILY REPRESENT THE VIEWS OF MY EMPLOYER, ACCENTURE.</span></p><p><span style="font-weight: inherit; font-style: inherit; font-size: 12px; font-family: 'Times New Roman';"> </span></p><p><span style="font-size: 12.0pt;">In Past, I was working on 'Geneva' instance to understand the ACLs for "HR" application.</span></p><p><span style="font-size: 12.0pt;">I happen to see one of the "ACL"on <span style="background: yellow;">hr_profile</span> (hr_profile.*) table was using   "<span style="background: yellow;">root_rule</span>" variable to evaluate an access per field level. This was really eye catching since I had not come across it and I started exploring what exactly it does in ACLs.</span></p><p><span style="font-size: 12.0pt;">So now, let me walk you through this <span style="background: yellow;">root_rule</span> object and how we can leverage its functionality.</span></p><ul style="list-style-type: disc;"><li><span style="font-size: 18.0pt;">What is root_rule?</span></li></ul><p><span style="font-size: 12.0pt;">           root_rule points to the element or an object against which ACL is getting evaluated.</span></p><p><span style="font-size: 12.0pt;">e.g., if we have ACLs on <strong>incident.short_description</strong>, then root_rule returns or stores incident.short_description as a value. If we have ACL configure at ROW level for table Incident, then root_rule will return incident as the value.</span></p><p><span style="font-size: 12.0pt;">We can check this by adding gs.print(root_rule) statements in ACL script part, and then turning on the security debugger, </span><span style="font-size: 12.0pt;">It will be printed as (incident.short_description);</span></p><p></p><ul style="list-style-type: disc;"><li><span style="font-size: 18.0pt;">What could be the potential uses of this root_rule variable?</span></li></ul><p><span style="font-size: 12.0pt;">If we have a table with hundreds of different fields, and if some set of fields requires different access control, then we will require to configure those many ACLs depending on the requirement. With the help of the root_rule, we can configure ACLs as <span style="background: yellow;">table.*</span> . Asterisk evaluate the ACLs on each fields (Unless field have its own ACL). Now table.* ACL gets evaluated at each field and while it does so, root_rule will store the value of the field against which ACL is currently being evaluated. With the help of this single ACL and root_rule variable, we can control the access at field level as per our choice and requirement.</span></p><p></p><ul><li><span style="font-size: 18pt;">How to check the root_rule functionality?</span></li></ul><p></p><p><span style="font-size: 12.0pt;">         Configure a table with name <span style="background: yellow;">mobile_device</span> and fields are like model, display_size, resolution etc.</span></p><p></p><ul style="list-style-type: disc;"><li><span style="font-size: 12.0pt;">Configure an ACL <span style="background: yellow;">mobile_device.*</span></span></li><li><span style="font-size: 12.0pt;">Put gs.print("Root Rule is "   + root_rule) in script section of the ACL</span></li><li><span style="font-size: 12.0pt;">Turn of security debug on</span></li><li><span style="font-size: 12.0pt;">Open the records in the mobile_device table so that ACL gets evaluated</span></li><li><span style="font-size: 12.0pt;">We will see print statements like 'Root Rule is mobile_device.model' , 'Root Rule is mobile_device.display_size', 'Root Rule is mobile_device.resolution' being printed.</span></li></ul><p></p><p style="margin-left: 54.0pt;"><span style="font-size: 12.0pt;">Now if we require to make conditional access to these fields based on some criteria, then we can parse the root_rule in script section to check the field and then can provide an access.</span></p><p></p><p style="margin-left: 54.0pt;"><span style="font-size: 12.0pt;">Link to OOB ACL on hr_profile table for reference</span></p><p></p><p style="margin-left: 54.0pt;"><span style="font-size: 12.0pt;"><a title="k-external-small" class="jive-link-external-small" href="https://" rel="nofollow" target="_blank">https://</a><span style="background: yellow;">instance</span>.service-now.com/nav_to.do?uri=sys_security_acl.do?sys_id=05ae15fbdf103100b5157a0d3df263ca </span></p><p style="margin-left: 54.0pt;"></p><p style="margin-left: 54.0pt;"></p><p style="margin-left: 54.0pt;"><span style="font-size: 12.0pt;"><img  class="image-1 jive-image" src="38bb7006db1c9304b322f4621f96194e.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p><span style="font-size: 18pt;">                         Note : <span style="font-size: 14pt;">This root_rule variable is not listed and documented anywhere, somehow, it is being used in some of the OOB ServiceNow ACLs</span></span></p>