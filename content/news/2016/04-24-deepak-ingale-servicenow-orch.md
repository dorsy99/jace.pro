---
title: "ServiceNow Orchestration and Powershell   Setup your virtual AD server"
date: 2016-04-23T16:25:02.000Z
authors: ["Deepak Ingale"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=73fde62ddbd0dbc01dcaf3231f961992"
---
<p>Microsoft has built a very Powerful scripting interface "PowerShell" . We can not only interact with windows server but also with the other infrastructure related components like VMware, NetApp storage.   The only thing we require is to add cmdlets (commands of Powershell are known as cmdlets) of these technologies/ platforms via import-module command. Once done, we are free to interact with these platforms.</p><p></p><p>In a series of this blog, I am going to start with "Creating your own AD Server" and thinking to extend it further to demonstrate different types of automations that we can achieve.</p><p>So let's start first with "Creating your own AD Server"</p><p>No separate Server, Laptop or Desktop is required. We are going to host this AD Server on VMware work station.</p><p></p><p><span style="font-size: 18pt;">Requirements:</span></p><p></p><p>1) A machine with CPU Clocked at 1.4GHz x86/64. This is the minimum requirement</p><p>2) A drive space of at least 40Gb. This is the minimum requirement</p><p><span>3) Windows Server 2008 R2 evaluation version OS with 180 days .You can download it from </span><a title="" _jive_internal="true" href="/www.microsoft.com/en-in/download/details.aspx?id=11093" rel="nofollow" target="_blank">https://www.microsoft.com/en-in/download/details.aspx?id=11093</a><span>.</span></p><p><span>4)   VMware workstation 10, </span><a title="" _jive_internal="true" href="/my.vmware.com/web/vmware/details?downloadGroup=WKST-1007-WIN&amp;productId=362&amp;rPId=8482" rel="nofollow" target="_blank">https://my.vmware.com/web/vmware/details?downloadGroup=WKST-1007-WIN&amp;productId=362&amp;rPId=8482</a><span>. We will create Virtual Server using this workstation</span></p><p>5) Host machine with at least 2GB RAM. Server 2008 R2 requires at least 512MB, you can increase it for better performance and experience if your host   machine has more RAM</p><p>6) MID Server installed on your local machine pointing to your personal developer instance.   <a title="sabell2012" __default_attr="7849" __jive_macro_name="user" class="jive-link-profile-small jive_macro jive_macro_user" data-id="7849" data-objecttype="3" data-orig-content="sabell2012" data-renderedposition="361_593_88_16" data-type="person" href="/community?id=community_user_profile&user=838f86e9db181fc09c9ffb651f9619d9">sabell2012</a> has already written an article <a title="ServiceNow Discovery 101: Setting Up a Local MID Server" __default_attr="5356" __jive_macro_name="blogpost" class="jive_macro jive_macro_blogpost" data-orig-content="ServiceNow Discovery 101: Setting Up a Local MID Server" data-renderedposition="361_8_1179_37" href="/community?id=community_blog&sys_id=a2bc2e25dbd0dbc01dcaf3231f9619e0">ServiceNow Discovery 101: Setting Up a Local MID Server</a> for it.   MID Server is required to interact with our ServiceNow instance. So go ahead and complete this installation</p><p></p><p><span style="font-size: 18pt;">Steps:</span></p><p></p><p>1) Download and install VMware workstation</p><p>2) Download evaluation copy of Server 2008 R2</p><p><span>3) Create a new Virtual Machine (VM) and install Server 2008 R2 OS </span><a title="" _jive_internal="true" href="/kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1018415" rel="nofollow" target="_blank">https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1018415</a></p><p>4) Once done, create your own domain , you can refer to steps for it.</p><p><a title="" _jive_internal="true" href="/technet.microsoft.com/en-us/library/dd883274(v=ws.10).aspx" rel="nofollow" target="_blank">https://technet.microsoft.com/en-us/library/dd883274(v=ws.10).aspx</a><span> </span></p><p>5) Go to "VM" &gt;&gt; "Settings" and "Network Adaptor" menu option via workstation and set networking mode to NAT. This is important for our MID Server, instance to communicate with Virtual machine.</p><p></p><p><img   class="image-2 jive-image" src="e55adccadb1c9704ed6af3231f961957.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p>6) Now we need to add "NAT" type connection. For this, launch "Virtual Network Editor" from "Edit" menu option of the Vmware workstation</p><p>It will open a configuration window like one shown above. It may happen that you will not see "NAT"</p><p></p><p><img   class="image-1 jive-image" src="3aa9fc06db9cdfc068c1fb651f961971.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p>We require to create "NAT" type network connection. If you do not find anything of this type, you can add via "Add Network" option. Make sure you are selecting the check boxes as above.</p><p>For IP address range, you can use any of the private IP address series</p><ol style="list-style-type: lower-alpha;"><li>e.g. 10.0.0.0 to 10.255.255.255 OR 172.26.31.0 OR 192.168.10.0 etc</li></ol><p>Let's use 192.168.10.0 for our set-up.</p><p>Add 192.168.10.0 in subnet IP address box, keep subnet mask to 255.255.255.0</p><p>You can see network adapter with name corresponding to your NAT network also got created in your local machine. In my case it is "VMnet8". Yours might be different.</p><p>This is an network adapter via which we are going to communicate between "AD server" to "External world" like ServiceNow instance.</p><p>Check the IP address of this virtual network adapter, it must be from the range 192.168.10.0 to 192.168.10.254 based on our subnet.</p><p>8) Check the IP address of the VM created, it must also be from the range 192.168.10.0 to 192.168.10.254.</p><p>9) Install Orchestration plugins on   your instance</p><p></p><p>That's it, we are now good to go ahead with activities related to window active directory server.</p><p></p><p><span style="font-size: 18pt;">Advantages:</span></p><p><span style="font-size: 12pt;">1) AD server is VM, do not forget to take a snapshot after successful installation. This helps in reverting your virtual machine in case we spoil it after some days. Its like a backup. </span></p><p><span style="font-size: 12pt;">2) Use the same AD server for LDAP integration related operation, we will require users and groups populated. we will create those in next post.</span></p><p></p><p><span style="font-size: 18pt; color: #fa5223;">Kindly do not forget to like or bookmark this article if it helps you.</span></p>