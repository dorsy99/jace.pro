---
title: "Session IDs and Angular apps"
date: 2016-03-25T08:48:09.000Z
authors: ["ajs"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=bebc6e25dbd0dbc01dcaf3231f961928"
---
<p>My team spent a lot of time recently working on building custom AngularJS apps on top of the ServiceNow platform. We also wanted the freedom to style the pages without the opinionated CSS loaded by Heisenberg. While Heisenberg and some of the other preloaded JavScript and CSS provide value for rapidly building simple applications, traditional developers want the freedom of starting with a clean CSS and JavaScript slate.</p><p></p><p>This is easily achieved on ServiceNow, by setting the <strong>direct</strong> attribute to TRUE on all of your UI Pages. In GENEVA this is easily set on the UI Page form.</p><p></p><p><img   alt="directTrue.png" class="image-1 jive-image" src="a4126d46dbdcd344e9737a9e0f9619d0.iix" style="width: 620px; height: 158px;"/></p><p></p><p>Prior to Geneva, you can achieve this by passing a querystring of   :</p><pre __default_attr="xml" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14588763102064651 jive_text_macro" data-renderedposition="359_8_1192_16" jivemacro_uid="_14588763102064651"><p>ui_page.do?sysparm_direct=true</p></pre><p></p><p>When making REST calls in your app the ServiceNow endpoints, if you do nothing, your users will be prompted to enter their ServiceNow credentials every time a call is made. To avoid that, you can leverage add an authentication with the <strong>X-UserToken</strong> set to the logged in user's session token. This is is a more User Friendly way to handle this as there is no impact to their experience.</p><p></p><p>After doing some research on the <a title="ki.servicenow.com/index.php?title=Scoped_GlideSystem_API_Reference#getSessionToken.28.29" href="http://wiki.servicenow.com/index.php?title=Scoped_GlideSystem_API_Reference#getSessionToken.28.29">wiki</a> and the <a title="augs.wordpress.com/2016/02/12/an-exercise-in-sensibility-scheduling-the-unschedulable/" href="https://baugs.wordpress.com/2016/02/12/an-exercise-in-sensibility-scheduling-the-unschedulable/">blogs, </a>I suggest the following approach for Angular apps:</p><p></p><p>In your UI Page that contains your <strong>ng-app="appName"</strong></p><p></p><p>You are going to insert the following Glide and JavaScript</p><pre>&lt;g:evaluate object="true"&gt;<br/>         var g_ck = gs.getSessionToken(); <br/>&lt;/g:evaluate&gt; <br/>&lt;script&gt;     <br/>         window.g_ck = "$[g_ck]"; <br/>&lt;/script&gt;</pre><p>This will add the session token from the gs object to your global JavaScript scope.</p><p></p><p>Then depending on how you make your REST calls, you can pass the token in the Headers. Here are a few examples.</p><p></p><p>If you want to set a global header default WHEN your only REST calls are to the the ServiceNow instance you can use $httpProvider.defaults</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14588772502012170 jive_macro_code jive_text_macro" data-renderedposition="867_8_1192_48" jivemacro_uid="_14588772502012170"><p>angular.module("appName").run(function ($http) {</p><p>         $http.defaults.headers.common['X-UserToken'] = window.g_ck;</p><p>}</p></pre><p></p><p>If you don't want to set it at a global level, you would need to specify it in the <strong>config</strong> for every $http request to servicenow</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_1458877423135608" data-renderedposition="979_8_1192_224" jivemacro_uid="_1458877423135608"><p>$http({</p><p>         method : "GET",</p><p>         url : 'api/now/etc',</p><p>         headers : {</p><p>                   'X-UserToken' : window.g_ck</p><p>         }</p><p>}).then(function (res) {});</p><p></p><p>// or with the shortcuts</p><p>$http.get('/api/now/etc',{</p><p>         headers : {</p><p>                   'X-UserToken' : window.g_ck</p><p>         }</p><p>}).then(function (res) {});</p></pre><p></p><p>I use <strong>window.g_ck</strong> because that's what ServiceNow does on <strong>direct=false</strong> UI Pages. That way, if you do decide to move your JavaScript to a UI Page with <strong>direct=false</strong> you won't have to update your JavaScript to continue to access the session token.</p><p></p><p>Let me know how it goes for you.</p>