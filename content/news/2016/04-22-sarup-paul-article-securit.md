---
title: "Article Security and Filtering in Knowledge v"
date: 2016-04-21T23:21:36.000Z
authors: ["Sarup Paul"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=264e66addbd0dbc01dcaf3231f96196c"
---
<p>Knowledge v3 (released with Fuji) <a title="ocs.servicenow.com/bundle/geneva-servicenow-platform/page/product/knowledge_management/reference/r_KMv3KeyDifferences.html" href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/product/knowledge_management/reference/r_KMv3KeyDifferences.html" rel="nofollow">integrated User Criteria</a> into the Knowledge Management application. <a title="i.service-now.com/kb_view.do?sysparm_article&#61;KB0550924" href="https://hi.service-now.com/kb_view.do?sysparm_article&#61;KB0550924" rel="nofollow">User Criteria</a> is meant to provide more configurable access controls for a more robust<a title="ocs.servicenow.com/bundle/geneva-it-service-management/page/product/service_catalog_management/reference/r_GoodPracImpleUsrCritria.html" href="https://docs.servicenow.com/bundle/geneva-it-service-management/page/product/service_catalog_management/reference/r_GoodPracImpleUsrCritria.html" rel="nofollow"> knowledge base. </a>User Criteria allows you to choose your level of security based on groups, roles, locations etc. and are applicable at the Knowledge base level. As a part of the changes, the &#34;Role&#34; field on the article was hidden. This gives the perception that it&#39;s not feasible to configure article level security, within a single Knowledge Base.</p>
<p> </p>
<p>With <a title="outu.be/OVGt5rgB3S0" href="https://youtu.be/OVGt5rgB3S0" rel="nofollow">KM v3,</a> it is possible to configure article level security, if desired, in your implementation. Additionally, you can implement additional filtering of articles. I will show you how to apply roles to articles in an Knowledge Base, as well as how to use Business Rules to filter with custom fields.</p>
<p> </p>
<h1><strong>Applying Roles to Knowledge articles</strong></h1>
<p>Roles based access control is honored by Knowledge v3 interfaces such as search and <a title="ocs.servicenow.com/bundle/geneva-servicenow-platform/page/product/knowledge_management/reference/r_KMv3KnowledgeArticleView.html" href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/product/knowledge_management/reference/r_KMv3KnowledgeArticleView.html" rel="nofollow">article view</a>. In order to configure article view access, you will need to enable the &#34;Role&#34; field and set the roles on each Article, that you would like to allow &#34;read&#34; access.</p>
<p><img class="image-5 jive-image" style="width: 620px; height: 210px; display: block; margin-left: auto; margin-right: auto;" src="52be6c8adb98d704ed6af3231f9619ae.iix" alt="km v3 roles.jpg" /></p>
<p> </p>
<p>Please note that this will work in coordination with the User Criteria defined for the Knowledge base. This means that if the KB does not provide read access to a specified group, allowing access via &#34;Roles&#34; will not bypass those restrictions. The &#34;write&#34; permissions will continue to be controlled by the User Criteria definitions. You will need to have broader access permitted through User Criteria (on KB configuration) and then apply restrictions on the article, to limit its access. Once the roles are enabled, you can <a title="ocs.servicenow.com/bundle/geneva-servicenow-platform/page/administer/roles/reference/r_BaseSystemRoles.html" href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/administer/roles/reference/r_BaseSystemRoles.html" rel="nofollow">select Roles</a> from the article, as has been supported in earlier releases. <span style="color: #eb7a3d;"><br /></span></p>
<p><img class="image-6 jive-image" style="width: 620px; height: 213px; display: block; margin-left: auto; margin-right: auto;" src="ab53dcc6db141f048c8ef4621f961929.iix" alt="user criteria v3.jpg" /></p>
<p> </p>
<p style="text-align: center;"><em>The earlier releases of Knowledge v3 had some known issues working with roles, so there were some fixes made to address them. These are available on <a title="ki.servicenow.com/index.php?title&#61;Release:Fuji_Patch_12#gsc.tab&#61;0" href="http://wiki.servicenow.com/index.php?title&#61;Release:Fuji_Patch_12#gsc.tab&#61;0" rel="nofollow">Fuji Patch 12</a> and <a title="ocs.servicenow.com/bundle/geneva-release-notes/page/release-notes/r_Geneva-Patch-4.html" href="https://docs.servicenow.com/bundle/geneva-release-notes/page/release-notes/r_Geneva-Patch-4.html" rel="nofollow">Geneva Patch 4</a> and onwards.</em></p>
<p> </p>
<h1><strong>Using Business Rules for Filtering</strong></h1>
<p>Article filtering using custom fields, is an option for securing articles using parameters other than roles. Some use cases such as &#34;Product&#34; or &#34;Location&#34; based entitlement can be achieved using this framework. You can consider this as a replacement for complex ACL logic. You will need to start by configuring a new field in the Knowledge form.</p>
<p> </p>
<p>Let&#39;s create a &#34;region&#34; field, for example:</p>
<p><img class="image-7 jive-image" style="width: 620px; height: 173px; display: block; margin-left: auto; margin-right: auto;" src="d3fce375db949b048c8ef4621f961965.iix" alt="knowledge filter.jpg" /></p>
<p>After that you can configure a &#34;before&#34; query business rule to filter content based on the logged in user&#39;s region.</p>
<p><img class="image-8 jive-image" style="width: 620px; height: 227px; display: block; margin-left: auto; margin-right: auto;" src="f73fc986db54d344e9737a9e0f961974.iix" alt="before query km v3.jpg" /></p>
<p> </p>
<p>In order to retrieve and compare against the location, you would need to script some of the logic in the &#34;Advanced&#34; section.</p>
<p class="p1" style="padding-left: 30px;"><span class="s1" style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">var gr &#61; new GlideRecord(&#34;sys_user&#34;);</span></p>
<p class="p1" style="padding-left: 30px;"><span class="s1" style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">gr.get(gs.getUserID());</span></p>
<p class="p1" style="padding-left: 30px;"><span class="s1" style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">var currentUserLocation &#61; gr.location.country;</span></p>
<p class="p1" style="padding-left: 30px;"><span class="s1" style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">var q&#61;current.addNullQuery(&#39;u_location&#39;);</span></p>
<p class="p1" style="padding-left: 30px;"><span class="s1" style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">q.addOrCondition(&#39;u_location&#39;, currentUserLocation);</span></p>
<p class="p1" style="padding-left: 30px;"><span class="s1" style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">gs.print(&#34;Query restricted to location: &#34; &#43; currentUserLocation);</span></p>
<p>This will allow you to restrict the content based on region. The rules will apply in:</p>
<ul><li><a href="community?id&#61;community_blog&amp;sys_id&#61;f91e226ddbd0dbc01dcaf3231f961910" rel="nofollow">Search</a></li><li>Browse</li><li>Article viewing</li></ul>
<p> </p>
<p>Allowing the additional controls that you may need. Using either or a combination of the Roles and Business rules you can configure who can access articles beyond the Knowledge Base level. For more information on upgrading to knowledge v3 see <a class="jive_macro jive_macro_blogpost" title="All things Upgrade considered on Knowledge v2 to v3." href="community?id&#61;community_blog&amp;sys_id&#61;e0dc2665dbd0dbc01dcaf3231f9619f4" rel="nofollow">All things Upgrade considered on Knowledge v2 to v3.</a></p>