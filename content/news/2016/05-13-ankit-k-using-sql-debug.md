---
title: "Using SQL Debugger to troubleshoot slow queries"
date: 2016-05-12T23:09:51.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=b8fca2a5dbd0dbc01dcaf3231f961903"
---
<p>ServiceNow has a plethora of <a title="ocs.servicenow.com/bundle/geneva-servicenow-platform/page/script/debugging/concept/c_SessionDebug.html" href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/script/debugging/concept/c_SessionDebug.html">debugging tools</a> available on the instance which helps ServiceNow admins and technical support engineers <a title="" _jive_internal="true" href="/community/service-management/configuration/blog/2015/04/15/basics-of-servicenow-performance-troubleshooting">troubleshoot performance issues</a> and narrow down the cause. Out of all the options ServiceNow offers, the SQL Debugger is the most powerful and helps admins find out all queries involved in a particular transaction. It can be used for both MySQL as well as Oracle based queries which are the relational database query languages available for ServiceNow instances. It empowers you to find the slowness based on the queries and using the explain plan tool create the appropriate indexes to help improve the performance of the application.</p><p></p><p>There are two types of of SQL Debugging tools:</p><ol><li>Debug SQL</li><li>Debug SQL (Detailed)</li></ol><p></p><h1>Debug SQL vs. Debug SQL (Detailed)</h1><p>The Debug SQL option lists all the queries involved but doesn't give the stack trace from where the query is originating as opposed to Debug SQL (Detailed) which does give you the Java stack trace   with a   "+"   symbol. This primarily is the only difference between the two.</p><p></p><table border="1" class="jiveBorder" style="border: 1px solid #c6c6c6; width: 100%;"><tbody><tr><th style="text-align: left; background-color: #f2f2f2; color: #505050; padding: 6px;" valign="middle"><span style="color: #eb7a3d;"><strong><strong>SQL DETAILED</strong></strong></span></th></tr><tr><td style="padding: 6px; text-align: center;"><img   alt="Detailed sql debug.jpg" class="image-4 jive-image" height="135" src="bbbbfff5dbd45704ed6af3231f961983.iix" style="height: 134px; width: 1025.67901234568px;" width="1025"/></td></tr></tbody></table><p></p><p>The MySQL debugger is only valid till your session exists. If you logout it automatically turns the debugger off. It is not necessary that you need to logout or wait for the session to timeout. Once done if you want to continue using the application it can be manually turned by navigating to <strong>System Security </strong>and clicking on<strong> Stop Debugging. </strong>If one of your users is experience unusual slowness, admins can turn on the SQL Debugger and then impersonate the user to investigate the queries involved in the transaction for that particular user transaction.</p><h2><img   alt="Appl_filter.png" class="image-5 jive-image" height="90" src="5b7ff48adbd497041dcaf3231f9619f1.iix" style="line-height: 19.0909080505371px; float: right; height: 90px; width: 103.181818181818px;" width="103"/></h2><p></p><h2>Impersonating a user to investigate queries for a particular user transaction</h2><p>We impersonate a user experiencing performance issues to see find the specific form, incident or transaction that could be causing slowness. In the Application</p><p>navigation filter type in <strong>Debug SQL. </strong>Click on either of the options to turn the MySQL Debugger on. You can impersonate any user after this and navigate to a form or list to the see a list of queries being executed.</p><p></p><p></p><table border="1"><tbody><tr><td><p>For example:</p><p>On trying to open the incident list, it took more then 180 seconds to render. This is reproducible every time and no other list is affected. To determine if the slowness lies on the database, we need to find the slow database query(s) or the source from where it's originating from.</p><p><img   alt="mysql debugger.jpg" class="image-6 jive-image" src="e6de584adb1057049c9ffb651f961994.iix" style="width: 620px; height: 320px; display: block; margin-left: auto; margin-right: auto;"/></p><p>There were approximately 3,800 insert queries that were loading with the list. Upon clicking the SQL Debugger (detail) to find the source, we see it is the the business rule. These queries were running against the incident table which was recursively adding gs.log() statements for every record being pulled, causing the slowness.</p></td></tr></tbody></table><p></p><p>If a long running database query is responsible for the slowness, then you can <a title="" _jive_internal="true" href="/community/service-automation-platform/applications/blog/2016/04/06/how-to-add-a-database-index-to-help-performance-of-instance-how-to-find-slow-queries">use the explain plan</a> to determine if there is a way to optimize it using an index. Cases where performance degradation is the underlying source (script includes and business rules) the queries can be identified and the appropriate steps or plan of action can be taken to rectify it to improve the performance of the application. The SQL debugger is a great must-use-tool recommended for troubleshooting performance of many ServiceNow applications. There are certain applications which do not use the SQL debugger such as the<a title="ocs.servicenow.com/bundle/geneva-servicenow-platform/page/use/visual_task_boards/concept/c_VisualTaskBoardUse.html" href="https://docs.servicenow.com/bundle/geneva-servicenow-platform/page/use/visual_task_boards/concept/c_VisualTaskBoardUse.html"> Visual Task Boards (VTB)</a>, ServiceNow support can help you out with that.</p><p></p><p></p><p>Thank you <a title="john.gonzalez" __default_attr="16830" __jive_macro_name="user" class="jive_macro jive_macro_user" data-orig-content="john.gonzalez" data-renderedposition="1318.380615234375_76.98910522460938_105_16" href="/community?id=community_user_profile&user=14505629db581fc09c9ffb651f961955">john.gonzalez</a>   for the idea to write this post!</p>