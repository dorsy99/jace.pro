---
title: "Data Sampling Techniques Part  CMDB Data Quality"
date: 2016-09-28T22:30:07.000Z
authors: ["drjohnchun"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=7d4e26addbd0dbc01dcaf3231f961983"
---
<p><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=6c3d2ae5dbd0dbc01dcaf3231f96199d">Last time</a>, we saw how <strong>Data Certification</strong> and <strong>Independent Review/Audit</strong> are used to ensure CMDB data quality. We also saw how statistical sampling may be used for Data Certification and it can almost always be used for Independent Review/Audit. Let's now create a fictitious CMDB and start crunching numbers to see how statistical sampling works in practice. In all cases, we'll work with the margin of error of  ± 5% at 95% confidence level.</p><p></p><p>Our fictitious CMDB contains the following CIs:</p><p></p><table border="1" class="jiveBorder" height="237" style="border: 1px solid #c6c6c6; width: 537px; height: 173px;"><tbody><tr><th style="text-align: left; background-color: #f2f2f2; color: #505050; padding: 6px;" valign="middle"><strong>CI Type</strong></th><th style="padding: 6px; text-align: center; color: #505050; background-color: #f2f2f2;" valign="middle"><strong>Count</strong></th><th style="padding: 6px; text-align: center; color: #505050; background-color: #f2f2f2;" valign="middle"><strong>Sample Size*</strong></th><th style="padding: 6px; text-align: center; color: #505050; background-color: #f2f2f2;" valign="middle"><strong>% Sample / Count</strong></th></tr><tr><td style="padding: 6px;">Services</td><td style="padding: 6px; text-align: right;">100</td><td style="padding: 6px; text-align: right;">80</td><td style="padding: 6px; text-align: right;">80%</td></tr><tr><td style="padding: 6px;">Applications</td><td style="padding: 6px; text-align: right;">1,000</td><td style="padding: 6px; text-align: right;">278</td><td style="padding: 6px; text-align: right;">28%</td></tr><tr><td style="padding: 6px;">Servers</td><td style="padding: 6px; text-align: right;">5,000</td><td style="padding: 6px; text-align: right;">357</td><td style="padding: 6px; text-align: right;">7%</td></tr><tr><td style="padding: 6px;">Databases</td><td style="padding: 6px; text-align: right;">3,000</td><td style="padding: 6px; text-align: right;">341</td><td style="padding: 6px; text-align: right;">11%</td></tr><tr><td style="padding: 6px;">Storage</td><td style="padding: 6px; text-align: right;">900</td><td style="padding: 6px; text-align: right;">270</td><td style="padding: 6px; text-align: right;">30%</td></tr><tr><td style="padding: 6px;"><strong>Total</strong></td><td style="padding: 6px; text-align: right;"><strong>10,000</strong></td><td style="padding: 6px; text-align: right;"><p><strong>370</strong></p></td><td style="padding: 6px; text-align: right;"><strong>4%</strong></td></tr></tbody></table><p><span style="font-size: 10pt;">* for  ± 5% margin of error at 95% confidence level</span></p><p></p><p>Shown in the third column are the sample sizes for each <em>CI Type</em> when the <em>CI Count</em> is used as population. We can immediately see that the relative sample size compared to the population (<em>Count</em>) becomes larger as the population becomes smaller as shown in the last column; for Services, the sample size is 80% of the population whereas for Servers, it's only 7%. Let's see why below.</p><p></p><p><strong>SAMPLE-SIZE CALCULATION</strong></p><p></p><p>Sample size is calculated, at 95% confidence level, using</p><p></p><p style="text-align: center;"><a __jive_macro_name="appEmbeddedView" _action_id="com.jivesoftware.rte.matheditor" _appuuid="3dd2dcdb-bd19-4256-9e35-16c3d2d7e3c3" _context="{&quot;app&quot;:&quot;Math Formula Editor&quot;,&quot;latexInput&quot;:&quot;Sample\\;Size\\;=\\;\\frac1{{\\displaystyle\\frac1{Population}}+\\left({\\displaystyle\\frac{2\\cdot Error}{1.96}}\\right)^2}&quot;,&quot;imageSize&quot;:&quot;20&quot;}" _jive_macro_name="appEmbeddedView" _previewimage="https://community.servicenow.com/servlet/JiveServlet/downloadImage/177565/a704168d-1a1d-45fc-90cc-c538391592ab.png%26st%3Ddefault%253AsBmp7GZEUS3-dJv923MQCcXpKTVhzbRHxANH_IwpDhucjXDmnwF1i7RaCPnGiJSxWDPtDV2p-XwnGOyRlp0uToBJ3LaMbeLhkWLqVwCCcRvfYiC8" _view="embedded.matheditor" class="jive-link-app-preview jive_macro_appEmbeddedView jive_macro" data-orig-content="&lt;img class=&quot;jiveImage&quot; style=&quot;width: 381px; height: 83px;&quot; alt=&quot;a704168d-1a1d-45fc-90cc-c538391592ab.png&amp;amp;st=default%3AsBmp7GZEUS3-dJv923MQCcXpKTVhzbRHxANH_IwpDhucjXDmnwF1i7RaCPnGiJSxWDPtDV2p-XwnGOyRlp0uToBJ3LaMbeLhkWLqVwCCcRvfYiC8&quot; src=&quot;https://community.servicenow.com/servlet/JiveServlet/downloadImage/38-5991-177565/a704168d-1a1d-45fc-90cc-c538391592ab.png%26st%3Ddefault%253AsBmp7GZEUS3-dJv923MQCcXpKTVhzbRHxANH_IwpDhucjXDmnwF1i7RaCPnGiJSxWDPtDV2p-XwnGOyRlp0uToBJ3LaMbeLhkWLqVwCCcRvfYiC8&quot; data-mce-style=&quot;width: 381px; height: 83px;&quot; data-mce-src=&quot;/servlet/JiveServlet/downloadImage/38-5991-177565/a704168d-1a1d-45fc-90cc-c538391592ab.png%26st%3Ddefault%253AsBmp7GZEUS3-dJv923MQCcXpKTVhzbRHxANH_IwpDhucjXDmnwF1i7RaCPnGiJSxWDPtDV2p-XwnGOyRlp0uToBJ3LaMbeLhkWLqVwCCcRvfYiC8&quot; __jive_id=&quot;177565&quot;&gt;" data-renderedposition="687_275_381_0"><img   alt="a704168d-1a1d-45fc-90cc-c538391592ab.png&amp;st=default%3AsBmp7GZEUS3-dJv923MQCcXpKTVhzbRHxANH_IwpDhucjXDmnwF1i7RaCPnGiJSxWDPtDV2p-XwnGOyRlp0uToBJ3LaMbeLhkWLqVwCCcRvfYiC8" class="jiveImage" src="6bc26fb1db9c9f04e9737a9e0f961914.iix" style="width: 381px; height: 83px;"/></a></p><p></p><p>where <em>Population</em> is population size and <em>Error</em> is margin of error. When the result is in decimal, round it up to the nearest integer (ceiling). In Excel, using named cells <em>Population</em> and <em>Error</em>, this can be written as</p><p></p><p style="text-align: center;">=CEILING(1/(1/Population + (2*Error/1.96)^2),1)</p><p></p><p>and in JavaScript, it's</p><p></p><p style="text-align: center;"><span style="color: #0000ff; font-size: 10pt; font-family: Consolas;">var</span><span style="font-size: 10pt; font-family: Consolas;"> sample_size = Math.ceil(1 / (1 / population + Math.pow(2 * error / 1.96, 2)));</span></p><p></p><p>A sample-size calculator based on this formula is available online at <a title="ww.surveymonkey.com/mp/sample-size-calculator" href="https://www.surveymonkey.com/mp/sample-size-calculator">SurveyMonkey</a>. When the population is huge, as we saw with the election poll example in <a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=efed222ddbd0dbc01dcaf3231f9619f9">Part 1</a>, the term 1/<em>Population </em>is almost zero, resulting in the simple relationship between the <em>Margin of Error</em> and <em>Sample Size</em> we saw in Part 1. If we further assume 5% margin of error, this simplifies to</p><p></p><p style="text-align: center;"><em> <a __jive_macro_name="appEmbeddedView" _action_id="com.jivesoftware.rte.matheditor" _appuuid="3dd2dcdb-bd19-4256-9e35-16c3d2d7e3c3" _context="{&quot;app&quot;:&quot;Math Formula Editor&quot;,&quot;latexInput&quot;:&quot;Sample\\;Size\\;=\\;\\frac1{{\\displaystyle\\frac1{Population}}+{\\displaystyle\\frac1{384.16}}}&quot;,&quot;imageSize&quot;:&quot;20&quot;}" _jive_macro_name="appEmbeddedView" _previewimage="https://community.servicenow.com/servlet/JiveServlet/downloadImage/177566/f33c6aef-dc38-4747-864e-d13f80d8c785.png%26st%3Ddefault%253AsBmp7GZEUS3-dJv923MQCcXpKTVhzbRHxANH_IwpDhucjXDmnwF1i7RaCPnGiJSxWDPtDV2p-XwnGOyRlp0uToBJ3LaMbeLhkWLqVwCCcRvfYiC8" _view="embedded.matheditor" class="jive-link-app-preview jive_macro_appEmbeddedView jive_macro" data-orig-content="&lt;img class=&quot;jiveImage&quot; style=&quot;width: 324px; height: 75px;&quot; alt=&quot;f33c6aef-dc38-4747-864e-d13f80d8c785.png&amp;amp;st=default%3AsBmp7GZEUS3-dJv923MQCcXpKTVhzbRHxANH_IwpDhucjXDmnwF1i7RaCPnGiJSxWDPtDV2p-XwnGOyRlp0uToBJ3LaMbeLhkWLqVwCCcRvfYiC8&quot; src=&quot;https://community.servicenow.com/servlet/JiveServlet/downloadImage/38-5991-177566/f33c6aef-dc38-4747-864e-d13f80d8c785.png%26st%3Ddefault%253AsBmp7GZEUS3-dJv923MQCcXpKTVhzbRHxANH_IwpDhucjXDmnwF1i7RaCPnGiJSxWDPtDV2p-XwnGOyRlp0uToBJ3LaMbeLhkWLqVwCCcRvfYiC8&quot; data-mce-style=&quot;width: 324px; height: 75px;&quot; data-mce-src=&quot;/servlet/JiveServlet/downloadImage/38-5991-177566/f33c6aef-dc38-4747-864e-d13f80d8c785.png%26st%3Ddefault%253AsBmp7GZEUS3-dJv923MQCcXpKTVhzbRHxANH_IwpDhucjXDmnwF1i7RaCPnGiJSxWDPtDV2p-XwnGOyRlp0uToBJ3LaMbeLhkWLqVwCCcRvfYiC8&quot; __jive_id=&quot;177566&quot;&gt;" data-renderedposition="1055_303.5_324_0"><img   alt="f33c6aef-dc38-4747-864e-d13f80d8c785.png&amp;st=default%3AsBmp7GZEUS3-dJv923MQCcXpKTVhzbRHxANH_IwpDhucjXDmnwF1i7RaCPnGiJSxWDPtDV2p-XwnGOyRlp0uToBJ3LaMbeLhkWLqVwCCcRvfYiC8" class="jiveImage" src="2f26c14edbd013043eb27a9e0f96198a.iix" style="width: 324px; height: 75px;"/></a> </em></p><p></p><p>From this, we see that as <em>Population</em> increases, <em>Sample Size</em> increases only gradually, maxing out at 385 (384.16 rounded up); so no matter how large population size is, we need a sample size no more than 385 to get  ± 5% margin of error at 95% confidence level.</p><p></p><p><strong>DATA CERTIFICATION</strong></p><p></p><p>Now that we know how to calculate sample size, let's look at some practical examples. Let's say we're performing data certification for applications, all 1,000 of them. There may be some fields and relationships that need to be manually verified, which add to the time and effort. Instead of tackling all records at once, it may be useful to get <strong>preliminary results</strong> by taking a random sample of 278 application CI records. This will give us a ballpark figure (within  ± 5% margin of error) ahead of time; for example, are we looking at 90% pass rate? 80%? Perhaps even 70%? Knowing this may help us prepare for any actions that need to be taken later. When we're finished with all 1,000 CI records, we can further validate our statistical approach.</p><p></p><p>We can also take a <strong>hybrid approach</strong> as mentioned in <a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=6c3d2ae5dbd0dbc01dcaf3231f96199d">Part 2</a>; for critical applications, every single record is evaluated whereas statistical sampling is used for the rest. Let's say out of 1,000 applications, 200 are critical (SOX, GxP, security, etc.). We can evaluate the rest 800 applications using a sample size of 260.</p><p></p><p><strong>INTERPRETING RESULTS</strong></p><p></p><p>Let's review once again what statistical sampling results mean. From the above example, let's say we reviewed a sample of 278 application CI records out of the population of 1,000. Of the 278 CIs, 270 passed and 8 failed. This gives 97  ± 5% confidence interval, so we expect the true value to be somewhere between 92% and 100%, or as low as 92% (this is a conservative estimate). If the minimum threshold for passing is 90%, the results are acceptable; on the other hand, if the minimum threshold is 95%, then the results are unacceptable.</p><p></p><p><strong>DEFINING POPULATION</strong></p><p></p><p>Population must be defined based on the objectives. As we saw above, if we are to certify all applications, then the correct population to be used is 1,000. However, if we are to certify non-critical applications only, then the population is reduced to 800 and the results may read, for example, "of the 800 non-critical applications, at least 90% passed certification."</p><p></p><p>If we are to evaluate the entire CMDB, then the population to be used is 10,000, resulting in the sample size of 370. Let's say the results show at least 90% pass rate; this applies to the entire CMDB but not to the individual CI types that make up the CMDB. For example, due to the randomness of the sample, close to 50% (185) of the sample may be servers (since servers make up half of the entire CMDB). Here, we can't claim "at least 90% pass rate for servers"; for us to be able to do that, we'll have to evaluate 357 sample records just from 5,000 servers.</p><p></p><p>In ServiceNow, if a filter is used to reduce the number of target records, then, typically, the result set is the population.</p><p></p><p><strong>ENSURING RANDOMNESS</strong></p><p></p><p>For the statistical sampling techniques to work, sample must be drawn at random without any bias; "random" in this context means "every record has an equal probability of being selected." Some may choose to select an arbitrary 20% of the population as sample by taking every fifth record (this is called <em>systematic sampling</em>); this doesn't ensure randomness, although may be acceptable in some auditing practices. A better method for random selection is to assign a random number to a unique key (for example, sys_id) of each record and then to sort by the random numbers; the first <em>n</em> (sample size) records can then be used as sample. Most random number generators, such as those used in JavaScript, Excel, etc., are called "pseudo" random number generators because the results are not truly random. However, they're sufficient for most practical applications.</p><p></p><p><strong>A "QUICK" CMDB ASSESSMENT</strong></p><p></p><p>Let's apply what we've seen so far to a practical use case. Let's say you haven't assessed your CMDB for data quality in a while. You'd like to conduct an assessment and, based on the results, take actions. While there are some automated checks in place, some attributes can only be reviewed manually, such as CI ownership that is used in change management workflows. You'd like to assess the entire CMDB, with 100,000 CIs (this is 10 times the CIs we had above). This includes "inactive" CIs as well since you'd like to make sure the "inactive" status was set correctly by discovery tools. The population size then is 100,000.</p><p></p><p>The sample-size calculator tells you the sample size to be used is 383. You select random sample and assign them to several people to speed up the progress, with an instruction on what to review and clear definitions of pass/fail. The results are ready at the end of the day and they don't look good; 333 (87%) passed and 50 failed, below the minimum 90% threshold you were hoping for. The failed CIs were mostly in applications and servers; you decide to conduct assessments just for them the next day. You also found 3 "inactive" CIs that should've been "active"; you decide to conduct a separate assessment just on "inactive" CIs.</p><p></p><p>Manually reviewing 100,000 records would be challenging. On the other hand, 383 records are much more manageable. Although the results are only ballpark figures, statistical sampling provides a "quick" way to gain insights and draw conclusions. As we just saw above, the insights can be used to further refine the results.</p><p></p><p><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=bfddaae9dbd0dbc01dcaf3231f961947">Next time</a>, we'll look at how some ServiceNow applications and features may relate to the techniques we have seen so far.</p><p></p><p><em>Please feel free to connect, follow, post feedback / questions / comments, share, like, bookmark, endorse.</em></p><p>John Chun, <span style="font-size: 8pt;">PhD PMP</span> <a href="http://linkedin.com/in/DrJohnChun"><img alt="see John's LinkedIn profile" class="image-2 jive-image" src="http://megaicons.net/static/img/icons_sizes/182/456/16/linkedin-icon.png" style="height: auto; vertical-align: -13px;" title="see John's LinkedIn profile"/></a></p><p><a href="http://snowaid.com/"><img alt="visit snowaid" class="image-1 jive-image" src="http://snowaid.com/images/signature.png" style="height: auto; margin-top: -9px;" title="visit snowaid"/></a></p>