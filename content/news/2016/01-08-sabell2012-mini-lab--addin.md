---
title: "MiniLab Adding Filters to the CNET WebService Example"
date: 2016-01-07T07:45:34.000Z
authors: ["sabell2012"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=ec8c66e1dbd0dbc01dcaf3231f961920"
---
<p><span style="font-size: 12pt;">In my previous article we enhanced the C#/.NET webservice example on the wiki using Visual Studio Community 2015.   I introduced some key concepts like WPF instead of Windows Forms, and using the App.config file to contain your userid and password.   Additionally I changed it up a bit and gave an example of a get instead of an insert.   This included how to receive the information coming back from ServiceNow, and make use of it.   Finally, I added in a sprinkling of best and good practices.</span></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">Wiki article:   <a title="" _jive_internal="true" href="/wiki.servicenow.com/index.php?title=Web_Services_C_Sharp_.NET_End_to_End_Tutorial" rel="nofollow" style="font-size: 16px; font-family: arial, sans-serif; color: #266fc8;" target="_blank">Web Services C Sharp .NET End to End Tutorial</a></span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">My article:     <a title="" _jive_internal="true" href="/groups/servicenow-user-group-us-tx-north-texas/blog/2015/12/31/mini-lab-visual-studio-community-2015-and-the-c-web-service-example" style="font-size: 15px; font-family: arial, sans-serif; color: #266fc8;">Mini-Lab: Visual Studio Community 2015 and the C# Web Service Example</a></span></p><p></p><p><span style="font-size: 12pt;">In this article we will continue with this example.   I will be showing how to expand the code and UI to incorporate the recommended best practices from the first part of another Wiki article:</span></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><a href="http://wiki.servicenow.com/index.php?title=Retrieving_A_Large_Number_Of_Records_Using_SOAP#gsc.tab=0" title="http://wiki.servicenow.com/index.php?title=Retrieving_A_Large_Number_Of_Records_Using_SOAP#gsc.tab=0">Retrieving A Large Number Of Records Using SOAP - ServiceNow Wiki</a></span></p><p></p><p><span style="font-size: 12pt;">Specifically section 2.1 and 2.1.3: <strong>Using Filters to Limit the Number of Results.</strong></span></p><p></p><p><span style="font-size: 12pt;">Well...I will be demonstrating the how, but not exactly like it is described.   I will leave that for you to do!   <span __jive_emoticon_name="happy" __jive_macro_name="emoticon" class="jive_emote jive_macro" data-renderedposition="324.6528015136719_733.5416870117188_16_16" src="/8.0.1.35b65d4/images/emoticons/happy.png"></span></span></p><p></p><p><span style="font-size: 12pt;"><strong>NOTE</strong>: I highly recommend performing both labs in my previous article before continuing with the lab in this article.</span></p><p></p><p><span style="font-size: 12pt;">Steps:</span></p><p></p><p><span style="font-size: 12pt;">1. If you haven't already; you will need to install VS Community 2015.   See my previous article for the links to download and the how-to.</span></p><p><span style="font-size: 12pt;">2. Create a new VS WPF Project.</span></p><p><span style="font-size: 12pt;">3. Test.</span></p><p></p><p></p><p><span style="font-size: 12pt;"><strong>Lab 2.1: Creating the ServiceNow Filter Limiter Project</strong></span></p><p></p><p><span style="font-size: 12pt;">1. Read through section 2.1 of the ServiceNow Wiki article.   This shows three approaches for limiting the number of records being retrieved.   We will be focusing on the third: Best Practice.</span></p><p></p><p><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">2. In the VS IDE navigate to File -&gt; New -&gt; Project.   The new project form will be displayed.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">3. Fill in the form with the following:</span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">a. Choose: <span style="font-style: inherit; font-family: inherit;"><strong>WPF Application</strong></span><br/></span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">b. <span style="font-style: inherit; font-family: inherit;"><strong>Name</strong></span>: ServiceNowFilterLimiter   <span class="emoticon_happy emoticon-inline" style="font-weight: inherit; font-style: inherit; font-family: inherit;"></span></span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">c. Click on the OK button to create your project.</span></p><p></p><p><img   class="image-1 jive-image" src="f077dc0adbd817049c9ffb651f961941.iix" style="width: 620px; height: 376px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">4. A new blank WPF project will be created.</span></p><p></p><p><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">5. From the Toolbox tab on the left pull out the following controls:</span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">a. RichTextbox control and a button control onto your new form.   You will find the RichTextbox control under the All WPF Controls tree.</span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">b. Five Labels</span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">c. Five Combo Box controls</span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">d. One button control</span></p><p></p><p><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;"><img   class="image-2 jive-image" src="4c983b35dbd0d3041dcaf3231f961942.iix" style="width: 620px; height: 349px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">e. Arrange them to look something like this (yeah I played with the color on the rtb control):</span></p><p></p><p><img   class="image-3 jive-image" src="99fcddc6dbdc9f048c8ef4621f961980.iix" style="width: auto; height: auto; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">f. Change the text of the labels, checkbox and button to be that as you see on the image above.</span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">g. Change the names of the controls to the following:</span></p><p style="padding-left: 60px;"><span style="font-size: 12pt;">i.         RichTextBox:   rtbResults</span></p><p style="padding-left: 60px;"><span style="font-size: 12pt;">ii.       Button:   btnSendQuery</span></p><p style="padding-left: 60px;"><span style="font-size: 12pt;">iii.     Checkbox:   chkActive</span></p><p style="padding-left: 60px;"><span style="font-size: 12pt;">iv.     Impact Combo:   cmbImpact</span></p><p style="padding-left: 60px;"><span style="font-size: 12pt;">v.       Urgency Combo:   cmbUrgency</span></p><p style="padding-left: 60px;"><span style="font-size: 12pt;">vi.     Priority Combo:   cmbPriority</span></p><p style="padding-left: 60px;"><span style="font-size: 12pt;">vii.   State Combo:   cmbState</span></p><p style="padding-left: 60px;"><span style="font-size: 12pt;">viii. User Combo:   cmbUser</span></p><p style="padding-left: 60px;"></p><p style="padding-left: 60px;"><span style="font-size: 12pt;">NOTE: It is also a good practice to change the names on your labels as well.</span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">h. This is probably a good point to save everything.   Navigate to File -&gt; Save All.</span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">6.   Now right-click on the <span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">ServiceNowFilterLimiter </span>project to bring up the project context menu.</span></p><p></p><p>7. <span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">Navigate to Add -&gt; Service Reference.   This will bring up the Add Service Reference Form.</span></p><p></p><p><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;"><img   class="jive-image image-4" src="2296b4c2dbdcd704ed6af3231f9619c1.iix" style="width: 620px; height: 349px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">8. Fill in the form with the following:</span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">a. <span style="font-style: inherit; font-family: inherit;"><strong>Address</strong></span>: <a title="" _jive_internal="true" href="/external-link.jspa?url=https:" rel="nofollow" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;" target="_blank">https://</a>&lt;&lt;servicenow instance name&gt;&gt;.service-now.com?incident.do?wsdl</span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">b. <span style="font-style: inherit; font-family: inherit;"><strong>Namespace</strong></span>: incidentTable</span></p><p style="padding-left: 60px; font-family: arial, sans-serif; color: #666666;"></p><p style="padding-left: 60px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;"><img   class="image-5 jive-image" src="48d8d482db945344e9737a9e0f96197d.iix" style="width: 620px; height: 503px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p style="padding-left: 60px; font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">9. Click the <strong>Go</strong> button.   A popup will ask you to fill in the userid and password.   BEWARE: It will send these in cleartext to ServiceNow.   Don't give that user too much authority.   Read should be sufficient.   We will be adding security next. <span class="emoticon_silly emoticon-inline" style="font-weight: inherit; font-style: inherit; font-family: inherit;"></span></span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">10. After a proper connection has been made the Add Service Reference form should look like this:</span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;"><a _jive_internal="true" href="/servlet/JiveServlet/downloadImage/38-5095-60590/pastedImage_57.png" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8; text-decoration: underline;"><img   class="image-11 jive-image" height="513" src="a6f91d8adb5c97049c9ffb651f96197b.iix" style="margin: 2px auto 10px; border: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; display: block;" width="634"/></a></span></p><p></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">11. Click the OK button.   A new Service Reference will be added to the project.</span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><img   class="image-12 jive-image" src="e0e733f9db145704ed6af3231f961986.iix" style="width: auto; height: auto; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">12. In the solution Explorer double-click on the App.config entry.   This will display the App.config file in the editor.   We will be adding some security, and the uid/pw data.</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-family: inherit; font-size: 12pt; font-style: inherit; font-weight: inherit; line-height: 1.5;">a.   Replace the the following XML to the &lt;Security mode=... /&gt; line with the following code:</span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"></p><p style="padding-left: 60px; font-family: arial, sans-serif; color: #666666;"></p><pre __default_attr="xml" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14520945161742322 jive_text_macro" data-renderedposition="5053.2119140625_7.986111640930176_1191_93" jivemacro_uid="_14520945161742322"><p style="font-family: arial, sans-serif; color: #666666;">                                       &lt;security mode="Transport"&gt;</p><p>                                               &lt;transport clientCredentialType="Basic" proxyCredentialType="Basic" realm=""&gt;</p><p>                                                       &lt;extendedProtectionPolicy policyEnforcement="Never" /&gt;</p><p>                                               &lt;/transport&gt;</p><p>                                               &lt;message clientCredentialType="UserName" algorithmSuite="Default" /&gt;</p><p>                                       &lt;/security&gt;</p></pre><p style="padding-left: 60px; font-family: arial, sans-serif; color: #666666;"></p><p style="padding-left: 60px; font-family: arial, sans-serif; color: #666666;"></p><div class="bar" style="font-weight: inherit; font-style: inherit; font-family: inherit;"><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">b. Add in a new section at the bottom after the &lt;/system_serviceModel&gt; tag.   I used my uid/pw combo that I created in a previousarticle.   BTW, this is a best practice!   Never hard-code this stuff in your code! </span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"></p></div><p></p><pre __default_attr="xml" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14520944804263988" data-renderedposition="5319.87890625_7.986111640930176_1191_62" jivemacro_uid="_14520944804263988"><p><span style="font-size: 12pt;">       &lt;appSettings&gt;</span></p><p><span style="font-size: 12pt;">               &lt;add key="userID" value="svcuser" /&gt;</span></p><p><span style="font-size: 12pt;">               &lt;add key="password" value="Pragmat1$t10"/&gt;</span></p><p><span style="font-size: 12pt;">       &lt;/appSettings&gt;</span></p></pre><div style="font-weight: inherit; font-style: inherit; font-family: inherit;"><p></p><p><span style="font-size: 12pt;">   </span></p></div><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;"><span style="font-style: inherit; font-family: inherit;"><strong>NOTE</strong></span>: If you REALLY want to crank down on the security of this file I found the following article excellent reading:</span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;"><a title="" _jive_internal="true" href="/weblogs.asp.net/jongalloway/encrypting-passwords-in-a-net-app-config-file" rel="nofollow" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #266fc8;" target="_blank">Jon Galloway - Encrypting Passwords in a .NET app.config File</a></span></p><p></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">c. Save the file (ctl-s).   The file should look something like this:</span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"><img   class="image-13 jive-image" src="ffb8740adbd097041dcaf3231f961932.iix" style="width: 620px; height: 316px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p></p><p><span style="font-family: inherit; font-size: 12pt; font-style: inherit; font-weight: inherit; color: #666666; line-height: 1.5;">13. Next we will add the Configuration reference to our project.   This is not (and in my book should be) done for you automatically.</span></p><p></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">a. Right-click on the References section in the Solution Explorer, and choose Add Reference from the context pop-up.   This will display the Add Reference form.</span></p><p></p><p><img   class="image-16 jive-image" height="315" src="c4c3f402db1cdfc068c1fb651f961974.iix" style="margin: 2px auto 10px; font-size: 16px; font-family: arial, sans-serif; color: #266fc8; display: block;" width="435"/></p><p></p><p style="padding-left: 30px;"><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">b. Scroll down and find the System.Configuration entry.   Click on this; a check box will be displayed.   Make sure this is checked.</span></p><p></p><p><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;"><img   class="image-17 jive-image" height="550" src="d1a4508adb541f048c8ef4621f961909.iix" style="margin: 2px auto 10px; font-size: 16px; font-family: arial, sans-serif; color: #266fc8; display: block;" width="802"/></span></p><p></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">c. Click OK to save your work. </span></p><p></p><p><span style="color: #666666; font-family: inherit; font-style: inherit; font-weight: inherit; font-size: 12pt;">14. Right-Click again on </span><span style="color: #666666; font-family: inherit; font-style: inherit; font-weight: inherit; font-size: 12pt;">the <span style="font-family: arial, sans-serif;">ServiceNowFilterLimiter </span>project to bring up the project context menu.</span></p><p></p><p>15. <span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">Navigate to Add -&gt; New Item.   This will bring up the New Item Form.   We will be adding a class that will be used as an object to contain our listed items in each combo box.</span></p><p></p><p style="padding-left: 30px;"><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">a. Choose Class, and make the name ComboBoxItem.cs</span></p><p><img   class="jive-image image-18" src="a7e5500edb5817041dcaf3231f9619a2.iix" style="margin-right: auto; margin-left: auto; font-size: 16px; line-height: 26.6667px; width: 620px; height: 379px; display: block;"/></p><p style="padding-left: 30px;"><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">b. Click on the Add button.   This will display an empty class form.</span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">c. Replace all the code on the form with the following:</span></p><p style="padding-left: 30px;"></p><p></p><pre __default_attr="c#" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14521161089083666 jive_text_macro" data-renderedposition="7678.50732421875_7.986111640930176_1191_311" jivemacro_uid="_14521161089083666"><p>namespace ServiceNowFilterLimiter</p><p>{</p><p>       public class ComboBoxItem</p><p>       {</p><p>               public string Value = "";</p><p>               public string Text = "";</p><p></p><p></p><p>               public ComboBoxItem(string val, string text)</p><p>               {</p><p>                       Value = val;</p><p>                       Text = text;</p><p>               }</p><p></p><p>               public override string ToString()</p><p>               {</p><p>                       return Text;</p><p>               }</p><p>       }</p><p>}</p></pre><p></p><pre __default_attr="c#" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14521165066644873 jive_text_macro" data-renderedposition="8010.7294921875_7.986111640930176_1191_0" jivemacro_uid="_14521165066644873"></pre><p></p><p><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">16. Now we will be adding in the core code that will do the work.   </span></p><p></p><p style="padding-left: 30px;"><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">a. Double-click on the Send Command button.   This will bring up the MainWindow code file.   You can also do this from the Solution Explorer.</span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><img   class="image-19 jive-image" src="0256b3fddb9c9b048c8ef4621f961905.iix" style="margin-right: auto; margin-left: auto; color: #3d3d3d; font-family: 'Helvetica Neue', Helvetica, Arial, 'Lucida Grande', sans-serif; line-height: 23.3333px; width: 620px; height: 345px; display: block;"/></p><p></p><p style="font-family: arial, sans-serif; color: #666666; padding-left: 30px;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">b. Replace both the MainWindow() and btnSend_Click() methods with the following code:</span></p><p></p><p style="padding-left: 30px;"><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;"><strong>NOTE</strong>: I have added in comments to clarify what the code does.</span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="color: #666666; font-family: arial, sans-serif; font-size: 16px;">Best Practice:   Add #region tags into your C# code to help organize sections that are related.   This also helps you "minimize" sections of code to help manage large code files.</span></p><p></p><p></p><pre __default_attr="c#" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14521153990761823 jive_text_macro" data-renderedposition="8709.72265625_7.986111640930176_1191_2053" jivemacro_uid="_14521153990761823"><p> <span style="color: rgba(0, 0, 0, 0); font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px;">             </span>public MainWindow()</p><p>               {</p><p>                       InitializeComponent();</p><p>                       initializeCombos();</p><p>                       initializeResults();</p><p></p><p>                       chkActive.SetCurrentValue(CheckBox.IsCheckedProperty, true);   // default active to checked</p><p>               }</p><p></p><p>               private void btnSendQuery_Click(object sender, RoutedEventArgs e)</p><p>               {</p><p>                       // Clear out our results (otherwise each query would tack onto the next)</p><p>                       rtbResults.Document.Blocks.Clear();</p><p></p><p>                       // declare our soap object for transmission</p><p>                       incidentTable.ServiceNowSoapClient soapClient = new incidentTable.ServiceNowSoapClient();</p><p></p><p>                       // pull the cred info from the app.config</p><p>                       soapClient.ClientCredentials.UserName.UserName = ConfigurationManager.AppSettings["userID"];</p><p>                       soapClient.ClientCredentials.UserName.Password = ConfigurationManager.AppSettings["password"];</p><p></p><p>                       // Initialize our query</p><p>                       incidentTable.getRecords getRecordsQuery = new incidentTable.getRecords();</p><p></p><p>                       // Initialize our response. And since we don't know how many will be returned put it into a List object</p><p>                       List&lt;incidentTable.getRecordsResponseGetRecordsResult&gt; responseList = new List&lt;incidentTable.getRecordsResponseGetRecordsResult&gt;();</p><p></p><p>                       // Activate query components based on what was chosen by the user in the UI</p><p>                       getRecordsQuery.assigned_to = cmbUser.SelectedValue != null &amp;&amp; ((ComboBoxItem)cmbUser.SelectedValue).Value != "" ? ((ComboBoxItem)cmbUser.SelectedValue).Value : null;</p><p>                       getRecordsQuery.state = cmbState.SelectedValue != null &amp;&amp; ((ComboBoxItem)cmbState.SelectedValue).Value != "" ? ((ComboBoxItem)cmbState.SelectedValue).Value : null;</p><p>                       getRecordsQuery.priority = cmbPriority.SelectedValue != null &amp;&amp; ((ComboBoxItem)cmbPriority.SelectedValue).Value != "" ? ((ComboBoxItem)cmbPriority.SelectedValue).Value : null;</p><p>                       getRecordsQuery.urgency = cmbUrgency.SelectedValue != null &amp;&amp; ((ComboBoxItem)cmbUrgency.SelectedValue).Value != "" ? ((ComboBoxItem)cmbUrgency.SelectedValue).Value : null;</p><p>                       getRecordsQuery.impact = cmbImpact.SelectedValue != null &amp;&amp; ((ComboBoxItem)cmbImpact.SelectedValue).Value != "" ? ((ComboBoxItem)cmbImpact.SelectedValue).Value : null;</p><p></p><p>                       try</p><p>                       {</p><p>                               // Now fire off our query.   Use a LINQ command to Order the results</p><p>                               responseList = soapClient.getRecords(getRecordsQuery).OrderBy(o =&gt; o.number).ToList();</p><p></p><p>                               // use a StringBuilder so that we can take advantage of the built-in formatter</p><p>                               StringBuilder results = new StringBuilder();</p><p>                               results.AppendFormat("Total records found: {0}", responseList.Count);</p><p></p><p>                               // Loop through our response records and print them to the results window</p><p>                               foreach (incidentTable.getRecordsResponseGetRecordsResult response in responseList)</p><p>                               {</p><p>                                       results.AppendFormat("\n{0}\t{1}\t{2}", </p><p>                                               response.number, </p><p>                                               response.severity, </p><p>                                               response.short_description.TrimEnd());</p><p>                               }</p><p></p><p>                               // Post the results for display</p><p>                               rtbResults.AppendText(results.ToString());</p><p>                       }</p><p>                       catch (Exception error)</p><p>                       {</p><p>                               // something bad happened!</p><p>                               rtbResults.AppendText(error.Message);</p><p>                       }</p><p>               }</p><p></p><p>               #region Initializers</p><p>               /// &lt;summary&gt;</p><p>               /// Method for initializing all of the Combo boxes on the form.</p><p>               /// &lt;/summary&gt;</p><p>               private void initializeCombos()</p><p>               {</p><p>                       // allow only values from the checkbox lists</p><p>                       cmbImpact.IsEditable = false;</p><p>                       cmbPriority.IsEditable = false;</p><p>                       cmbUrgency.IsEditable = false;</p><p>                       cmbState.IsEditable = false;</p><p></p><p>                       cmbImpact.Items.Clear();</p><p>                       cmbImpact.Items.Add(new ComboBoxItem("", ""));</p><p>                       cmbImpact.Items.Add(new ComboBoxItem("1", "High"));</p><p>                       cmbImpact.Items.Add(new ComboBoxItem("2", "Medium"));</p><p>                       cmbImpact.Items.Add(new ComboBoxItem("3", "Low"));</p><p></p><p>                       cmbPriority.Items.Clear();</p><p>                       cmbPriority.Items.Add(new ComboBoxItem("", ""));</p><p>                       cmbPriority.Items.Add(new ComboBoxItem("1", "High"));</p><p>                       cmbPriority.Items.Add(new ComboBoxItem("2", "Medium"));</p><p>                       cmbPriority.Items.Add(new ComboBoxItem("3", "Low"));</p><p></p><p>                       cmbUrgency.Items.Clear();</p><p>                       cmbUrgency.Items.Add(new ComboBoxItem("", ""));</p><p>                       cmbUrgency.Items.Add(new ComboBoxItem("1", "Critical"));</p><p>                       cmbUrgency.Items.Add(new ComboBoxItem("2", "High"));</p><p>                       cmbUrgency.Items.Add(new ComboBoxItem("3", "Medium"));</p><p>                       cmbUrgency.Items.Add(new ComboBoxItem("4", "Low"));</p><p>                       cmbUrgency.Items.Add(new ComboBoxItem("5", "Planning"));</p><p></p><p>                       cmbState.Items.Clear();</p><p>                       cmbState.Items.Add(new ComboBoxItem("", ""));</p><p>                       cmbState.Items.Add(new ComboBoxItem("1", "New"));</p><p>                       cmbState.Items.Add(new ComboBoxItem("2", "Active"));</p><p>                       cmbState.Items.Add(new ComboBoxItem("3", "Awaiting Problem"));</p><p>                       cmbState.Items.Add(new ComboBoxItem("4", "Awaiting User Info"));</p><p>                       cmbState.Items.Add(new ComboBoxItem("5", "Awaiting Evidence"));</p><p>                       cmbState.Items.Add(new ComboBoxItem("6", "Resolved"));</p><p>                       cmbState.Items.Add(new ComboBoxItem("7", "Closed"));</p><p></p><p>                       cmbUser.Items.Clear();</p><p>                       cmbUser.Items.Add(new ComboBoxItem("", ""));</p><p>                       cmbUser.Items.Add(new ComboBoxItem("46d44a23a9fe19810012d100cca80666", "Beth Anglin"));</p><p></p><p>               }</p><p></p><p>               /// &lt;summary&gt;</p><p>               /// Method for setting up the results box at program load.</p><p>               /// &lt;/summary&gt;</p><p>               private void initializeResults()</p><p>               {</p><p>                       // clear out the rich text box</p><p>                       rtbResults.Document.Blocks.Clear();</p><p></p><p>                       // make the scrollbar to be visible if results larger than display</p><p>                       rtbResults.VerticalScrollBarVisibility = ScrollBarVisibility.Auto;</p><p></p><p>                       // kill the pesky extra new lines style</p><p>                       Style noSpaceStyle = new Style(typeof(Paragraph));</p><p>                       noSpaceStyle.Setters.Add(new Setter(Paragraph.MarginProperty, new Thickness(0)));</p><p>                       rtbResults.Resources.Add(typeof(Paragraph), noSpaceStyle);</p><p>               }</p><p>               #endregion</p></pre><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">17. We are ready to test!   Navigate to Debug -&gt; Start Debugging.   This will run our application and display the form.</span></p><p></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">a.   Impact: High</span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">b.   State: Active</span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">c.   Make sure Active is checked (should be defaulted according to the code right?!)</span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">d. User: Beth Anglin</span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">e. The results should appear in the window on the form.</span></p><p style="padding-left: 30px; font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">18. Click on the Send Command button.   My results looked like this:</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;"><img   class="image-20 jive-image" src="75765102db90d7041dcaf3231f96194e.iix" style="width: auto; height: auto; display: block; margin-left: auto; margin-right: auto;"/></span></p><p></p><p style="padding-left: 30px;">NOTE: If you get nothing back then go over to your instance and see if there are any records you can retrieve using the above settings.</p><p></p><p><span style="color: #666666; font-weight: inherit; font-size: 16px; font-family: arial, sans-serif; font-style: inherit;">19. Finally always clean up your unused Usings (another best practice)!   See my previous article on how to do this.</span></p><p></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-size: 12pt; font-family: inherit; line-height: 1.5; font-style: inherit;">That's it!   You have now implemented a more complex form for limiting the results to be returned from ServiceNow!   Cool, huh?!   :-D</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;">Steven Bell</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: bold; font-style: inherit; font-size: 12pt; font-family: inherit; color: #800080;">If you find this article helps you, don't forget to log in and "like" it!</span></p><p style="font-family: arial, sans-serif; color: #666666;"></p><p style="font-family: arial, sans-serif; color: #666666;"><span style="font-weight: bold; font-style: inherit; font-size: 12pt; font-family: inherit; color: #800080;">Also, if you are not already, I would like to encourage you to become a member of our blog!</span></p>