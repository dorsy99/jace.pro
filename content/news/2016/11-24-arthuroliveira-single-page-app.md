---
title: "Single page app on Service Portal  Part   Unique URL deep linking"
date: 2016-11-24T01:58:52.000Z
authors: ["arthuroliveira"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=092e266ddbd0dbc01dcaf3231f9619f2"
---
<p dir="ltr" style="text-align: center;"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">"Deep linking consists of using a uniform resource identifier (URI) that links to a specific location within an app rather than simply launching the app."</span></p><p dir="ltr" style="margin-left: 144pt; text-align: right;"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">Wikipedia</span></p><p dir="ltr" style="margin-left: 72pt;"></p><p dir="ltr" style="margin-left: 72pt;"></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #ff0000; font-weight: bold;">DISCLAIMER </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">This functionality isn't officially supported by service portal. Use at your own risk.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">In this post we will continue from where we left off on </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Single page app on Service Portal   Part 1</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Ui Router supports url history out of the box by appending hashes to the url but unfortunately it isn't possible within service portal.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">For this demo we will implement our own workaround to accomplish the unique url functionality in our application by using get parameters (?) instead of hash (#).</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Let's get to it!   All the functionality will live inside the client script of helloworld-uiview widget defined on the blog post part 1, lets see where we left off.</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">function ($state,$location) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">       if ($location.path().indexOf('editor') != -1) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">               return;</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">       }</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">       $state.go('homepage');</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">}</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Let's start by loading all the parameters from the url, then removing $state.go('homepage') as we want to read from the url what state to load. Your code should look like this:</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">function ($state,$location) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">if ($location.path().indexOf('editor') != -1) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">return;</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">}</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">// returns an object with the url parameters </span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">var urlParams = $location.search();</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">// Check if we have a variable called state from the url, if there is we load that state passing all the parameters</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">if (urlParams.state) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">$state.go(urlParams.state, urlParams);</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">// If state isn't present in the parameters send user to default state</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">} else {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">$state.go('homepage');</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">}</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">}</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Lets save our widget and go to /helloworld?state=detail and you should see the detail view</span></p><p dir="ltr"><img  alt="pasted image 0.png" class="image-1 jive-image" src="2e2de0cedbd4dfc068c1fb651f9619cd.iix" style="width: auto; height: auto;"/></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">But if you click on </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">Go To Homepage View</span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;"> you are going to notice the url doesn't change. That's because we are not done yet. Let's go back to our uiview and add that functionality. </span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Next we are going to listen to a UI Router event called $</span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">stateChangeSuccess fired once the state transition is </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold; font-style: italic;">complete, </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">every time it happens we are going to check it new state is different than old state (this can be improved to support same state with different parameters) if its different we are going to append state to parameters, in case the state wasnt specified in the url, and we manipulate   the url with angular $location service</span></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">function ($state,$location,$rootScope) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">if ($location.path().indexOf('editor') != -1) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">return;</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">}</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">// returns an object with the url parameters </span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">var urlParams = $location.search();</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">// Check if we have a variable called state from the url, if there is we load that state passing all the parameters</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">if (urlParams.state) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">$state.go(urlParams.state, urlParams);</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">// If state isn't present in the parameters send user to default state</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">} else {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">$state.go('homepage');</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">   </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">}</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">       $rootScope.$on('$stateChangeSuccess',</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">               function (event, toState, toParams, fromState, fromParams) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">                       if (toState.name != fromState.name) {</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">                               toParams.state = toState.name;</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">                               $location.search(toParams);</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">                       }</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">               }</span></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">       );</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-style: italic;">}</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">IMPORTANT: </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Please be careful when choosing your state parameters as they can conflict with service portal . e.g. Never use </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000; font-weight: bold;">ID </span><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">as SP relies on to define what page to load   </span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Save, test your portal and Voilí ! </span></p><p dir="ltr"></p><p dir="ltr"><img  alt="gif-generated.gif" class="image-2 jive-image" src="47fd840adb101f048c8ef4621f9619c1.iix" style="width: 620px; height: 376px;"/></p><p dir="ltr"></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">NOTE: Your widget will reload every time the url changes (not 100% why other than $rootScope.$apply() being called somewhere else). There is a work around that, but this is topic for another time.</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Thank you</span></p><p dir="ltr"></p><p dir="ltr"><span style="font-size: 14.6667px; font-family: Arial; color: #000000;">Arthur Oliveira</span></p>