---
title: "Writing an AngularJS custom filter for Service Portal"
date: 2016-06-23T08:11:30.000Z
authors: ["Sush"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=269caee1dbd0dbc01dcaf3231f961940"
---
<p>Service Portal is the quick and flexible way to build an application portal that your employees will love. I have been playing with it a lot and thought I would share with you all few things I learned. This topic is targeted towards advanced users/web developers.</p><p></p><p>People who have worked with angular might have used the built in filters for formatting expression values like dates, currencies etc or limiting the number of items displayed and more. Most of the time these built-in filters will do the job for us, but sometimes in your application, you might have a need to create a custom angular filter.</p><p></p><p>With angular providers in Service Portal, we can create angular directives, services and factory that can be automatically injected into your client script controller.</p><p><img   alt="Screen Shot 2016-06-22 at 10.16.06 AM.png" class="image-1 jive-image" height="301" src="d7a0684edbdc9fc03eb27a9e0f961991.iix" style="width: 987px; height: 300.755px;" width="987"/></p><p>If you see the type dropdown above, it doesn't have the option to create a "filter". So you cannot use angular providers for creating filters.</p><p></p><p>I will walk you through the steps to create a custom filter that we can use on a list of Incidents.</p><p></p><ul><li><span style="color: #3d3d3d; font-size: 12pt;"><strong>Step 1: Create a portal or use an existing one.</strong></span></li></ul><p>                 If you have a portal you are already working with just use that or to create a sample one to play with.   Attaching a screenshot of my example portal.</p><p></p><p><img   alt="Screen Shot 2016-06-22 at 1.31.55 PM.png" class="image-2 jive-image" height="560" src="a7df7371db58d3041dcaf3231f9619a9.iix" style="width: 986px; height: 559.964px;" width="986"/></p><p></p><p></p><ul><li><span style="font-size: 16px; font-weight: bold;">Step 2: Create a Service Portal page and add that to your example portal.</span></li></ul><p><span style="font-size: 10pt;">                 For demo purpose, I am going to create a new page and call it homepagetest and add that to my portal I created in the previous step.<br/></span></p><p></p><p><span style="font-size: 10pt;"><img   alt="Screen Shot 2016-06-22 at 1.34.44 PM.png" class="image-3 jive-image" src="3d332506dbdc13043eb27a9e0f961924.iix" style="width: 620px; height: 307px;"/></span></p><p></p><ul><li><span style="font-weight: bold; font-size: 16px;">Step 3: Create a simple widget to get a list of incidents and displaying it.</span></li></ul><p><span style="font-size: 10pt;">                 Click on widgets under "Service Portal" application menu. Create a new widget by clicking on the new button.</span></p><p><span style="font-size: 10pt;">                   Below is the example widget i have created.</span></p><p><span style="font-weight: bold; font-size: 16px;"><img   alt="Screen Shot 2016-06-22 at 1.41.16 PM.png" class="image-4 jive-image" src="aa300dcadb909f048c8ef4621f9619bf.iix" style="width: 620px; height: 165px;"/></span></p><p></p><p>Please use the below snippets to create your widget</p><p><strong>HTML:</strong></p><p></p><p><span style="font-family: 'courier new', courier;">&lt;div class="container"&gt;</span></p><p><span style="font-family: 'courier new', courier;">&lt;!-- your widget template --&gt;</span></p><p><span style="font-family: 'courier new', courier;">   &lt;div class="col-md-12"&gt;</span></p><p><span style="font-family: 'courier new', courier;">   &lt;h3 style="display:inline-block;float:left;"&gt;Incident List&lt;/h3&gt;</span></p><p><span style="font-family: 'courier new', courier;">   &lt;div class="form-group" style="display:inline-block;float:right;margin-top: 10px;margin-bottom: 0px"&gt; </span></p><p><span style="font-family: 'courier new', courier;">       </span></p><p><span style="font-family: 'courier new', courier;">       &lt;div class="col-sm-12"&gt; &lt;input type="text" ng-model="filterValue" class="form-control"   placeholder="Search" style=""&gt; &lt;/div&gt; </span></p><p><span style="font-family: 'courier new', courier;">   &lt;/div&gt;</span></p><p><span style="font-family: 'courier new', courier;">   &lt;/div&gt; </span></p><p><span style="font-family: 'courier new', courier;">   &lt;div ng-repeat="incident in data.incidentList | startsFilter:filterValue" class="each-incident"&gt;</span></p><p><span style="font-family: 'courier new', courier;">       &lt;h4&gt;{{incident.number}}&lt;/h4&gt;</span></p><p><span style="font-family: 'courier new', courier;">       &lt;p style="margin-bottom:0px;"&gt;{{incident.short_desc}}&lt;/p&gt;</span></p><p><span style="font-family: 'courier new', courier;">   &lt;/div&gt;</span><span style="font-family: 'courier new', courier;"> </span></p><p><span style="font-family: 'courier new', courier;">&lt;/div&gt;</span></p><p></p><p></p><p><strong>CSS:</strong></p><p></p><p><span style="font-family: 'courier new', courier;">.each-incident{</span></p><p><span style="font-family: 'courier new', courier;">   display:flex;</span></p><p><span style="font-family: 'courier new', courier;">   justify-content:space-between;</span></p><p><span style="font-family: 'courier new', courier;">   align-items:center;</span></p><p><span style="font-family: 'courier new', courier;">   padding:10px;</span></p><p><span style="font-family: 'courier new', courier;">   border-top:1px solid #ddd;</span></p><p><span style="font-family: 'courier new', courier;">   clear:both;</span></p><p><span style="font-family: 'courier new', courier;">}</span></p><p></p><p><span style="font-weight: bold;">Server Script:</span></p><p></p><p><span style="font-family: 'courier new', courier;">(function() {</span></p><p><span style="font-family: 'courier new', courier;">   /* populate the 'data' object */</span></p><p><span style="font-family: 'courier new', courier;">   /* e.g., data.table = $sp.getValue('table'); */</span></p><p><span style="font-family: 'courier new', courier;">data.incidentList = [];</span></p><p><span style="font-family: 'courier new', courier;">var gr = new GlideRecord('incident');</span></p><p><span style="font-family: 'courier new', courier;">   gr.addQuery('active', true);</span></p><p><span style="font-family: 'courier new', courier;">   gr.query();</span></p><p><span style="font-family: 'courier new', courier;">   while(gr.next()){</span></p><p><span style="font-family: 'courier new', courier;">   var temp = {};</span></p><p><span style="font-family: 'courier new', courier;">   temp.number = gr.number.toString();</span></p><p><span style="font-family: 'courier new', courier;">   temp.short_desc = gr.short_description.toString();</span></p><p><span style="font-family: 'courier new', courier;">   data.incidentList.push(temp);</span></p><p><span style="font-family: 'courier new', courier;">   }</span></p><p><span style="font-family: 'courier new', courier;">})();</span></p><p></p><p>After populating your widget with above code, go ahead and save it.</p><p></p><ul><li><span style="font-size: 16px; font-weight: bold;">Step 4: Creating our filter and adding a dependency to our widget.</span></li></ul><p>               We will be coding our filter inside good old UI Scripts. So go ahead and create a new UI Script record.</p><p></p><p><img   alt="Screen Shot 2016-06-22 at 3.50.50 PM.png" class="image-5 jive-image" src="b5002c46db9057041dcaf3231f961987.iix" style="width: 620px; height: 183px;"/></p><p></p><p>Here is the filter code. copy and paste this into UI script.</p><p></p><p><span style="font-family: 'courier new', courier;">(function() {</span></p><p><span style="font-family: 'courier new', courier;">       angular.module('startsWithFilter', []).filter('startsFilter', function() {</span></p><p><span style="font-family: 'courier new', courier;">               return function(input, filtervalue) {</span></p><p><span style="font-family: 'courier new', courier;">                       if (filtervalue) {</span></p><p><span style="font-family: 'courier new', courier;">                               var output = [];</span></p><p><span style="font-family: 'courier new', courier;">                               for (var i = 0; i &lt; input.length; i++) {</span></p><p><span style="font-family: 'courier new', courier;">                                       if (input[i].short_desc.toLowerCase().substring(0, filtervalue.length) === filtervalue.toLowerCase()) {</span></p><p><span style="font-family: 'courier new', courier;">                                               output.push(input[i]);</span></p><p><span style="font-family: 'courier new', courier;">                                       }</span></p><p><span style="font-family: 'courier new', courier;">                               }</span></p><p><span style="font-family: 'courier new', courier;">                               return output;</span></p><p><span style="font-family: 'courier new', courier;">                       } else {</span></p><p><span style="font-family: 'courier new', courier;">                               return input;</span></p><p><span style="font-family: 'courier new', courier;">                       }</span></p><p><span style="font-family: 'courier new', courier;">               };</span></p><p><span style="font-family: 'courier new', courier;">       });</span></p><p><span style="font-family: 'courier new', courier;">})();</span></p><p></p><p>Now that we have the filter script ready let's add this as a dependency. Under "Service Portal" application menu there is a module called "Dependencies", go ahead and click on that. Once you are in, click new and fill in the form as below.</p><p></p><p><img   alt="Screen Shot 2016-06-22 at 4.00.21 PM.png" class="image-6 jive-image" height="172" src="7f0d7f7ddbd01304b322f4621f9619cf.iix" style="width: 792px; height: 172.452px;" width="792"/></p><p></p><p>Now we have to create a JS includes record and link the UI Script.</p><p></p><p><img   alt="Screen Shot 2016-06-22 at 4.04.48 PM.png" class="image-7 jive-image" height="190" src="c88d108edb9c9704ed6af3231f9619be.iix" style="width: 807px; height: 190.035px;" width="807"/></p><p></p><p>On JS Includes table click on new and create a record for our "startsWithFilter" and select the source as UI Scripts, the search box appears for you to select the UI Script, here please select "startsWithFilter" and hit save.</p><p><img   alt="Screen Shot 2016-06-22 at 4.07.29 PM.png" class="image-8 jive-image" height="178" src="8fb12331db5093049c9ffb651f9619ba.iix" style="width: 798px; height: 177.619px;" width="798"/></p><p></p><p>Now your widget dependency record is complete and it should look something like this.</p><p></p><p><img   alt="Screen Shot 2016-06-22 at 4.10.39 PM.png" class="image-9 jive-image" height="319" src="3324cdcadb5897041dcaf3231f961922.iix" style="width: 788px; height: 319.013px;" width="788"/></p><p></p><p>We now our filter script added to Dependencies list, next let's link this to our simple widget created in step 3. Open the widget record and scroll down to the section that says "Dependencies".</p><p>insert a new row and select the dependency we added above, save the widget record.</p><p><img   alt="Screen Shot 2016-06-22 at 4.15.54 PM.png" class="image-10 jive-image" height="351" src="ffb120cadb50d704ed6af3231f9619ef.iix" style="width: 766px; height: 350.877px;" width="766"/></p><p></p><ul><li><span style="font-size: 16px; font-weight: bold;">Step 5: Adding our widget to a Service Portal page.</span></li></ul><p>               The last and final step is to add the widget we created to a Service portal page using Service portal designer.</p><p><img   alt="Screen Shot 2016-06-22 at 4.22.33 PM.png" class="image-11 jive-image" src="53b4804adb58db048c8ef4621f9619f2.iix" style="width: auto; height: auto;"/></p><p></p><p>click on "Service portal configuration" which takes you to a new page with a list of options.</p><p></p><p><img   alt="Screen Shot 2016-06-22 at 4.22.47 PM.png" class="image-12 jive-image" src="a6c0effddb185b048c8ef4621f9619fa.iix" style="width: 620px; height: 237px;"/></p><p></p><p>Select designer, A new page opens up and u can see all the "Service portal pages", search for your page, in my case its "homepagetest"</p><p><img   alt="Screen Shot 2016-06-22 at 4.23.18 PM.png" class="image-13 jive-image" height="182" src="0a5f050edb14d304b322f4621f961922.iix" style="width: 790px; height: 182.21px;" width="790"/></p><p>Now in the page designer view drag and drop "Container" on the page followed by 12 column layout. On the left side you can see all the widgets available for us to use, we will just search for our widget we created in step 3 and drag and drop that into the 12 column layout. It should look something like this.</p><p><img   alt="Screen Shot 2016-06-22 at 4.32.18 PM.png" class="image-14 jive-image" height="135" src="7f87a086db509304b322f4621f961913.iix" style="width: 883px; height: 135.175px;" width="883"/></p><p></p><p>We have successfully added our new widget on the page. Now let's check out this widget in action. Click on "portals" under "Service Portal" Application menu. Select the portal we used for this tutorial and hit "try it" button at the bottom.</p><p></p><p>you should see your Incident List Widget with a search field on the top right. Just start typing and you can see our "startsWithFilter" doing its magic.</p><p></p><p><img   alt="startsWithFilter.gif" class="image-15 jive-image" src="47890ccadb981344e9737a9e0f9619f6.iix" style="width: 620px; height: 598px;"/></p><p></p><p>Sorry for the long blog, I wanted to make it as straightforward as possible for anyone with any level of expertise to follow this. Hope this helps.</p><p></p><p>Thanks,</p><p>Sush</p>