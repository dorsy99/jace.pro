---
title: "Adventures in Service Portaling Populate Catalog Variable Values through the URL"
date: 2016-11-04T18:55:04.000Z
authors: ["Brad Tilton"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=ec3eea6ddbd0dbc01dcaf3231f9619d6"
---
<p>There's a pretty common use case in ServiceNow that goes something like this: A new user is onboarded and some sort of automation kicks off an onboarding process in ServiceNow. As part of the process ServiceNow sends an email to the hiring manager with a url that points to an order guide or catalog item. In that URL you might have included some url parameters that will populate some of the variables to help the hiring manager out and also to reduce the possibility or errors. In order to accomplish this you would use an onLoad catalog client script on the order guide or catalog item you're loading. The script commonly looks something like this:</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14782664055556216" data-renderedposition="113_8_1175_256" jivemacro_uid="_14782664055556216"><p>function onLoad() {</p><p>       //Use the 'getParameterValue' function below to get the parameter values from the URL   </p><p>       var user = getParameterValue('sysparm_user');</p><p>       if (user) {</p><p>               g_form.setValue('user_variable', user);</p><p>       }</p><p>}</p><p></p><p>function getParameterValue(name) {</p><p>       var url = document.URL.parseQuery();</p><p>       if (url[name]) {</p><p>               return decodeURI(url[name]);</p><p>       } else {</p><p>               return;</p><p>       }</p><p>}</p></pre><p></p><p>This works really well and is documented in a few places including <a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=596dea29dbd0dbc01dcaf3231f96190b">one of my blog posts</a>. However, this script will not work when your order guide or catalog item is rendered within Service Portal. The reason is that Service Portal <a title="ithub.com/service-portal/documentation/blob/master/documentation/client_scripting.md" href="https://github.com/service-portal/documentation/blob/master/documentation/client_scripting.md">blocks a number of javascript global objects from running within client scripts</a> including document and prototype which are both used in line 11.</p><p></p><p>So what do you do if you want to use url parameters to populate values into catalog artifacts in the Service Portal? I recently discovered that the <a title="eveloper.mozilla.org/en-US/docs/Web/API/Window/top" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/top">top object</a> is not blocked, so I tried modifying this script a bit and it seems to work. I will admit that this method is more of a workaround/hack, but it's the only way I've been able to populate a variable from the url through the Service Portal so far.</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_1478267296066281 jive_text_macro" data-renderedposition="558_8_1175_304" jivemacro_uid="_1478267296066281"><p>function onLoad() {</p><p>       //Use the 'getParameterValue' function below to get the parameter values from the URL   </p><p>       var user = getParameterValue('sysparm_user');</p><p>       if (user) {</p><p>               g_form.setValue('user_variable', user);</p><p>       }</p><p>}</p><p></p><p>function getParameterValue(name) {</p><p>       name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");</p><p>       var regexS = "[\\?&amp;]" + name + "=([^&amp;#]*)";</p><p>       var regex = new RegExp(regexS);</p><p>       var results = regex.exec(top.location);</p><p>       if (results == null) {</p><p>               return "";</p><p>       } else {</p><p>               return unescape(results[1]);</p><p>       }</p><p>}</p></pre><p></p><p>So in this case if your url included &amp;sysparm_user=Brad at the end then the value 'Brad' would be populated into the user_variable variable. Something to note is that this code snippet should be used within a client script or catalog client script on a form you're rendering through the Service Portal. If you're working within a widget and want to use a url parameter you would want to use angular's <a title="ocs.angularjs.org/guide/$location" href="https://docs.angularjs.org/guide/$location">$location service</a>.</p><p></p><p>Feel free to leave any feedback, and if anyone has a better way to do this please let us know in the comments.</p>