---
title: "Request item error when adding a new variable or UI Policy"
date: 2016-09-02T04:38:32.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=9cfd622ddbd0dbc01dcaf3231f9619fd"
---
<p>For many of you, Service Catalog is a critical feature. You spend a lot of time adding and editing Service Catalog items to provide your users with the right service and product choices. While maintaining items, you may frequently edit <a title="ocs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/concept/c_ServiceCatalogVariables.html" href="https://docs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/concept/c_ServiceCatalogVariables.html" style="line-height: 1.5;">variables</a><span style="line-height: 1.5;"> and catalog <a title="ocs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/task/t_CreatUIPolicyForSvcCalgIt.html" href="https://docs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/task/t_CreatUIPolicyForSvcCalgIt.html">UI policies</a> on your items.</span></p><p></p><p><span style="line-height: 1.5;">Variables enable you to offer users choices when they order catalog items. In the example below, the Report Performance Problem catalog item contains three variables that enable your users to specify an application, describe the slowdown, and list particular transactions that are slow:</span></p><p style="text-align: center;"><img   alt="service_catalog_UI_policy1.gif" class="image-5 jive-image" src="a1ad40cadbd017041dcaf3231f9619ae.iix" style="width: 620px; height: 326px;"/></p><p></p><p><span style="line-height: 1.5;">UI policies give you a mechanism for dynamically changing information on a form with having to use client scripts. In the example below (using the Report Performance Problem catalog item again), if users describe the nature of the slowdown as <strong>All operations within the application are slow</strong>, a UI Policy removes the text box for describing the particular transactions that are slow:</span></p><p></p><p style="text-align: center;"><img   alt="service_catalog_UI_policy2.gif" class="image-6 jive-image" src="96697f7ddb545704ed6af3231f961901.iix" style="width: 620px; height: 271px;"/></p><p></p><h2>Cannot update existing request item records</h2><p>In some versions of ServiceNow, users are experiencing an issue after they add a new variable or UI policy to an existing catalog item that has outstanding requests. If a fulfiller opens one of the existing request item records, the following error appears:</p><p></p><p><span style="font-family: 'courier new', courier;">TypeError: g_form.getAppliedFieldName is not a function</span></p><p></p><p><span style="font-family: 'courier new', courier;">Uncaught TypeError: g_form.getAppliedFieldName is not a function</span></p><p><span style="font-family: 'courier new', courier;">GlideFieldPolicy._debugAction @ ui_policy.jsx?v=04-09-2016_1519:722</span></p><p><span style="font-family: 'courier new', courier;">GlideFieldPolicy._runAction @ ui_policy.jsx?v=04-09-2016_1519:619</span></p><p><span style="font-family: 'courier new', courier;">GlideFieldPolicy.runActions @ ui_policy.jsx?v=04-09-2016_1519:577</span></p><p><span style="font-family: 'courier new', courier;">GlideFieldPolicy.runPolicy @ ui_policy.jsx?v=04-09-2016_1519:37</span></p><p><span style="font-family: 'courier new', courier;">GlideFieldPolicy.runPolicyOnLoad @ ui_policy.jsx?v=04-09-2016_1519:32</span></p><p><span style="font-family: 'courier new', courier;">ui_policy_onLoad @ ui_policy.jsx?v=04-09-2016_1519:741</span></p><p><span style="font-family: 'courier new', courier;">runBeforeRender @ js_includes_doctype.jsx?v=04-09-2016_1519&amp;lp=Tue_May_24_10_48_15_PDT_2016&amp;c=4_62:404</span></p><p><span style="font-family: 'courier new', courier;">(anonymous function) @ z_last_include.js:10</span></p><p><span style="font-family: 'courier new', courier;">(anonymous function) @ z_last_include.js:16</span></p><p></p><p>Broken references to variables in the catalog UI policies are causing the problem. The system does not know about new variables added to the item. Answers to the variables are inserted into the sc_item_option table during the ordering process, but the sc_item_option table does not have an entry for the new variables.</p><p><img   alt="service_catalog_UI_policy3.gif" class="image-7 jive-image" src="343bd54edb1c1b04ed6af3231f961933.iix" style="width: 620px; height: 337px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p>Also, UI policies are defined on the item level and run on req-item, so the system does not know:</p><ul><li>how to render the new variable on req-item and task form</li><li>that a particular UI policy should not be loaded</li></ul><h2></h2><p>There is no workaround for this issue, so upgrading to one of the versions where the issue is fixed is your best bet. For the most current information about versions in which this issue has been seen and has been fixed, view the known error article associated with the problem: <a title="i.service-now.com/kb_view.do?sysparm_article=KB0596179" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0596179" style="font-family: arial, sans-serif;">KB0596179 - Catalog UI policy on a new variable on a catalog item causes error on existing request items without the new variable</a>. You can subscribe to the known error article and be automatically notified when there are changes (such as the addition of new "fixed in" versions) by clicking the <strong>Subscribe</strong> button in the upper right corner of the article.</p><p></p><p>To help you find the broken references, we can offer the following script. This script finds the broken variable references and prints out the URL for the catalog ui policy actions that have broken references.</p><p></p><p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px;"><span style="font-family: 'courier new', courier;">function findBrokenPolicies() {</span></p><p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px;"><span style="font-family: 'courier new', courier;"> </span><br/><span style="font-family: 'courier new', courier;">       var cupaIDStr = "";</span></p><p></p><p><span style="font-family: 'courier new', courier;">       var gr = new GlideRecord('catalog_ui_policy_action');</span><br/><span style="font-family: 'courier new', courier;">       gr.addActiveQuery();</span><br/><span style="font-family: 'courier new', courier;">       gr.query();   //Query the entire list of catalog UI Policy Actions to find the catalog_variable value</span></p><p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px;"><span style="font-family: 'courier new', courier;">       while (gr.next()) {</span></p><p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px;"><span style="font-family: 'courier new', courier;">               var cv = gr.catalog_variable.getDisplayValue();</span><br/><span style="font-family: 'courier new', courier;">               var sID = cv.split('IO:')[1];   // Remove the IO: from the value in the catalog_variable IE: IO:d4892e556f081d00362401dfde3ee496 </span><br/><span style="font-family: 'courier new', courier;">               var upaName = gr.sys_name;</span><br/><span style="font-family: 'courier new', courier;">               var upaID = gr.sys_id; </span><br/><span style="font-family: 'courier new', courier;">               var gr2 = new GlideRecord('item_option_new');</span><br/><span style="font-family: 'courier new', courier;">               gr2.addActiveQuery();</span></p><p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px;"><span style="font-family: 'courier new', courier;">               if (!gr2.get(sID)) {</span><br/><span style="font-family: 'courier new', courier;">                       cupaIDStr += upaID + ","; // If the queried record does not exist, we add it to the cupaIDStr (cupa = Catalog UI Policy Action)</span><br/><span style="font-family: 'courier new', courier;">               }</span></p><p></p><p><span style="font-family: 'courier new', courier;">               gr2 = new GlideRecord('sc_item_option_mtom');</span><br/><span style="font-family: 'courier new', courier;">               gr2.addQuery('sc_item_option.item_option_new.sys_id', sID);</span><br/><span style="font-family: 'courier new', courier;">               gr2.query();</span></p><p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px;"><span style="font-family: 'courier new', courier;">               if (!gr2.next()) {</span><br/><span style="font-family: 'courier new', courier;">                       cupaIDStr += upaID + ","; // If the queried record does not exist, we add it to the cupaIDStr (cupa = Catalog UI Policy Action)</span><br/><span style="font-family: 'courier new', courier;">               }</span></p><p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px;"><span style="font-family: 'courier new', courier;">       }</span><br/><span style="font-family: 'courier new', courier;"> </span><br/><span style="font-family: 'courier new', courier;">       var cupaIDList = cupaIDStr.substring(0, cupaIDStr.length - 1);     </span></p><p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px;"><span style="font-family: 'courier new', courier;">       // If a match is found, we print out the URL, else we print out no matches found</span></p><p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px;"><span style="font-family: 'courier new', courier;">       if (cupaIDList.length &gt; 0) {</span><br/><span style="font-family: 'courier new', courier;">               gs.print("Catalog UI Policy Actions with broken references can be found in the following location: ");</span><br/><span style="font-family: 'courier new', courier;">               var cupaURL = "/catalog_ui_policy_action_list.do?sysparm_query=sys_idIN" + cupaIDList + "&amp;sysparm_first_row=1&amp;sysparm_view=";</span><br/><span style="font-family: 'courier new', courier;">               gs.print(cupaURL);</span><br/><span style="font-family: 'courier new', courier;">       } else {</span></p><p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px;"><span style="font-family: 'courier new', courier;">               gs.print("No matches found in the Catalog UI Policy Actions table"); </span><br/><span style="font-family: 'courier new', courier;">       }</span><br/><span style="font-family: 'courier new', courier;">}</span></p><p></p><p></p><p><span style="font-size: 20px; font-weight: bold; line-height: 1.5;">Additional information</span></p><p>The ServiceNow Community contains several discussions about this Service Catalog issue:</p><ul><li><a __default_attr="33222" __jive_macro_name="user" class="jive_macro jive_macro_user" data-orig-content="jeetendravazirani" data-renderedposition="2615.610595703125_37.99715805053711_125_16" href="/community?id=community_user_profile&user=a731daa5db981fc09c9ffb651f96198a" modifiedtitle="true" title="jeetendravazirani">jeetendravazirani</a> <a title="" _jive_internal="true" href="/community?id=community_question&sys_id=ef6ff6a9db58dbc01dcaf3231f96193e">ran into the issue</a> and received advice from <a title="shouvik" __default_attr="35600" __jive_macro_name="user" class="jive_macro jive_macro_user" data-orig-content="shouvik" data-renderedposition="2615.610595703125_438.88250732421875_67_16" href="/community?id=community_user_profile&user=d0121ee1dbd81fc09c9ffb651f9619e5">shouvik</a> and <a title="ctomasi" __default_attr="2218" __jive_macro_name="user" class="jive_macro jive_macro_user" data-orig-content="ctomasi" data-renderedposition="2615.610595703125_536.4302368164062_68_16" href="/community?id=community_user_profile&user=7ae05a61db981fc09c9ffb651f9619a2">ctomasi</a></li><li><a title="johannes" __default_attr="32686" __jive_macro_name="user" class="jive_macro jive_macro_user" data-orig-content="johannes" data-renderedposition="2638.408935546875_37.99715805053711_75_16" href="/community?id=community_user_profile&user=422f8e25db181fc09c9ffb651f9619b1">johannes</a> <a title="" _jive_internal="true" href="/community?id=community_question&sys_id=af81536ddbdcdbc01dcaf3231f9619c8">faced the problem</a> after ugrading to Helsinki</li></ul><p></p><p>General information about Service Catalog variables and UI policies is available in the product documentation:</p><ul><li><a title="ocs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/concept/c_IntroductionToCatalogItems.html" href="https://docs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/concept/c_IntroductionToCatalogItems.html">Service catalog items</a></li><li><a title="ocs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/concept/c_ServiceCatalogVariables.html" href="https://docs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/concept/c_ServiceCatalogVariables.html">Service catalog variables</a></li><li><a title="ocs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/concept/c_ServiceCatalogUIPolicy.html" href="https://docs.servicenow.com/bundle/helsinki-it-service-management/page/product/service-catalog-management/concept/c_ServiceCatalogUIPolicy.html">Service catalog UI policy</a></li></ul>