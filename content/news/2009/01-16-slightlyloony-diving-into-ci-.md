---
title: "Diving Into CI Relationships"
date: 2009-01-15T21:42:57.000Z
authors: ["SlightlyLoony"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=34edeae9dbd0dbc01dcaf3231f9619ad"
---
<p><img  alt="" class="jive-image" src="2cd38c86db941344e9737a9e0f9619bb.iix" style="width: auto; height: 222px;" />The other day I was on the phone with a customer who wanted to write a business rule that understood CI relationships. In particular, he was trying to make a business rule that could tell if a CI had a "used by" relationship with a particular business service. He thought it would be easy, but he couldn't figure out how in the world the CI knew about the relationship with the business service. He could see it on the screen, but couldn't find a reference to the business service anywhere, in any field in the CI. Here's how we do it:<!--break--><br /><br />The "trick" is an old and venerable one that goes by many names. We call it a <i>many-to-many table</i>, but the notion is also known as a <i>join table</i>, a <i>connector table</i>, and it goes by various other names as well. For CI relationships, the table is named <b>cmdb_rel_ci</b>, and it contains three very useful fields:<ul><li><b>parent</b>: a CI reference to the parent CI (the one on the left side of the relationship)</li><li><b>child</b>: a CI reference to the child CI (the one on the right side of the relationship)</li><li><b>type</b>: a reference to an entry in the cmdb_rel_type table, which you can see at <b>Configuration â†’ CI Relation Types</b></li></ul><br /><br />The <b>cmdb_rel_type</b> table has two fields of primary interest:<ul><li><b>parent_descriptor</b>: The English description of the relationship from the parent CI's perspective, such as "depends on".</li><li><b>child_descriptor</b>: The English description of the relationhsip from the child CI's perspective, such as "used by".</li></ul><br /><br />For my caller's case, he just needed to look for records in cmdb_rel_ci where the parent field pointed to the right business service, the child field pointed to the CI the business rule was on, and the type field pointed to the cmdb_rel_type entry for a <i>depends on::used by</i> relationship. That turned about to be about five lines of Javascript, once he understood how to do it...</p>