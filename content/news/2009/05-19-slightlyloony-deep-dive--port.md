---
title: "Deep Dive Port Scanning"
date: 2009-05-18T19:41:44.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=47fda62ddbd0dbc01dcaf3231f9619ab"
---
<p><img  alt="" class="jive-image" src="52733b35db505704ed6af3231f9619af.iix" style="width: auto; height: 186px;" />Shazzam is a feature we added to Discovery a few months ago. It uses <i>port scanning</i> (amongst other things) to find devices on the network. At Knowledge09 (our recent user conference), several people asked me exactly what port scanning actually was. Well, it's like this...<br /><br />Wikipedia has a fairly good <a title=".wikipedia.org/wiki/Port_scanning" href="http://en.wikipedia.org/wiki/Port_scanning">discussion of port scanning</a>, and it has pointers to more technical articles if you're interested in the gory details. <br /><br />For TCP ports, Discovery uses the "TCP scan" technique — it simply tries to establish a connection on the port that it's testing. There are three possible outcomes: success, an error, or a timeout. On success, Discovery knows it has a device at that IP address, and that the port it tested is open. On an error, Discovery knows there's a device at that IP address (otherwise there wouldn't be an error!), and that the port it tested is <i>not</i> open. On a timeout, Discovery has a slightly more ambiguous situation — maybe there's no device at that address, or maybe a firewall is simply dropping connection attemtps. Generally Disocvery is testing several ports on each device, so it will only figure there is no device at a particular IP address if <i>all</i> ports report a timeout.<br /><br />For UDP ports, Discovery actually performs a query and looks for a valid response. For example, for SNMP (port 161), it will send a query to read the value of the <tt>sysDescr</tt> OID, and it will only report the port as open if that query succeeds.<br /><br />What makes port scanning especially useful for finding lots of devices on a network is <i>speed</i>. Discovery uses a Java technology called "<a title=".wikipedia.org/wiki/New_I/O" href="http://en.wikipedia.org/wiki/New_I/O">NIO</a>" that is especially efficient when testing large numbers of IP addresses and ports.</p>