---
title: "Ports of No Joy"
date: 2009-05-27T21:04:52.000Z
authors: ["SlightlyLoony"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=917dee29dbd0dbc01dcaf3231f961927"
---
<p><img  alt="" class="jive-image" src="875aaff1dbd09b048c8ef4621f9619df.iix" style="width: auto; height: 100px;" />In some of your discoveries, you may have noticed something that seems quite strange: while exploring a Linux server, a printer, or a Unix server, Discovery's logs tell you that "WMI Authentication failed" — and yet, the discovery worked just fine. Huh? What kind of a stupid discovery program would look for WMI on a printer, anyway?<br /><br />This will probably make more sense if you understand what's going on "under the hood"...<!--break--><br /><br />Once Discovery determines there's a device at a particular IP address, the next thing it does is to look for certain open ports (i.e., ports that the target device is listening to). If Discovery finds that port 22 is open, that's a pretty good indication that the target device will accept SSH connections (because port 22 is the <i><a title="w.iana.org/assignments/port-numbers" href="http://www.iana.org/assignments/port-numbers">well-known</a></i> port for SSH) — and Discovery will launch an <i>UNIX - Classify</i> probe to find out what kind of UNIX box the target is (because usually a device listening to SSH is a UNIX box). If it finds ports 139 and 445 open, then the target device is likely a Windows machine, and Discovery will launch a <i>Windows - Classify</i> probe to find out what sort of Windows box it is.<br /><br />However, it's not <i>certain</i> that just because port 22 is open, the target device is a UNIX box. For example, it is possible (with third-party software) to enable SSH access to a Windows box. In this case, the <i>UNIX - Classify</i> probe would fail, either because of an authentication error (if Discovery didn't have credentials for the Windows box) or because the UNIX command <i>uname</i> is missing. Similarly, just because ports 139 and 445 are open it's not <i>certain</i> that the target device is a Windows box. For example, some printers emulate Windows printing services and this causes those two ports to be open on the printer — and it's fairly common for Linux boxes to run SAMBA, which emulates a host of Windows services and also opens ports 139 and 445. In these cases, the <i>Windows - Classify</i> probe will get an error because it can't open a WMI connection (printers and Linux boxes don't support WMI). <br /><br />So...it's not completely stupid that these errors show up. From Discovery's perspective, a Linux box running SAMBA looks exactly like a Windows server it doesn't have credentials for — so Discovery just tells you what it knows for sure, and carries on. Usually when one of these errors shows up, Discovery will succeed with a different probe. For example, on that Linux box running SAMBA, presumably Discovery would be able to explore the device through SSH — so despite the error, the discovery actually works just fine. Because it's fairly unusual to have SSH running on Windows boxes, and fairly common to have SAMBA or Windows printing services emulation, the most common example of this sort of error shows up as the WMI connection problem...</p>