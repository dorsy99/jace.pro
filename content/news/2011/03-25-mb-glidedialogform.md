---
title: "GlideDialogForm Popup has a CallBack"
date: 2011-03-24T05:15:19.000Z
authors: ["MB"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=086c6aa1dbd0dbc01dcaf3231f9619eb"
---
<p><div style="background: none repeat scroll 0 0 #FFFBFB;border: 2px solid #980000 ;margin: 25px 0 10px;padding: 0px 5px 5px 10px;position: relative;color:#D0583F"><br /> <span><b>Geek Speak</b><br />I am sure that those who read this blog title, will know instantly that this is pure "Geek Speak". But if you can appreciate this title, you will probably like this example.</span><br /></div><br /> <br /><b>Use Case:</b><br />I had a scenario recently where someone wanted to maintain user records for each of their external clients that call in. They however did not have a definitive list of who all of those people were. So we had to utilize a "populate as you go" type methodology. When a person called in, if they are not in the system, a user account would be created and associated with the record quickly, and without leaving the form. Reference fields, like the "Caller" field have a lookup popup that could allow me to click the "New" button and create a user record. However I wanted to customize a specific view for these type of users.<br /><br />In Service-Now there are many different types of popups that you can utilize on your form. The one that I decided to use is called a "GlideDialogForm". This is a popup that loads a form, in my case a user form. You can specify a specific view to display, which makes it very nice for customization purposes. I saw on some forums how you can pass values INTO the popup form, but I needed to RETURN the record created to my original form and populate the field, again without leaving the form. Thus my conundrum.<br /><br />I saw a handful of forum posts like...<br /><a title="44687" href="/community?id=community_question&sys_id=1b3f3a69db58dbc01dcaf3231f9619a3">How do I create (Ajax Style ??) Pop-up's</a><br />This one explains how to pass values INTO the popup form.<br /><a title="47086" href="/community?id=community_question&sys_id=322fb269db58dbc01dcaf3231f961923">Pass values when calling a GlideDialogForm with a UI Action</a><br /><br />And one on Servicenowguru.com explaining a concept of "QuickForms". There are so many different applications for this technique.<br />http://www.servicenowguru.com/system-ui/glidedialogwindow-quickforms/<br /><br />But again, how to return the newly created record to my current form without leaving or refreshing the form.<br /><br /><br /><div style="background: none repeat scroll 0 0 #F6FBFB;border: 2px solid #C9D5D8 ;margin: 25px 0 10px;padding: 0px 5px 5px 10px;position: relative;color:#55A0B4"><br /><span style="background: none repeat scroll 0 0 #white;color: #505050;display: block;font-size: 120%;font-weight: bold;padding: 3px 8px;position: absolute;">Method - Here is how I did it.</span><br /><i>I found that the "GlideDialogForm" has a callback capability.</i> As in this example of create a new GlideDialogForm object, you would normally put in the window title and table as parameters, but you can thirdly add in a callback function.<br /><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br />var dialog = new GlideDialogForm('User Management', 'sys_user', dothis);</pre><br /><br />By default this callback function will contain, as standard returned parameters....<br /><br /><div style="background: none repeat scroll 0 0 #FAFCFD;border: 2px solid #C7CDDA ;margin: 25px 0 10px;padding: 0px 5px 5px 10px;position: relative;color:#6187B3"><br /> <span><b><i>callbackFunc(action_verb, sys_id, table, displayValue)</i></b>.</span><br /></div><br /><br /><br />This made it perfect for me. The callback included the sys_id of the newly created record which I could then insert into the caller field. Seamless method to accomplish my goal.<br /></div><br /><br /><div style="background: none repeat scroll 0 0 #F6FBFB;border: 2px solid #C9D5D8 ;margin: 25px 0 10px;padding: 0px 5px 5px 10px;position: relative;color:#55A0B4"><br /><span style="background: none repeat scroll 0 0 #white;color: #505050;display: block;font-size: 120%;font-weight: bold;padding: 3px 8px;position: absolute;">Results - here is how it looks and the code used.</span><br />I created an icon next to the caller field that would display if this field is not populated via a client script (see it below). This icon would then popup a dialog window with the user creation form with the view I wanted.<br /><br /> Here is what the caller field with the icon looks like.<br /><br /><img  alt="" class="jive-image" src="20bbd406db1c9fc068c1fb651f9619f5.iix" /><br /><br /><br />Here is what the popup would look like. This screenshot does not display the view that I had created, but you can get the idea. Create whatever view on the user form to display in here.<br /><br /><img  alt="" class="jive-image" src="014af086db109f048c8ef4621f9619c4.iix" /><br /><br />Once you submit the form, it then populates the caller field like so.<br /><img  alt="" class="jive-image" src="e9f1b335db105704ed6af3231f96198f.iix" /><br /><br /></div><br />To bring this all together, create an onLoad client script with the following code. <br /><br />I also added in a variable "edit" which if true, this same icon will appear even if the field is populated. The popup will open the user record to make any edits you desire.<br /><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />function onLoad() {<br />var field = 'caller_id';<br />var table = g_form.getTableName();<br />var edit = 'false'; //If true, the icon will appear if the field is populated so you can edit the selected user account.<br /><br />var lookupfield = 'lookup.' + table + '.' + field;<br />var usericon = $(lookupfield);<br />var fieldvalue = g_form.getValue(field);<br />var fieldid = -1;<br /><br />if (usericon){<br />if (edit == 'true'){<br />if (fieldvalue != ''){<br />fieldid = fieldvalue;<br />}<br />usericon.insert({<br />after:'&lt;a id="AddUserPopup"&gt;&lt;img width="16" height="16" border="0" src="images/icons/user_licensed.gif" title="Add User Popup"&gt;&lt;/a&gt;'});<br /><br />var userpop = $('AddUserPopup');<br />userpop.observe('click', function() { userPopup(fieldid); });<br />}<br />else {<br /><br />if (fieldvalue == ''){<br />usericon.insert({<br />after:'&lt;a id="AddUserPopup"&gt;&lt;img width="16" height="16" border="0" src="images/icons/user_licensed.gif" title="Add User Popup"&gt;&lt;/a&gt;'});<br /><br />var userpop = $('AddUserPopup');<br />userpop.observe('click', function() { userPopup(fieldid); });<br />}<br />}<br />}<br />}<br /><br />function userPopup(fieldid) {<br />var dialog = new GlideDialogForm('User Management', 'sys_user', dothis);<br />dialog.setTitle("User Management");<br />dialog.setSysID(fieldid); //pass in sys_id to edit existing record<br />dialog.addParm('sysparm_view', 'default'); //Specify a view you have created<br />dialog.addParm('sysparm_form_only', 'true');<br />dialog.render();<br />}<br /><br />//this is my callback function.  All I am doing is taking the sys_id and using the setValue to place it in the caller_id field.<br />function dothis(action, sys_id, table, displayValue) {<br />g_form.setValue('caller_id', sys_id);<br />}<br /></pre><br /><br />Enjoy!<br />&lt;script&gt;&lt;/script&gt;<br /> var _gaq = _gaq || [];<br /> _gaq.push(['_setAccount', 'UA-22945975-1']);<br /> _gaq.push(['_trackPageview']);<br /><br /> (function() {<br /> var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;<br /> ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';<br /> var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);<br /> })();<br /><br /></p>