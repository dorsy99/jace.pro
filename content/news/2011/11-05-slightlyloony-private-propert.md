---
title: "Private Property Keep Out"
date: 2011-11-04T15:56:44.000Z
authors: ["SlightlyLoony"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=1dfde22ddbd0dbc01dcaf3231f961917"
---
<p>Many object-oriented programming languages (Java and C++, for example) have the notion of <em>private</em> members: properties and methods that can only be seen, modified, and used from <em>inside</em> an object. The JavaScript language has no such feature. When you define a JavaScript class, all the methods and properties of that class are exposed. Your class has no clothes — everything about it is visible to any code that's using it.</p><p></p><p>But just because the JavaScript language doesn't have the notion of privacy doesn't mean you can't have it...</p><p></p><p>For example, if I were building a simple class to tally up the number of characters in a series of strings, I might do something like this:</p><pre style="margin-left: 20px; line-height: 1; color: firebrick;"><br/>function Test() {<br/>       this.count = 0;<br/>}<br/><br/>Test.prototype.logger = function(x) {<br/>       gs.log(x);<br/>}<br/><br/>Test.prototype.tally =   function(x) {<br/>       this.logger('Tally ho!');<br/>       if (x)<br/>               this.count += x.toString().length;<br/>}<br/><br/>Test.prototype.getCount = function() {<br/>       this.logger('Take that!');<br/>       return this.count;<br/>}<br/><br/>var x = new Test();<br/>JSUtil.logObject(x);<br/><br/>x.tally("Is my dog smarter than yon cabbage?");<br/>x.tally("We'll never know, 'cause he just ate the cabbage.");<br/>gs.log(x.getCount());</pre><p><br/>When I run this code, here's what I get:</p><pre style="margin-left: 20px; line-height: 1; color: firebrick;"><br/>Log Object<br/>   Object<br/>       count: number = 0<br/>       logger: function<br/>       tally: function<br/>       getCount: function<br/>Tally ho!<br/>Tally ho!<br/>Take that!<br/>84</pre><p><br/>The <span style="font-family=courier;color: FireBrick;">count</span> property and the <span style="font-family=courier;color: FireBrick;">logger()</span> method are there for any code to see — and to modify. Why does that matter? Well, a truly malicious programmer could tally up a bunch of strings, then change the <span style="font-family=courier;color: FireBrick;">count</span> value to whatever he wanted it to be. That probably doesn't matter too much with a count like this, but if that value represented money you might care a little more. But it's really not intentionally malicious programmers that one wants to defend against — it's the <em>accidental</em> and generally innocent changes that you want your classes to be impervious to.</p><p></p><p>So in this case, I'd really like the <span style="font-family=courier;color: FireBrick;">count</span> property and the <span style="font-family=courier;color: FireBrick;">logger()</span> method to be <em>private</em> — entirely off-limits and invisible to any code using an instance of my <span style="font-family=courier;color: FireBrick;">Test</span> class. Another feature of JavaScript (<a title=".wikipedia.org/wiki/Closure_%28computer_science%29" href="http://en.wikipedia.org/wiki/Closure_%28computer_science%29">closures</a>) lets me do it. Here's one way:</p><pre style="margin-left: 20px; line-height: 1; color: firebrick;"><br/>function Test() {<br/>       var count = 0;<br/><br/>       function logger(x) {<br/>               gs.log(x);<br/>       }<br/><br/>       this.tally = function(x) {<br/>               logger('Tally ho!');<br/>               if (x)<br/>                       count += x.toString().length;<br/>       }<br/><br/>       this.getCount = function() {<br/>               logger('Take that!');<br/>               return count;<br/>       }<br/>}<br/><br/>var x = new Test();<br/>JSUtil.logObject(x);<br/><br/>x.tally("Is my dog smarter than yon cabbage?");<br/>x.tally("We'll never know, 'cause he just ate the cabbage.");<br/>gs.log(x.getCount());</pre><p><br/>When I run this privatized code, I get:</p><pre style="margin-left: 20px; line-height: 1; color: firebrick;"><br/>Log Object<br/>   Object<br/>       tally: function<br/>       getCount: function<br/>Tally ho!<br/>Tally ho!<br/>Take that!<br/>84</pre><p><br/>That looks exactly like the preceding code, with one exception: the <span style="font-family=courier;color: FireBrick;">count</span> property and the <span style="font-family=courier;color: FireBrick;">logger()</span> method are completely missing from the object. They're invisible. They're private. Your code can't see them and can't change them.</p><p></p><p>How does this work?</p><p></p><p>There are two parts to the change I made. First, instead of relying on the <span style="font-family=courier;color: FireBrick;">prototype</span> property to initialize the methods for my instance, I'm doing it directly in the constructor function (with the assignments to <span style="font-family=courier;color: FireBrick;">this.tally</span> and <span style="font-family=courier;color: FireBrick;">this.getCount</span>). Each of those properties has a function assigned to it.</p><p></p><p>Secondly, if you look at the bodies of those functions, you'll see that they refer to properties of the <em>enclosing</em> function (the constructor function itself). For example, each function refers to the <span style="font-family=courier;color: FireBrick;">count</span> variable, which is defined in the enclosing constructor function. Because those two functions I'm assigning as properties are nested inside the constructor function, the constructor function and all it's properties are part of the <em>scope chain</em> for them. Here's where the little magic bit of closures comes in: when I assign that function to a property, the scope chain comes along with it — but it's hidden from view, and utterly inaccessible from outside the scope chain.</p><p></p><p>If you're not practiced in the art of closures, this can be a challenge to wrap your brain around. In many programming languages, there simply is no equivalent of this. The closures feature is quite a powerful one, useful for many things — and private properties in a class are a great example. It's another tool that's worth learning well...</p>