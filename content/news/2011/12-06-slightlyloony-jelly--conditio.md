---
title: "Jelly Conditional Love"
date: 2011-12-05T22:11:46.000Z
authors: ["SlightlyLoony"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=15bd2aa9dbd0dbc01dcaf3231f9619ff"
---
<p><span class="asset-asset_lightbox-Small asset-align-right"><a href="/files/SlightlyLoony/jelly-face3.JPG" rel="lightbox"><img rel="lightbox" src="http://community.service-now.com/files/imagecache/Small/SlightlyLoony/jelly-face3.JPG" alt="" title="" class="imagecache imagecache-Small" /></a></span>The ServiceNow platform renders HTML based on data it retrieves from its database. Often we want to make decisions about <i>what</i> HTML to render based on that database information. The Jelly tags (its <i>statements</i>) that let you do that are its <i>conditional tags</i>, and they are the subject of today's post. Our little helper at right can't wait for some more Jelly, conditional or not!<br /><br />In this post I'm going to show you how Jelly lets you choose whether particular HTML gets rendered. For this purpose, we're going to use a silly little exercise: if a variable named <span style="font-family=Courier;color:FireBrick;">jvar_employee</span> is true, we'll render some HTML that shows the name as an employee's name; if it's false, we'll render it as an alien's name. For now, don't worry about how the variables we're using have values set in them in real; we'll cover that in later posts — just concentrate on understanding how Jelly's <i>conditional tags</i> work. For the purpose of our exercise, we're just setting the variables to a constant value.<br /><!--break--><br />Probably the most common conditional tag you'll see is the <span style="font-family=Courier;color:FireBrick;">if</span> tag. Here's what our exercise problem looks like using this basic conditional tag:<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;j:jelly&gt;<br />    &lt;j:set/&gt;<br />    &lt;j:set/&gt;<br />    &lt;j:if&gt;<br />        <span>Employee:</span>$[SP]<span style="color:blue">${jvar_name}</span><br />    &lt;/j:if&gt;<br />    &lt;j:if&gt;<br />        <span>Alien:</span>$[SP]<span style="color:red">${jvar_name}</span><br />    &lt;/j:if&gt;<br />&lt;/j:jelly&gt;<br /></pre><br />You can paste this straight into a UI Page to try it out. Try changing the value assigned to <span style="font-family=Courier;color:FireBrick;">jvar_employee</span> in the <i>set</i> tag to see how the rendered HTML changes. In JavaScript, I might have written something like this:<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />if (employee)<br />   output('employee stuff');<br />else<br />   output('alien stuff');<br /></pre><br />I'd use that handy-dandy <i>else</i> statement. But in Jelly there is no <i>else</i> tag, so we have to write it by using inverted tests. The Jelly above is the equivalent of this sort of JavaScript:<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />if (employee)<br />   output('employee stuff');<br />if (!employee)<br />   output('alien stuff');<br /></pre><br />It's the same thing, really — just a bit more typing. In Jelly, you generally will use a JEXL expression inside the <i>test</i> attribute, just as I did in this example. This JEXL expression must evaluate to a boolean result (i.e., true or false), but otherwise there's no restriction on what is in the expression. It could be simple, like my example, or something much more complex with many terms, math, and comparisons. Generally you'll find that your Jelly is easier to read and understand if these JEXL expressions are relatively simple. In later posts, I'll show you some ways to do that.<br /><br />By the way, I snuck something into the sample: I used <span style="font-family=Courier;color:FireBrick;">$[SP]</span> in a couple of places. For now, just think of this as a magic incantation to get a non-breaking space (&nbsp;) into your rendered HTML.<br /><br />Jelly has several conditional tags; the <i>if</i> tag is just the most popular one. Here's another, usually called the <i>choose/when/otherwise</i> tags:<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;j:jelly&gt;<br />    &lt;j:set/&gt;<br />    &lt;j:set/&gt;<br />    &lt;j:choose&gt;<br />        &lt;j:when&gt;<br />            <span>Employee:</span>$[SP]<span style="color:blue">${jvar_name}</span><br />        &lt;/j:when&gt;<br />        &lt;j:otherwise&gt;<br />            <span>Alien:</span>$[SP]<span style="color:red">${jvar_name}</span><br />        &lt;/j:otherwise&gt;<br />    &lt;/j:choose&gt;<br />&lt;/j:jelly&gt;<br /></pre><br />The choice of names for these tags is a bit unfortunate (and certainly unconventional!), but the way it works is often quite useful. This behaves like the good old <i>if/else if/else</i> conditional blocks that JavaScript programmers are very familiar with. The <i>when</i> tests are evaluated in the order that they are written until one evaluates to a <i>true</i>. When one of the <i>when</i>s tests <i>true</i>, the contained Jelly is evaluated — and then nothing further within the <i>choose</i> tag is evaluated. If none of the <i>when</i>s test true, then the (optional) <i>otherwise</i> tag is evaluated. That's exactly like a chain of JavaScript <i>if</i> statements like this:<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />if (x &lt; 0)<br />   // do stuff...<br />else if (x &lt; 5)<br />   // do other stuff...<br />else if (x &lt; 100)<br />   // do even other stuff...<br />else<br />   // do desperately different stuff...<br /></pre><br />Finally, Jelly has one last conditional tag &amp;nash; and if you know JavaScript, this will look very familiar:<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;j:jelly&gt;<br />    &lt;j:set/&gt;<br />    &lt;j:set/&gt;<br />    &lt;j:switch&gt;<br />        &lt;j:case&gt;<br />            <span>Employee:</span>$[SP]<span style="color:blue">${jvar_name}</span><br />        &lt;/j:case&gt;<br />        &lt;j:default&gt;<br />            <span>Alien:</span>$[SP]<span style="color:red">${jvar_name}</span><br />        &lt;/j:default&gt;<br />    &lt;/j:switch&gt;<br />&lt;/j:jelly&gt;</pre><br />It's our old friend, the <i>switch</i> statement, and Jelly's <i>switch</i> works almost exactly like the JavaScript version. The <i>on</i> JEXL expression is evaluated just once, before Jelly starts processing its contents. Then each <i>case</i> tag compares the result of the <i>on</i> expression to its <i>value</i> tag. In my example, the <i>value</i> tag is a constant — but it could have been a JEXL expression, too. While the <i>switch</i> tag looks a lot like the <i>choose</i> tag, there is an important difference in its behavior: the <i>switch</i> tag will evaluate <i>all</i> the enclosed <i>case</i> tags whose <i>value</i>s match. There's one other small difference, too — the <i>case</i> tag has an optional attribute <i>fallThru</i> that defaults to false (which means I could have left it out of my example altogether). If you set this attribute to <i>true</i>, then Jelly will keep evaluating the stuff inside the following <i>case</i> or <i>default</i> tag. This is exactly what happens in JavaScript if you forget to put a <i>break</i> statement at the end of your code after a <i>case</i> statement. I don't think I've ever had a legitimate use for this "feature", though I've certainly troubleshot some subtle bugs cause by my leaving it out. Jelly defaults it to the way you'd normally use it (thank you, oh Jelly inventors!) but still lets you choose the weird, counter-intuitive way if you want to — you weirdo.<br /><br />Ok, that's about enough Jelly for one day!</p>