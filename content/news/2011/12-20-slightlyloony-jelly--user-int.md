---
title: "Jelly User Interaction"
date: 2011-12-19T23:47:59.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=ae7ca2e1dbd0dbc01dcaf3231f9619bd"
---
<p>Throughout this series, I've been using UI Pages as my examples — but to this point I haven't mentioned one of the main purposes that people <em>want</em> UI Pages: the ability to interact with a user. So today I'm going to show you a very simple example of how that might be done. I've deliberately kept this example stripped to the basics in order to highlight the bits I'm showing you. In the world of HTML, that means it's ugly as sin — try to ignore that (or fix it up yourself!) and concentrate on the mechanics.</p><p></p><p>Our goal today: we need an order form for hamburgers, for our very simple gourmet hamburger business. Our chef will let you ask for anything you want on your burger, but he delivers it the way he decides to. The burgers are a fixed price: $27.89 (they're really <em>good</em>!), which is about the same in Euros these days. So our order form needs only one input: the number of burgers you want. When you submit your order, we compute the extended price, the tax (8.75% here in San Diego), and the total. Here's the example page, which is named <span style="font-family=courier;color: FireBrick;">order_form</span>:</p><p></p><p></p><pre style="margin-left: 20px; line-height: 1; color: firebrick;"><br/>&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;j:jelly&gt;<br/>       &lt;g2:evaluate&gt;<br/>               var isAnswer = (jelly.sysparm_answer != null);<br/>               isAnswer;<br/>       &lt;/g2:evaluate&gt;<br/>       &lt;j2:if&gt;<br/>               Number of burgers you want: &lt;input id="number_of" type="text" /&gt;<br/><br/>               &lt;input id="enter_number" type="submit" /&gt;<br/>         

                     $('enter_number').onclick = function(event) {<br/>                             window.location = 'order_form.do?sysparm_answer=true${AMP}' +<br/>                                       'sysparm_number=' + $('number_of').value;<br/>                     }<br/>             <br/>       &lt;/j2:if&gt;<br/>       &lt;j2:if&gt;<br/>               &lt;g2:evaluate&gt;<br/>                       var qty = jelly.sysparm_number - 0;<br/>                       var ext = qty * 27.89;<br/>                       var tax = ext * 0.0875;<br/>                       var tot = ext + tax;<br/>                       var extStr = ext.toFixed(2);<br/>                       var taxStr = tax.toFixed(2);<br/>                       var totStr = tot.toFixed(2);<br/>               &lt;/g2:evaluate&gt;<br/>               Your delicious burgers will be ready shortly after you fork over the cash.   You owe us:<br/><br/>               $[extStr] for the burgers<br/><br/>               $[taxStr] for the tax man<br/><br/>               $[totStr] due to us, now, in small unmarked bills and coins<br/>       &lt;/j2:if&gt;<br/>&lt;/j:jelly&gt;</pre><p><br/>Most of that you should be able to understand right now. The only thing I've really added to the Jelly is a couple of Jelly variables whose names start with <span style="font-family=courier;color: FireBrick;">sysparm_</span> instead of <span style="font-family=courier;color: FireBrick;">jvar_</span> (but they're Jelly variables nonetheless). More on those a little further along in this post. Right now I want to tell you a little bit about how UI Pages actually work in the ServiceNow system.</p><p></p><p>When you define a UI Page, you define more than the Jelly — you also give that UI Page a <em>name</em> (and there are other fields that I'm not going to describe today). That name is how you get the UI Page to display — it becomes part of the URI. For example, I named this UI Page <span style="font-family=courier;color: FireBrick;">order_form</span>, and to ask for it I use the URI <span style="font-family=courier;color: FireBrick;">/order_form.do</span>. The ".do" after the UI Page's name is the standard way on the ServiceNow platform to construct a URI that runs a UI Page (or other things, but those are topics for another day). It's important that the name you pick for your UI Page be different than the name of any other UI Page or other valid URI, otherwise you might get something unexpected when you use that URI!</p><p></p><p>Just like any other URI, you can include <em>query parameters</em> in your ServiceNow URIs. But...there's a convention you need to follow to make these query parameters available to your Jelly pages — the names of those query parameters need to start with <span style="font-family=courier;color: FireBrick;">sysparm_</span>. When they do, the ServiceNow platform will automagically copy them into Jelly variables — those same Jelly variables that I mentioned earlier. So, for example, a URI that looks like this:</p><pre style="margin-left: 20px; line-height: 1; color: firebrick;"><br/>/order_form.do?sysparm_answer=false&amp;sysparm_number=5</pre><p><br/>Will result in two Jelly variables appearing in your <span style="font-family=courier;color: FireBrick;">order_form</span> UI Page: <span style="font-family=courier;color: FireBrick;">sysparm_answer</span> (with a value of "false") and <span style="font-family=courier;color: FireBrick;">sysparm_number</span> (with a value of 5).</p><p></p><p>Now, armed with this knowledge, take a close look at the example Jelly above. The first <span style="font-family=courier;color: FireBrick;">evaluate</span> tag is just testing to see if the <span style="font-family=courier;color: FireBrick;">sysparm_answer</span> parameter was present. If we request the <span style="font-family=courier;color: FireBrick;">order_form</span> UI Page with no query parameters, then the result of this evaluate will be <em>false</em>; otherwise it's <em>true</em>:</p><pre style="margin-left: 20px; line-height: 1; color: firebrick;"><br/>       &lt;g2:evaluate&gt;<br/>               var isAnswer = (jelly.sysparm_answer != null);<br/>               isAnswer;<br/>       &lt;/g2:evaluate&gt;</pre><p><br/>Just after that evaluate, we have a couple of <span style="font-family=courier;color: FireBrick;">if</span> tags. Check out what they're doing:</p><pre style="margin-left: 20px; line-height: 1; color: firebrick;"><br/>       &lt;j2:if&gt;<br/>               ...<br/>       &lt;/j2:if&gt;<br/>       &lt;j2:if&gt;<br/>               ...<br/>       &lt;/j2:if&gt;</pre><p><br/>Basically they divide our single UI Page into two: one that renders if there <em>wasn't</em> a <span style="font-family=courier;color: FireBrick;">sysparm_answer</span> parameter, the other if there <em>was</em>. Now let's look inside the piece that only renders when there is no <span style="font-family=courier;color: FireBrick;">sysparm_answer</span> parameter:</p><pre style="margin-left: 20px; line-height: 1; color: firebrick;"><br/>               Number of burgers you want: &lt;input id="number_of" type="text" /&gt;<br/><br/>               &lt;input id="enter_number" type="submit" /&gt;<br/>         

                     $('enter_number').onclick = function(event) {<br/>                             window.location = 'order_form.do?sysparm_answer=true${AMP}' +<br/>                                       'sysparm_number=' + $('number_of').value;<br/>                     }<br/>             </pre><p><br/>This just puts up a really dumb little form to capture the number of burgers the user wants to order. But look in the script: when the user clicks on the submit button, that script constructs the URI to go right back to our order form — but this time <em>with</em> query parameters. Now let's look at the piece that only renders when there <em>are</em> query parameters:</p><pre style="margin-left: 20px; line-height: 1; color: firebrick;"><br/>               &lt;g2:evaluate&gt;<br/>                       var qty = jelly.sysparm_number - 0;<br/>                       var ext = qty * 27.89;<br/>                       var tax = ext * 0.0875;<br/>                       var tot = ext + tax;<br/>                       var extStr = ext.toFixed(2);<br/>                       var taxStr = tax.toFixed(2);<br/>                       var totStr = tot.toFixed(2);<br/>               &lt;/g2:evaluate&gt;<br/>               Your delicious burgers will be ready shortly after you fork over the cash.   You owe us:<br/><br/>               $[extStr] for the burgers<br/><br/>               $[taxStr] for the tax man<br/><br/>               $[totStr] due to us, now, in small unmarked bills and coins</pre><p><br/>In this <span style="font-family=courier;color: FireBrick;">evaluate</span> tag we compute the extended price, the sales tax, and the total. Just below that, we render the results so that our customer can pay us.</p><p></p><p>What I did here with a single UI Page could just as easily have been done with two completely separate UI Pages — which way to go is a design choice that's entirely up to you. Generally I prefer the page-for-each-function style (which would take two pages here), but your mileage may vary.</p><p></p><p>So there you go — UI Pages that actually interact with a user! What more could you possibly want?</p>