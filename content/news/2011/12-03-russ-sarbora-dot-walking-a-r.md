---
title: "Dotwalking a Runbook activity result payload"
date: 2011-12-02T06:38:35.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=8d0daaa5dbd0dbc01dcaf3231f961919"
---
<p>It seems that most of the time I'm writing Runbooks, I'm focused on doing <i>something</i> to my target systems. The output of <i>something</i> tends to not be very interesting. For the most part, all I care about is that <i>something</i> doesn't bomb out and cause my activity to fail. Recently, however, I needed to return a chunk of structured data from a Run Powershell activity. More importantly, I needed to be able to walk through that structured data and examine pieces of it.<br /><br />Now, Powershell is very good at dealing with XML data. so it would seem that having my Powershell generate XML would be the way to go. But on the other hand, I had to use Javascript to manipulate that data once it got back to my instance. Walking and/or XPathing through a complex XML DOM in Javascript didn't sound like much fun. So I started thinking about making the Powershell return JSON that would be decoded into Javascript objects for my sensor script to interact with. Problem is, Powershell is not good at generating JSON, in fact, it doesn't have any built-in support for serializing objects into JSON. In a perfect world, I mused, I could write my Powershell to return XML, and then have it magically converted into Javascript objects to write script against.<br /><br />It turns out, we don't need a perfect world, Runbook will already do this bit of alchemy for us. When an activity's payload can be parsed as valid xml data, it will automatically be converted into Javascript objects and made available to your sensor script in document.result.output.<br /><br />For example: if your activity is returning this xml:<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />&lt;a&gt;<br />  &lt;b&gt;1&lt;/b&gt;<br />  &lt;c&gt;2&lt;/c&gt;<br />&lt;/a&gt;<br /></pre><br /><br />You can access that data from your sensor_script (or the onProbe_complete handler if you're writing a custom activity) with the following<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />var b=document.result.output.b;<br />var c=document.result.output.c;<br /></pre><br /><br />If the XML contains multiple elements with the same name, they are converted into an array.<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />&lt;a&gt;<br />  &lt;b&gt;1&lt;/b&gt;<br />  &lt;b&gt;2&lt;/b&gt;<br />&lt;/a&gt;<br /></pre><br /><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />for (var i=0;i&lt;document.result.output.b.length;i++) {<br />var b=document.result.output.b&lt;i&gt;;<br />}<br /></pre><br /><br />Pretty cool. Even better, this works from any Runbook activity, not just Run Powershell!<br /><br />Thanks to Chuck Tomasi for his <a href='http://community.service-now.com/blog/ctomasi/discovery-parsing-retrieved-xml-files'>post</a> on how this works in Discovery sensors, which made me realize it would probably also work in Runbook.</p>