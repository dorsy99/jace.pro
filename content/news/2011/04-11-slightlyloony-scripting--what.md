---
title: "Scripting Whats Up with the this"
date: 2011-04-11T03:05:06.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=51cdeea9dbd0dbc01dcaf3231f9619a5"
---
<p><img  alt="" class="jive-image" src="883b494edb90d304b322f4621f96196c.iix" style="width: auto; height: 188px;" />The light bulb just went off for our super-genius at right — finally, it all makes sense to him. <i>What</i> makes sense, you ask? Why, code like this (which I used in <a title="lightlyLoony/blog/2011/4/8/2065" href="/community?id=community_blog&sys_id=45edeae9dbd0dbc01dcaf3231f9619b2">my last post</a>):<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />gr = this._get_real_gr(gr);</pre><br /><br /><i>_get_real_gr()</i> is a function, so why can't I just call it? Why is that pesky, awkward <i>this.</i> there in front of it?<br /><!--break--><br />Understanding the <i>this</i> keyword is critical to understanding how to work with JavaScript objects, so this is worth your time and attention to understand. Guzzle some coffee, pinch yourself, sedate the kids, muzzle the dog, just do whatever it takes to get yourself focused on understanding <i>this</i> for the next few minutes.<br /><br />Try modifying the MACResolver script include from my last post to remove the <i>this.</i> in the two places where it prefixes the function call. Then try running it — you'll get this error in the log:<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />Evaluator: org.mozilla.javascript.EcmaError: "_get_real_gr" is not defined.<br />   Caused by error in Script Include: 'MACResolver' at line 30<br /><br />     27:<br />     28:         // if we have a NIC here, get the real CI...<br />     29:         if (klass == 'cmdb_ci_network_adapter') {<br />==&gt;  30:            gr = _get_real_gr(gr);<br />     31:            if (!gr)<br />     32:               continue;<br />     33:</pre><br /><br />But if you look at the source from my last post, you can <i>see</i> that function being defined. What's wrong with this moronic JavaScript compiler, telling you it's undefined when it's right there?<br /><br />This is happening because without the <i>this.</i> JavaScript is expecting our function to be global, and it's not. Instead, our function is defined as a property in our <i>MACResolver</i> object. The <i>this.</i> prefix tells JavaScript to look for the function definition in <i>this</i> object. But what <i>is</i> this object? Well, that's different each time you create and use an object. Consider the test code from the last post:<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />var mac = new MACResolver();<br />var gr = mac.resolve('00:50:56:ae:33:d9');<br />gs.log(gr.sys_class_name + ': ' + gr.name);</pre><br /><br />In this code, we created a new instance of the <i>MACResolver</i> class and stored it in the <i>mac</i> variable. In the case of this example, the <i>this.</i> refers to the <i>mac</i> variable, and it is exactly as if you had written <i>mac._get_real_gr()</i>. But <i>inside</i> the object, in its own code, you're writing code that has to run no matter how the class is used. That's what the <i>this.</i> keyword does for you: it lets you invoke an instance function (aka a <i>method</i>) or refer to an instance variable (aka a <i>property</i> or a <i>field</i>) from within the object, no matter how it is being used.<br /><br />Here's another reason why the <i>this</i> keyword is necessary. Imagine that in your code you already had a global function named <i>_get_real_gr()</i>. If it weren't for the <i>this</i> keyword, you'd have a confusing situation: an instance function and a global function with the same name. Which one should JavaScript actually invoke? The <i>this</i> keyword solves the problem: leave it off, and you're calling the global function. Put it in, and you're calling the instance function.<br /><br />There now, that wasn't so hard, was it? <i>Was</i> it?</p>