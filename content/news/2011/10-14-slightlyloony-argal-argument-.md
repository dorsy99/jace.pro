---
title: "Argal Argument Puzzler"
date: 2011-10-13T06:22:54.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=8e4d2229dbd0dbc01dcaf3231f9619cc"
---
<p><span class="asset-asset_lightbox-Small asset-align-right"><a href="/files/SlightlyLoony/arguing2.jpg" rel="lightbox"><img rel="lightbox" src="http://community.service-now.com/files/imagecache/Small/SlightlyLoony/arguing2.jpg" alt="" title="" class="imagecache imagecache-Small" /></a></span>The two developers at right (you know they don't work here, dressed like that!) were having quite the argument the other day. Brian asserted, spittle flying, that it's impossible in JavaScript to have an <a title=".wikipedia.org/wiki/Anonymous_function" href="http://en.wikipedia.org/wiki/Anonymous_function">anonymous</a> <a title=".wikipedia.org/wiki/Recursion_%28computer_science%29" href="http://en.wikipedia.org/wiki/Recursion_%28computer_science%29">recursive function</a>. Emily insulted several of his ancestors, called Brian some names we won't repeat here, and declared that of course it was possible — and even easy!<br /><br />Friends called me in as a peacemaker, afraid that physical blows were in the immediate future. Emily and Brian agreed not to hurt me while I investigated.<br /><br />So who was right — Brian or Emily?<br /><!--break--><br />Emily wins this one, to her great satisfaction.<br /><br />Here's an example of a classic recursive function — computing the greatest common denominator of two numbers:<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />function gcd(x, y) {<br />    return (y ==0) ? x : gcd(y, x % y);<br />}<br /><br />gs.log(gcd(47437,77519));<br /></pre><br />When you run it, you get the answer <i>1157</i>, which is correct. That is <i>not</i> an anonymous function, though. Anonymous functions have no name, and this one has a perfectly good name (<i>gcd()</i>). The absence of a name is why Brian thought it was impossible to have an anonymous recursive functions, because recursive functions (by definition) call themselves, just as this one does. And how could any function call itself without knowing its own name?<br /><br />So how can Emily be right? Here's the solution she proposed:<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />var x = function(x, y) {<br />    return gcd(x,y);<br /><br />    function gcd(x, y) {<br />        return (y ==0) ? x : arguments.callee(y, x % y);<br />    }<br />}<br /><br />gs.log(x(47437,77519));<br /></pre><br />She gets points for coming up with a solution that actually works (if you run this, you'll get the right answer), and is, technically, an anonymous function. But Brian objected, pointing out that really all Emily was doing with this solution is wrapping a non-anonymous function (<i>gcd()</i>) in an anonymous wrapper. She's cheating, said he, and we could see him winding up again.<br /><br />So I showed him the studly way to build an anonymous recursive function, using the <a href="https://developer.mozilla.org/en/JavaScript/Reference/Functions_and_function_scope/arguments">quite satifyingly obscure <i>callee</i> property of the <i>arguments</i> object</a>. "Huh?" said he, succintcly, staring at the code:<br /><pre style="margin-left:20px;line-height:1;color:FireBrick;"><br />var x =  function(x, y) {<br />    return (y ==0) ? x : arguments.callee(y, x % y);<br />}<br /><br />gs.log(x(47437,77519));<br /></pre><br />Brian couldn't argue with the fact that this code produced the correct answer, nor could he argue that it wasn't using a purely anonymous function. But how does it work?<br /><br />The <i>callee</i> property contains a reference to the function whose <i>arguments</i> object it is contained by. In our example, that means it has exactly the same value as the variable <i>x</i>. But...the variable <i>x</i> cannot be known to the code inside the anonymous function, so that code can't invoke it. But the <i>arguments</i> object is known inside the function <i>by definition</i> — so the code inside the function is perfectly free to invoke the <i>callee</i> property as a function. <i>Presto!</i> the elusive anonymous recursive function.<br /><br />So far as I can tell, the <i>callee</i> property serves only one useful purpose: to enable anonymous recursive functions. Nice of the JavaScript designers to include it, wasn't it?<br /><br />I'm happy to report that Brian and Emily are now talking normally to each other again...</p>