---
title: "MiniLab Workflows  Turnstile Enhancement"
date: 2015-09-29T18:31:45.000Z
authors: ["sabell2012"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=982de2e5dbd0dbc01dcaf3231f961991"
---
<p style="margin-bottom: 0.0001pt;"><span style="font-size: 12pt; font-family: arial,helvetica,sans-serif;">Continuing in the vein of <a _jive_internal="true" href="/groups/servicenow-user-group-us-tx-north-texas/blog/2015/09/27/mini-lab-workflows-for-loop"><strong>workflow looping</strong></a> I found that I wanted a better Turnstile Activity.   One that would take a variable rather than a "hard-coded" integer.     To do this would require modifying the out-of-the-box Turnstile Activity to accept a variable.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><span style="color: #ff0000;"><strong>NOTE</strong></span>: BEST PRACTICE: Try to avoid modifying and saving back down over the top of an existing out-of-the-box anything in ServiceNow. Any future upgrade to the software will be skipped to preserve your changes.   Always make a copy and use that instead.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">We will be doing the following for this lab:</span></p><p style="margin-bottom: 0.0001pt;"></p><ol style="list-style-type: decimal;"><li><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">Make a copy of the existing Turnstile Activity</span></li><li><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">Modifying the Turnstile Activity to accept a variable of our choosing rather than an integer.</span></li><li><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">Creating a workflow to demonstrate looping using our enhanced Turnstile Activity (we will be using the initialize activity from my previous lab.</span></li></ol><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><span style="; color: red; text-decoration: underline;"><strong>Assumption</strong></span>: That you have worked with and created ServiceNow Workflows before.   Also, you should probably play with this in your personal instance until you get proficient with the concept.   Just saying.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><strong>NOTE</strong>: We are going to create all of our activities first and wire them all together as the last step.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><strong>NOTE</strong>: I <span style="text-decoration: underline;"><strong>highly</strong></span> recommend creating an Update Set to capture your enhanced Turnstile Activity so that you can port it around if you want.   I have placed everything from this lab out on the share if you want to download it.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-size: 18pt; font-family: arial,helvetica,sans-serif;"><strong>Lab 1.1 — Enhancing the Turnstile Activity</strong></span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">1. Navigate to Workflow â†’ Administration <span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">â†’</span> Activity Definitions. This will open the Activity Definitions list view.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">2. Search for the <strong>Turnstile Activity</strong>, and click on the link to open the activity.   This will open the activity definition form.</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       a. Change the name field to be: Turnstile (Enhanced)</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       b. Right-Click on the form header to display the context menu.</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       c. <span style="color: #ff0000;"><strong>Click on Insert and Stay.   </strong></span><span style="color: #ff0000;">Make sure you do this or you will be modifying the original!   <span style="color: #000000;">This will make a copy of the original activity that will be yours to modify.</span>   Otherwise you will "own" the out-of-the-box version, and it WILL be skipped on your next ServiceNow upgrade.   If you do save down over the original simply <a href="http://wiki.servicenow.com/index.php?title=Versions#Reverting_Changes&amp;gsc.tab=0"><strong>revert</strong> </a>to the previous version and try again.</span></span></p><p style="margin-bottom: 0.0001pt;"><span style="color: #ff0000; font-size: 12pt; font-family: arial,helvetica,sans-serif;"> </span></p><p style="margin-bottom: 0.0001pt;"><span style="color: #ff0000; font-size: 12pt; font-family: arial,helvetica,sans-serif;"><img   alt="" class="jiveImage image-0" src="bbde5486db9c9fc03eb27a9e0f9619ea.iix" style="width: 620px; height: 265px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p style="margin-bottom: 0.0001pt;"><span style="color: #ff0000; font-size: 12pt; font-family: arial,helvetica,sans-serif;"><strong> </strong></span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       d. In the <strong>Script</strong> field scroll down and change script to the following:</span></p><p style="margin-bottom: 0.0001pt;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14435339476974158 jive_text_macro" data-renderedposition="1092_8_1177_608" jivemacro_uid="_14435339476974158"><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">var Turnstile__Enhanced_ActivityHandler = Class.create();</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">Turnstile__Enhanced_ActivityHandler.prototype = Object.extendsObject(WFActivityHandler, {</span></p><p style="margin-bottom: 0.0001pt;">           </p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       initialize: function() {</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                               var schpdName = 'iterations_' + activity.activity.sys_id;</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                               WFActivityHandler.prototype.initialize.call(this);</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                               if (!workflow.scratchpad[schpdName]) {</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                                                       workflow.scratchpad[schpdName] = 1;</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                               }</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       },</span></p><p style="margin-bottom: 0.0001pt;">           </p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       onExecute: function() {</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                               // implement activity definition code here</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                               var schpdName = 'iterations_' + activity.activity.sys_id;</span></p><p style="margin-bottom: 0.0001pt;">                                   </p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                               var iterCountVar = parseInt(workflow.scratchpad[schpdName], 10);</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                               var <strong>iterAllowedVar</strong> = parseInt(this.js(activity.vars.iterations), 10);</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                               if (iterCountVar &gt; iterAllowedVar) {</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                                                       //You've iterated too many times...stop iterating</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                                                       activity.result = 'cancel';</span></p><p style="margin-bottom: 0.0001pt;">                                                           </p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                               } else {</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                                                       //Still iterating</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                                                       iterCountVar ++;</span></p><p style="margin-bottom: 0.0001pt;">                                                           </p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                                                       workflow.scratchpad[schpdName] = iterCountVar;</span></p><p style="margin-bottom: 0.0001pt;">                                                           </p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                                                       activity.result = 'continue';</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                                               }</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       },</span></p><p style="margin-bottom: 0.0001pt;">           </p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       type: 'Turnstile__Enhanced_ActivityHandler'</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">});</span></p>     </pre><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> </span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><strong>NOTE:</strong>   If you look careful you will notice that the following line has been modified:</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"></p><p style="margin-bottom: 0.0001pt; text-indent: 0.5in; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">var iterAllowedVar = parseInt(<span style="color: red;"><strong>this.js(</strong></span>activity.vars.iterations<span style="color: red;"><strong>)</strong></span>, 10);</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">The this.js(…) will take whatever variable is fed to it and convert it to the value contained in that variable.   This will be important when we go to use the new activity in our workflow.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       e. Right-click on the form menu to bring up the context menu.   Click save to save the script change.</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">3. Now go to the bottom of our Activity definition.   You will notice that there are no variables or conditions defined.   These were not copied with our activity, and will need to be put back (with a very slight modification).</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">4. On the Activity Variables tab click the New button.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">5. Fill out the form with the following:</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> </span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       a. <strong>Column Name</strong>: iterations</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       b. <strong>Label</strong>: Allowed Iterations</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       c. <strong>Type</strong>: String         &lt;- Here is our "slight" modification.   Previously this was Integer</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       d. <strong>Order</strong>: 100</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       e. <strong>Max length</strong>: 100   &lt;- This is important as we will be putting a variable in this field now.</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       f. Click the Submit button to save your new variable.</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">6. Click on the Condition Defaults tab.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">7. Click on the New button.   We will be creating two new defaults.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">8. Fill out the form with the following:</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> </span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       a. <strong>Name</strong>: Continue</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       b. <strong>Activity definition</strong>: Turnstile (Enhanced)</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       c. <strong>Condition</strong>: activity.result == 'continue'</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       d. <strong>Order</strong>: 100</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       e. <strong>Short Description</strong>: Continue iterating</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       f. Right-click on the form header to bring up the context menu and click Save to save your new Continue condition default.</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">9. Now change the form to the following:</span></p><p></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       a. <strong>Name</strong>: Cancel</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       b. <strong>Activity definition</strong>: Turnstile (Enhanced)</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       c. <strong>Condition</strong>: activity.result == 'cancel'</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       d. <strong>Order</strong>: 200</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       e. <strong>Short Description</strong>: You've looped too many times...cancel it...</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       f. Right-click on the form header to bring up the context menu and click Insert to save your new Cancel condition default.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">You have now completed your new enhanced Turnstile Activity!   Congratulations!</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-size: 18.0pt; font-family: 'Arial','sans-serif';"><strong> </strong></span></p><p style="margin-bottom: 0.0001pt;"><span style="font-size: 18.0pt; font-family: 'Arial','sans-serif';"><strong> </strong></span></p><p style="margin-bottom: 0.0001pt;"><span style="font-size: 18.0pt; font-family: 'Arial','sans-serif';"><strong>Lab 1.2 — Using the Turnstile Activity</strong></span></p><p style="margin-bottom: 0.0001pt;"><span style="font-size: 18.0pt; font-family: 'Arial','sans-serif';"><strong> </strong></span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">1. Navigate to Workflow <span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">â†’</span> Workflow Editor.   This will open the workflow editor.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       a. In the Workflow Navigation column click on the plus symbol to create a new workflow</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><img  __jive_id="29005" alt="" class="jiveImage image-0" src="bbde5486db9c9fc03eb27a9e0f9619ea.iix" style="width: auto; height: auto; display: block; margin-left: auto; margin-right: auto;"/></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">2. Create a new workflow</span></p><p style="padding-left: 30px;"></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> a. <strong>Name</strong>: Enhanced Turnstile Example</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> b. <strong>Table</strong>: Global</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> c. Take all other defaults</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> d. Click the Submit button to create the workflow</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">3. On the Workflow Core tab, navigate to Utilities</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">4. Drag out a Run Script Activity on to the desktop.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">Here we will be initializing our loop.   We will load a specified number of records from the Incident table.   Store these into a scratchpad variable.   The number of times to loop will be the number of records.   We will start with 0 as the first number.   Notice that there is a slight tweak to the count variable from what we did in the last lab.   This is because the Turnstile is acting on the "end" of things and loops one more time than we would like.   No biggy.</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       a. <strong>Name</strong>: Initialize</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">       b. <strong>Script</strong>:</span></p><p style="margin-bottom: 0.0001pt;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14435339476813778 jive_text_macro" data-renderedposition="3937_8_1177_496" jivemacro_uid="_14435339476813778"><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">var identifier = context.name + '.' + activity.name;   // introducing just a bit more sophistication!</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">var incidentRecords = new GlideRecord('incident');</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">incidentRecords.addQuery('state', '!=', 7); // closed</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">incidentRecords.setLimit(workflow.inputs.u_numberofrecords); // note that this comes from your inputs</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">incidentRecords.orderByDesc('number');</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">incidentRecords.query();</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">var incident = {};</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">var incidentList = []; // this will be an array of objects</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">while (incidentRecords.next()) {</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       incident = {};</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       incident.sys_id = incidentRecords.sys_id + '';</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       incident.number = incidentRecords.number + '';</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       incident.assigned_to = incidentRecords.assigned_to.getDisplayValue() + '';</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       incident.short_description = incidentRecords.short_description + '';</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       incident.state = incidentRecords.state.getDisplayValue() + ''; // notice that we get the label</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       incidentList.push(incident);</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">}</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">workflow.scratchpad.count = incidentList.length - 1; // the overall count available</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">workflow.scratchpad.incidentList = incidentList; // the list of incident objects</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">workflow.scratchpad.counter = 0;   // our counter</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">workflow.scratchpad.message = '';   // the cumulative message</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">gs.info('---&gt; [WF:{2}] Total number of records to loop: {0}, test value {1}', workflow.scratchpad.count, workflow.scratchpad.incidentList[workflow.scratchpad.counter].number, identifier);</span></p>     </pre><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> </span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> c. Click the Submit button to create the Activity</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">5. Drag out a Run Script Activity on to the desktop.</span></p><p></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> a. <strong>Name</strong>: Compile Message</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> b. <strong>Script</strong>:</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">Here we will save up a cumulative message which we will print out each time to the System Log (in the Do Work Script Activity). Note that we are reference the "current" incident record using our object array, and our counter.   This is part of the magic!</span></p><p style="margin-bottom: 0.0001pt;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14435339476715198 jive_text_macro" data-renderedposition="4685_8_1177_192" jivemacro_uid="_14435339476715198"><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">var incident = workflow.scratchpad.incidentList[workflow.scratchpad.counter];</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">workflow.scratchpad.message += '[' + workflow.scratchpad.counter + ']' </span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       + ' Number: ' + incident.number </span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       + ' - ' + incident.short_description </span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       + ' - ' + incident.assigned_to</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       + ' - ' + incident.state</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">                       + '\n';</span></p>     </pre><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">c. Click the Submit button to create the Activity</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">6. On the Workflow Core tab, navigate to Timers</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">7. Drag out a Timer Activity.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">         Here we will wait one second so that the logs are written down in order.   Otherwise there is no need for this activity.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> a. <strong>Name</strong>: Wait a Sec</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> b. <strong>Timer Based On</strong>: A user specified duration</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> c. <strong>Duration</strong>: 1 seconds</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> d. Click on the Submit button to create the Activity</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">8. Copy the Wait a Sec Activity (we will need two for our workflow).</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> </span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">9. On the Workflow Core tab, navigate to Utilities</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">10. Drag out a Script Activity on to the desktop.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> a. <strong>Name:</strong> Do Work</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> b. <strong>Script</strong>:</span></p><p style="margin-bottom: 0.0001pt;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14435339476629002" data-renderedposition="5402_8_1177_112" jivemacro_uid="_14435339476629002"><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">var identifier = context.name + '.' + activity.name;   </span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">gs.info('---&gt; [WF:{2}]\nLoop Count: {0} - Message so far:\n{1}', workflow.scratchpad.counter, workflow.scratchpad.message, identifier);   </span></p>     </pre><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> </span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">11. On the Workflow Core tab, navigate to Utilities.   You will now see your new Turnstile (Enhanced) activity present in the list!</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">12. Drag out a Turnstile (Enhanced) Activity on to the desktop.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">We can now enter a variable instead of an integer! Cool huh?! </span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">             a. <strong>Name</strong>: Loop Check</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">             b. <strong>Allowed Iterations</strong>:   ${workflow.scratchpad.count}</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">             c. Click the Submit button to create the Activity</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">13. On the Workflow Core tab, navigate to Utilities</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">14. Drag out a Run Script Activity on to the desktop.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">Here we will log down the final Message to the System Logs.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">a. <strong>Name</strong>: Log Message</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">b. <strong>Script</strong>:</span></p><p style="margin-bottom: 0.0001pt;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14435339476477357" data-renderedposition="5970_8_1177_112" jivemacro_uid="_14435339476477357"><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">var identifier = context.name + '.' + activity.name;</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">gs.info('---&gt; [WF:{1}]\nFINAL Message:\n{0}', workflow.scratchpad.message, identifier);</span></p>     </pre><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> </span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">c. Click the Submit button to create the Activity</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">15. Wire everything up to look like the following:</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> </span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><img   alt="3.turn_workflow.JPG" class="image-1 jive-image" src="1702c5c6dbd097049c9ffb651f96192e.iix" style="height: 406px; width: 620px; display: block; margin-left: auto; margin-right: auto;"/><br/></span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">16. Click on the triple bar in the upper left of the Desktop, then click on Edit Inputs. We will use this to define a single test input variable for our workflow.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">17. Add a new input variable:</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">a.<strong> Name</strong>: Number of Records</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">b.<strong> Column Name</strong>:<strong>     </strong>u_numberofrecords<br/>c.<strong> Type</strong>: Integer<br/>d.<strong> Order</strong>: 100<br/>e.<strong> Length</strong>: 40<br/>f.<strong> Default Value</strong>: 5</span></p><p style="margin-bottom: 0.0001pt; padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">g. Click the Submit button to create the new variable.</span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">16. Close the Workflow Inputs form.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">Now we are ready to test our new Turnstile Activity!</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><strong>Testing</strong></span></p><p style="margin-bottom: 0.0001pt;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">1. Now click the Run Workflow button on the top right. The Start Workflow form will appear.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">2. Click the Start button to run the workflow.</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> </span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><img   alt="" class="jiveImage image-1" src="31681c82db1c17049c9ffb651f9619f3.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">3. Accept the default of five loops.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">4. The workflow will loop through five times and then exit.</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> </span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><img   alt="" class="jiveImage image-2" src="41beb3b9dbd45fc03eb27a9e0f9619b8.iix" style="width: 620px; height: 398px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">5. From your ServiceNow browser tab Navigate to System Logs â†’ All. This will open the System Logs list view.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">6. Filter for all messages starting with ---&gt;</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">7. Order by date Created descending.   You should see something like the following. There should be five entries showing the counting up from zero to four, then a "FINAL" message should be printed out with all of the entries.</span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><img   alt="" class="image-3 jiveImage" src="4c32ed86dbdc1b04ed6af3231f961941.iix" style="display: block; margin-left: auto; margin-right: auto; width: 620px; height: 184px;"/></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">And now you have your very own Turnstile Activity.</span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"> </span></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">I have placed the Enhanced Turnstile Activity and the example from this lab out on the <a href="https://share.servicenow.com/app.do#/detailV2/45a8dea1457242007c39bada468d18cb/overview"><strong>share</strong></a> for you to download if you wish.<br/></span></p><p style="margin-bottom: 0.0001pt;"></p><p style="margin-bottom: 0.0001pt;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">Steven Bell</span></p><p style="font-weight: inherit; font-style: inherit; font-family: inherit;"><span style="color: #800080; font-size: 12pt; font-style: inherit; font-family: arial, helvetica, sans-serif; font-weight: inherit;"><strong>If you find this article helps you, don't forget to log in and "like" it!   I would also like to encourage you to become a member of our blog!</strong></span></p><p style="margin-bottom: .0001pt; background: white;"><span style="color: purple; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong><a _jive_internal="true" data-containerid="-1" data-containertype="-1" data-objectid="86661" data-objecttype="111" href="/servlet/JiveServlet/downloadImage/38-4985-86661/CS_logo.jpg"><img  alt="CS_logo.jpg" class="image-18 jive-image" height="60" src="7b0dff7ddbd01304b322f4621f961922.iix" width="151"/></a></strong></span><span style="color: purple; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong><a _jive_internal="true" data-containerid="2061" data-containertype="14" data-objectid="2273" data-objecttype="102" href="/community?id=community_article&sys_id=330d6ea5dbd0dbc01dcaf3231f961965"><img  alt="MVP-logo.jpeg" class="image-17 jive-image" height="48" src="8c91ad0edbd8d304b322f4621f961940.iix" width="135"/></a></strong></span></p><p><span style="color: #eb7a3d;">Please Share, Like, Comment this blog if you've found it helpful or insightful.</span></p><p></p><hr/><p><span style="color: #eb7a3d;"><span style="color: #303030;">for Click for <a title="" _jive_internal="true" href="/community?id=community_forum&sys_id=a6299a2ddbd897c068c1fb651f961926">More Expert Blogs </a>and also Find <a title="" _jive_internal="true" class="jivecontainerTT-hover-container jive-link-community-small" data-containerid="2059" data-containertype="14" data-objectid="2037" data-objecttype="14" href="/community?id=community_forum&sys_id=d6295a2ddbd897c068c1fb651f9619f1">Expert Events</a>!</span><br/></span></p><hr/><p>     </p><p><span class="jive-content-footer-item"></span></p>