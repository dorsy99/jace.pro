---
title: "ServiceNow Selenium Testing  Test Organization"
date: 2015-09-01T01:04:01.000Z
authors: ["jbauguess"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=78ccee25dbd0dbc01dcaf3231f9619d4"
---
<p><span style="font-size: 12pt;">Last time, I talked about the bare basic steps to get up and running with browser automation.   Today I'm going to show some test organization to use in your test suites.</span></p><p></p><p><span style="font-size: 12pt;">It's important to remember what our goals are as developers.   We're not testing every limit of the system.   Our browser tests are basically acceptance tests.   Let QA do the exploratory testing.   We want clearly defined paths that are repeatable and stable to ensure no changes to code break existing functionality.   How many times have you changed a UI policy or UI policy action only to have something unexpected happen in another state on the form?   With complex processes, this is a very real possibility.</span></p><p><span style="font-size: 12pt;"><br/></span></p><p><span style="font-size: 12pt;">I write tests that will do the following:</span></p><ol><li><span style="font-size: 12pt;">Take the quickest path through a process.   (ie: Create a change request, set it for approval, approve it, work it, close it.)</span></li><li><span style="font-size: 12pt;">Take a convoluted path through a process. (ie: Create a change request, set it for approval, move it back to planning, move to approval, move it back to planning, etc.)</span></li><li><span style="font-size: 12pt;">Reproduce any defects that have been found. (ie: Create a change request, set it for approval, reject it, make sure that the record state field didn't change but the approval value did change.)<br/></span></li></ol><p><span style="font-size: 12pt;">For me, right now, that's over 60 tests for change management alone (given different change types, different ci types, different number of times going through a convoluted path).<br/></span></p><p><span style="font-size: 12pt;"><br/></span></p><p><span style="font-size: 12pt;">The first thing to do is to write code to perform page operations.   This code needs to live outside the test class, so on either the page object class, or some extension of the page object class that will be used in the test.</span></p><p></p><p><span style="font-size: 12pt;">Example:</span></p><p></p><p><span style="font-size: 12pt; font-family: 'courier new', courier;">public void createChangeRequestByType(String changeType) {</span></p><p><span style="font-family: 'courier new', courier; font-size: 12pt;">     driver.get(getBASE_URL() + "change_request.do");</span></p><p><span style="font-family: 'courier new', courier; font-size: 12pt;">     useSelectElement(type, changeType);</span></p><p><span style="font-family: 'courier new', courier; font-size: 12pt;">     shortDescription.sendKeys("Testing a " + changeType + " change request");</span></p><p><span style="font-family: 'courier new', courier; font-size: 12pt;">     insertAndStayButton.click();</span></p><p><span style="font-family: 'courier new', courier; font-size: 12pt;">     sys_id = sysId.getAttribute("value");</span></p><p><span style="font-size: 12pt; font-family: 'courier new', courier;">}</span></p><p></p><p><span style="font-size: 12pt;">This is repeatable with different change types.   Of course, what if different types require different fields before proceeding?</span></p><p></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">public void createChangeRequestByType(String changeType) {</span></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">     driver.get(getBASE_URL() + "change_request.do");</span></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">     useSelectElement(type, changeType);</span></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">     shortDescription.sendKeys("Testing a " + changeType + " change request");</span></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;"><strong>     fillOutNewFormFieldsByType(changeType);</strong></span></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">     insertAndStayButton.click();</span></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">     sys_id = sysId.getAttribute("value");</span></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">}</span></p><p style="font-size: 13.3333330154419px;"></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">public void fillOutNewFormFieldsByType(String changeType) {</span></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">     switch(changeType) {</span></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">             case "Standard" :</span></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">                     fillOutStandardNewFields();</span></p><p style="font-size: 13.3333330154419px;"><span style="line-height: 1.5em; font-size: 12pt; font-family: 'courier new', courier;">                     break;</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; line-height: 1.5em; font-family: 'courier new', courier;">             case "Emergency" :</span></p><p style="font-size: 13.3333330154419px;"><span style="line-height: 1.5em; font-size: 12pt; font-family: 'courier new', courier;">                     fillOutEmergencyNewFields();</span></p><p style="font-size: 13.3333330154419px;"><span style="line-height: 1.5em; font-size: 12pt; font-family: 'courier new', courier;">                     break;</span></p><p style="font-size: 13.3333330154419px;"><span style="line-height: 1.5em; font-size: 12pt; font-family: 'courier new', courier;">             case "Routine" :</span></p><p style="font-size: 13.3333330154419px;"><span style="line-height: 1.5em; font-size: 12pt; font-family: 'courier new', courier;">                     fillOutRoutineNewFields();</span></p><p style="font-size: 13.3333330154419px;"><span style="line-height: 1.5em; font-size: 12pt; font-family: 'courier new', courier;">                     break;</span></p><p style="font-size: 13.3333330154419px;"><span style="line-height: 1.5em; font-size: 12pt; font-family: 'courier new', courier;">             default:</span></p><p style="font-size: 13.3333330154419px;"><span style="line-height: 1.5em; font-size: 12pt; font-family: 'courier new', courier;">                     fillOutStandardNewFields();</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; line-height: 1.5em; font-family: 'courier new', courier;">                     break;                     </span></p><p style="font-size: 13.3333330154419px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">     }</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">}</span></p><p style="font-size: 13.3333330154419px;"></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;">And, of course, add in the functions for each case in the switch statement.</span></p><p style="font-size: 13.3333330154419px;"></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;">Eventually, you'll have a lot of functions that all handle some portion of the workflow of the form.   Then your tests in your test classes become concise and very easy to read/debug:</span></p><p style="font-size: 13.3333330154419px;"></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">@Test</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">public void testStandardChangeRequestHappyPath() {</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.createChangeRequestByType("Standard");</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.moveChangeRequestToRequested();</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.approveChangeRequest();</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.workChangeRequest();</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.closeChangeRequest();</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">}</span></p><p style="font-size: 13.3333330154419px;"></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">@Test</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">public void testStandardChangeRequestRejectionPath() {</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.createChangeRequestByType("Standard");</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.moveChangeRequestToRequested();</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.rejectChangeRequest();</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.closeChangeRequest();</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">}</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;"><br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">@Test</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">public void testRoutineChangeRequestHappyPath() {</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.createChangeRequestByType("Routine");</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.workChangeRequest();</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     change.closeChangeRequest();</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">}</span></p><p style="font-size: 13.3333330154419px;"></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;">Even a non-programmer could look at those blocks of code and have a reasonable idea as to what was going on in the tests at a high level.</span></p><p style="font-size: 13.3333330154419px;"></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;">Next, let's talk assertions.</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;"><br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;">On the BaseTest class I have written a few functions that take a WebElement as an argument and determine if that element is read-only or mandatory.   Using those functions, we can ensure our UI Policies are working in the correct states.</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;"><br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">public void standardNewRecordAssertions() {</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     assertTrue("Short Description is mandatory on new standard changes", change.isMandatory(change.shortDescriptionSpan));</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">     assertTrue("Opened By is read only", change.isReadOnly(change.openedBySpan));</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">}</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;"><br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;">You may be wondering why the syntax includes the page object, where above they functions do not.   I buy in to <a title="rtinfowler.com/bliki/PageObject.html" href="http://martinfowler.com/bliki/PageObject.html">Martin Fowler's view of Page Objects</a>: even though the assertions being repeatable is nice, the page object isn't supposed to do the asserting, the test is.   (Of course, I'm also not truly encapsulating my page operations in private variables with getters and setters, but that's more of a convenience since there are so many variables and the classes are long enough as they are.   In all honestly I do need to do that at some point.)<br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;"><br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;">Inserting that method appropriately into a function can tell us if the user is getting the correct field states, given a form state.   Of course, this is where most of your test failures can come from, I've found.   Sometimes the UI Policies take a while to load, or at least, take long enough to where the test will fail the assertion.   Tread carefully on these.   It may be necessary to use the <a title="lenium.googlecode.com/git/docs/api/java/org/openqa/selenium/support/ui/ExpectedConditions.html" href="http://selenium.googlecode.com/git/docs/api/java/org/openqa/selenium/support/ui/ExpectedConditions.html">ExpectedConditions</a> class and <a title="elenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/support/ui/WebDriverWait.html" href="https://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/support/ui/WebDriverWait.html">WebDriverWait</a>.</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;"><br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">WebDriverWait wait = new WebDriverWait(driver, 30);</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">wait.until(ExpectedConditions.visibilityOf(change.shortDescription));</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;"><br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;">WebDriverWait allows you to force the page to wait for a specific condition.   These conditions are defined with the ExpectedConditions class.   You can also craft your own ExpectedConditions and pass those into the until function.</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;"><br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">wait.until(new ExpectedCondition&lt;Boolean&gt;() {</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">                                       public Boolean apply(WebDriver d) {</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">                                                 return d.findElement(By.id("my-element")).isDisplayed();<br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">                                       }</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">                             });</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;"><br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;">I haven't needed to make my own custom conditions yet, so I don't have a great deal of experience with them.</span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;"><br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;">I'm currently working on testing that includes the left nav pane of the form.   Working with iFrames in Selenium is a pain, and most of my testing really is concerned with the form itself, not the nav pane.   However, I do want to get some tests that ensure that clicking on links yields the correct results.   Spoiler alert: the page object that has the left nav links is over 500 variables (at least for my instance it is)!<br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;"><br/></span></p><p style="font-size: 13.3333330154419px;"><span style="font-size: 12pt;">That's all for this time.   Happy testing.<br/></span></p>