---
title: "Looking through your eyes"
date: 2015-06-17T02:59:00.000Z
authors: ["Slava"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=325eaaaddbd0dbc01dcaf3231f9619fe"
---
<p style="text-align: justify;">Quite often there is a need to set up reports that return different results depending on who runs them. In versions before Dublin, it could be done fairly easily using <a title="ki.servicenow.com/index.php?title=Using_Filters_and_Breadcrumbs#Scripted_Filters" href="http://wiki.servicenow.com/index.php?title=Using_Filters_and_Breadcrumbs#Scripted_Filters">scripted filters</a>. With introduction of <a title="ki.servicenow.com/index.php?title=Using_Filters_and_Breadcrumbs#Dynamic_Filter_Options" href="http://wiki.servicenow.com/index.php?title=Using_Filters_and_Breadcrumbs#Dynamic_Filter_Options">dynamic filter options</a> in Dublin, this feature has become even more intuitive as you no longer need to memorize things like <strong>gs.getUserID()</strong> or <strong>getMyGroups()</strong>. What is not as straightforward, however, is testing of such reports.</p><p style="text-align: justify;"></p><p style="text-align: justify;">In many cases, reports are created by non-admin users directly in a production instance where for security reasons you cannot allow them to <a title="iki.servicenow.com/index.php?title=Impersonating_a_User" href="https://wiki.servicenow.com/index.php?title=Impersonating_a_User">impersonate</a> other users (those who will be using the reports). Requiring all reports to be created in a test instance first is also not an option. Non-admin users will not be able to transfer reports between instances and will either have to redo them in production or involve system administrators, which is too much of an overhead. Besides, a test instance may not have the most recent data even if you clone it from production regularly.</p><p style="text-align: justify;"></p><p style="text-align: justify;">If this problem sounds familiar to you, here is a workaround you might find helpful. Instead of using <strong>gs.getUserID()</strong> or <strong>getMyGroups()</strong> in reports, you can create your own functions that will return the ID or the list of groups of another user depending on the value of a user preference:</p><p style="text-align: justify;"></p><p>1. Create a very simple <a title="iki.servicenow.com/index.php?title=UI_Pages" href="https://wiki.servicenow.com/index.php?title=UI_Pages">UI page</a> with a reference field pointing to <strong>Users [sys_user]</strong> table. This is where your report creators will choose a user through whose eyes they want to view reports. Use processing script to save their selection as a <a title="ki.servicenow.com/index.php?title=User_Preferences" href="http://wiki.servicenow.com/index.php?title=User_Preferences">user preference</a>.</p><p></p><p>2. Make this UI page accessible via a module in the navigation pane, a <a title="iki.servicenow.com/index.php?title=UI_Actions" href="https://wiki.servicenow.com/index.php?title=UI_Actions">UI action</a> in the user's profile, or elsewhere. Since the page is so simplistic, you may want to display it in a <a title="ki.servicenow.com/index.php?title=GlideDialogWindow_API_Reference" href="http://wiki.servicenow.com/index.php?title=GlideDialogWindow_API_Reference">GlideDialogWindow</a> to make it look elegant.</p><p></p><p><img   alt="view_reports_as.png" class="image-0 jive-image" src="60ab49c6dbd497049c9ffb651f96195d.iix" style="height: auto;"/></p><p></p><p>3. In a global business rule, define functions that will read the user preference and return results based on its value. If no preference is set for the current user, these functions should default to the out-of-box ones, such as <strong>gs.getUserID()</strong> or <strong>getMyGroups()</strong>.</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14344919770558507 jive_text_macro jive_macro_code" jivemacro_uid="_14344919770558507">
<p>function getRepUserID() {</p>
<p>       var view_as_user = gs.getUser().getPreference('view_reports_as');</p>
<p></p>
<p>       if (view_as_user == null || view_as_user == '')</p>
<p>               view_as_user = gs.getUserID();</p>
<p></p>
<p>       return view_as_user;</p>
<p>}</p>
<p></p>
<p>function getRepGroups() {</p>
<p>       var view_as_sys_id = getRepUserID();</p>
<p>       var view_as_groups = gs.getUser().getUserByID(view_as_sys_id).getMyGroups();</p>
<p></p>
<p>       return view_as_groups;</p>
<p>}</p>

</pre><p></p><p></p><p>4. Finally, create <a title="ki.servicenow.com/index.php?title=Using_Filters_and_Breadcrumbs#Dynamic_Filter_Options" href="http://wiki.servicenow.com/index.php?title=Using_Filters_and_Breadcrumbs#Dynamic_Filter_Options">dynamic filter options</a> that will leverage the new functions and, optionally, hide the out-of-box ones.</p><p style="text-align: justify;"></p><p style="text-align: justify;"><strong>Important!</strong> This solution does not change the security context in any way. Results returned by the reports will be constrained by security rules applicable to the current user, not the one indicated in the user preference.</p>