---
title: "MiniLab Web Services  Part  Using an Encoded Query"
date: 2015-11-25T10:09:45.000Z
authors: ["sabell2012"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=914ee2addbd0dbc01dcaf3231f9619a0"
---
<p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">In my previous article we used a SOAP Client to send a simple query to ServiceNow to retrieve a set of records.   Building on what we did in that article I wanted to next tackle encoded queries.</span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">In reality this isn't much different than GlideRecord encoded queries. ServiceNow has provided in each out-of-the-box table WSDL an encoded query parameter that allows you to do essentially the same thing.</span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;"><strong>Prerequisites:</strong></span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">If you have already performed the lab in my previous article you can skip the prerequisites.</span></p><p style="margin-bottom: .0001pt;"></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">1. Some sort of SOAP Client installed on your test machine. In the lab I will be using SoapUI.</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">2. Create a web service user with itil and soap roles in ServiceNow.</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">3. Perform the first lab: <a _jive_internal="true" href="/groups/servicenow-user-group-us-tx-north-texas/blog/2015/11/23/mini-lab-web-services-part-1-using-soapui-to-test-servicenow-wsdl"><span style="color: #266fc8; background: #F8FBFE;">Mini-Lab: Web Services — Part 1: Using SoapUI to Test ServiceNow WSDL</span></a></span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;"><strong><span style="font-size: 18pt;">Lab 2.1: Executing an a Date Range Query With a SOAP Client</span> </strong></span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">In this lab we will be pulling back a set of records based on a date range.</span></p><p style="margin-bottom: .0001pt;"></p><p><span style="font-size: 12pt; line-height: 1.5;">1. Using our previous SoapUI project; edit the XML to look like the following:</span></p><p style="margin-bottom: .0001pt;"></p><pre __default_attr="xml" __jive_macro_name="code" class="_jivemacro_uid_14484242122154777 jive_macro_code jive_text_macro" data-renderedposition="497_8_1192_128" jivemacro_uid="_14484242122154777"><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;"><span>&lt;soapenv:Envelope xmlns:soapenv="</span><a title="" _jive_internal="true" href="/schemas.xmlsoap.org/soap/envelope" rel="nofollow" target="_blank">http://schemas.xmlsoap.org/soap/envelope/</a><span>" xmlns:inc="</span><a title="" _jive_internal="true" href="/www.service-now.com/incident" rel="nofollow" target="_blank">http://www.service-now.com/incident</a><span>"&gt;</span></span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">     &lt;soapenv:Header/&gt;</span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">     &lt;soapenv:Body&gt;</span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">             &lt;inc:getRecords&gt;</span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">                     <span style="color: red;">&lt;__encoded_query&gt;sys_updated_on&amp;gt;=2015-05-10 00:00:00^sys_updated_on&amp;lt;=2015-11-20 23:59:59&lt;/__encoded_query&gt;</span></span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">             &lt;/inc:getRecords&gt;</span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">     &lt;/soapenv:Body&gt;</span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">&lt;/soapenv:Envelope&gt;</span></p></pre><p style="margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="font-size: 12pt;"><strong>NOTE</strong>:   This will retrieve all Incident records that were updated between the two dates mentioned.</span></p><p></p><p><span style="font-size: 12pt;">2. Click on the play button to run the query.   You should see your results appear in the results panel to the right of the query.</span></p><p></p><p><span style="font-size: 12pt;">3. Look through the results and make sure that the updated date falls within the range specified in your query.</span></p><p></p><p style="margin-bottom: .0001pt;"><img   class="image-1 jive-image" src="f36c8c02db5c1344e9737a9e0f9619bd.iix" style="display: block; margin-left: auto; margin-right: auto; width: 620px; height: 350px;"/></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">As you can see the encoded query is actually pretty straight-forward.   It is knowing the syntax that is secret.</span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">Now let us try something a bit more complex.</span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 18pt;"><strong>Lab 2.2: Executing an Encoded Query With Additional Filters</strong></span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">Here we will pull back all records that are Active and were the Assigned To user ID is either Beth Anglin or David Woo.</span></p><p style="margin-bottom: .0001pt;"></p><pre __default_attr="xml" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14484242209294480 jive_text_macro" data-renderedposition="1368_8_1192_144" jivemacro_uid="_14484242209294480"><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;"><span>&lt;soapenv:Envelope xmlns:soapenv="</span><a title="" _jive_internal="true" href="/schemas.xmlsoap.org/soap/envelope" rel="nofollow" target="_blank">http://schemas.xmlsoap.org/soap/envelope/</a><span>" xmlns:inc="</span><a title="" _jive_internal="true" href="/www.service-now.com/incident" rel="nofollow" target="_blank">http://www.service-now.com/incident</a><span>"&gt;</span></span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">     &lt;soapenv:Header/&gt;</span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">     &lt;soapenv:Body&gt;</span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">             &lt;inc:getRecords&gt;</span></p><p style="margin-bottom: .0001pt;"><span style="color: red; font-size: 12pt;">                   &lt;active&gt;true&lt;/active&gt;</span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;"><span style="color: red;">                   &lt;__encoded_query&gt;</span><span style="color: red;">assigned_to.user_name<strong>IN</strong>beth.anglin,david.loo</span><span style="color: red;">&lt;/__encoded_query&gt;</span></span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">             &lt;/inc:getRecords&gt;</span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">     &lt;/soapenv:Body&gt;</span></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">&lt;/soapenv:Envelope&gt;</span></p></pre><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">NOTE: A couple of things here.   Note that you can mix in the fields from the WSDL; as in this case here the active field is used.   This, of course, could just as easily been added into the encoded query, but I wanted to show what was possible.   Also note that the assigned_to field is actually the sys_id of a user.   So it will be necessary to dot-walk to the user id field (user_name) to get at the real-English names. </span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><img   class="image-2 jive-image" src="2aefa3f9db5c93049c9ffb651f961983.iix" style="width: 620px; height: 351px; display: block; margin-left: auto; margin-right: auto;"/></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 18pt;"><strong>Encoded Query Reference:</strong></span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;">I thought I would throw in a "non-comprehensive, but overall pretty good" reference of what I have tested and found to work with the encoded query parameter.</span></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">These are all URL encoded queries.   It is <span style="text-decoration: underline;">not</span> necessary to encode everything.</span><ul style="list-style-type: circle;"><li><span style="color: black; font-size: 12pt;">Dates are any valid date format.   I prefer: yyyy-mm-dd</span></li><li><span style="color: black; font-size: 12pt;">Dates and strings are not to be surrounded by quotes. Exception: When working with JavaScript values.</span></li><li><span style="font-size: 12pt;"><span style="color: black;">The "&gt;" symbol is encoded as </span><span style="color: #00b050;">&amp;gt;</span></span></li><li><span style="font-size: 12pt;"><span style="color: black;">The "&lt;" symbol is encoded as </span><span style="color: #00b050;">&amp;lt;</span></span></li><li><span style="font-size: 12pt;">Less than or equal to: <span style="color: #00b050;">&amp;lt;=</span></span></li><li><span style="font-size: 12pt;">Greater than or equal to: <span style="color: #00b050;">&amp;gt;=</span></span></li><li><span style="color: black; font-size: 12pt;">AND is represented by "^"</span></li><li><span style="color: black; font-size: 12pt;">OR is represented by "^OR"</span></li><li><span style="font-size: 12pt;"><span style="color: black;">Booleans:   </span><span style="color: #00b050;">false</span><span style="color: #00b050;">true</span></span></li><li><span style="font-size: 12pt;"><span style="color: black;">NOT is "&lt;&gt;"   and is indicated thus </span><span style="color: #00b050;">&amp;lt;&amp;gt;</span></span></li><li><span style="color: black; font-size: 12pt;">Dot walking is allowed!</span></li><li><span style="font-size: 12pt;"><span style="color: black;"><strong>NOTE</strong></span><span style="color: black;">: It is not allowed to use parenthesis in encoded queries.</span></span></li></ul></li></ul><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">AND Query</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="font-size: 12pt;"><span style="color: black;">sys_updated_on=2015-05-10</span><span style="color: red;"><strong>^</strong></span><span style="color: black;">sys_updated_by.user_name=Admin</span></span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;">This would return all records updated by user Admin on 10/5/2015.</span></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">OR Query</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="font-size: 12pt;"><span style="color: black;">sys_updated_on=2015-05-10</span><span style="color: red;"><strong>^OR</strong></span><span style="color: black;">sys_updated_on=2015-05-15</span></span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;">This would return all records updated on 5/10 and 5/15/2015.</span></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">IN Query</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt; text-indent: .5in;"><span style="font-size: 12pt;"><span style="color: black;">assigned_to.user_name</span><span style="color: red;"><strong>IN</strong></span><span style="color: black;">beth.anglin,david.loo</span></span></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">CONTAINS Query</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt; text-indent: .5in;"><span style="font-size: 12pt;"><span style="color: black;">sys_updated_by</span><span style="color: red;"><strong>CONTAINS</strong></span><span style="color: black;">beth.anglin</span></span></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">Starting a NEW Query (NQ)</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt; text-indent: .5in;"><span style="font-size: 12pt;"><span style="color: black;">sys_updated_by</span><span style="color: red;"><strong>CONTAINS</strong></span><span style="color: black;">beth.anglin</span><span style="color: red;"><strong>^NQ</strong></span><span style="color: black;">sys_id=5137153cc611227c000bbd1bd8cd2007</span></span></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">LIKE Query (end wild card is implied)</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt; text-indent: .5in;"><span style="font-size: 12pt;"><span style="color: black;">sys_updated_by</span><span style="color: red;"><strong>LIKE</strong></span><span style="color: black;">beth.a</span></span></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">ROLE Query</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt; text-indent: .5in;"><span style="font-size: 12pt;"><span style="color: red;"><strong>roles=</strong></span><span style="color: black;">itil</span></span></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">Choice Query (by value field)</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt; text-indent: .5in;"><span style="color: black; font-size: 12pt;">install_status=1</span></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">Javascript parameters are allowed</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt; text-indent: .5in;"><span style="font-size: 12pt;"><span style="color: black;">sys_updated_on</span><span style="color: #339933;">&amp;gt;</span><span style="color: black;">javascript</span><span style="color: #339933;">:</span><span style="color: black;">gs.</span><span style="color: #660066;">dateGenerate</span>('2015-05-10','23:59:59')</span></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">ORDER BY Query</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt; text-indent: .5in;"><span style="font-size: 12pt;"><span style="color: black;">unit_name=day</span><span style="color: red;"><strong>^ORDERBY</strong></span><span style="color: black;">value</span></span></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">BETWEEN Query</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;"><strong>What did work:</strong></span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="font-size: 12pt;"><span style="color: black;">sys_updated_on</span><span style="color: #00b050;"><strong>&amp;gt;</strong></span><span style="color: #00b050;">=</span><span style="color: black;">2015-05-10 00:00:00</span><span style="color: #00b050;"><strong>^</strong></span><span style="color: black;">sys_updated_on</span><span style="color: #00b050;"><strong>&amp;lt;</strong></span><span style="color: black;">2015-05-20 23:59:59</span></span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;"><strong>What did <span style="text-decoration: underline;">not</span> work:</strong></span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;">Interestingly I was not able to get BETWEEN to work and by all accounts it should have.</span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;">sys_updated_onBETWEEN2015-05-15^2015-06-15</span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;">sys_updated_onBETWEEN2015-05-15,2015-06-15</span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;">sys_updated_onBETWEENjavascript:gs.dateGenerate('2015-11-01','00:00:00')@javascript:gs.daysAgoEnd(0)</span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"></p><ul style="list-style-type: disc;"><li><span style="color: black; font-size: 12pt;">INSTANCEOF Query</span></li></ul><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt; text-indent: .5in;"><span style="font-size: 12pt;"><span style="color: black;">sys_class_name</span><span style="color: red;"><strong>INSTANCEOF</strong></span><span style="color: black;">cmdb_ci_computer</span></span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="font-size: 12pt;"><span style="color: black;"><strong>NOTE</strong></span><span style="color: black;">:   This query replaces:</span></span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;">sys_class_name=cmdb_ci_computer</span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;">^ORsys_class_name=cmdb_ci_server</span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;">^ORsys_class_name=cmdb_ci_win_server</span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;">^ORsys_class_name=cmdb_ci_unix_server</span></p><p style="margin-left: .5in; margin-bottom: .0001pt;"><span style="color: black; font-size: 12pt;">^ORsys_class_name=cmdb_ci_linux_server</span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt;"><span style="font-size: 12pt;"><strong>Some great references:</strong></span></p><p><span style="font-size: 12pt;"><strong><br/></strong></span><span style="color: #0070c0; text-decoration: underline; font-size: 12pt;"><strong><a href="https://wiki.servicenow.com/index.php?title=Direct_Web_Services"><span style="color: #0070c0;">https://wiki.servicenow.com/index.php?title=Direct_Web_Services</span></a></strong></span></p><p style="margin-bottom: .0001pt;"><span style="color: #0070c0; font-size: 12pt;"><a href="http://wiki.servicenow.com/index.php?title=Direct_Web_Service_API_Functions"><span style="color: #0070c0;"><strong>http://wiki.servicenow.com/index.php?title=Direct_Web_Service_API_Functions</strong></span></a></span></p><p style="margin-bottom: .0001pt;"></p><p style="margin-bottom: .0001pt; background: white;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">There you go!   Now you can see how encoded queries can be used by an external Soap Client to retrieve information from a ServiceNow table.</span></p><p style="margin-bottom: .0001pt; background: white;"></p><p style="margin-bottom: .0001pt; background: white;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">In my next article I will show how what we have covered so far with WSDL and Soap Clients can help with the creation of ServiceNow Scripted Web Services.</span></p><p style="margin-bottom: .0001pt; background: white;"></p><p style="margin-bottom: .0001pt; background: white;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;">Steven Bell</span></p><p style="background: white;"></p><p style="background: white;"><span style="color: purple; font-size: 12pt; font-family: 'Calibri','sans-serif'; font-style: inherit;"><strong>If you find this article helps you, don't forget to log in and "like" it!</strong></span></p><p style="background: white;"></p><p style="background: white;"><span style="color: purple; font-size: 12pt; font-family: 'Calibri','sans-serif'; font-style: inherit;"><strong>Also, if you are not already, I would like to encourage you to become a member of our blog!</strong></span></p><p style="margin-bottom: .0001pt; background: white;"><span style="color: purple; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong><a _jive_internal="true" data-containerid="-1" data-containertype="-1" data-objectid="86661" data-objecttype="111" href="/servlet/JiveServlet/downloadImage/38-4985-86661/CS_logo.jpg"><img  alt="CS_logo.jpg" class="image-18 jive-image" height="60" src="db03114edbd4130468c1fb651f96190b.iix" width="151"/></a></strong></span><span style="color: purple; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong><a _jive_internal="true" data-containerid="2061" data-containertype="14" data-objectid="2273" data-objecttype="102" href="/community?id=community_article&sys_id=330d6ea5dbd0dbc01dcaf3231f961965"><img  alt="MVP-logo.jpeg" class="image-17 jive-image" height="48" src="e9ca2086db94dfc068c1fb651f96191f.iix" width="135"/></a></strong></span></p><p><span style="color: #eb7a3d;">Please Share, Like, Comment this blog if you've found it helpful or insightful.</span></p><p></p><hr/><p><span style="color: #e23d39;">For other Expert Knowledge</span></p><p><span style="font-size: 11pt;"><strong><a title="" _jive_internal="true" href="/bit.ly/1njDGAZ">Ask A Developer</a>             <a title="" _jive_internal="true" href="/bit.ly/1Pg93au">What's In Store For IT Leaders in 2016 </a>           <a title="" _jive_internal="true" href="/bit.ly/1PxAtEE">ServiceNow Online Learning Courses   </a>       <a title="" _jive_internal="true" href="/bit.ly/1Qo39TY">ServiceNow Foundations: User Interface</a></strong></span></p><hr/><p><span style="color: #000000; font-size: 12pt; font-family: Calibri;">   </span></p>