---
title: "MiniLab Adding Underscorejs Into ServiceNow"
date: 2015-11-06T00:05:52.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=dcfc62a5dbd0dbc01dcaf3231f961924"
---
<p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">In one of my responses out on the <a title="Scripting" __default_attr="2104" __jive_macro_name="community" class="jive_macro_community jive_macro" data-orig-content="Scripting" data-renderedposition="10.5_254.46665954589844_81_19" href="undefined2104">Scripting</a> forum <a title="kevinanderson" __default_attr="42943" __jive_macro_name="user" class="jive_macro jive_macro_user" data-orig-content="kevinanderson" data-renderedposition="10.5_385.5333251953125_123_19" href="/community?id=community_user_profile&user=37401629db581fc09c9ffb651f961902">kevinanderson</a> made a wistful comment about wishing we had a compatible port of underscore.js.   It got me to thinking, and I believe I have found a pretty straightforward way to implement it!</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><strong>Prerequisites:</strong></span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">1. Know the basics of scripting in ServiceNow.</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">2. Familiar with UI Action, Fix Scripts, Script Includes, and UI Scripts.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><strong>What will be covered:</strong></span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">1. Script Include port</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">2. UI Script port</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">3. GlideSystem Include (gs.include)</span></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">4. Testing of the entire port</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><strong>Requirements:</strong></span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">1. The underscore.js library must be available and fully functional on both the front- (browser), and back-end (Server) Scripting environments.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><strong>Design:</strong></span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">1. Since UI Scripts are not available to the Server, and Script Includes are not available to the browser this will have to be a split or double port.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><img   alt="" class="image-1 jive-image" src="8250610edb9c1b04ed6af3231f961949.iix" style="max-width: 1200px; max-height: 900px;"/></span></p><p></p><p><span style="font-size: 14pt; font-family: arial,helvetica,sans-serif;"><strong>Lab 1.1: Port underscore.js to the Server Side</strong></span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">1. In your ServiceNow instance navigate to System Definition -&gt; Script Includes.   The Script Includes list view will be displayed.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">2. Click on the New button.   A blank Script Include form will be displayed.</span></p><p></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">3. Fill in the form with the following:</span></p><p></p><p style="padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><strong>Name</strong>:   underscorejs.min</span></p><p style="padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><strong>Client Callable</strong>: unchecked</span></p><p style="padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><strong>Active</strong>: checked</span></p><p style="padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">Leave the <strong>Script</strong> blank for the moment.</span></p><p style="padding-left: 30px;"></p><p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">4. Now we need the actual underscore.js code.   There are two flavors:   full, and min.   Min means <a title="n.wikipedia.org/wiki/Minification_(programming)" href="https://en.wikipedia.org/wiki/Minification_(programming)">minified</a> and comes out to around 10k-ish bytes size.   Perfect for our needs so we will be using that.   The full code is worthy of study.</span></p><p></p><p style="padding-left: 30px;"><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">a. Navigate to <a title="derscorejs.org/" href="http://underscorejs.org/">Underscore.js homesite</a> -&gt; <a title="ithub.com/jashkenas/underscore" href="https://github.com/jashkenas/underscore">GitHub</a> -&gt; <a class="js-navigation-open js-directory-link" href="https://github.com/jashkenas/underscore/blob/master/underscore-min.js" style="color: #4078c0; text-decoration: underline; font-family: Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, 'Segoe UI Emoji', 'Segoe UI Symbol'; font-size: 13px; font-style: normal; font-weight: normal; text-align: start; text-indent: 0px; background-color: #f5f5f5;" title="underscore-min.js">underscore-min.js</a></span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">b. Copy out just code from the window.</span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><img   alt="1.underscore_github copy.jpg" class="image-2 jive-image" src="7e1b3f31dbd45704ed6af3231f96193d.iix" style="width: 620px; height: 300px; display: block; margin-left: auto; margin-right: auto;"/>c. Go back to your Script Include and paste the underscore.js code into the Script field.</span></p><p></p><p><span style="font-size: 12pt;"><img   alt="2.underscore_script include.png" class="image-3 jive-image" src="f889250edbdc130468c1fb651f9619d1.iix" style="width: 620px; height: 317px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>NOTE</strong>: That the editor complains (the red "x") next to line 5.   If you hover over that icon it should say:   Expected ')' to match '(' from line 5 and instead saw ','.   Ignore this error.</span></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">d. Click the Submit button to save your work.   You will get an error popup.   Click the ok button and save the script (it might actually pop more than once so keep clicking Ok).</span></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><img   alt="3.underscore_popup error.png" class="image-4 jive-image" src="7e90c1c6db9c9304b322f4621f96190f.iix" style="height: auto; display: block; margin-left: auto; margin-right: auto;"/>e. That is it for activating the underscore.js library on the Server side.   So let's test it out.</span></p><p></p><p><span style="font-size: 12pt;">5. Navigate to System Definition -&gt; Fix Scripts.   The Fix Scripts list view will appear.</span></p><p></p><p><span style="font-size: 12pt;">6. Click the New button.   A blank Fix Scripts form will be displayed.</span></p><p></p><p><span style="font-size: 12pt;">7. Fill the form out with the following:</span></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Name</strong>: Underscore.js Test</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Active</strong>: checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Description</strong>: Code to test the underscore.js library (Server Side)</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>Script</strong>:</span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14467439304813861 jive_macro_code jive_text_macro" data-renderedposition="2703_8_1192_192" jivemacro_uid="_14467439304813861" modifiedtitle="true"><p><span style="font-size: 12pt;">gs.include('underscorejs.min');   // bring in our library</span></p><p></p><p><span style="font-size: 12pt;">var even = _.find([1, 2, 3, 4, 5, 6], function(num){ return num % 2 == 0; });</span></p><p><span style="font-size: 12pt;">gs.print(even);</span></p><p></p><p><span style="font-size: 12pt;">var map1 = _.map([1, 2, 3], function(num){ return num * 3; });</span></p><p><span style="font-size: 12pt;">var map2 = _.map({one: 1, two: 2, three: 3}, function(num, key){ return num * 3; });</span></p><p><span style="font-size: 12pt;">var map3 = _.map([[1, 2], [3, 4]], _.first);</span></p><p></p><p><span style="font-size: 12pt;">gs.print(map1);</span></p><p><span style="font-size: 12pt;">gs.print(map2);</span></p><p><span style="font-size: 12pt;">gs.print(map3);</span></p></pre><p></p><p><span style="font-size: 12pt;"><strong>NOTE</strong>:   I copied and modified the examples from the underscore.js home page.   <span __jive_emoticon_name="happy" __jive_macro_name="emoticon" class="jive_emote jive_macro" data-renderedposition="2917.5_579.11669921875_16_16" src="/8.0.1.35b65d4/images/emoticons/happy.png"></span></span></p><p></p><p><span style="font-size: 12pt;">8. Click on the Submit button to save your work.</span></p><p></p><p><span style="font-size: 12pt;"><img   alt="4.underscore_fix script.png" class="image-5 jive-image" src="3eef9002db9c1f048c8ef4621f961923.iix" style="width: 620px; height: 285px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p></p><p><span style="font-size: 12pt;">9. Now run your Fix Script.   You should see the following results:</span></p><p></p><p><span style="font-size: 12pt;"><img   alt="5.underscore_fix script_result.png" class="image-6 jive-image" src="df2ff731dbd01344e9737a9e0f961949.iix" style="height: auto; display: block; margin-left: auto; margin-right: auto;"/></span></p><p><span style="font-size: 12pt;">Woohoo!   It worked!   Now let's go get it working for the browser side.</span></p><p></p><p></p><p><span style="font-size: 14pt; font-family: arial,helvetica,sans-serif;"><strong>Lab 1.2: Port underscore.js to the Browser Side</strong></span></p><p></p><p><span style="font-size: 12pt;">Since this type of Script Include is not available to the Client Side then we need to create a library that is also available to the Browser.   To do this we will need to use a UI Script.</span></p><p></p><p><span style="font-size: 12pt;">1. From your ServiceNow instance navigate to System UI -&gt; UI Scripts.   The UI Scripts list view will be displayed.</span></p><p><span style="font-size: 12pt;">2. Click on the New button.   A blank UI Script form will be displayed.</span></p><p><span style="font-size: 12pt;">3. Fill out the form with the following:</span></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">a.<strong> Name</strong>: underscorejs.min</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">b.<strong> Global</strong>: checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">c.<strong> Active</strong>: checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">d.<strong> Script</strong>:   Go get the underscore-min.js code again and paste it here just like you did with the Script Include in Lab 1.1.</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">e. Click the Submit button to save your work.   You will get the same Syntax Error popups that you received with the Script Include submit.   Click Ok on all that appear.   They have no affect on things.   Just the editor complaining about nothing.   <span __jive_emoticon_name="silly" __jive_macro_name="emoticon" class="jive_emote jive_macro" data-renderedposition="4053.5_628.4833374023438_16_16" src="/8.0.1.35b65d4/images/emoticons/silly.png"></span><br/></span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><img   alt="6.underscore_ui script.png" class="image-7 jive-image" src="eb52a946db5c130468c1fb651f96191e.iix" style="width: 620px; height: 313px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p style="padding-left: 30px;"></p><p style="padding-left: 30px;"><span style="font-size: 12pt;"><strong>NOTE</strong>: Global UI Scripts are not available in Scoped applications.</span></p><p style="padding-left: 30px;"></p><p><span style="font-size: 12pt;">Now we are done with setup, let us go and do a test!   For that we will be creating a new button on the Incident form that will do nothing more than test our new underscore.js library.   This button will not interact with the Incident, but instead the Incident provides a platform for us to test our functionality.<br/></span></p><p></p><p><span style="font-size: 12pt;">4. Navigate to System UI -&gt; UI Actions.   The UI Actions list view will be displayed.</span></p><p></p><p><span style="font-size: 12pt;">5. Click the New button.   A blank UI Action form will be displayed.</span></p><p></p><p><span style="font-size: 12pt;">6. Fill out the form with the following:</span></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">a.<strong> Name</strong>: Test Underscore.js</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">b.<strong> Table</strong>: Incident</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">c.<strong> Order</strong>: 100</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">d.<strong> Form Button</strong>: checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">e.<strong> Active</strong>: Checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">f.<strong> Show insert</strong>: Checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">g.<strong> Show update</strong>: Checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">h.<strong> Client</strong>: Checked</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">i.<strong> Onclick</strong>: test()</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">j.<strong> Script</strong>:</span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14467451361084128" data-renderedposition="4965_8_1192_144" jivemacro_uid="_14467451361084128"><p><span style="font-size: 12pt;">function test() {</span></p><p><span style="font-size: 12pt;">       alert ('ready');</span></p><p><span style="font-size: 12pt;">       try {</span></p><p><span style="font-size: 12pt;">               _.each([1, 2, 3], alert);</span></p><p><span style="font-size: 12pt;">       }</span></p><p><span style="font-size: 12pt;">       catch(err) {</span></p><p><span style="font-size: 12pt;">               alert(err);</span></p><p><span style="font-size: 12pt;">       }</span></p><p><span style="font-size: 12pt;">}</span></p></pre><p></p><p><span style="font-size: 12pt;">7. Click the Submit button to save your work.</span></p><p></p><p><span style="font-size: 12pt;"><img   alt="7.underscore_ui action.png" class="image-8 jive-image" src="b635c1cedb1497049c9ffb651f961923.iix" style="width: 620px; height: 313px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p></p><p><span style="font-size: 12pt;">8. Navigate to Incident -&gt; Open.   The Open Incidents list view will be displayed.</span></p><p></p><p><span style="font-size: 12pt;">9. Click on an Incident and open it.   The Incident form should be displayed and you should see our new button in the upper right of the form.</span></p><p></p><p><img   alt="8.underscore_incident test.png" class="image-9 jive-image" src="e24f9c4edb1057049c9ffb651f9619eb.iix" style="width: 620px; height: 314px; display: block; margin-left: auto; margin-right: auto;"/></p><p><span style="font-size: 12pt;">10. Click on the Test Underscore.js button.   You should see an Alert box like this:</span></p><p></p><p><span style="font-size: 12pt;"><img   alt="9.underscore_ready.png" class="image-10 jive-image" src="765c3bb5dbd01304b322f4621f961991.iix" style="height: auto; display: block; margin-left: auto; margin-right: auto;"/></span></p><p></p><p><span style="font-size: 12pt;">11. Keep clicking Ok and you will see the following popups in a row:</span></p><p></p><p><span style="font-size: 12pt;"><img   alt="10.underscore_one.png" class="image-11 jive-image" src="c350ed0adb9cd344e9737a9e0f961946.iix" style="height: auto; display: block; margin-left: auto; margin-right: auto;"/></span></p><p><span style="font-size: 12pt;"><img   alt="11.underscore_two.png" class="image-12 jive-image" src="06c00d0adb9c9304b322f4621f961954.iix" style="height: auto; display: block; margin-left: auto; margin-right: auto;"/></span></p><p><span style="font-size: 12pt;"><img   alt="12.underscore_three.png" class="image-13 jive-image" src="50dc5046db985304b322f4621f96197f.iix" style="height: auto; display: block; margin-left: auto; margin-right: auto;"/></span></p><p></p><p><span style="font-size: 12pt;">It works!!!! Woohoo!   Cool stuff!</span></p><p></p><p><span style="font-size: 12pt;">12. Now go and mark your UI Action active field as unchecked to turn it off.</span></p><p></p><p><span style="font-size: 12pt;">You now have a front- and back-end implementation of underscore.js.   Obviously this opens up the ability to bring in other libraries (perhaps Node.js?).</span></p><p></p><p><span style="font-size: 12pt;">So there you go Kevin; challenge met!</span></p><p></p><p><span class="punctuation token" style="color: #3d3d3d; font-family: arial,helvetica,sans-serif; font-size: 12pt;">Steven Bell.</span></p><p></p><p></p><p style="font-family: arial,sans-serif; color: #666666;"><span style="color: #800080; font-weight: inherit; font-family: arial,helvetica,sans-serif; font-style: inherit; font-size: 12pt;"><strong>If you find this article helps you, don't forget to log in and "like" it!</strong></span></p><p></p><p style="font-family: arial,sans-serif; color: #666666;"><span style="color: #800080; font-weight: inherit; font-family: arial,helvetica,sans-serif; font-style: inherit; font-size: 12pt;"><strong>I would also like to encourage you to become a member of our blog!</strong></span></p>