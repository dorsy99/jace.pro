---
title: "Performance considerations when using GlideRecord"
date: 2015-10-20T02:13:08.000Z
authors: ["sergiu.panaite"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=620deaa5dbd0dbc01dcaf3231f961981"
---
<p style="font-size: 13.3333px; text-align: justify;">If you are a developer and working for a customer that uses ServiceNow platform, you will probably have to deal sooner or later with scripting in ServiceNow and therefore touch GlideRecord.</p><p style="font-size: 13.3333px; text-align: justify;">If that's the case keep in mind the following performance considerations when using GlideRecord:</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">1. Always try to add a filter in a GlideRecord query, especially one based on an indexed field. Don't bring back a full table via GlideRecord if it's not really needed, as it causes overhead and can take time.</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;"><span style="font-size: 10pt;">POOR PERFORMANCE: </span></p><p style="font-size: 13.3333px; text-align: justify;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_1445438999604838 jive_text_macro" data-renderedposition="160_8_1192_112" jivemacro_uid="_1445438999604838"><p><span style="font-size: 10pt; font-family: Courier;">var gr = new GlideRecord('incident');</span></p><p><span style="font-size: 10pt; font-family: Courier;">gr.query();     //brings back the entire table incident</span></p><p></p><p><span style="font-size: 10pt; font-family: Courier;">while (gr.next()){</span></p><p><span style="font-size: 10pt; font-family: Courier;">       // do something here</span></p><p><span style="font-size: 10pt; font-family: Courier;">}</span></p>       </pre><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;"><span style="text-align: justify; font-size: 13.3333px;">GOOD: </span></p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">Example 1 (this would benefit from an index on <strong>incident.`active`</strong> field):</p><p style="font-size: 13.3333px; text-align: justify;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_1445438999594404 jive_text_macro" data-renderedposition="367_8_1192_192" jivemacro_uid="_1445438999594404"><p><span style="font-size: 10pt; font-family: Courier;">var gr = new GlideRecord('incident');</span></p><p></p><p><span style="font-family: Courier; font-size: 10pt;">gr.addQuery('active', true);</span></p><p><span style="font-size: 10pt; font-family: Courier;">//or (one or the other, not both)</span></p><p><span style="font-size: 10pt; font-family: Courier;">gr.addActiveQuery()</span></p><p></p><p><span style="font-size: 10pt; font-family: Courier;">gr.query();</span></p><p></p><p><span style="font-size: 10pt; font-family: Courier;">while (gr.next()){</span></p><p><span style="font-size: 10pt; font-family: Courier;">       // do something here</span></p><p><span style="font-size: 10pt; font-family: Courier;">}</span></p>       </pre><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">Example 2 (this would benefit from an index on <strong>`sys_created_on`</strong> field):</p><p style="font-size: 13.3333px; text-align: justify;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14454389995874612 jive_macro_code jive_text_macro" data-renderedposition="616_8_1192_128" jivemacro_uid="_14454389995874612"><p>var gr = new GlideRecord('incident');</p><p>gr.addQuery('sys_created_on', "&gt;", "2015-09-10 04:05:00");</p><p>gr.query();</p><p></p><p>while (gr.next()){</p><p>       // do something here</p><p>}</p>       </pre><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">2. While adding filters in GlideRecord queries is good, avoid creating filters which are too complex.</p><p style="font-size: 13.3333px; text-align: justify;">Rather than creating a series of <strong>addQuery()</strong> and <strong>addOrCondition()</strong> calls to obtain a result, use <strong>addEncodedQuery()</strong>. This will make the query easier to create and maintain.</p><p style="font-size: 13.3333px; text-align: justify;">Avoid complex queries on very large tables.</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">Create a query string by generating encoded query strings through a filter and using that string with addEncodedQuery.</p><p style="font-size: 13.3333px; text-align: justify;">As an example, if I want all incidents that are active, created after a certain date with a certain state and a particular approval value I go in the instance at incidents module, expand "All" filter and add all my conditions then click "Run". Then right click on the link, "Copy query" and I get my encoded query:</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;"><span style="font-size: 12pt; font-family: Cochin;">"<span style="; font-size: 10pt; font-family: 'book antiqua', palatino;"><strong>active=true^sys_created_on&gt;javascript:gs.dateGenerate('2015-09-01','23:59:59')^state=3^approval=requested</strong></span>"</span></p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">I add this query in a GlideRecord call:</p><p style="font-size: 13.3333px; text-align: justify;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14454389995804000" data-renderedposition="1015_8_1192_144" jivemacro_uid="_14454389995804000"><p>var myQuery = "active=true^sys_created_on&gt;javascript:gs.dateGenerate('2015-09-01','23:59:59')^state=3^approval=requested";</p><p>var gr = new GlideRecord('incident');</p><p>gr.addEncodedQuery(myQuery);</p><p>gr.query();</p><p></p><p>while (gr.next()){</p><p>       // do something here</p><p>}</p>       </pre><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">3. Limit number of returned records when querying very large tables.</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">For example, this:</p><p style="font-size: 13.3333px; text-align: justify;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_1445438999574765 jive_text_macro" data-renderedposition="1273_8_1192_128" jivemacro_uid="_1445438999574765"><p>var gr = new GlideRecord('incident');</p><p>gr.addActiveQuery();</p><p>gr.query();</p><p></p><p>while (gr.next()){</p><p>       // do something here</p><p>}</p>       </pre><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">might work fine if you have only a few thousands active incidents, but if you have 1000000 active incidents, the query() method has to retrieve all those records and this can take time.</p><p style="font-size: 13.3333px; text-align: justify;">In cases like this, using the <strong>setLimit()</strong> method is indicated.</p><p style="font-size: 13.3333px; text-align: justify;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14454389995698857" data-renderedposition="1477_8_1192_144" jivemacro_uid="_14454389995698857"><p>var gr = new GlideRecord('incident');</p><p>gr.addActiveQuery();</p><p>gr.setLimit(100);</p><p>gr.query();</p><p></p><p>while (gr.next()){</p><p>       // do something here</p><p>}</p>       </pre><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">4. Make sure fields used in filters exist, otherwise your GlideRecord will retrieve the full table (it's like doing a SQL query without a WHERE clause).</p><p style="font-size: 13.3333px; text-align: justify;">For example, if I query 'incident' table using a filter for a field ('<strong>myfield</strong>' in this case) that doesn't exists I get full incident table back:</p><p style="font-size: 13.3333px; text-align: justify;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14454389995635266 jive_text_macro" data-renderedposition="1716_8_1192_96" jivemacro_uid="_14454389995635266"><p>var gr = new GlideRecord('incident');</p><p>gr.addQuery('myfield', 'test');</p><p>gr.query();</p><p></p><p>gs.log('Total number of records is: ' + gr.getRowCount());</p>       </pre><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">The log might also show (depending on the result set size) a warning like:</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px;"><span style="font-family: 'courier new', courier; font-size: 8pt;"><strong>2015-10-14 01:25:12 (145) Default-thread-168 5DC3A6D62B03860090AA3EA3B4DA15A4 WARNING *** WARNING *** Large Table: Table handling an extremely large result set: 94304</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>Query that got us here is: TABLENAME = incident ENCODED_QUERY = myfield=test</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.db.QueryWarning.warn(QueryWarning.java:42)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.db.DBQuery.loadResultSet(DBQuery.java:2287)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.db.DBQuery.executeAndReturnTable(DBQuery.java:237)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.db.DBAction.executeNormal(DBAction.java:197)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.db.DBAction.executeAndReturnException(DBAction.java:166)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.db.RDBMSQueryContext.executeQuery(RDBMSQueryContext.java:46)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.db.DBQuery.execute(DBQuery.java:1772)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.db.meta.Table.queryBasic(Table.java:311)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.db.meta.Table.query(Table.java:189)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.script.GlideRecordITable.query(GlideRecordITable.java:77)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.script.GlideRecord.query0(GlideRecord.java:2982)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.script.GlideRecord.query(GlideRecord.java:2707)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.script.GlideRecord.jsFunction_query(GlideRecord.java:2593)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             sun.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             java.lang.reflect.Method.invoke(Method.java:597)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             org.mozilla.javascript.FunctionObject.doInvoke(FunctionObject.java:597)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             org.mozilla.javascript.FunctionObject.call(FunctionObject.java:504)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             org.mozilla.javascript.ScriptRuntime.call(ScriptRuntime.java:1227)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             org.mozilla.javascript.gen.c7133.call(&lt;refname&gt;:3)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             org.mozilla.javascript.gen.c7133.exec(&lt;refname&gt;)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.script.ScriptEvaluator.execute(ScriptEvaluator.java:233)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.script.ScriptEvaluator.evaluateString(ScriptEvaluator.java:105)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.script.ScriptEvaluator.evaluateString(ScriptEvaluator.java:72)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.script.ScriptEvaluator.evaluateString(ScriptEvaluator.java:63)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.script.Evaluator.evaluateString(Evaluator.java:91)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.processors.ScriptProcessor.evaluateScript(ScriptProcessor.java:302)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.processors.ScriptProcessor.runScript(ScriptProcessor.java:207)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.processors.ScriptProcessor.process(ScriptProcessor.java:168)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.processors.Processor.runProcessor(Processor.java:402)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.processors.Processor.processTransaction(Processor.java:192)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.processors.ProcessorRegistry.process(ProcessorRegistry.java:146)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.ui.GlideServletTransaction.process(GlideServletTransaction.java:36)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             com.glide.ui.GlideServlet$1.run(GlideServlet.java:414)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-size: 8pt; font-family: 'courier new', courier;"><strong>             java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)</strong></span></p><p style="font-size: 13.3333px;"><span style="font-family: 'courier new', courier; font-size: 8pt;"><strong>             java.lang.Thread.run(Thread.java:682)</strong></span></p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">Another option is to use Glide property "<span style="color: #333333; font-family: Omnes-pro, Arial, Verdana, sans-serif; font-size: 14px;">glide.invalid_query.returns_no_rows</span>" (thanks to <a title="kalai" __default_attr="10800" __jive_macro_name="user" class="jive_macro jive_macro_user" data-orig-content="kalai" data-renderedposition="2475_544.15625_47_16" href="/community?id=community_user_profile&user=4b02d6e1dbd81fc09c9ffb651f9619d2">kalai</a> for pointing it out) which controls how an invalid GlideRecord query is handled. Full description of the property here:</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;"><a href="http://wiki.servicenow.com/?title=Available_System_Properties#gsc.tab=0" title="http://wiki.servicenow.com/?title=Available_System_Properties#gsc.tab=0">Available System Properties - ServiceNow Wiki</a></p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">A quick example from our wiki for above property:</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;"><a href="http://wiki.servicenow.com/index.php?title=GlideRecord#addQuery" title="http://wiki.servicenow.com/index.php?title=GlideRecord#addQuery">GlideRecord - ServiceNow Wiki</a>   - 8.9.1 Controlling invalid queries</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">Besides the available options presented above, thanks to our community, <a title="treycarroll" __default_attr="10780" __jive_macro_name="user" class="jive_macro jive_macro_user" data-orig-content="treycarroll" data-renderedposition="2647_458.015625_78_16" href="/community?id=community_user_profile&user=569e8ae9dbd41fc09c9ffb651f9619e5">treycarroll</a>   <span style="font-size: 12.6px; font-family: arial, sans-serif; color: #999999;"><strong></strong></span>went a step further and created an extension to GlideRecord that will throw an exception if you pass a bad column name or operator. I find this very useful and you can read his post here:</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;"><a title="Extension to GlideRecord: addQuery2,&nbsp; Throws an exception if you pass a bad column name or bad operator" __default_attr="207359" __jive_macro_name="thread" class="jive_macro_thread jive_macro" data-orig-content="Extension to GlideRecord: addQuery2,&nbsp; Throws an exception if you pass a bad column name or bad operator" data-renderedposition="2704_8_667_16" href="/community?id=community_question&sys_id=0cb3cf65dbd8dbc01dcaf3231f961991">Extension to GlideRecord: addQuery2,&nbsp; Throws an exception if you pass a bad column name or bad operator</a></p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px;">5. Don't increment variables in while loops for counting purposes when you can use GlideAggregate. Again, filtering based on indexed fields is very important.</p><p style="font-size: 13.3333px;">You can also use <strong>GlideRecord.getRowCount()</strong> method if besides counting you need to process the returned records.</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">POOR PERFORMANCE:</p><p style="font-size: 13.3333px; text-align: justify;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14454389995576687 jive_text_macro" data-renderedposition="2836_8_1192_176" jivemacro_uid="_14454389995576687"><p>var gr = new GlideRecord('incident');</p><p>gr.addQuery('active', true);</p><p>gr.query();</p><p></p><p>var count = 0;</p><p></p><p>while (gr.next()){</p><p>       count++;</p><p>}</p><p>gs.log('Total number of records is: ' + count);</p>       </pre><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">BETTER PERFORMANCE (when you need to do processing on the returned records):</p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">- example using getRowCount() method of GlideRecord:</p><p style="font-size: 13.3333px; text-align: justify;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14454389995524345 jive_macro_code jive_text_macro" data-renderedposition="3126_8_1192_160" jivemacro_uid="_14454389995524345"><p>var gr = new GlideRecord('incident');</p><p>gr.addQuery('active', true);</p><p>gr.query();</p><p></p><p>gs.log('Total number of records is: ' + gr.getRowCount());</p><p></p><p>while (gr.next()){</p><p>       // do something here</p><p>}</p>       </pre><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">BEST (for counting purposes):</p><p style="font-size: 13.3333px; text-align: justify;"></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14454389995026954 jive_text_macro" data-renderedposition="3362_8_1192_192" jivemacro_uid="_14454389995026954"><p>var gr = new GlideAggregate('incident');</p><p>gr.addQuery('active', true);</p><p>gr.addAggregate('COUNT');</p><p>gr.query();</p><p></p><p>var incidents = 0;</p><p>if (gr.next()) {</p><p>     incidents = gr.getAggregate('COUNT');</p><p>}</p><p></p><p>gs.log('Total number of records is: ' + incidents);</p>     </pre><p style="font-size: 13.3333px; text-align: justify;"></p><p style="font-size: 13.3333px; text-align: justify;">6. Don't overkill your script with logging statements (gs.log). While during testing phase adding more logging statements helps debugging, on a production instance this could add overhead (be aware for each <strong>gs.log</strong> we have to insert a row in syslog table and write a log line in the application localhost_log as well).</p>