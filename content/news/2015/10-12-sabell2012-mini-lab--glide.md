---
title: "MiniLab GlideRecord Between Query Extension"
date: 2015-10-11T17:43:14.000Z
authors: ["sabell2012"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=52fc26a5dbd0dbc01dcaf3231f9619d0"
---
<p><span style="font-size: 12pt;"><strong>NOTE: This article builds off of my previous GlideRecord extension <a title="" _jive_internal="true" href="/groups/servicenow-user-group-us-tx-north-texas/blog/2015/10/06/mini-lab-extending-the-gliderecord-object">article</a>.</strong></span></p><p></p><p><span style="font-size: 12pt;">I have wanted SQL BETWEEN capability for some time with GlideRecord.   With the ability to extend the out-of-the-box object myself it then became a relative snap to implement this feature (albeit not quite the perfect way I would want, but good enough).</span></p><p></p><p><span style="font-size: 12pt;"><strong>Requirements:</strong></span></p><p></p><p><span style="font-size: 12pt;">1. Extends the GlideRecord object as a new .addQuery type.</span></p><p><span style="font-size: 12pt;">2. Takes two GlideDateTime objects as a from-date, and to-date.</span></p><p><span style="font-size: 12pt;">3. Returns all records for any query between the given range for any given GlideDateTime field.</span></p><p></p><p><span style="font-size: 12pt;"><strong>SQL Example:</strong></span></p><p></p><p style="padding-left: 30px;"><span style="font-family: 'courier new', courier; font-size: 12pt;">SELECT * FROM incident WHERE sys_created_on BETWEEN '2013-06-12' AND '2014-11-28'</span></p><p></p><p><span style="font-size: 12pt;"><strong>Desired GlideRecord Implementation:</strong></span></p><p></p><p style="padding-left: 30px;"><span style="font-family: 'courier new', courier;">&lt;&lt;GlideRecord&gt;&gt;.addBetweenQuery(&lt;&lt;String&gt;&gt;field, &lt;&lt;GlideDateTime&gt;&gt;fromDate, &lt;&lt;GlideDateTime&gt;&gt;toDate);</span></p><p></p><p><span style="; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong>NOTE</strong></span><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">: My actual desired implementation would have been something like this:</span></p><p></p><p style="padding-left: 30px;"><span style="font-family: 'courier new', courier;">&lt;&lt;GlideRecord&gt;&gt;.addQuery(&lt;&lt;String&gt;&gt;field, 'BETWEEN', &lt;&lt;GlideDateTime&gt;&gt;fromDate, &lt;&lt;GlideDateTime&gt;&gt;toDate);</span></p><p></p><p><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;">But currently I don't want to have to sort through the partial </span><span style="font-size: 16px; font-family: arial, helvetica, sans-serif;">overriding</span><span style="font-size: 12pt; font-family: arial, helvetica, sans-serif;"> of .addQuery it would take.   Maybe later!   :-)</span></p><p></p><p><span style="; font-size: 14pt;"><strong> </strong></span></p><p><span style="; font-size: 18pt;"><strong>Lab 1.1: Extend GlideRecord With New Between Function</strong></span></p><p></p><p><span style="font-size: 12pt;"><strong>NOTE</strong>: If you have already created the GlideRecordExtensions Script include from my other article you can skip steps 1 through 3.</span></p><p></p><p><span style="font-size: 12pt;">1. Navigate to System Definition -&gt; Script Include.   The Script Include List View will be displayed.</span></p><p><span style="font-size: 12pt;"> </span></p><p><span style="font-size: 12pt;">2. Click on the New button.   A new Script Include form will be displayed.</span></p><p><span style="font-size: 12pt;"> </span></p><p><span style="font-size: 12pt;">3. Fill in the following fields:</span></p><p><span style="font-size: 12pt;"><span style="font-size: 16px;">   </span>   a. <strong>Name</strong>: GlideRecordExtensions</span></p><p><span style="font-size: 12pt;"><span style="font-size: 16px;">   </span>   b. <strong>Accessable From</strong>: All Application Scopes</span></p><p><span style="font-size: 12pt;"> <span style="font-size: 16px;">     </span> c. <strong>Active</strong>: checked</span></p><p><span style="font-size: 12pt;"><span style="font-size: 16px;">     </span> d. Right-click on the form header to bring up the context menu and choose Save to save your work.</span></p><p></p><p></p><p><span style="font-size: 12pt;">4. Now continue filling in the remaining fields:</span></p><p><span style="font-size: 12pt;"> </span></p><p><span style="font-size: 12pt;">       a. <strong>Description</strong>: </span></p><p><span style="font-size: 12pt;">       <span style="font-size: 16px;">   <span style="font-size: 16px;">   </span></span>addBetweenQuery - search for all records between two dates inclusive</span></p><p></p><p><span style="font-size: 12pt;">   <span style="font-size: 16px;">   </span>b. <strong>Script</strong>:</span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14445662528779671 jive_text_macro" data-renderedposition="1108.5_8_1177_176" jivemacro_uid="_14445662528779671"><p><span style="font-size: 12pt;">   GlideRecord.prototype.addBetweenQuery = function(fieldToCheck, beginDate, endDate) {</span></p><p></p><p><span style="font-size: 12pt;">   <span style="font-size: 16px;">   <span style="font-size: 16px;">   </span></span>var beginDateCheck = gs.dateGenerate(beginDate); // convert to the appropriate string</span></p><p><span style="font-size: 12pt;">   <span style="font-size: 16px;">   <span style="font-size: 16px;">   </span></span>var endDateCheck = gs.dateGenerate(endDate); // ibid.</span></p><p></p><p><span style="font-size: 12pt;">   <span style="font-size: 16px;">   <span style="font-size: 16px;">   </span></span>this.addQuery(fieldToCheck, '&gt;=', beginDateCheck);</span></p><p><span style="font-size: 12pt;">   <span style="font-size: 16px;">   <span style="font-size: 16px;">   </span></span>this.addQuery(fieldToCheck, '&lt;=', endDateCheck);</span></p><p><span style="font-size: 12pt;">   };</span></p>   </pre><p></p><p><span style="font-size: 12pt;">   <span style="font-size: 16px;">   </span>c. Click on the Update button to save your work.</span></p><p></p><p><img   alt="1.Script Include.jpg" class="image-0 jive-image" src="6caa888edbdc5fc03eb27a9e0f961929.iix" style="height: 225px; display: block; margin-left: auto; margin-right: auto; width: 620px;"/></p><p></p><p></p><p><span style="font-size: 18pt;"><strong>Lab 1.2: Testing the .addBetweenQuery functionality</strong></span></p><p></p><p><span style="font-size: 12pt;">1. Navigate to System Definition -&gt; Fix Scripts.   The Fix Scripts List View will be displayed.</span></p><p></p><p><span style="font-size: 12pt;">2. Click on the New button.   A new Fix Script form will be displayed.</span></p><p><span style="font-size: 12pt;"> </span></p><p><span style="font-size: 12pt;">3. Fill in the following fields:</span></p><p><span style="font-size: 12pt;"> <span style="font-size: 16px;">       </span>a. <strong>Name</strong>: GlideRecord Extension Between Test</span></p><p><span style="font-size: 12pt;">   <span style="font-size: 16px;">   </span>b. <strong>Active</strong>: checked</span></p><p><span style="font-size: 12pt;">   <span style="font-size: 16px;">   </span>c. <strong>Run Once</strong>: true</span></p><p><span style="font-size: 12pt;">   <span style="font-size: 16px;">   </span>d. <strong>Script</strong>:</span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14445671811974005 jive_text_macro" data-renderedposition="1932.5_8_1177_337" jivemacro_uid="_14445671811974005"><p>gs.include('GlideRecordExtensions');</p><p></p><p>var beginDate = new GlideDateTime('2013-06-12');</p><p>var endDate = new GlideDateTime('2014-11-28');</p><p></p><p>// Retrieve all active records between the two dates inclusive!</p><p>var incidents = new GlideRecord('incident');</p><p>incidents.addBetweenQuery('sys_created_on', beginDate, endDate); //&lt;--- Our new function!</p><p>incidents.addQuery('active', true);</p><p>incidents.query();</p><p></p><p>gs.print('---&gt; Records found: ' + incidents.getRowCount());</p><p></p><p>// Convert our GlideRecord recordset to an object list for easier manipulation</p><p>var convertedList = incidents.toObjectList();</p><p>gs.print('---&gt; Records converted: ' + convertedList.length);</p><p></p><p>for (var i=0; i &lt; convertedList.length; i++) {</p><p><span style="font-size: 13.3333px;">   <span style="font-size: 13.3333px;">   </span></span>gs.print(convertedList[i].number + ' - ' + convertedList[i].sys_created_on);</p><p>}</p></pre><p></p><p><span style="font-size: 12pt;"><span style="font-size: 16px;">   </span>   e. Right-click on the form header to bring up the context menu and choose Save to save your work.</span></p><p></p><p></p><p><span style="font-size: 12pt;">4. If you have not <a title="" _jive_internal="true" href="/groups/servicenow-user-group-us-tx-north-texas/blog/2015/10/01/mini-lab-fix-script-application-enhancement">enhanced </a>your Fix Scripts form scroll down to the bottom of the form and click on the Run Fix Script related link to run the script; click the Ok button on the next form, and the Proceed button on the next form (too many "are-you-sure-forms"!).</span></p><p></p><p><span style="font-size: 12pt;">5. Your results should look something like the following:</span></p><p></p><p><img   alt="results.png" class="image-0 jive-image" src="43562bf9db9c5b048c8ef4621f96196b.iix" style="height: 327px; width: 620px; display: block; margin-left: auto; margin-right: auto;"/></p><p></p><p><span style="font-size: 12pt; line-height: 1.5em;">BTW, you could derive this same kind of functionality by using the following built-in functionality .addEncodedQuery.   It would look like this:</span></p><p></p><p style="padding-left: 30px;"><span style="font-size: 12pt; font-family: 'courier new', courier;">incidents.addEncodedQuery("active=true^sys_created_onBETWEENjavascript:gs.dateGenerate('2013-06-12','00:00:00')@javascript:gs.dateGenerate('2014-11-28','00:00:00')");</span></p><p></p><p><span style="font-size: 12pt;">The encoded query would be difficult to read, and difficult to maintain.   The addBetweenQuery is much easier to read!</span></p><p><span style="font-size: 12pt;"> </span></p><p><span style="font-size: 12pt;">My solution does not zero out the times, and you may want to implement that feature.</span></p><p></p><p><span style="font-size: 12pt;">I have posted the latest GlideRecordExtensions out on the <a title="hare.servicenow.com/app.do#/detailV2/e9ee991d4543c2007c39bada468d18d0/overview" href="https://share.servicenow.com/app.do#/detailV2/e9ee991d4543c2007c39bada468d18d0/overview">share </a>with this functionality if you would like to download it.</span></p><p></p><p><span style="font-size: 12pt;">Steven Bell</span></p><p class="jive-blog-post-message" style="font-weight: inherit; font-style: inherit; font-family: inherit;"></p><div style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #666666;"><p style="font-weight: inherit; font-style: inherit; font-family: inherit;"><span style="font-weight: inherit; font-style: inherit; font-size: 12pt; font-family: inherit;"> </span></p><p style="font-weight: inherit; font-style: inherit; font-family: inherit;"><span style="color: #800080; font-size: 12pt; font-style: inherit; font-family: arial, helvetica, sans-serif; font-weight: inherit;"><strong>If you find this article helps you, don't forget to log in and "like" it!   I would also like to encourage you to become a member of our blog!</strong></span></p><p style="margin-bottom: .0001pt; background: white;"><span style="color: purple; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong><a _jive_internal="true" data-containerid="-1" data-containertype="-1" data-objectid="86661" data-objecttype="111" href="/servlet/JiveServlet/downloadImage/38-4985-86661/CS_logo.jpg"><img  alt="CS_logo.jpg" class="image-18 jive-image" height="60" src="5b2ac902dbd49f048c8ef4621f9619f6.iix" width="151"/></a></strong></span><span style="color: purple; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong><a _jive_internal="true" data-containerid="2061" data-containertype="14" data-objectid="2273" data-objecttype="102" href="/community?id=community_article&sys_id=330d6ea5dbd0dbc01dcaf3231f961965"><img  alt="MVP-logo.jpeg" class="image-17 jive-image" height="48" src="adf2044adb985fc03eb27a9e0f9619c4.iix" width="135"/></a></strong></span></p><p><span style="color: #eb7a3d;">Please Share, Like, Comment this blog if you've found it helpful or insightful.</span></p><p></p><hr/><p><span style="color: #eb7a3d;"><span style="color: #303030;">for Click for <a title="" _jive_internal="true" href="/community?id=community_forum&sys_id=a6299a2ddbd897c068c1fb651f961926">More Expert Blogs </a>and also Find <a title="" _jive_internal="true" href="/community?id=community_forum&sys_id=d6295a2ddbd897c068c1fb651f9619f1">Expert Events</a>!</span><br/></span></p><hr/></div>