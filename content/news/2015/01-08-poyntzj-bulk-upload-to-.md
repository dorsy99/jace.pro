---
title: "Bulk upload to Managed Documents"
date: 2015-01-07T22:44:22.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=ee6c6ea1dbd0dbc01dcaf3231f961981"
---
<p>We have a requirement to upload a number of documents which are sitting on our SharePoint site into the Managed Documents area of Servicenow.</p><p>i have been looking around and found a few links which provided some assistance and pointers, this being a v good example</p><p><a href="http://wiki.servicenow.com/index.php?title=AttachmentCreator_SOAP_Web_Service" title="http://wiki.servicenow.com/index.php?title=AttachmentCreator_SOAP_Web_Service">http://wiki.servicenow.com/index.php?title=AttachmentCreator_SOAP_Web_Service</a></p><p></p><p>Still not quite what I wanted.</p><p>In the end, I have downloaded the documents from our SP site to an area on my machine.</p><p>I have created 2 x Web services in Service now.   One is for <strong>dms_document</strong> and one is for <strong>dms_document_revision</strong></p><p><em><br/></em>I then wrote a VBS routine <em>(yeah, yeah, i know <span __jive_emoticon_name="happy"></span> but I have a lot of old VBS code from other old projects / routines that could be bolted together)</em></p><p>This routine will do the following</p><ul><li>Check the folder you provide exists</li><li>for each file in the folder<ul><li>create a dms_document based on the file name</li><li>create a dms_document_revision based on the file name and the sys_id from the dms_document</li><li>Encode the attachment to Base64 and from the extension, try to establish the MIME Type</li><li>send the attachment over via the attachment creator and linking it to the dms_document_revision sys_id from the new record above</li></ul></li></ul><p></p><p>You have to run the routine via <strong>cscript</strong> as it is showing you the file it is processing and the sys_id's that are returned</p><p>If it fails to get a sys_id from Servicenow, it will STOP.</p><p></p><p></p><p><strong style="font-size: 12pt;">Things you need to do first</strong></p><p><span style="font-size: 10pt;"><br/></span></p><p><span style="font-size: 10pt;">Download the two files,.   the XML file needs to be imported to your site - it creates 2 x web services</span></p><p>the TXT file needs to be renamed to VBS </p><p></p><p>Once downloaded,   inside the VBS file there is a line <em>(18)</em> where you need to enter your site's details</p><p>You may also want to look at lines 97 and 98 as these refer to a couple of fields in the dms_document area and are coded to a couple of specific values that we always use.   <em>One is the <strong>audience</strong> and the other is the </em><strong><em>classification</em></strong></p><p></p><p>To run the routine, import and commit the XML file</p><p>make sure you have a folder on you machine with a file in it.</p><p>make sure you have amended the line 18</p><p></p><p><strong style="font-size: 12pt;">Running the routine</strong></p><p>run the command by</p><p><strong>         cscript wsdl.vbs "username" "password" "path to file(s)"</strong></p><p><em><strong>If you do not provide the 3 required parameters, it will provide a usage screen</strong></em></p><p></p><p>It can take some optional parameters too so you can amend the <strong>Requested By</strong>, <strong>Owned By</strong>, <strong>Type</strong> and <strong>Author</strong> fields when importing files</p><p>these are all options to the command, but if you plan to miss one of the options off, double quote at that point.</p><p></p><p>In this example,it will make <strong>Julian Poyntz</strong> the Requsted by, leave the owner field alone and sets the type to be <strong>SOP-Data Centre </strong><em>(no need to do anything to the Author parameter)</em></p><p style="padding-left: 30px;"><strong>cscript wsdl.vbs "username" "password" "path to file(s)" "Julian Poyntz" "" "SOP-Data Centre"</strong></p><p></p><p>In this example, it will make <strong>John Doe</strong> the Requested by, <strong>Jane Doe</strong> the owner, leave Type alone and set <strong>Jonny Doe</strong> as the Author</p><p><strong>         cscript wsdl.vbs "username "password" "path to file(s)" "John Doe" "jane doe" " "Jonny Doe"</strong></p><p></p><p><strong></strong>Hope this helps someone at some point</p>