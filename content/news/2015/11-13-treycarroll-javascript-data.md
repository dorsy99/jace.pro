---
title: "Javascript Data Structures an argument for deprecating the ArrayUtil"
date: 2015-11-13T04:34:57.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=957dee29dbd0dbc01dcaf3231f9619ac"
---
<p>I come from a Java and C# background so, as much as I love the power of Javascript, there are some significant gaps that leave me longing for those other languages.   One of the "biggies" is the lack of data structures.     Javascript arrays are these odd "everything" structures.   After programming in Javascript for a while, we become accustomed to using arrays as: arrays (of course), lists, queues, stacks and sets.     But implementations of those abstract data-types have some very specific characteristics and therefore should provide certain required operations, while very intentionally eschewing other operations.</p><p></p><p>But the real question is, "Are we missing out as Javascript programmers because our language doesn't natively support these ADTs?"       I would give a pragmatic answer: "It depends."   I don't really mind using the array functions to simulate Stacks and Queues, but some of the other ADTs are problematic.   Let's walk through some examples to see how this plays out.</p><p></p><p>To create a Javascript Stack we can very easily do the following:</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14473599439581101 jive_text_macro" data-renderedposition="227.9971466064453_7.997159004211426_1078_93" jivemacro_uid="_14473599439581101"><p>var stack = [];</p><p>stack.push('vanilla');</p><p>stack.push('chocolate');</p><p>stack.push('strawberry');</p><p>var sb = stack.pop();</p><p>alert(sb);   //this will output 'strawberry'</p></pre><p></p><p>Stacks are LIFO (Last-in First-out) data structures, so pop() gives us back strawberry, which was added last.     This works great!   Even the names of the methods, "push" and "pop" are conceptually correct.     We'll just overlook the fact that you could do this.</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14473603013012132" data-renderedposition="400.72442626953125_7.997159004211426_1078_15" jivemacro_uid="_14473603013012132"><p>alert( stack[0] );//This should not be possible on a true stack</p></pre><p></p><p>To create a Javascript Queue we can do this:</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14473601860306618 jive_text_macro" data-renderedposition="476.178955078125_7.997159004211426_1078_93" jivemacro_uid="_14473601860306618"><p>var queue = [];</p><p>queue.push('vanilla');</p><p>queue.push('chocolate');</p><p>queue.push('strawberry');</p><p>var v = queue.shift();</p><p>alert(v);   //this will output 'vanilla'</p></pre><p></p><p>Queues are FIFO (First-in First-out) data structures, so shift() gives us back vanilla, which was added first.     So it works, but this is not quite as nice as when we used an array as a Stack.     The correct name for the operation for adding an element to a Queue should be enqueue(), not push(). (This is not a Stack!)     Similarly, Javascript arrays' way of getting something out of a queue is called shift(), but it should be called dequeue().</p><p></p><p>And again, we can violate the structure's conceptual accessors and grab something off of the back end using code like this:</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_1447361558724337 jive_macro_code jive_text_macro" data-renderedposition="708.90625_7.997159004211426_1078_15" jivemacro_uid="_1447361558724337"><p>var evilAccessElement = queue[queue.length - 1];</p></pre><p></p><p>Once we get to the Set data type, however, things really break down.   The characteristics of a Set mean that it:</p><p></p><ul><li>Must not allow duplicate elements,</li><li>Must only support insert() and delete() with no provision for adding or removing at an index,</li><li>Must offer union(), difference() and intersection() operations.</li></ul><p></p><p>Our humble Javascript array was doing fairly well up to this point, but now it is hopelessly inadequate to mimic the desired data type.   But do we really need Sets for ServiceNow coding?   I would argue yes.</p><p></p><p>How many times have you had to remove duplicates from an array?   Have you ever loaded a user's roles from sys_user_has_roles?     Sure we can write a GlideAggregate query that groups by the role's sys_id to eliminate the duplicates, but what if the data structure could just quietly disregard the addition of redundant elements while we iterated over the elements after running the simple query?     And what about the power of intersections, unions and differences?     If we take the example of working with groups of approvers (this is a frequent use-case in our development of catalog items), the power becomes clear.     Storing the approvers' ids in arrays forces you to repeatedly, painstakingly re-implement comparison code which could have been written (and tested!) once as a part of the data structure itself.</p><p></p><p>As Michael Ritchie has pointed out, ServiceNow provides the ArrayUtil to support the use of Javascript's array type in situations where Set-like behaviors are required.   I have used the ArrayUtil and I am sincerely grateful to our friends at ServiceNow for providing us with tools, but I am not a huge fan of the ArrayUtil/array-as-a-Set paradigm for a few reasons:</p><p></p><p>1)   I want the data structure to throw an exception if I accidentally add an element of the wrong type or attempt to use it incorrectly.   But even if I do something catastrophically wrong, such as providing a string in place of the required array-type first parameter of indexOf(), the ArrayUtil does not throw an exception.   Instead, it returns the -1 (not found) flag.   That behavior leads me to believe that my call was well formed and that the desired element just isn't there.   But, how are we going log and handle errors, if we can't detect them?     The human who raises an INC becomes our only "catch" mechanism!</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14473891737984335 jive_macro_code jive_text_macro" data-renderedposition="1235.553955078125_7.997159004211426_1078_108" jivemacro_uid="_14473891737984335"><p>var x = [1, 2, 3];</p><p>var util = new ArrayUtil();</p><p>try{     </p><p>     gs.print(util.indexOf("This should be an array not a string", "1"));//This outputs -1!</p><p>} catch(e){</p><p>     gs.print('Error:'+e);</p><p>}</p></pre><p></p><p>Similarly, the concat method is oddly tolerant when I do this:</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14473904263645359" data-renderedposition="1403.7357177734375_7.997159004211426_1078_139" jivemacro_uid="_14473904263645359"><p>//Outputs *** Script: This should be an array not a string</p><p><span style="font-size: 9pt; line-height: 12pt;">//Does not throw an error<br/></span></p><p>var x = [1, 2, 3];</p><p>var util = new ArrayUtil();</p><p>try{</p><p>     gs.print(util.concat("This should be an array not a string", x));</p><p>} catch(e){</p><p>     gs.print('Error:'+e);</p><p>}</p></pre><p></p><p>2) It allows you to perform set operations on arrays of wildly different type elements:</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="_jivemacro_uid_14473913438167156 jive_macro_code jive_text_macro" data-renderedposition="1602.82666015625_7.997159004211426_1078_77" jivemacro_uid="_14473913438167156"><p>var arrayUtil = new ArrayUtil();</p><p>var a1 = ["1","2","3","4","5"];</p><p>var a2 = [{foo:'bar'}];</p><p>var a3 = [undefined,null,3,'string'];</p><p>gs.print(arrayUtil.diff(a1, a2, a3)); //*** Script: 1,2,3,4,5</p></pre><p></p><p>While this is not an error per se, it silently (complicitly?) tolerates meaningless comparisons.</p><p></p><p>3) The implementation of the indexOf() method returns inconsistent results when the array contains string and number versions of the same value.</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14473888168052397 jive_text_macro" data-renderedposition="1780.099365234375_7.997159004211426_1078_46" jivemacro_uid="_14473888168052397"><p>var x = [1, "1"];</p><p>var util = new ArrayUtil();</p><p>gs.print(util.indexOf(x, "1"));//This returns 0, even though the string   "1" is at index 1!</p></pre><p></p><p>4) The wiki <a title="ki.servicenow.com/index.php?title=ArrayUtil#gsc.tab=0" href="http://wiki.servicenow.com/index.php?title=ArrayUtil#gsc.tab=0">article</a> documenting its use contains errors and omissions.</p><p></p><ul><li>indexOf</li></ul><p>indexOf (Array array, [int startIndex]);</p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14473901783645005" data-renderedposition="1932.0595703125_7.997159004211426_1078_15" jivemacro_uid="_14473901783645005"><p>arrayUtil.indexOf(a1, "b"));//The parameter "b" doesn't look much like a start index!</p></pre><p><span style="color: #333333; font-family: Omnes-pro, Arial, Verdana, sans-serif; line-height: 21px; background-color: #ffffff;">   </span></p><ul><li>ensureArray and convertArray</li></ul><p>There is no documentation for the ensureArray or convertArray methods.   Given that objects can have complex, nested properties, how would theses conversions work?</p><p></p><p>5) It blurs the lines between the list and set data types.</p><ul><li>It supports retrieval of indices suggesting a List data type.</li><li>It supports intersection|difference|union operations suggesting a Set data type.</li><li>You can change conceptual data structures suddenly.   The structure (an array) tolerates duplicates, but then removes them when you call unique.   What was the data-type before the call to unique?   What is it after the call?</li></ul><p></p><p>6) It violates Solid OO Design principles.</p><ul><li>Putting the state into one object and behaviors into another just doesn't make sense.</li></ul><p></p><p>7) Lastly, and perhaps most importantly: The ArrayUtil is not available on the client.</p><ul><li>No client scripts can make immediate use of unique(), intersection(), diff(), union(), indexOf(), etc.   If you include this code in a client script, it will error out:</li></ul><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14475110841001162 jive_text_macro" data-renderedposition="2276.40625_7.997159004211426_1078_15" jivemacro_uid="_14475110841001162"><p>var arrayUtil = new ArrayUtil(); </p></pre><ul><li>It is possible to use the ArrayUtil methods by creating a client-callable Script Include to wrap the operations and make them available on the client, however, the inherent network latency involved in making an ajax call means that there will always be a noticeable lag while the result is retrieved.</li></ul><p></p><p>For these reasons I found that it made sense to create a separate, new u_GenericSet data type.   The structure is "generic" in the sense of Java generics, in which collections are permanently typed at construction, and which throw exceptions when passed parameters of an incorrect type.</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14473895091568239" data-renderedposition="2417.457275390625_7.997159004211426_1078_15" jivemacro_uid="_14473895091568239"><p><span style="font-weight: inherit; font-style: inherit;"><span class="comment" style="font-weight: inherit; font-style: inherit;">// Wrap code that uses this in a try/catch block and write code to handle exceptions.</span><span style="font-weight: inherit; font-style: inherit;"> </span></span></p></pre><div class="dp-highlighter" style="font-weight: inherit; font-style: inherit;"><ol class="dp-c" start="1" style="font-weight: inherit; font-style: inherit; font-family: inherit;"><li><span style="font-weight: inherit; font-style: inherit;"><span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> u_GenericSet = Class.create();   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">u_GenericSet.prototype = {   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">// Constructor creates a deep copy of the array parameter to avoid pass by reference mayhem.     </span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">// Array parameter is optional</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       initialize: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> (elementType, array) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (elementType == undefined || elementType == null || elementType == '') {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">throw</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="string" style="font-weight: inherit; font-style: inherit;">"Mandatory constructor parameter 'elementType' was omitted when constructing object of type u_GenericSet"</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (!/^(number|string|object|</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">boolean</span><span style="font-weight: inherit; font-style: inherit;">)$/i.test(elementType)) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">throw</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="string" style="font-weight: inherit; font-style: inherit;">"Constructor parameter 'elementType' must be number|string|object|boolean when constructing object of type u_GenericSet"</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType = elementType.toLowerCase();   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary = [];   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> ( array &amp;&amp; array.length ) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">for</span><span style="font-weight: inherit; font-style: inherit;"> (</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> i = </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">; i &lt; array.length; i++) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> ((</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">typeof</span><span style="font-weight: inherit; font-style: inherit;"> array[i]) != </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">throw</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="string" style="font-weight: inherit; font-style: inherit;">"Could not construct the u_GenericSet object because array parameter elements were not all of type "</span><span style="font-weight: inherit; font-style: inherit;"> + </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">                               <span class="keyword" style="font-weight: inherit; font-style: inherit;">this.add</span><span style="font-weight: inherit; font-style: inherit;">(array[i]);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">// Ensures no duplicates.   Param must be of type set at construction</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       add: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> (element) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> passedType = (</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">typeof</span><span style="font-weight: inherit; font-style: inherit;"> element).toLowerCase();   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (passedType != </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">throw</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="string" style="font-weight: inherit; font-style: inherit;">"u_GenericSet was constructed to contain only elements of type:"</span><span style="font-weight: inherit; font-style: inherit;"> + </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType + </span><span class="string" style="font-weight: inherit; font-style: inherit;">" Attempted to add element of type:"</span><span style="font-weight: inherit; font-style: inherit;"> + </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">typeof</span><span style="font-weight: inherit; font-style: inherit;"> element;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="comment" style="font-weight: inherit; font-style: inherit;">//First element</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.length == </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary[</span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">] = element;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="comment" style="font-weight: inherit; font-style: inherit;">//If the element is bigger than last element, stick it at the end               </span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (element &gt; </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary[</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.length - </span><span class="number" style="font-weight: inherit; font-style: inherit;">1</span><span style="font-weight: inherit; font-style: inherit;">]) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary[</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.length] = element;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="comment" style="font-weight: inherit; font-style: inherit;">//If the element is smaller than first element, stick it at the beginning</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (element &lt; </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary[</span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">]) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.splice(</span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">, </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">, element);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> finder = </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">._binaryIndexOf(element);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (finder.foundIt) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               } <span class="keyword" style="font-weight: inherit; font-style: inherit;">else</span><span style="font-weight: inherit; font-style: inherit;"> {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.splice(finder.ndx, </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">, element);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">//Returns object with 2 properties: 1) foundIt (boolean), 2) ndx (integer)</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       _binaryIndexOf: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> (searchElement) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> minIndex = </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> maxIndex = (</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.length == </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">) ? </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;"> : </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.length - </span><span class="number" style="font-weight: inherit; font-style: inherit;">1</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> currentIndex;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> currentElement;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">while</span><span style="font-weight: inherit; font-style: inherit;"> (minIndex &lt;= maxIndex) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       currentIndex = (minIndex + maxIndex) / <span class="number" style="font-weight: inherit; font-style: inherit;">2</span><span style="font-weight: inherit; font-style: inherit;"> | </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       currentElement = <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary[currentIndex];   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (currentElement &lt; searchElement) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               minIndex = currentIndex + <span class="number" style="font-weight: inherit; font-style: inherit;">1</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">else</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (currentElement &gt; searchElement) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               maxIndex = currentIndex - <span class="number" style="font-weight: inherit; font-style: inherit;">1</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">else</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (currentElement == searchElement) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> { foundIt: </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">true</span><span style="font-weight: inherit; font-style: inherit;">, ndx: currentIndex };   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> { foundIt: </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">false</span><span style="font-weight: inherit; font-style: inherit;">, ndx: minIndex };   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">//Returns a boolean</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       _binaryExists: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> (searchElement) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> minIndex = </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> maxIndex = (</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.length == </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">) ? </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;"> : </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.length - </span><span class="number" style="font-weight: inherit; font-style: inherit;">1</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> currentIndex;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> currentElement;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">while</span><span style="font-weight: inherit; font-style: inherit;"> (minIndex &lt;= maxIndex) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       currentIndex = (minIndex + maxIndex) / <span class="number" style="font-weight: inherit; font-style: inherit;">2</span><span style="font-weight: inherit; font-style: inherit;"> | </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       currentElement = <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary[currentIndex];   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (currentElement &lt; searchElement) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               minIndex = currentIndex + <span class="number" style="font-weight: inherit; font-style: inherit;">1</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       } <span class="keyword" style="font-weight: inherit; font-style: inherit;">else</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (currentElement &gt; searchElement) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               maxIndex = currentIndex - <span class="number" style="font-weight: inherit; font-style: inherit;">1</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       } <span class="keyword" style="font-weight: inherit; font-style: inherit;">else</span><span style="font-weight: inherit; font-style: inherit;"> {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">true</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">false</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">           </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">//Returns a boolean</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       contains: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> (element) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> passedType = (</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">typeof</span><span style="font-weight: inherit; font-style: inherit;"> element).toLowerCase();   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (passedType != </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">throw</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="string" style="font-weight: inherit; font-style: inherit;">"u_GenericSet was constructed to contain only elements of type:"</span><span style="font-weight: inherit; font-style: inherit;"> + </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType + </span><span class="string" style="font-weight: inherit; font-style: inherit;">" Attempted to call contains for element of type:"</span><span style="font-weight: inherit; font-style: inherit;"> + </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">typeof</span><span style="font-weight: inherit; font-style: inherit;"> element;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">._binaryExists(element);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">//Removes a value, not a value at an index </span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       remove: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> (element) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> passedType = (</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">typeof</span><span style="font-weight: inherit; font-style: inherit;"> element).toLowerCase();   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (passedType != </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">throw</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="string" style="font-weight: inherit; font-style: inherit;">"u_GenericSet was constructed to contain only elements of type:"</span><span style="font-weight: inherit; font-style: inherit;"> + </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType + </span><span class="string" style="font-weight: inherit; font-style: inherit;">" Attempted to call remove for element of type:"</span><span style="font-weight: inherit; font-style: inherit;"> + </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">typeof</span><span style="font-weight: inherit; font-style: inherit;"> element;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> finder = </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">._binaryIndexOf(element);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (finder.foundIt) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.splice(finder.ndx, </span><span class="number" style="font-weight: inherit; font-style: inherit;">1</span><span style="font-weight: inherit; font-style: inherit;">);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">true</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">false</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">// Returns an int</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       size: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> () { </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.length; },   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">//Returns a new u_GenericSet containing the elements from both sets</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       union: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> (otherSet) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (otherSet.type != </span><span class="string" style="font-weight: inherit; font-style: inherit;">"u_GenericSet"</span><span style="font-weight: inherit; font-style: inherit;">) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">throw</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="string" style="font-weight: inherit; font-style: inherit;">"Called union() on u_GenericSet with a parameter that was not a u_GenericSet type object."</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> otherAsArray = otherSet.toArray();   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> oReturn = </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">new</span><span style="font-weight: inherit; font-style: inherit;"> u_GenericSet(</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType, </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">for</span><span style="font-weight: inherit; font-style: inherit;"> (</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> i = </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">; i &lt; otherAsArray.length; i++) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       oReturn.add(otherAsArray[i]);   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> oReturn;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">//Returns a new u_GenericSet containg the elements in this set that are not in the other</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       difference: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> (otherSet) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (otherSet.type != </span><span class="string" style="font-weight: inherit; font-style: inherit;">"u_GenericSet"</span><span style="font-weight: inherit; font-style: inherit;">) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">throw</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="string" style="font-weight: inherit; font-style: inherit;">"Called difference() on u_GenericSet with a parameter that was not a u_GenericSet type object."</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> inThisSetButNotInOtherSet = [];   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">for</span><span style="font-weight: inherit; font-style: inherit;"> (</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> i = </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">; i &lt; </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.length; i++) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (!otherSet.contains(</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary[i])) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               inThisSetButNotInOtherSet.push(<span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary[i]);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">new</span><span style="font-weight: inherit; font-style: inherit;"> u_GenericSet(</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType, inThisSetButNotInOtherSet);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">//Returns a new u_GenericSet containing elements that are members of both sets</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       intersection: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> (otherSet) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (otherSet.type != </span><span class="string" style="font-weight: inherit; font-style: inherit;">"u_GenericSet"</span><span style="font-weight: inherit; font-style: inherit;">) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">throw</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="string" style="font-weight: inherit; font-style: inherit;">"Called intersection() on u_GenericSet with a parameter that was not a u_GenericSet type object."</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> inBothSets = [];   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> baseSet;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> foreignSet;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="comment" style="font-weight: inherit; font-style: inherit;">//Use the smallest set as the base set to minimize number of comparisons/iterations required</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.size() &lt; otherSet.size()) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       baseSet = <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       foreignSet = otherSet;   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               } <span class="keyword" style="font-weight: inherit; font-style: inherit;">else</span><span style="font-weight: inherit; font-style: inherit;"> {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       baseSet = otherSet;   </span></li><li><span style="font-weight: inherit; font-style: inherit;">                       foreignSet = <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> baseIter = baseSet.getIterator();   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">while</span><span style="font-weight: inherit; font-style: inherit;"> (baseIter.hasNext()) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> val = baseIter.getValue();   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (foreignSet.contains(val)) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               inBothSets.push(val);   </span></li><li><span style="font-weight: inherit; font-style: inherit;">                       }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">                       baseIter.next();   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">new</span><span style="font-weight: inherit; font-style: inherit;"> u_GenericSet(</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.elementType, inBothSets);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">// Returns a boolean</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       isEmpty: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> () {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.length == </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">// Empties all elements</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       purgeAll: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> () {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary = [];   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">// Returns a comma separated list in a String</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       toString: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> () {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.toString();   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       <span class="comment" style="font-weight: inherit; font-style: inherit;">//Creates a deep copy to avoid inadvertent modification of the original</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       toArray: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> () {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> ret = [];   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">for</span><span style="font-weight: inherit; font-style: inherit;"> (</span><span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> i = </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">; i &lt; </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary.length; i++) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       ret.push(<span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary[i]);   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> ret;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">   <span class="comment" style="font-weight: inherit; font-style: inherit;">//Returns an object with functions: next(), hasNext(), and getValue();   </span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">     getIterator: <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> () {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> current = undefined;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> store = </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">this</span><span style="font-weight: inherit; font-style: inherit;">.ary;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> hasNext() {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (store.length == </span><span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">false</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (current == undefined) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               current = <span class="number" style="font-weight: inherit; font-style: inherit;">0</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">if</span><span style="font-weight: inherit; font-style: inherit;"> (current &lt; store.length) {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">true</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       } <span class="keyword" style="font-weight: inherit; font-style: inherit;">else</span><span style="font-weight: inherit; font-style: inherit;"> {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> </span><span class="keyword" style="font-weight: inherit; font-style: inherit;">false</span><span style="font-weight: inherit; font-style: inherit;">;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> next() {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">var</span><span style="font-weight: inherit; font-style: inherit;"> val = store[current];   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       current++;   </span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> val;   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">function</span><span style="font-weight: inherit; font-style: inherit;"> getValue() {   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">                       <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> store[current];   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">               }   </span></li><li><span style="font-weight: inherit; font-style: inherit;">               <span class="keyword" style="font-weight: inherit; font-style: inherit;">return</span><span style="font-weight: inherit; font-style: inherit;"> { next: next, getValue: getValue, hasNext: hasNext };   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">       },   </span></li><li><span style="font-weight: inherit; font-style: inherit;">       type: <span class="string" style="font-weight: inherit; font-style: inherit;">'u_GenericSet'</span><span style="font-weight: inherit; font-style: inherit;">   </span></span></li><li><span style="font-weight: inherit; font-style: inherit;">}   </span></li></ol><p></p></div><p></p><p><span class="jive-content-footer-item" style="font-weight: inherit; font-style: inherit; font-family: inherit;">Exaples of usage:</span><span class="jive-content-footer-item jive-content-footer-tags" style="font-weight: inherit; font-style: inherit; font-family: inherit;"><span class="jive-edit-inline-tags-edit noprint" style="font-weight: inherit; font-style: inherit; font-family: inherit;"><a _jive_internal="true" href="/community?id=community_blog&sys_id=ce4d2229dbd0dbc01dcaf3231f9619cd" style="font-weight: inherit; font-style: inherit; font-family: inherit; color: #8ca9cd;"><span style="font-weight: inherit; font-style: inherit; font-family: inherit;"><br/></span></a></span></span></p><p></p><p>Intersection:</p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14473659586448592 jive_text_macro" data-renderedposition="6738.6787109375_7.997159004211426_1078_201" jivemacro_uid="_14473659586448592"><p><span class="jive-content-footer-item" style="font-weight: inherit; font-style: inherit; font-family: inherit;">//If we ever need to find the set of items that belong to both set a AND set b, we can use the intersection() method.</span></p><p>var a = new u_GenericSet('number',[2002,2004,2006]); </p><p>for(var i = 0; i &lt; 1000; i++){ </p><p>     a.add(i); </p><p>} </p><p></p><p>var b = new u_GenericSet('number', [3,6,9]); </p><p>for(var j = 2000; j &lt; 5000; j++){ </p><p>     b.add(j); </p><p>} </p><p></p><p>var res = a.intersection(b); </p><p><span style="font-size: 9pt; line-height: 12pt;">gs.print(res.toString());</span></p></pre><p></p><p>There are thousand of elements in these sets, but they only share these few elements:</p><p><img   class="jive-image image-4" src="87661046db145344e9737a9e0f961939.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p>Union:</p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14473663847366601 jive_text_macro" data-renderedposition="7147.76953125_7.997159004211426_1078_201" jivemacro_uid="_14473663847366601"><p>//If we ever need to find the set of elements that are in set a OR in set b we can take the set union of the two sets</p><p>var a = new u_GenericSet('number'); </p><p>for(var i = 0; i &lt; 10; i++){ </p><p>     a.add(i); </p><p>} </p><p></p><p>var b = new u_GenericSet('number'); </p><p>for(var j = 5; j &lt; 15; j++){ </p><p>     b.add(j); </p><p>} </p><p></p><p>var res = a.union(b); </p><p>gs.print(res.toString());</p></pre><p></p><p>Notice that even though 5-10 were in both, they only appear in the resulting Set once.</p><p><img   class="image-3 jive-image" src="6ad290c6dbd417041dcaf3231f96191f.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p>Difference:</p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14473662109552655" data-renderedposition="7551.40576171875_7.997159004211426_1078_201" jivemacro_uid="_14473662109552655"><p>//If we ever need to find elements that are in set a, but not in set b we can take the set difference</p><p>var a = new u_GenericSet('number'); </p><p>for(var i = 0; i &lt; 10; i++){ </p><p>     a.add(i); </p><p>} </p><p></p><p>var b = new u_GenericSet('number'); </p><p>for(var j = 7; j &lt; 20; j++){ </p><p>     b.add(j); </p><p>} </p><p></p><p>var res = a.difference(b); </p><p>gs.print(res.toString());</p></pre><p></p><p>Only 0-6 were in Set a and not in Set b.   7-10 were in Set b, so they were removed from the result set.   11-19 were never even checked; since they were not in Set a, we automatically discarded them.</p><p><img   class="image-2 jive-image" src="15633886db5c5f048c8ef4621f961909.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p>So there you have it: a Generic Set data structure that you can use for your Service-Now development.   Enjoy!     Make sure that you wrap your code in try/catch blocks and handle the exceptions that it throws when you pass the wrong type elements into it.   The really nice thing about this class is that it will work both from client code and from server code.   I have it loaded as a global UI Script so that I can use it from any client script.   I am also using it as a server-side script include.   I really like the result, since I can now use a u_GenericSet from any script without having to change gears between client and server scripts.</p><p></p><p>If you like this article, make sure that you check out my post on a Map/Dictionary for Client and Server side use in ServiceNow code: <a title="A Map Data Type for ServiceNow" __default_attr="4956" __jive_macro_name="blogpost" class="jive_macro jive_macro_blogpost" data-orig-content="A Map Data Type for ServiceNow" data-renderedposition="8053.22412109375_837.9971313476562_227_15" href="/community?id=community_blog&sys_id=e31da2e5dbd0dbc01dcaf3231f96195e">A Map Data Type for ServiceNow</a></p><p></p><p><span style="color: #000000; font-family: monospace; font-size: medium; line-height: normal; white-space: pre;">Happy coding. <span __jive_emoticon_name="happy" __jive_macro_name="emoticon" class="jive_emote jive_macro" data-renderedposition="8091.40576171875_108.05397033691406_16_16" src="/8.0.1.35b65d4/images/emoticons/happy.png"></span> We work on an amazing platform. Enjoy it!<br/></span></p><p>var u_GenericMap = Class.create();   u_GenericMap.prototype = {                       //Constructor.               //@param map is optional.   If provided, it must be of type u_GenericMap and its elements will be put() into the new Map.           initialize: function (keyType, valType, map) {                           if (keyType == undefined || keyType == null || keyType == '') {                           throw "Mandatory constructor parameter 'keyType' was omitted when constructing object of type u_GenericMap";                   }                           if (!/^(number|string|object|boolean)$/i.test(keyType)) {                           throw "Constructor parameter 'keyType' must be number|string|object|boolean when constructing object of type u_GenericMap";                   }                           if (valType == undefined || valType == null || valType == '') {                           throw "Mandatory constructor parameter 'valType' was omitted when constructing object of type u_GenericMap";                   }                           if (!/^(number|string|object|boolean)$/i.test(valType)) {                           throw "Constructor parameter 'valType' must be number|string|object|boolean when constructing object of type u_GenericMap";                   }                           this.keyType = keyType.toLowerCase();                   this.valType = valType.toLowerCase();                   this.obj = {};                   this.length = 0;                           if (map &amp;&amp; map.type == 'u_GenericMap') {                           var iterator = map.getIterator();                           while (iterator.next()) {                                   this.obj[iterator.getCurrent().key] = iterator.getCurrent().value;                           }                   }           },                       //Adds an element to the map using he key/value params           put: function (key, val) {                           var passedKeyType = (typeof key).toLowerCase();                   var passedValType = (typeof val).toLowerCase();                           if (passedKeyType != this.keyType) {                           throw "u_GenericMap was constructed to contain only keys of type:" + this.keyType + " Attempted to put element using key of type:" + passedKeyType;                   }                           if (passedValType != this.valType) {                           throw "u_GenericMap was constructed to contain only values of type:" + this.valType + " Attempted to put value of type:" + passedValType;                   }                                         this.length++;                   this.obj[key] = val;           },                   //Returns true if the map contains this key           containsKey: function (key) {                           var passedKeyType = (typeof key).toLowerCase();                           if (passedKeyType != this.keyType) {                           throw "u_GenericMap was constructed to contain only keys of type:" + this.keyType + " Attempted to call containsKey with parameter of type:" + passedKeyType;                   }                           return this.obj.hasOwnProperty(key) ;           },                   //Returns undefined if the key does not exist, otherwise returns the associated value           getValue: function (key) {                           var passedKeyType = (typeof key).toLowerCase();                           if (passedKeyType != this.keyType) {                           throw "u_GenericMap was constructed to contain only keys of type:" + this.keyType + " Attempted to call getValue with parameter of type:" + passedKeyType;                   }                           return this.obj[key];           },                   //Remove an element at a key           remove: function (key) {                           var passedKeyType = (typeof key).toLowerCase();                           if (passedKeyType != this.keyType) {                           throw "u_GenericMap was constructed to contain only keys of type:" + this.keyType + " Attempted to call remove with parameter of type:" + passedKeyType;                   }                           if (!this.obj.hasOwnProperty(key)) {                           return false;                   }                           this.length--;                   delete this.obj[key];                           return true;           },                   //Returns the size of the structure           size: function () { return this.length; },                   //Determines if map is empty           isEmpty: function () {                   return this.obj.length == 0;           },                   //Purge all elements           purgeAll: function () {                   this.length = 0;                   this.obj = {};           },                   //Returns a JSON encoded string representation of the map           toString: function () {                   try {//try client first.   This will throw if executing on the server                           if (window) {                                   return JSON.stringify(this.obj);                           }                   } catch (e) {//Server side                           try {                                   return new JSON().encode(this.obj);                           } catch (e) {                                   throw "u_GenericMap-&gt;toString() Error:" + e.message;                           }                   }           },                   //Returns an array of the keys           getKeys: function () {                   var keys = [];                   for (var k in this.obj) {                           keys.push(k);                   }                   return keys;           },                   //Returns an array of the values           getValues: function () {                   var vals = [];                   for (var k in this.obj) {                           vals.push(this.obj[k]);                   }                   return vals;           },                   //Returns an iterator with functions for next(), hasNext() and getCurrent().   getCurrent() returns an obj with keys: key, value           getIterator: function () {                           var store = [];                   var currentVal;                   var currentIndex;                                       for (var k in this.obj) {                           store.push({ 'key': k, 'value': this.obj[k] });                   }                   currentIndex = 0;                                           //sets var "currentVal", returns true if there are more elements, false otherwise                   function hasNext() {                           if (currentIndex &lt; store.length) {                                   currentVal = store[currentIndex];                                   return true;                           } else {                                   return false;                           }                   }                           //Returns the currentValue, set the var "currentVal", increments the internal index                   function next() {                           currentVal = store[currentIndex];                           return store[currentIndex++];                   }                           //Returns an object with keys: key, value                   function getCurrent() {                           return currentVal;                   }                   return { next: next, getCurrent: getCurrent, hasNext: hasNext };           },           type: 'u_GenericMap'   }</p>