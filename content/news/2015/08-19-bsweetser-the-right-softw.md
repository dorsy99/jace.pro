---
title: "The Right Software Rights Calculations"
date: 2015-08-18T05:56:53.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=d21e226ddbd0dbc01dcaf3231f9619e0"
---
<p style="font-family: 'Helvetica Neue'; font-size: 14px;"><span>There is no denying it. Software licensing is a tricky topic. Sometimes, the metric used to calculate software is fairly straight forward. An example of a simple model is <strong>Per workstation</strong>, which uses one software license right for each installation of the software. Unfortunately, it is not always this easy. Software publishers are constantly creating new and creative ways to license their software to better reflect the value you get from the software. Some models make more sense than others. This can make it increasingly difficult for Software Asset Managers to effectively track software to ensure the organization is compliant for the software.</span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">This post quickly reviews some of the built-in software license calculations in ServiceNow and how to create a new <strong>License calculation</strong> if one does not exist. This topic is covered in more detail in the <a title="" _jive_internal="true" href="/community/service-management/asset-management/blog/2015/01/24/the-who-what-when-where-and-why-for-asset-management-training">ServiceNow Asset Management course</a>. Note that the license calculations used here do not necessarily represent the actual licensing from the software publisher in the example.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">For the purpose of demonstration, the software title used here is Adobe Illustrator CC (Creative Cloud). There are nine installations of Illustrator CC in the environment on nine different systems that are assigned to 5 different users. Some users have multiple systems. They are listed here with Model and Form factor displayed for use later in the post.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"><img   alt="2015-08-17_15-51-38.png" class="image-0 jive-image" src="f4243b35db105fc03eb27a9e0f9619e3.iix" style="height: 454px; width: 620px; display: block; margin-left: auto; margin-right: auto; border: #000 solid 1px;"/></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><h1>Per workstation</h1><p style="font-family: 'Helvetica Neue'; font-size: 14px;"><strong>Per workstation</strong> is one of the simplest licensing models simply counts each installation of the software as a right used. Here is a Software Counter that tallies up the rights used in this environment. As expected, nine rights are used because there are nine installations of the software.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"><img   alt="2015-08-17_11-37-00.png" class="image-1 jive-image" src="9a8055c2db54d304b322f4621f96191b.iix" style="height: 216px; width: 620px; display: block; margin-left: auto; margin-right: auto; border: #000 solid 1px;"/></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><h1>Per named user</h1><p style="font-family: 'Helvetica Neue'; font-size: 14px;">A License type on the counter of <strong>Per named user</strong> allows users to have installations on any number of computers, but to only consume one software license right. In this scenario, there are five users of Adobe Illustrator CC. ServiceNow uses the <strong>Assigned to</strong> field on CI record to identify the user, so this information is important for user based licenses.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"><img   alt="2015-08-17_11-44-59.png" class="jive-image image-2" src="bef1784adb189344e9737a9e0f9619c6.iix" style="height: 216px; width: 620px; display: block; margin-left: auto; margin-right: auto; border: #000 solid 1px;"/></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><h1>Number of installs per user</h1><p style="font-family: 'Helvetica Neue'; font-size: 14px;">Some licenses are user based, but limit the number of installations that user can have. For example, a license may allow for each user to have the software installed to two computers and only use a single license right. The License type <strong>Number of installs per user</strong> performs the count per user. If a user has more than the allotted number of installations, then more rights are used. In this sample, Kathie Argenti has three installations, so she is using two license rights for the software, and the final count reflects this. No other user has more than two installations, so they are each using just a single right.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"><img   alt="2015-08-17_11-50-41.png" class="jive-image image-3" src="92b01c82db105344e9737a9e0f9619bb.iix" style="height: 246px; width: 620px; display: block; margin-left: auto; margin-right: auto; border: #000 solid 1px;"/></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><h1>Custom License Calculations</h1><p style="font-family: 'Helvetica Neue'; font-size: 14px;">With new types of license calculations on the rise, you may find that the built-in options do not quite meet your needs. One example that has been brought to my attention several times and most recently on the <a title="" _jive_internal="true" href="/community?id=community_question&sys_id=d2318be5db98dbc01dcaf3231f9619e8">community</a>, is one that allows users to have two installations, but it has an additional restriction that one of the installs can be on a desktop computer and the other can be on a laptop. If both of the user's installations are on a desktop or both are on a laptop, then the user consumes two software license rights. No default <strong>License type</strong> in ServiceNow allows for this, so it requires the creation of a custom calculation. Because ServiceNow is flexible, these calculations can be created and shared with other ServiceNow users through <a title="hare.servicenow.com/" href="https://share.servicenow.com/">Share</a> or the <a title="tore.servicenow.com/" href="https://store.servicenow.com/">App Store</a> (I am not aware of any custom calculations posted to either of these sites yet, but this could be the start of something).</p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">Note that this example covers some basic things that you might want to do as part of a license calculation, such as determine what has previously been counted for a computer or user. What follows is a breakdown of the process to create a custom calculation to handle this particular situation. It could be modified to support other models, such as Office 365, which also allows multiple installs, but only differentiates between computer and tablet installations.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><h2>Software License Calculation Creation</h2><p style="font-family: 'Helvetica Neue'; font-size: 14px;">First, you need to create the new License Calculation record.</p><ol style="font-family: 'Helvetica Neue'; font-size: 14px;"><li>Navigate to <strong>Software Asset &gt; Reconciliation &gt; License Calculations</strong>.</li><li>Click <strong>New</strong>.</li><li>Name the Calculation. This scenario uses the <strong>Software install</strong> table and and the software is entitled to the user, so you should use an Entitlement type of <strong>User</strong>.</li></ol><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"><img   alt="2015-08-17_15-01-26.png" class="jive-image image-4" src="04fc6ff1db981fc068c1fb651f96197d.iix" style="height: auto; display: block; margin-left: auto; margin-right: auto; border: #000 solid 1px;"/></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><h2>Required information</h2><p style="font-family: 'Helvetica Neue'; font-size: 14px;">Next comes the tough (but fun!) part: the script to perform the calculation! Before coding, consider the foundation information and how it can be used here and what the process looks like.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">Foundation information required:</p><ul><li><strong>Form factor</strong> for device - this is best stored on the Model record. Then you can identify it in a single locations for all CIs and Assets based on that model. See <a title="Model Extension: Model Management Part 8" __default_attr="3845" __jive_macro_name="blogpost" class="jive_macro jive_macro_blogpost" data-orig-content="Model Extension: Model Management Part 8" href="/community?id=community_blog&sys_id=614e26addbd0dbc01dcaf3231f961948">Model Extension: Model Management Part 8</a> for more details on this.</li><li>What has been counted for the user already. This count needs to break up the counted installs by Form factor for the device.</li></ul><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><h2>Script flow</h2><p style="font-family: 'Helvetica Neue'; font-size: 14px;">Here is the flow that this script takes to perform the calculation.</p><ol style="font-family: 'Helvetica Neue'; font-size: 14px;"><li>Check that the <strong>Assigned to</strong> field is populated. If not, then automatically count a right used regardless of form factor.</li><li>Check that the <strong>Form factor</strong> is populated for the Model. If not, then automatically count a right used. This ensures that you show more rights used than you may actually need. You should take appropriate measures to identify Models that need the Form factor to be populated.</li><li>With the <strong>Assigned to</strong> and <strong>Form factor </strong>populated, determine the number of installations already counted on desktops and laptops for the user. This uses a GlideAggregate to perform the count.</li><li>With the Desktop and Laptop counts identified, determine the form factor for the current item being counted.<ol><li>If the current item is a desktop, determine if there is a desktop right available to the user. In this case, it just means that the number of desktops counted for the user already is lower than the number of laptops.</li><li>If the current item is a laptop, determine if there is a laptop right available to the user. Similar to above, this means there are fewer laptop installations counted for the user than desktops.</li><li>If there is not an available right, then consume a license right for the software.</li></ol></li></ol><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><h2>The code</h2><p style="font-family: 'Helvetica Neue'; font-size: 14px;">And now the code itself:</p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">1. Check the <strong>Assigned to</strong>:</p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>if (!user) { </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       valuation = 1; </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>}</strong> </span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">2. Check the <strong>Form factor</strong>:</p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>else if (workstation.model_id.u_form_factor == "") { </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;">       valuation = 1; </span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;">} </span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">3. Get the count of desktops and laptops already counted for the user.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>else { </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       var desktopCount = 0; </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       var laptopCount = 0; </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       var installDesktop = new GlideAggregate(query_table); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installDesktop.addAggregate('COUNT'); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installDesktop.addQuery('installed_on.assigned_to', user.sys_id); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installDesktop.addQuery('counted_by.counter', counter_id); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installDesktop.addQuery('cached', true); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installDesktop.addQuery('installed_on.model_id.u_form_factor','Desktop'); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installDesktop.setGroup(false); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installDesktop.query(); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       if (installDesktop.next()) { </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>               desktopCount = installDesktop.getAggregate('COUNT'); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       } </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       var installLaptop = new GlideAggregate(query_table); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installLaptop.addAggregate('COUNT'); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installLaptop.addQuery('installed_on.assigned_to', user.sys_id); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installLaptop.addQuery('counted_by.counter', counter_id); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installLaptop.addQuery('cached', true); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installLaptop.addQuery('installed_on.model_id.u_form_factor','Laptop'); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installLaptop.setGroup(false); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       installLaptop.query(); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       if (installLaptop.next()) { </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>               laptopCount = installLaptop.getAggregate('COUNT'); </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>         }</strong> </span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">4.1 Desktop rights check.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       if (workstation.model_id.u_form_factor == 'Desktop' &amp;&amp; desktopCount &lt; laptopCount ) { </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>               valuation = "0"; </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       }</strong> </span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">4.2 Laptop rights check.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       else if (workstation.model_id.u_form_factor == 'Laptop' &amp;&amp; laptopCount &lt; desktopCount ) { </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>               valuation = "0"; </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 30px;"><span style="font-family: 'courier new', courier;"><strong>       }</strong> </span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">4.3 Add right used when no rights were already available.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 60px;"><span style="font-family: 'courier new', courier;"><strong>else { </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 60px;"><span style="font-family: 'courier new', courier;"><strong>               valuation = "1"; </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 60px;"><span style="font-family: 'courier new', courier;"><strong>       } </strong></span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px; padding-left: 60px;"><span style="font-family: 'courier new', courier;"><strong>}</strong> </span></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><h2>Wrap up</h2><p style="font-family: 'Helvetica Neue'; font-size: 14px;">Then when you apply this to the Software Counter, you get the count for each user, but Bertie Luby uses two rights because he has two laptops, and Kathie Argenti uses two rights because she has three computers, two laptops and one desktop. You can</p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"><img   alt="2015-08-17_16-58-19.png" class="jive-image image-5" src="66ce0d8edb9413043eb27a9e0f961961.iix" style="height: 217px; width: 620px; display: block; margin-left: auto; margin-right: auto; border: #000 solid 1px;"/></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"><img   alt="2015-08-17_17-00-49.png" class="jive-image image-6" src="079ba0cadbd09344e9737a9e0f9619f7.iix" style="height: 368px; width: 620px; display: block; margin-left: auto; margin-right: auto; border: #000 solid 1px;"/></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">I've attached this full script (commented) as a text file if you want to copy and paste it all at once.</p><p style="font-family: 'Helvetica Neue'; font-size: 14px;"></p><p style="font-family: 'Helvetica Neue'; font-size: 14px;">Hopefully this gives you an idea on how to handle complex counters in your environment.   What complex counters do you need for your environment? If you are not sure, be sure to reference your agreements or documentation with the software publisher where they identify how to calculate software rights usage.</p>