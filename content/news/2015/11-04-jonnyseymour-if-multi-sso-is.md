---
title: "If MultiSSO is installed check SAML installations exits are inactive"
date: 2015-11-03T06:14:26.000Z
authors: ["jonnyseymour"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=85bc6a25dbd0dbc01dcaf3231f9619e7"
---
<p>Setting SSO is incredibly popular. Multi-SSO features flexibility and security in a incredible simplified interface. On this blog I want to talk about a problem that can happens after upgrading to Multi-SSO from an earlier version where some old scripts will remain active when they should be disabled. That is a rough idea thought.</p><p></p><p><img  alt="multisso1.png" class="image-2 jive-image" height="120" src="94a8f0cedbdcd704ed6af3231f9619b6.iix" style="width: 201px; height: 119.582px; display: block; margin-left: auto; margin-right: auto;" width="201"/></p><p>Lets talk about:</p><ul><li>Multi-SSO and Installation exits</li><li>Multi-SSO installation exit problem</li><li>Solution to the Multi-SSO Installation exit problem</li></ul><p></p><h2>Multi-SSO and Installation exits</h2><p></p><p>The <a title="ki.servicenow.com/index.php?title=Multiple_Provider_Single_Sign-On#gsc.tab=0" href="http://wiki.servicenow.com/index.php?title=Multiple_Provider_Single_Sign-On#gsc.tab=0">multiple provider single sign-on</a> feature allows organizations to use several SSO identity providers (IdPs) to manage authentication as well as retain local database (basic) authentication.</p><p></p><p><a title="ki.servicenow.com/index.php?title=Installation_Exits#gsc.tab=0" href="http://wiki.servicenow.com/index.php?title=Installation_Exits#gsc.tab=0">Installation exits</a> are customizations that exit from Java to call a script before returning back to Java. They are usually related to login, logout, validate password and external authentication. That is why I think of them as "doorman scripts." Installation exists are located on<strong> System Definition &gt; Installation Exits. </strong>Some <a title="ki.servicenow.com/index.php?title=Installation_Exits#gsc.tab=0" href="http://wiki.servicenow.com/index.php?title=Installation_Exits#gsc.tab=0">installation exits</a> can be overrode with a custom script that replaces the script in the default installation exit.</p><p></p><p>Each SSO plugin comes with its own installation exits.</p><p>When <a title="ki.servicenow.com/index.php?title=Multiple_Provider_Single_Sign-On#gsc.tab=0" href="http://wiki.servicenow.com/index.php?title=Multiple_Provider_Single_Sign-On#gsc.tab=0">Multi-SSO</a> is installed is comes with its own installation exits, the previous SAML installation exits are not longer required and the system will make them inactive.</p><p></p><h2>Multi-SSO Installation exit problem</h2><p>After enabling Multi-SSO, some SSO validations may fail if the Multi-SSO installation scripts do not execute first.</p><p>There are some exceptional cases where some SAML* installation exits remain active (incorrectly) after the Multi-SSO plugin is installed.</p><p>e.g. If SAML is already active at the time you activated <a title="ki.servicenow.com/index.php?title=Multiple_Provider_Single_Sign-On#gsc.tab=0" href="http://wiki.servicenow.com/index.php?title=Multiple_Provider_Single_Sign-On#gsc.tab=0">Multiple Single Sign-On</a> and if you already customized the SAML <a title="ki.servicenow.com/index.php?title=Installation_Exits#gsc.tab=0" href="http://wiki.servicenow.com/index.php?title=Installation_Exits#gsc.tab=0">installation exits</a>.</p><p></p><p>This could cause the logs will show the following errors:</p><pre __jive_macro_name="quote" class="jive_macro_quote jive_text_macro" data-renderedposition="799.7833251953125_8_917_230"><p>WARNING *** WARNING *** Evaluator: org.mozilla.javascript.EcmaError: Cannot convert null to an object.</p><p>Caused by error in Script Include: 'SAML2_update1' at line 35</p><p></p><p>32: this.lastGeneratedRequestID = null;</p><p>33: this.inResponseTo = null;</p><p>34: this.logoutFailureEventId = "saml2.logout.validation.failed";</p><p><span style="color: #e23d39;">==&gt; 35: this.certGR = this.getCertGR();</span></p><p>36: </p><p>37: // Keep SAMLAssertion object for validation</p><p>38: this.SAMLResponseObject = null;</p></pre><p></p><h2>Solution to the Multi-SSO Installation exit problem</h2><p>To resolve the problem, if <a title="ki.servicenow.com/index.php?title=Multiple_Provider_Single_Sign-On#gsc.tab=0" href="http://wiki.servicenow.com/index.php?title=Multiple_Provider_Single_Sign-On#gsc.tab=0">Multi-SSO</a> is installed correctly, validate the following installation exits have Active set to False:</p><p></p><table border="1" cellpadding="0" cellspacing="0" height="191" style="padding: 0px 5.4pt; width: 303px; height: 192px;"><tbody><tr><td style="border: solid windowtext 1.0pt; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="212"><p><strong>Installation exit</strong></p></td><td style="border: solid windowtext 1.0pt; border-left: none; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="32"><p></p></td><td style="border: solid windowtext 1.0pt; border-left: none; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="238"><p><strong>Active</strong></p></td></tr><tr><td style="border: solid windowtext 1.0pt; border-top: none; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="212"><p>SAML2Logout</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="32"><p>=</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="238"><p>false</p></td></tr><tr><td style="border: solid windowtext 1.0pt; border-top: none; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="212"><p>SAML2Logout_update1</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="32"><p>=</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="238"><p>false</p></td></tr><tr><td style="border: solid windowtext 1.0pt; border-top: none; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="212"><p>SAML2SingleSignon</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="32"><p>=</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="238"><p>false</p></td></tr><tr><td style="border: solid windowtext 1.0pt; border-top: none; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="212"><p>SAML2SingleSignon_update1</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="32"><p>=</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #F2DBDB; padding: 0 5.4pt 0 5.4pt;" valign="top" width="238"><p>false</p></td></tr><tr><td style="border: solid windowtext 1.0pt; border-top: none; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="212"><p>MultiSSO</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="32"><p>=</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="238"><p>true</p></td></tr><tr><td style="border: solid windowtext 1.0pt; border-top: none; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="212"><p>MultiSSOLogin</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="32"><p>=</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="238"><p>true</p></td></tr><tr><td style="border: solid windowtext 1.0pt; border-top: none; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="212"><p>MultiSSOLogout</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="32"><p>=</p></td><td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #DBE5F1; padding: 0 5.4pt 0 5.4pt;" valign="top" width="238"><p>true</p></td></tr></tbody></table><p></p><p></p><p>Here is the result:</p><p><img   alt="2015-11-01_1038_INSTALL_EXITS.png" class="image-1 jive-image" src="6c32e542dbd4d7041dcaf3231f96193d.iix" style="width: 620px; height: 268px;"/></p><p></p><p>In conclusion, after installing Multi-SSO plugin, check SAML installation exits are disabled as it will save you time on troubleshooting. However, do not stop there. If other scripts have been customized, the similar steps apply. e.g. script includes, business rules, etc. versions need to be updated to the most current script manually.</p><p></p><p>Check out <a title="" _jive_internal="true" href="/people/jonnyseymour/content">my other blogs,</a> as I have also discussed about <a title="ki.servicenow.com/index.php?title=Email_Notifications#gsc.tab=0" href="http://wiki.servicenow.com/index.php?title=Email_Notifications#gsc.tab=0">email notifications </a>and <a title="ki.servicenow.com/index.php?title=Multiple_Provider_Single_Sign-On#gsc.tab=0" href="http://wiki.servicenow.com/index.php?title=Multiple_Provider_Single_Sign-On#gsc.tab=0">SSO</a>.</p><p></p><p>More information here:</p><ul><li><a href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0546974" title="https://hi.service-now.com/kb_view.do?sysparm_article=KB0546974">Authentication Resources (KB0546974)</a> </li><li><a href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/integrate/single-sign-on/concept/c_MultipleProviderSingleSignOn.html" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/integrate/single-sign-on/concept/c_MultipleProviderSingleSignOn.html">Docs: Multiple provider single sign-on</a> </li><li><a href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/integrate/single-sign-on/task/t_SettingUpMultiProviderSSO.html" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/integrate/single-sign-on/task/t_SettingUpMultiProviderSSO.html">Docs: Set up multi-provider SSO</a> </li><li><a href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/integrate/single-sign-on/task/t_ActivateMultipleProviderSSO.html" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/integrate/single-sign-on/task/t_ActivateMultipleProviderSSO.html">Docs: Activate multiple provider single sign-on</a> </li><li><a href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/integrate/saml/concept/c_SAML2.0WebBrowserSSOProfile.html" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/integrate/saml/concept/c_SAML2.0WebBrowserSSOProfile.html">Docs: SAML 2.0</a> </li><li><a href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/integrate/saml/concept/c_ADFSIntegrationWithSAML2.0.html" title="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/integrate/saml/concept/c_ADFSIntegrationWithSAML2.0.html">Docs: ADFS integration with SAML 2.0</a> </li><li><a href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0538763" title="https://hi.service-now.com/kb_view.do?sysparm_article=KB0538763">Determining if the SAML certificate is incorrect (KB0538763)</a></li><li><a href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0529257" title="https://hi.service-now.com/kb_view.do?sysparm_article=KB0529257">Common SAML 2.0 Errors and Their Solutions (KB0529257)</a></li><li><a href="https://html-online.com/search.jspa?q=jonnyseymour&amp;type=post" title="https://community.servicenow.com/search.jspa?q=jonnyseymour&amp;type=post">My other blogs</a></li></ul><p></p><p></p><p>Thanks <a __default_attr="38430" __jive_macro_name="user" class="jive_macro jive_macro_user" data-orig-content="chris.beltran" data-renderedposition="2110.033447265625_57.26666259765625_96_17" href="/community?id=community_user_profile&user=3dbf4aaddb181fc09c9ffb651f96191e" modifiedtitle="true" title="chris.beltran">chris.beltran</a></p>