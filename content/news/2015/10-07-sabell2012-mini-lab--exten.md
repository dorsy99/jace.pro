---
title: "MiniLab Extending the GlideRecord Object"
date: 2015-10-06T23:28:22.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=b96c2ea1dbd0dbc01dcaf3231f9619b9"
---
<p><span style="font-size: 12pt;">So now that I have this nifty way of turning a <a title="" _jive_internal="true" href="/groups/servicenow-user-group-us-tx-north-texas/blog/2015/09/24/community-code-snippets--gliderecord-to-object-array-conversion">GlideRecord into an object array</a>, AND I have that in a Script Include function library, what's next?   Well, how about extending the GlideRecord object to include the new toObjectList function?</span></p><p></p><p><span style="font-size: 12pt;">I have seen things like this done in ServiceNow to extend the JavaScript language, but they use a Global Business rule which loads with every table call (no matter what).   This adds to the overall activity load, and does not put forth the extension into every corner of ServiceNow.   I like a different approach, lets write a Script Include that we will call on demand that provides the requested functionality.   No performance load and it goes away when our code has completed!</span></p><p><span style="font-size: 12pt;"> </span></p><p><span style="font-size: 12pt;">New stuff!</span></p><p><span style="font-size: 12pt;"> </span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">GlideRecord.prototype.</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">GlideRecord.restorelocation()</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">gs.include(...)</span></p><p style="padding-left: 30px;"><span style="font-size: 12pt;">JSUtil.describeObject(...)<br/></span></p><p><span style="font-size: 12pt;"> </span></p><p></p><p><span style="font-size: 18pt;"><strong>Lab 1.1 - Create a Script Include to Extend GlideRecord</strong></span></p><p></p><p><span style="font-size: 12pt;">With this lab we will be creating a Script Include function library that we will call with a gs.include statement.</span></p><p></p><p><span style="font-size: 12pt;">1. Navigate to System Definition -&gt; Script Includes. This will display the Script Includes list view.</span></p><p><span style="font-size: 12pt;">2. Click on the New button.   This will display the new Script Include form.</span></p><p><span style="font-size: 12pt;">3. Fill in the form with the following:</span></p><p><span style="font-size: 12pt;">       a. <strong>Name</strong>: GlideRecordExtensions (this will trigger the creation of a Script template; delete this before entering in the script below).</span></p><p><span style="font-size: 12pt;">       b. <strong>Client</strong> <strong>Callable</strong>: False</span></p><p><span style="font-size: 12pt;">       c. <strong>Active</strong>: True</span></p><p><span style="font-size: 12pt;">       d. <strong>Script</strong>: </span></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14441388163563214 jive_text_macro" data-renderedposition="653_8_1192_496" jivemacro_uid="_14441388163563214"><p>// These functions will be tacked onto the GlideRecord object when we new it.</p><p>// You can add functions and properties to existing objects in this manner</p><p>// The "this" variable is actually the GlideRecord object!</p><p>GlideRecord.prototype.toObjectList = function() {</p><p>       var objectList = [];</p><p>   </p><p>       // loop through all the records and create the object array</p><p>       while(this.next()) {</p><p>               objectList.push(this.toObject(this));</p><p>       }</p><p>       this.restoreLocation(); // set it back to the beginning so that we can use if for other things</p><p></p><p>       return objectList;</p><p>};</p><p></p><p>// Turn a single GlideRecord record into an object</p><p>GlideRecord.prototype.toObject = function(recordToPackage) {</p><p>     var packageToSend = {};</p><p></p><p>     for (var property in recordToPackage) {</p><p>             try {</p><p style="padding-left: 30px;">                     packageToSend[property] = recordToPackage[property].getDisplayValue();</p><p>             }</p><p style="padding-left: 30px;">             catch(err){}</p><p>     }</p><p></p><p>     return packageToSend;</p><p>};</p>   </pre><p></p><p></p><p><span style="font-size: 18pt;"><strong>Lab 1.2 - Testing the New Extensions</strong></span></p><p></p><p><span style="font-size: 12pt;">1. Navigate to System Definition -&gt; Fix Scripts.   This will display the Fix Scripts list view.</span></p><p><span style="font-size: 12pt;">2. Click on the New button.   This will display a new Fix Scripts form.</span></p><p><span style="font-size: 12pt;">3. Fill in the form with the following:</span></p><p><span style="font-size: 12pt;">       a. <strong>Name</strong>: GlideRecordExtension Test</span></p><p><span style="font-size: 12pt;">       b. <strong>Active</strong>: true</span></p><p><span style="font-size: 12pt;">       c. <strong>Script</strong>: </span></p><p></p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code jive_text_macro _jivemacro_uid_14441388163343530" data-renderedposition="1434_8_1192_416" jivemacro_uid="_14441388163343530"><p>// This brings in our new functionality (so to speak)</p><p>gs.include('GlideRecordExtensions');</p><p></p><p>var incidents = new GlideRecord('incident');</p><p>incidents.addActiveQuery();</p><p>incidents.setLimit(10);</p><p>incidents.query();</p><p></p><p>gs.print(incidents.getRowCount());</p><p></p><p>// Now invoke our new GlideRecord extension!</p><p>var stuffList = incidents.toObjectList();</p><p></p><p>// Check to see if our list is now populated</p><p>gs.print(stuffList.length);</p><p></p><p>// It is! Now pick one of the objects out of the array and see if it's properties are populated</p><p>gs.print(stuffList[5].number);</p><p></p><p>// They are!   Now describe that entire object to see if it was a fluke</p><p>gs.print(JSUtil.describeObject(stuffList[5]));</p><p></p><p>// Everything is filled in like it should be!</p>   </pre><p></p><p><span style="font-size: 12pt;">4. Click the Submit button to save your work.   The Fix Scripts list view will be displayed.</span></p><p><span style="font-size: 12pt;">5. Click on the name of your new Fix Script.   This will display your Fix Script for editing.<br/></span></p><p><span style="font-size: 12pt;">6. At the bottom of the form click on the Run Fix Script link in the Related Lists section.   This will display the run Run Fix Script form.</span></p><p><span style="font-size: 12pt;">7. Click the Ok button to continue. This will display the warning form.</span></p><p><span style="font-size: 12pt;">8. Click the Proceed button to continue.   You should have a results form that displays something like the following:</span></p><p><span style="font-size: 12pt;"> </span></p><p><span style="font-size: 12pt;"><img   alt="1. Fix Script run.JPG" class="image-0 jive-image" src="8caa8802db9cdb048c8ef4621f9619ff.iix" style="height: 541px; width: 620px; display: block; margin-left: auto; margin-right: auto;"/></span></p><p><span style="font-size: 12pt;"> </span></p><p><span style="font-size: 12pt;"> </span></p><p><span style="font-size: 12pt;">Now that wasn't so bad.   In the next article I will use this functionality along with a new ECMA 5 array method called .filter to show off yet another nifty bit of capability.</span></p><p></p><p><span style="font-size: 12pt;">Steven Bell</span></p><p><span style="font-size: 12pt;"> </span></p><p style="font-weight: inherit; font-style: inherit; font-family: inherit;"><span style="color: #800080; font-size: 12pt; font-style: inherit; font-family: arial, helvetica, sans-serif; font-weight: inherit;"><strong>If you find this article helps you, don't forget to log in and "like" it!   I would also like to encourage you to become a member of our blog!</strong></span></p><p style="margin-bottom: .0001pt; background: white;"><span style="color: purple; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong><a _jive_internal="true" data-containerid="-1" data-containertype="-1" data-objectid="86661" data-objecttype="111" href="/servlet/JiveServlet/downloadImage/38-4985-86661/CS_logo.jpg"><img  alt="CS_logo.jpg" class="image-18 jive-image" height="60" src="6656e3b9db10df04e9737a9e0f961932.iix" width="151"/></a></strong></span><span style="color: purple; font-size: 12pt; font-family: arial, helvetica, sans-serif;"><strong><a _jive_internal="true" data-containerid="2061" data-containertype="14" data-objectid="2273" data-objecttype="102" href="/community?id=community_article&sys_id=330d6ea5dbd0dbc01dcaf3231f961965"><img  alt="MVP-logo.jpeg" class="image-17 jive-image" height="48" src="472ac5c6db941b04ed6af3231f96198c.iix" width="135"/></a></strong></span></p><p><span style="color: #eb7a3d;">Please Share, Like, Comment this blog if you've found it helpful or insightful.</span></p><p></p><hr/><p><span style="color: #eb7a3d;"><span style="color: #303030;">for Click for <a title="" _jive_internal="true" href="/community?id=community_forum&sys_id=a6299a2ddbd897c068c1fb651f961926">More Expert Blogs </a>and also Find <a title="" _jive_internal="true" class="jivecontainerTT-hover-container jive-link-community-small" data-containerid="2059" data-containertype="14" data-objectid="2037" data-objecttype="14" href="/community?id=community_forum&sys_id=d6295a2ddbd897c068c1fb651f9619f1">Expert Events</a>!</span><br/></span></p><hr/>