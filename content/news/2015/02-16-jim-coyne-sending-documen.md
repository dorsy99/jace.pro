---
title: "Sending Documents in an Email Notification"
date: 2015-02-16T01:52:21.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=651deea5dbd0dbc01dcaf3231f96196e"
---
<p>Someone asked me how they could send an actual document with a notification and not just a link to it.   That's pretty easy now, with the "Include attachments" field on the Notification record.   However, in this particular case, the document was not being attached to a task or other type of record - it is a PDF document that contains the company's Terms of Service.   They wanted to send the PDF out to users in certain situations, such as when ordering a catalog item.</p><p></p><p>So, instead of manually attaching the document to multiple records whenever it needed to go out, this is how it can be handled, limiting the amount of scripting and maintenance required.</p><p></p><p style="font-size: 13.3333330154419px;"><strong>Step 1</strong> - Create a new Event in the Registry</p><p style="font-size: 13.3333330154419px;">Select the "Registry" module in the "System Policy" application and create a new record.   I called it "u.terms.of.service" <strong>(remember to prefix any custom events with "u." in order to avoid issues with SN adding a new event with the same name)</strong> and set the Table field to "Knowledge [kb_knowledge]":</p><p style="font-size: 13.3333330154419px;"><img   alt="Custom_Window_Title.png" class="image-1 jive-image jiveImage" src="4597998adb1c97049c9ffb651f9619f6.iix"/></p><p></p><p></p><p><strong>Step 2</strong> - Create the Notification</p><p>Create a new notification, and set it to go out when the "u.terms.of.service" event is fired:</p><p><img   alt="Test_-_Terms_of_Service.png" class="jive-image image-3" height="109" src="83e5300adb5cdfc03eb27a9e0f961985.iix" style="height: 109px; width: 750.888888888889px;" width="751"/></p><p></p><p>Make sure the "Event parm 1 contains recipient" field is checked as we will send the sys_id of the user in the event in step 4 below (you may have to switch to the Advanced view to see the field):</p><p><img   alt="Test_-_Terms_of_Service.png" class="jive-image image-5" height="144" src="84c0984edb505304b322f4621f961986.iix" style="height: 144px; width: 769.655172413793px;" width="770"/></p><p>Make sure the "Send to event creator" field is checked as well to ensure the email will go out.</p><p></p><p>The important part of the notification is to select the "Include attachments" field:</p><p><img   alt="Test_-_Terms_of_Service.png" class="jive-image image-6" src="111fa7b1db98dfc0b322f4621f961977.iix" style="height: auto; width: auto;"/></p><p></p><p>Fill in the Subject and Message fields with whatever you want in the email message.</p><p></p><p></p><p style="font-size: 13.3333330154419px;"><strong>Step 3</strong> - Create a new Knowledge Article</p><p style="font-size: 13.3333330154419px;">This step allows you to create a record that will contain the attachment(s).   Create the article and attach the document to the record.   I use the event name as the Short description.   You can limit who can see the article by adding the "admin" role to the "Roles" field.   You do not even have to publish the article in order for this to work, so only your admin and KB admins would even see it.   You can also create a new Topic and Category combination for these documents if you want to separate them from all the other "normal" KB articles.</p><p style="font-size: 13.3333330154419px;"></p><p style="font-size: 13.3333330154419px;"><strong>NOTE:</strong>   You will need to export the article from your development instance and import it into production or just recreate the article in production as the KB table is not tracked in Update Sets.</p><p style="font-size: 13.3333330154419px;"></p><p></p><p><strong>Step 4</strong> - Fire the event</p><p>This can be from a Business Rule or even a Workflow - all depends on the requirements:</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_text_macro jive_macro_code _jivemacro_uid_14240299296032859" jivemacro_uid="_14240299296032859">
<p>(function() {</p>
<p>       var gr = new GlideRecord("kb_knowledge");</p>
<p>       gr.addEncodedQuery("workflow_state=published^short_description=u.terms.of.service");</p>
<p>       gr.query();</p>
<p>       if (gr.next()) {</p>
<p>             gs.eventQueue("u.terms.of.service", gr, current.getValue("caller_id"));</p>
<p>       }</p>
<p>})();</p>

</pre><p></p><p>The script queries the KB table for a record with a Short description the same as the event name (or however else you may want to search for it).   It then adds the event to the queue if it finds a record, passing along the event name, the GlideRecord object of the KB article (gr) and the user who should receive the document (current.getValue("caller_id")).   You will probably have to change where you are getting the value for that last parameter based on your situation (my example is sending the email to the Caller on an Incident record).</p><p></p><p>The nice thing about doing it this way is you can easily update the attachment on the KB article record and the new document will go out from then on.   The condition on line 3 of the script checks for a published KB article - that way you can retire the article and the notification would no longer go out because the event would not fire as the article would not be found in the query, all without having to change any code.</p>