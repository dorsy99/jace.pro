---
title: "How to resend emails from the email table"
date: 2015-09-26T19:40:01.000Z
authors: ["jonnyseymour"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=12dde6e9dbd0dbc01dcaf3231f9619d9"
---
<p><span style="color: #3334ca;">Let's talk about</span></p><ul><li><span style="color: #3334ca;">Three simple steps to resend emails</span></li><li><span style="color: #3334ca;">If the email has attachments, how to pre-prepare them for re-sending</span></li><li><span style="color: #3334ca;">How to set the email to be ready to be sent</span></li><li><span style="color: #3334ca;">Why do we need to wait until it gets processed</span></li></ul><p></p><h2>Three simple steps to resend email</h2><p></p><p>I'll try to cover some cases of re-sending emails from an instance.</p><p>Most cases, are straight forward. However, if the email has failed or it has attachments, you may want to consider additional steps.</p><p></p><p>There are three(3) simple steps to resend emails:</p><ol><li>If the email has attachments, pre-prepare them for re-sending.</li><li>Set the email to be ready to be sent</li><li>Wait until it gets processed</li></ol><p></p><p><img  alt="Send_mail_2.png" class="image-10 jive-image" height="99" src="fb92b002db589304b322f4621f961995.iix" style="width: 99px; height: 99px; display: block; margin-left: auto; margin-right: auto;" width="99"/></p><p></p><h3>Step 1. If the email has attachments, pre-prepare them for re-sending.</h3><h3></h3><p>If the email has attachments and it has failed (e.g. IO Message Error), please prepare them for re-sending.</p><p>If it does not have attachments, just go to the next step (2).</p><ol style="list-style-type: decimal;"><li>Open each email with attachment:<ol style="list-style-type: decimal;"><li>Save all the attachments from the email.</li><li>Delete all the attachments from the email itself.</li><li>Save the email record.</li><li>Add all the attachments extracted previously (on step 2).</li><li>Save the record.</li></ol></li></ol><p></p><p>NOTE: Exporting the XML record and re-importing back does not necessarily work.</p><h4></h4><h4><strong><strong>Example to show how to pre-prepare email with attachments for re-sending</strong></strong></h4><p></p><p>Open the email, and then go to "manage attachments".</p><p><img   alt="2015-09-25_1513.png" class="image-2 jive-image" src="a9551446db5817041dcaf3231f961924.iix" style="height: 117px; width: 620px;"/></p><p>Then save all the attachments:</p><p><img   alt="2015-09-25_1521.png" class="image-3 jive-image" src="f4357bb9db905704ed6af3231f96197c.iix" style="height: 553px; width: 620px;"/></p><p>Then remove all the attachments, <strong>and save the email.</strong></p><p><img   alt="2015-09-25_1526.png" class="jive-image image-4" src="4de5594edb5813043eb27a9e0f961914.iix" style="height: 303px; width: 620px;"/></p><p>Then re-attach all the emails saved previously.</p><p><img   alt="2015-09-25_1529.png" class="image-5 jive-image" src="43927c8adb5c57049c9ffb651f961988.iix" style="height: 243px; width: 620px;"/></p><p>Then save the email.</p><p></p><h3>Step 2. Set the email to be ready to be sent</h3><h3></h3><p>If the email has errors, fix them. Usual errors are wrong addresses, too many recipients, etc. Validate the error and correct them. Manual fixes sometimes are required.</p><p><span style="color: #3366ff;">Then set the email type to <strong>"send-ready"</strong> and save. Internally, a business rule will run. </span></p><p><span style="color: #3366ff;">Then re-open and set Mailbox = "Outbox" and State = "Ready". Then save.</span></p><p></p><h4>Example of how to set the email to be ready to be sent</h4><h4></h4><p>Set the email Type to "send-ready":</p><p><img   alt="2015-09-25_1555.png" class="image-6 jive-image" src="12d21c8adbd49704ed6af3231f961918.iix" style="height: 233px; width: 620px;"/></p><p>Then open each email and set Mailbox = "Outbox", and State = "Ready".</p><p><img   alt="2015-09-25_1601.png" class="image-7 jive-image" src="86413375db5c1fc068c1fb651f96191f.iix" style="height: 136px; width: 620px;"/></p><p></p><h4>Example script to reprocess emails</h4><p>An alternative example script to reprocess the emails with "send-failed", "send-ignored", and "send-ready" in all states is:</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_macro_code _jivemacro_uid_14442266047281762 jive_text_macro" data-renderedposition="3059.800048828125_8_902_224" jivemacro_uid="_14442266047281762"><p>// Set queryString with the query to perform -- USE CAREFULLY </p><p>queryString = "typeINsend-failed,send-ignored,send-ready^sys_created_onONToday@javascript:gs.daysAgoStart(0)@javascript:gs.daysAgoEnd(0)"</p><p>var gr = new GlideRecord('sys_email');</p><p>gr.addEncodedQuery(queryString);</p><p>gr.query();</p><p></p><p>while (gr.next()) {</p><p>       gr.type = "send-ready"; // this is the first update</p><p>       gr.update();</p><p>       gr.mailbox = "outbox"; // note this happen as a second update</p><p>       gr.state = "ready";</p><p>       gr.update();</p><p>}</p>     </pre><p></p><p></p><p>Additional note: Note there is a "Resend" button if the email Type = "sent".</p><p>This is only useful if the email was sent correctly on the first place.</p><p><img   alt="2015-09-25_1605.png" class="jive-image image-8" src="bf1ed506db54d7041dcaf3231f96197d.iix" style="height: 22px; width: 620px;"/></p><p><img   alt="2015-09-25_1606.png" class="image-9 jive-image" src="87e8348adbd89344e9737a9e0f96191d.iix" style="height: 96px; width: 620px;"/></p><p></p><p></p><h3>Step 3. Wait until it gets processed</h3><p></p><p>Then if you have enabled the outbound email services, they will be resend on the next cycle.</p><p>This is usually 30-sec to 1 minute.</p><p></p><p>Hopefully they will be sent without problems.</p><p></p><h2>Conclusion</h2><p>Re-sending emails require three steps. If the email has attachments, pre-prepare the attachments for re-sending, then set the email to be ready to be sent and finally wait until it gets processed</p><h2></h2><h2>Review what have your learn</h2><p></p><p>After reading this blog you will know:</p><ul><li>How to re-add attachement to emails</li><li>How to set an email to be ready to deliver</li><li>Where is the 'Resend' button on emails</li></ul><p></p><p>More information can be found here:</p><ul><li><p><a title="i.service-now.com/kb_view.do?sysparm_article=KB0540674" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0540674">Email Resources Page (KB0540674)</a></p></li><li><p><a __default_attr="166978" __jive_macro_name="thread" class="jive_macro_thread jive_macro" data-orig-content="Easy way to re-send a mail from SNOW?" data-renderedposition="4044.85009765625_38_274_17" href="/community?id=community_question&sys_id=7c6cc3a5db9cdbc01dcaf3231f961900" modifiedtitle="true" title="Easy way to re-send a mail from SNOW?">Easy way to re-send a mail from SNOW?</a></p></li><li><p><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=bc7c22e1dbd0dbc01dcaf3231f961996">Incoming email classified as reply to 'null' via watermark</a></p></li><li><p><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=3a8c2ae1dbd0dbc01dcaf3231f9619fc">Two watermarks in incoming Email messages</a></p></li><li><p><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/reference-pages/reference/r_AdditionalProperties.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/reference-pages/reference/r_AdditionalProperties.html">Docs: Additional email properties</a></p></li><li><p><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/reference-pages/reference/r_AvailableSystemProperties.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/reference-pages/reference/r_AvailableSystemProperties.html">Docs: Available system properties</a></p></li><li><p><a title="ocs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/wizards/task/t_CreateTheEmailNotification.html" href="https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/administer/wizards/task/t_CreateTheEmailNotification.html">Docs: Create an email notification</a></p></li><li><p><a title="i.service-now.com/kb_view.do?sysparm_article=KB0547784" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0547784">Troubleshooting Outbound Email (KB0521382)</a></p></li><li><p><a title="i.service-now.com/kb_view.do?sysparm_article=KB0547784" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0547784">Troubleshooting stuck event process (KB0547784)</a></p></li><li><p><a title="i.service-now.com/kb_view.do?sysparm_article=KB0528669" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0528669">Verifying the recipient has an email address (KB0528669)</a></p></li><li><p><a title="i.service-now.com/kb_view.do?sysparm_article=KB0528671" href="https://hi.service-now.com/kb_view.do?sysparm_article=KB0528671">Verifying the recipient's email address is properly formatted (KB0528671)</a></p></li><li><p><a title="" _jive_internal="true" href="/community?id=community_blog&sys_id=932e6a6ddbd0dbc01dcaf3231f961953">Speed up your email delivery by validating recipients</a></p></li><li><p><a href="https://html-online.com/search.jspa?q=jonnyseymour&amp;type=post" title="https://community.servicenow.com/search.jspa?q=jonnyseymour&amp;type=post">My other blogs</a></p></li></ul><p></p><p></p><p>Note: Tested in Fuji, with Chrome</p>