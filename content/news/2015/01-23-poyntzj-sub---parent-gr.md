---
title: "Sub  Parent groups and adding members to parent group"
date: 2015-01-22T22:00:50.000Z
authors: ["poyntzj"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=df3e62addbd0dbc01dcaf3231f96194d"
---
<p>We have 2 distinct domains in our environment.   An internal one and an external one.</p><p>Both are used for ESS users, but also our process users and our 3rd party partners.</p><p>Occasionally, some of our 3rd party partners use our Servicenow for working on tickets and need tickets assigning to them.</p><p></p><p>All our users and groups are imported on a regular basis.   Part of the group process removes all the group members and then readds the members as they are at the time of import.</p><p></p><p>When we import our users or groups from the EXT domain, we prefix with either <strong>EXT\</strong> <em>(users)</em> or just <strong>EXT</strong> <em>(groups)</em>   for easy identification</p><p>Until now, all the EXT- Groups have been linked to an internal group by using the Parent feature on the Group record</p><p><em>We decided to do this as it is easier for most engineers to see one group that may cover SQL or WEB instead of an internal and external one.</em></p><p></p><p></p><p><img  alt="" class="image-0 jiveImage" src="13a4a7b9db941704ed6af3231f9619ad.iix" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p></p><p>When assigning a ticket to the group, we have to Expand the parent group and then choose the child group.</p><p><img alt="" class="image-0 jiveImage" src="data:image/png;base64,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" style="max-width: 1200px; max-height: 900px;"/></p><p></p><p>From there, the group manger(s) or assigners can assign a ticket or the engineer can assign it to themselves.</p><p>No great issues, though a little cumbersome as it is not as easy as typing in the group name and looking up.</p><p></p><p>A new group coming on board also has internal and external users, but they wanted all the users to appear in a single group.</p><p>Due to our imports and the clearing of groups, it is not straight forward, and security etc prevents these users from having an internal user account.</p><p></p><p>I therefore decided to add a new onAfter script to the transform maps for internal groups.   After processing the target group and the target groups' members, it looks at the groups table for any child groups.   If it finds any child groups, it will then add the child groups members to the target groups member list.</p><p>This satisifes the request from this group and to be honest, makes it a little easier ot assign tickets between teams</p><p></p><p>the onAfter script is as follows.</p><p></p><pre __default_attr="javascript" __jive_macro_name="code" class="jive_text_macro jive_macro_code _jivemacro_uid_14219413885356636" jivemacro_uid="_14219413885356636" modifiedtitle="true">
<p>(function(){</p>
<p>       var recID = target.getValue('sys_id');</p>
<p>       var strGrpName = target.getValue('name');</p>
<p>       //gs.log('Processing : ' + recID + ' : ' + strGrpName);</p>
<p></p>
<p>       // Query the groups and get any groups where the parent is the current group</p>
<p>       var suggr = new GlideRecord('sys_user_group');</p>
<p>       suggr.addQuery('parent',recID);</p>
<p>       suggr.query();</p>
<p>       while (suggr.next())</p>
<p>       {</p>
<p>               //gs.log('Sub member of ' + strGrpName + ' is : ' + suggr.name);</p>
<p></p>
<p>               // now we have groups where the parent is our current group, lets</p>
<p>               // get some users info</p>
<p>               var sugmgr = new GlideRecord('sys_user_grmember');</p>
<p>               sugmgr.addQuery('group',suggr.sys_id);</p>
<p>               sugmgr.query();</p>
<p>               while (sugmgr.next())</p>
<p>               {</p>
<p>                       //gs.log('Member of ' + suggr.name + ' is : ' + sugmgr.user.getDisplayValue());</p>
<p>               </p>
<p></p>
<p>                       // now to see if we have any records for the user in the parent group</p>
<p>                       var sugmgr2 = new GlideRecord('sys_user_grmember');</p>
<p>                       sugmgr2.addQuery('group', recID);</p>
<p>                       sugmgr2.addQuery('user',sugmgr.user);</p>
<p>                       sugmgr2.query();</p>
<p>                       if (!sugmgr2.next())</p>
<p>                       {</p>
<p>                               gs.log('Adding : ' + sugmgr.user.getDisplayValue() + ' to group : ' + strGrpName);</p>
<p>                               sugmgr2.initalize();</p>
<p>                               sugmgr2.group = recID;</p>
<p>                               sugmgr2.user = sugmgr.user;</p>
<p>                               sugmgr2.insert();</p>
<p>                       }</p>
<p>               }</p>
<p>       }</p>
<p>               </p>
<p>})();</p>
</pre>