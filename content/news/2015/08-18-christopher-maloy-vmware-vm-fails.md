---
title: "VMWare VM Fails To Add To Domain Using Guest Customization Rules"
date: 2015-08-17T20:22:23.000Z
authors: ["Christopher.Maloy"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=96edaee9dbd0dbc01dcaf3231f96193f"
---
<p>This blog post will be short. </p><p></p><p>Problem:</p><p>You create a new VM in VMWare and you have Guest Customization Rules created in ServiceNow to add this newly minted VM to the domain and fails to do so.   </p><p></p><p>Answer:</p><p>After some research I found this article that tells you why this is the case:</p><p>Symptoms:</p><ul><li>When performing guest customization via the vCenter Server, the Windows Guest Operating Systems (Guest OS) fail to join Active Directory. The affected Guest OS-s are as follows, but not limited to:<ul><li>Windows Server 2008</li><li>Windows Server 2008 R2</li><li>Windows Server 2003</li><li>Windows Server 2003 R2</li><li>Windows 7</li><li>Windows 8/8.1</li></ul></li><li>When deploying a virtual machine from a Windows template and using a guest customization, it fails to join to the Active Directory (AD) domain</li></ul><p></p><p>Resolution:</p><p style="font-family: Arial, Helvetica, sans-serif, 'Bitstream Vera Sans'; font-size: 12px; color: #666666;">Guest customization of a Windows Server 2008/Windows 7 operating systems and later uses the sysprep functionality built into the Windows operating system. Using a NETBIOS name when joining a Windows Server 2008/Windows 7 to an AD domain is no longer supported.</p><p></p><p style="font-family: Arial, Helvetica, sans-serif, 'Bitstream Vera Sans'; font-size: 12px; color: #666666;">If the NETBIOS name of the AD domain is specified in guest customization, the virtual machine does not join the AD domain. </p><p></p><p style="font-family: Arial, Helvetica, sans-serif, 'Bitstream Vera Sans'; font-size: 12px; color: #666666;">To resolve this issue, use the fully qualified domain name (FQDN) of the AD domain in guest customization and switch the domain login from down-level style log-on (<span style="font-size: 14px !important; font-family: 'Courier New';">domain\user</span>) to user principal name (<span style="font-size: 14px !important; font-family: 'Courier New';">user@FQDN_of_domain.local</span>).</p><p></p><p><a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1012314" title="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1012314">VMware KB: Windows guest customization fails to join deployed virtual machine to Active Directory domain</a></p><p></p><p>In ServiceNow the configuration page should look like this:</p><p></p><p><img  alt="ServiceNow.png" class="image-0 jive-image" src="dc9fef31db1c1fc068c1fb651f9619b2.iix" style="height: 269px; width: 620px;"/></p><p>Hope this helps.   </p>