---
title: "ECC Queue Tales Good Credentials Gone Bad"
date: 2008-12-05T20:21:12.000Z
authors: ["SlightlyLoony"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=8d9daa69dbd0dbc01dcaf3231f961962"
---
<p><img  alt="" class="jive-image" src="9432484adb98d3049c9ffb651f9619cd.iix" style="width: auto; height: 98px;" />Yesterday I was on a call with a customer who had a tough problem: Discovery was working fine except for network gear, and even with heroic efforts they'd been unable to find the problem. They'd identified the bit that was failing: the PortScanner probe was reporting that the network gear was not responding to SNMP, and therefore the SNMP probes were never getting fired. <br /><br />Now SNMP — as its name implies — is a pretty darned simple protocol. There's not much to go wrong beyond credentials (the community string) and some kind of access restriction.<!--break--> The customer had already eliminated access restriction as a problem: they tried running another SNMP tool from the same computer the MID server was running on, and that tool worked just fine. That left credentials as a source of trouble.<br /><br /><img  alt="" class="jive-image" src="84e0a08edb5057049c9ffb651f9619f1.iix" style="width: auto; height: 35px;" />So we looked at the credentials (<b>Discovery â†’ Credentials</b>) and saw something like the screenshot at right. Looks fine: two SNMP credentials, marked "active". And the customer had re-entered the credentials several times, very carefully, to eliminate any possibility of fat-fingering. The credentials looked fine — so what the heck was going on here?<br /><br />At this point we broke out the big gun: we installed <a title="w.wireshark.org/" href="http://www.wireshark.org/">WireShark</a> (an excellent free open source <a title="mpnetworking.about.com/od/networksecurityprivacy/g/bldef_sniffer.htm" href="http://compnetworking.about.com/od/networksecurityprivacy/g/bldef_sniffer.htm">network sniffer</a>) on the MID server, and watched what was actually happening on the network as Discovery tried to explore a piece of network gear. We also watched the other SNMP tool (the one that worked!) to see what it was doing differently.<br /><br />Well, the other SNMP tool was behaving differently all right: it was using the correct community string and Discovery was trying only "public" (the default community string that it <i>always</i> tries). Somehow Discovery was managing to ignore the credentials so carefully entered. But why? <br /><br /><img  alt="" class="jive-image" src="c3404442db941304b322f4621f9619ba.iix" style="width: auto; height: 36px;" />At this point we went back to the <i>Credentials</i> table and drilled into one of them (see screenshot at right) — and then the problem was obvious! For reasons unknown, someone had configured the credentials to apply to specific MID servers, instead of the default of <i>all</i> MID servers. No problem so far, but…then they neglected to specify any MID servers! So the credential was there, it was active, but it applied to exactly zero MID servers.<br /><br />It was a good credential gone bad…<br /><br />We set it <i>All MID Servers</i> and ran Discovery again, and everything worked just fine.</p>