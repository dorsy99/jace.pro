---
title: "A Useful Trick"
date: 2010-06-30T20:00:48.000Z
authors: ["SlightlyLoony"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=b5cc2265dbd0dbc01dcaf3231f9619c3"
---
<p><img  alt="" class="jive-image" src="75467046db989304b322f4621f961983.iix" style="width: auto; height: 200px;" />Sometimes when you're writing a script, you need to query one table but get results based on fields in another, related table. For example, you might want to query for NICs on Windows servers. The NIC table itself doesn't know what kind of CI it's related to â€” that information is in the <i>related</i> CI. You can do this with filters, but how do you do it in script?<br /><!--break--><br />Here's how (using the example above):<br /><pre style="margin-left:20px;line-height:1;"><br />var gr = new GlideRecord('cmdb_ci_network_adapter');<br />gr.addQuery('cmdb_ci.sys_class_name', 'cmdb_ci_windows_server');<br />gr.query();<br /></pre><br /><i>Presto!</i> At the end of that simple little script, you've got a list of all the NICs on Windows servers.<br /><br />The trick lies in the first argument to the <span style="font-family:Courier;font-weight:bold;">addQuery()</span> method. Notice the dot? That tells you that the query is going to be "dot-walking". In this case, the <span style="font-family:Courier;font-weight:bold;">cmdb_ci</span> field in the <span style="font-family:Courier;font-weight:bold;">cmdb_ci_network_adapter</span> table is a reference field, referring to the CI that a NIC is related to. The <span style="font-family:Courier;font-weight:bold;">sys_class_name</span> field of the <span style="font-family:Courier;font-weight:bold;">cmdb_ci</span> table specifies what <i>kind</i> of CI it is, and <span style="font-family:Courier;font-weight:bold;">cmdb_ci_windows_server</span> is the kind we're looking for.<br /><br />Easy, wasn't it?</p>