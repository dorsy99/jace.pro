---
title: "Tips and Tricks Accepting Different Argument Types"
date: 2010-08-11T19:17:00.000Z
authors: ["SlightlyLoony"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=aadc2a65dbd0dbc01dcaf3231f96196c"
---
<p><img  alt="" class="jive-image" src="c746b00adb9097041dcaf3231f96196c.iix" style="width: auto; height: 113px;" />Have you ever written a handy-dandy little script function, and then wished you could have it accept different kinds of arguments? For instance, perhaps you wrote a function that took a list of people's first and last names (in an array of two-element arrays) that figured out how many characters were in the longest combinations. Cool! Then you realize that you could make that function even more generally useful if it could <i>also</i> accept a GlideRecord with first and last name fields. But is it really possible to make a single function that could accept either form of argument?<br /><br />Why, yes it is!<br /><!--break--><br />Consider this test code:<br /><pre style="margin-left:20px;line-height:1;"><br />gs.log('Method 1: string argument');<br />var nicGR = new GlideRecord('cmdb_ci_network_adapter');<br />nicGR.addQuery('ip_address', '10.10.10.135');<br />nicGR.query();<br />if (nicGR.next()) {<br />   var cis = getCIs(nicGR.cmdb_ci);<br />   while (cis.next())<br />      gs.log('   ' + cis.name);<br />}<br /><br />gs.log('Method 2: GlideRecord argument');<br />var nicGR = new GlideRecord('cmdb_ci_network_adapter');<br />nicGR.addQuery('ip_address', '10.10.10.135');<br />nicGR.query();<br />var cis = getCIs(nicGR, 'cmdb_ci');<br />while (cis.next())<br />   gs.log('   ' + cis.name);<br /><br />gs.log('Method 3: Array of sys_ids argument');<br />var sysIDs = [];<br />sysIDs.push('d48740560a0a3c19009fcd0945f91624');<br />var cis = getCIs(sysIDs);<br />while (cis.next())<br />   gs.log('   ' + cis.name);<br /><br />gs.log('Method 4: function argument');<br />var cis = getCIs(getNICs, 'cmdb_ci');<br />while (cis.next())<br />   gs.log('   ' + cis.name);<br /><br />function getNICs() {<br />   var nicGR = new GlideRecord('cmdb_ci_network_adapter');<br />   nicGR.addQuery('ip_address', '10.10.10.135');<br />   nicGR.query();<br />   return nicGR;<br />}<br /></pre><br />When I run it on my instance, it produces:<br /><pre style="margin-left:20px;line-height:1;"><br />Method 1: string argument<br />    sanops05<br />Method 2: GlideRecord argument<br />    sanops05<br />Method 3: Array of sys_ids argument<br />    sanops05<br />Method 4: function argument<br />    sanops05<br /></pre><br />In each of the four pieces of the test code, the <i>getCIs()</i> method is called — each time with a different type of first argument. Yet each time it produces the same result. Somehow this function knew how to behave no matter what type of argument it got. Here's how it knew:<br /><pre style="margin-left:20px;line-height:1;"><br />function getCIs(source, field) {<br />   // get ourselves a list of CI sys_id values...<br />   if (typeof source == 'function')<br />      source = source();<br />   var sysIDs = [];<br />   if (source instanceof GlideRecord) {<br />      if (!field)<br />         return null;<br /><br />      while (source.next())<br />         sysIDs.push('' + source.getValue(field));<br />   } else if (source instanceof Array)<br />      sysIDs = source;<br />   else<br />      sysIDs.push('' + source);<br /><br />   // now we'll do the actual work, with an array of sys_ids...<br />   var gr = new GlideRecord('cmdb_ci');<br />   gr.addQuery('sys_id', sysIDs);<br />   gr.query();<br />   return gr;<br />}</pre><br /><br />The first part of the function figures out what kind of argument it got, and then does what it needs to do to turn that argument into an array of sys_ids. The second part simply takes that list of sys_ids and queries for them. So all the magic is happening in the first part.<br /><br />In that code, the first thing it does is check to see if the <i>source</i> argument is a function. If so, it executes the function and replaces <i>source</i> with the result. In other words, it's assuming that if someone passed it a function, they must want us to get our source from it. The next bit figures out whether <i>source</i> is a GlideRecord (in which case we iterate through it, collecting sys_ids from the specified field), an Array (in which case we assume we got a list of sys_ids), or something else (in which case we assume we got a single sys_id, so we stuff it into an array).<br /><br />The way we figure out what kind of argument we got is by careful use of the <a href="https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Operators/Special_Operators/typeof_Operator"><i>typeof</i></a> and <a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Special_Operators/instanceof_Operator"><i>instanceof</i></a> operators. Both are standard features of JavaScript, documented at the preceding links. Be sure to read that documentation carefully — these operators may not work exactly as you'd expect!</p>