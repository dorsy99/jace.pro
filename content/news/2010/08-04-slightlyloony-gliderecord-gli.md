---
title: "GlideRecord Glimmerings This or That"
date: 2010-08-03T18:38:50.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=bf8d2a69dbd0dbc01dcaf3231f9619e8"
---
<p>[asset|aid=340|format=Small|formatter=asset_lightbox|title=nerdette.jpg|width=150|height=113|align=right]Suppose your boss wanted to automatically scan every week to look for any "dog" computers you might have. For the moment, a dog computer is defined as any computer with either less than 1 gigabyte of RAM <i>or</i> a CPU with a clock rate lower than one gigahertz. How would you do this?<br /><br />The obvious approach is to make a scheduled job that runs the query and then perhaps sends the results directly to your boss in an email. For the purposes of this post, I'm going to ignore the details of how to make a scheduled job or to have it send an email — here I want to talk about the script that would do the work. How would I write a function that returns this information?<br /><!--break--><br />If you're familiar with coding GlideRecord queries, the tricky bit here is the "or" part. If you coded it like this...<br /><pre style="clear: both;margin-left:20px;line-height:1;"><br />var answer = lookForDogs();<br />gs.log('\n' + answer);<br /><br />function lookForDogs() {<br />   var MIN_RAM       = 1000;  // in megabytes<br />   var MIN_CPU_SPEED = 1000;  // in MHz<br /><br />   var gr = new GlideRecord('cmdb_ci_computer');<br /><br />   gr.addQuery ('ram',       '&lt;', MIN_RAM      );<br />   gr.addQuery ('cpu_speed', '&lt;', MIN_CPU_SPEED);<br /><br />   gr.query();<br />   var answer = '';<br />   while (gr.next())<br />      answer += 'Dog: ' + gr.name + '(' + gr.ram + ' mb RAM, ' + gr.cpu_speed + ' MHz CPU speed)' + '\n';<br />   return answer;<br />}<br /></pre><br />...you'd get a (hopefully very short!) list of the really, really doggy computers — those that have <i>both</i> less than 1 gigabyte of RAM <i>and</i> CPUs with clock rates less than 1 gigahertz. So how do you get the computers with <i>either</i> condition being met? You do it like this:<br /><pre style="clear: both;margin-left:20px;line-height:1;"><br />var answer = lookForDogs();<br />gs.log('\n' + answer);<br /><br />function lookForDogs() {<br />   var MIN_RAM       = 1000;  // in megabytes<br />   var MIN_CPU_SPEED = 1000;  // in MHz<br /><br />   var gr = new GlideRecord('cmdb_ci_computer');<br /><br />   var cond = gr.addQuery   ('ram',       '&lt;', MIN_RAM      );<br />   cond.addOrCondition      ('cpu_speed', '&lt;', MIN_CPU_SPEED);<br /><br />   gr.query();<br />   var answer = '';<br />   while (gr.next())<br />      answer += 'Dog: ' + gr.name + '(' + gr.ram + ' mb RAM, ' + gr.cpu_speed + ' MHz CPU speed)' + '\n';<br />   return answer;<br />}<br /></pre><br />The tricky little bit is in the middle of the function. This time when we add the query condition for the RAM, we save the result (in the previous example we paid no attention to it). What's in that result is a <i>QueryCondition</i> object, which holds the result of the addQuery() invocation. These are always created, but most of the time you don't need them. This time, however, we need to make use of a feature of that QueryCondition object: the addOrCondition() method you see invoked on the next line in the script. You can specify the "or" in exactly the same ways that you can specify the usual "and" conditions.<br /><br />One additional little detail: the addOrCondtion() method <i>also</i> returns a QueryCondition object. This provides you with the means to specify an arbitrarily complex set of query conditions, with any combination of "and" and "or" conditions, nested any way you'd like them to be. This isn't a capability you'll need often, but when you <i>do</i> need it, it's there!</p>