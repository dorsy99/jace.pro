---
title: "JSUtil  A Script Include port of Underscorejs"
date: 2013-07-04T22:04:18.000Z
authors: ["adiddigi"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=b92e666ddbd0dbc01dcaf3231f9619ff"
---
<p>Remember <a title="ki.servicenow.com/index.php?title=JSUtil" href="http://wiki.servicenow.com/index.php?title=JSUtil">JSUtil</a>? Its a cool script include to do a lot of Javascript! <br /><br />To scratch an itch, and to do some more, I wrote(ported) another Script Include called JSUtil2, which is kinda port of Underscore.js.<br /><br />Hope you will find it useful: <br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />/*<br /> * JSUtil already has some utility functions, Some more utility functions.<br /> * Written by diddigiabhi@gmail.com<br /> * Re-written for Service Now from underscore.js: http://underscorejs.org/<br /> *<br /> */<br /><br /><br /> var JSUtil2 = Class.create();<br /><br /> //Setting the version.<br /> JSUtil2.version = 0.1;<br /> //Collection functions start here<br /><br /><br />//Checks if an object is empty<br />//String,Arrays,Objects can be passed.<br />JSUtil2.isEmpty = function(obj){<br />   if(typeof obj == 'string' || obj == 'array') return obj.length === 0;<br />   for (var key in obj) if (! JSUtil2.has(obj, key)) return false ;<br />      return true;<br />  <br />};<br /><br />//Checks if a key belongs to an Object<br />//JSUtil has a method `contains`, you can either use that or this.<br />JSUtil2.has = function(obj,key){<br /><br /><br />   return hasOwnProperty.call(obj, key);<br />  <br />};<br /><br /><br />// One of the important functions,iterates over a given object as<br />// per a given iterator.We don't use context much in Service Now, But if<br />// you want to, pass it as 3rd parameter.<br />JSUtil2.each = function(obj,iterator,context){<br /><br />   if(JSUtil.nil(obj)) {gs.log("JSUtil2 Error: Object not defined.");return;}<br />   if (typeof obj.length == 'number' ) {<br />      for (var i = 0, l = obj.length; i &lt; l; i++) {<br /><br />         if (iterator.call(context, obj&lt;i&gt;, i, obj) === {}) return;<br />      }<br />   } else {<br />      for (var key in obj) {<br />         if (JSUtil2.has(obj, key)) {<br /><br />            if (iterator.call(context, obj[key], key, obj) === {}) return;<br />         }<br />      }<br />   }<br />};<br /><br />//produces a new array of values as per the iterator function defined.<br />JSUtil2.map = function(obj, iterator, context){<br /><br />   var results = [];<br />  <br />   JSUtil2.each(obj, function(value,key,list){     <br />      results.push( iterator.call(context, value, key, list));  <br />   });<br />  <br />  <br />   return results;<br />  <br />};<br /><br /><br /><br />// `properties` is an array of key:value pairs.  Find checks if the given Array of objects<br />// has those properties, and outputs those objects as array of objects.<br />JSUtil2.find = function(obj,properties){<br /><br />   //Properties is a JSON Object<br />  <br />   if(typeof properties != 'object') {<br />      gs.log("JSUtil2 Error: Properties are not Object.");<br />      return false;<br />   }<br />  <br />   for(var i in properties){<br /><br />//First check if the key is present in the object, if yes, then check if has the value that is specified.<br />if(JSUtil2.has(obj,i) &amp;amp;&amp;amp; obj&lt;i&gt; == properties&lt;i&gt;){<br />         //do nothing<br />        <br />         continue;<br />        <br />        <br />      }<br />      else{<br />         return false;<br />      }<br />     <br />     <br />     <br />   }<br />   return true;<br />  <br />  <br />};<br /><br /><br />//Looks through all the values of the object and return those<br />//which satisfy the iterator defined.<br />JSUtil2.filter  = function(obj, iterator, context){<br /><br />   var retArr = [];<br />   if(JSUtil.nil(obj)) return;<br />   JSUtil2.each(obj, function(value, index , list){<br /><br />      if(iterator.call(context, value, index, list)) {<br />         retArr.push(value);}<br /><br />      });<br />   JSUtil.logObject(retArr);<br />   return retArr;<br />  <br />  <br />};<br /><br /><br />//Underscore.js's implementation of JSUtil2's find.<br />JSUtil2.where = function(obj, properties){<br /><br />   if(JSUtil2.isEmpty(obj)) return [];<br /><br />   return JSUtil2.filter(obj, function(value) {<br />      for (var key in properties) {<br /><br />         if (properties[key] !== value[key]){return false;}<br />      }<br />      return true;<br />   });<br />  <br />};<br /><br /><br />//extracts list of property values.<br />JSUtil2.pluck = function(obj, key){<br /><br />   return JSUtil2.map(obj, function(value){   return value[key];   });<br />  <br />  <br />};<br /><br /><br />// Array functions start here<br /><br />//Checks if the passed object is an array<br />JSUtil2.checkArray = function(arr){<br />   return JSUtil.notNil(arr) &amp;amp;&amp;amp; typeof arr == 'object' &amp;amp;&amp;amp; typeof (arr.length) == 'number';<br />};<br /><br /><br />//If n is specified, it returns first n items in the array.<br />JSUtil2.first  = function(arr,n){<br />   if(! JSUtil2.checkArray(arr)) return '-infinity' ;<br /><br />   if(arr.length == 0) return '-infinity';<br /><br />   return (n != null)? arr.slice( 0, n) : arr[0];<br />  <br />  <br />};<br /><br /><br />//return the last item if n is not specified, else retuns n -last characters.<br />JSUtil2.last = function(arr,n){<br /><br />   if(! JSUtil2.checkArray(arr)) return '-infinity' ;<br /><br />   if(arr.length == 0) return '-infinity';<br /><br />   return (n != null)? arr.slice((arr.length-n), arr.length) : arr[arr.length-1];<br />  <br />};<br /><br />//Removes all the 'falsy' values returned. false,0,null,'', nan and undefined are<br />//falsy values in Javascript.<br />JSUtil2.compact = function(arg){<br /><br /><br />   return JSUtil2.filter(arg, function(value){<br /><br />      return value;<br />   } );<br />  <br />};<br /><br /></pre><br /><br /><br />The documentation(for a couple of methods) too is on Github: https://github.com/abhididdigi/JSUtil2/blob/master/docs.md<br /><br />Some more methods on the way.</p>