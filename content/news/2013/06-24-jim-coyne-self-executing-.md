---
title: "SelfExecuting Anonymous Functions"
date: 2013-06-23T05:54:46.000Z
authors: ["Jim Coyne"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=b4fca2a5dbd0dbc01dcaf3231f961902"
---
<p>This is something I've been wanting to share for a while now and figured it was finally time to do so. I won't explain too much about how they actually work, as Mark Dalgleish has a great article that does just that - http://markdalgleish.com/2011/03/self-executing-anonymous-functions. I will, however, explain why and where I use them within the ServiceNow platform.<br /><br />By now, I think most ServiceNow developers know that any server-side code should be wrapped within a function in order to protect variables from being unexpectedly modified in some other bits of code - http://wiki.servicenow.com/index.php?title=Business_Rules#Business_Rule_Variables_are_Global. Of course when I learned about that, I started wrapping my code within functions in order to protect it as well. Problem is, I started wrapping all my code in functions called "runScript()" or something similar. But, I started thinking, am I really protecting myself, or am I opening myself up for more problems if the wrong "runScript()" function was called. Everything seemed to be running OK, but I could not be sure.<br /><br />I had started to think I should name the functions based on the records' sys_id in it to ensure uniqueness. Maybe I was getting paranoid, but I just wanted to make sure I was not introducing a different problem by wrapping the code in functions with the same name. Then I ran across Mark's article one day and knew that I finally found the proper solution. From that day on, I started using Self-Executing Anonymous Functions wherever I could - in Business Rules, Workflow scripts, server UI Actions (as well as mixed Client/Server UI Actions), Access Control rules, Relationships, etc.... Basically anywhere a script runs on the server. You can see a couple of examples in some answers I've provided to other user's issues:<br />Business Rule - <a title="57580" href="/community?id=community_question&sys_id=d94ffa69db58dbc01dcaf3231f96192d">Preventing Duplicate Data being created by Update or Insert</a><br />Relationship - <a title="57746" href="/community?id=community_question&sys_id=86dfc3a5dbdcdbc01dcaf3231f9619b8">See related child incidents in each child incident</a><br /><br />So basically, instead of defining a Business Rule like:<pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />myNewScript123();<br />function myNewScript123() {<br />   current.field_name = some value;<br />}<br /></pre><br />you can now write it as:<pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />(function(){<br />   current.field_name = some value;<br />})();</pre><br /><br />It does not save you a lot of typing, but you do not have to worry about coming up with a new function name each time. <br /><br />I had been reluctant to use them in my solutions to people's question before actually writing about it so as to not cause any confusion. I just wasn't sure, but am confident now in their use, and so will use them whenever appropriate from now on. For instance, my "Applications with Role" article (http://community.servicenow.com/blog/jimcoyne/applications-role) really should have the following code in the "Query with" field:<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />(function(){<br />   current.addQuery('roles', parent.name);<br />})();</pre><br /><br />It's the same code, just wrapped in a Self-Executing Anonymous Function for safety!<br /><br />And with the new code editor in Berlin and above, you can add an Editor Macro that will easily allow you to add the S-EAF syntax to your code by typing "seaf" and then the tab key within a script field - https://wiki.servicenow.com/index.php?title=Using_the_Syntax_Editor#Using_Script_Macros. Just import the attached XML into your instance (remove the "txt" extension).</p>