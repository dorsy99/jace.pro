---
title: "I want badges"
date: 2013-03-21T03:59:55.000Z
link: "https://community.servicenow.com/community?id=community_blog&sys_id=d14ee2addbd0dbc01dcaf3231f9619a8"
---
<p>I like the notification badges that iOS displays on my iPhone's and iPad's applications.<br />I thought I'd recreate the same in ServiceNow. After all ServiceNow is as much capable as iOS...<br />The below UI Page is an attempt to display 'My Work', 'My Groups Work' and 'My Approvals' as a nice badges widget on one's homepage for quasi-realtime tracking of one's tasks.<br /><br /><h2>UI Pages to the rescue</h2><br />I started by creating a UI Page that will host my notification badges.<br /><br /><b>Name:</b> render_gadget_tasks_badges<br /><b>Category:</b> Home Pages<br /><b>HTML:</b> all the Jelly/HTML/Javascript/CSS that constitutes the UI Page is detailed in order below.<br /><br /><h2>Jelly Phase One</h2><br />We ask Jelly to generate in Phase 1 two variables that represent currently logged in user and their groups.<br />Those two variables will be useful in the next phase.<br /><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />&lt;g:evaluate&gt;<br />  var user = gs.getUserID();<br />  user;<br />&lt;/g:evaluate&gt;<br /><br />&lt;g:evaluate&gt;<br />  var groups = gs.getUser().getMyGroups();<br />  groups;<br />&lt;/g:evaluate&gt;<br /></pre><br /><br /><h2>Jelly Phase Two</h2><br />In Jelly's phase two we query the task table for the user's pending work (tasks assigned to them or tasks assigned to their groups or approvals pending).<br /><br /><h3>Tasks assigned to the user</h3><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />&lt;g2:evaluate var="jvar_my_work_count"&gt;<br />  var gr = new GlideRecord("task");<br />  gr.addQuery("active", "true");<br />  gr.addQuery("state", "!=", "-5");<br />  gr.addQuery("assigned_to", "$[user]");<br />  gr.query();<br />  gr.getRowCount();<br /><br />  &lt;j2:set var="jvar_my_work_link" value="task_list.do?sysparm_query=active=true^state!=-5^assigned_to=$[user]^EQ"/&gt;<br />&lt;/g2:evaluate&gt;<br /></pre><br /><br /><h3>Tasks assigned to the user's groups</h3><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />&lt;g2:evaluate var="jvar_my_groups_work_count"&gt;<br />  var temp1 = "$[groups]";<br />  var temp2 = temp1.replace("[", " ");<br />  var temp3 = temp2.replace("]", " ");<br /><br />  var grp = new GlideRecord("task");<br />  grp.addQuery("active", "true");<br />  grp.addQuery("state", "!=", "-5");<br />  grp.addQuery("assigned_to", "");<br />  grp.addQuery("assignment_group", "IN", temp3);<br />  grp.query();<br />  grp.getRowCount();<br /><br />  &lt;j2:set var="jvar_my_groups_work_link" value="task_list.do?sysparm_query=active=true^state!=-5^assigned_to=^assignment_group=javascript:getMyGroups()^EQ"/&gt;<br />&lt;/g2:evaluate&gt;<br /><br /></pre><br /><br /><h3>Pending user approvals</h3><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />&lt;g2:evaluate var="jvar_my_approvals"&gt;<br />  var gra = new GlideRecord("sysapproval_approver");<br />  gra.addQuery("state", "requested");<br />  gra.addQuery("approver", "$[user]");<br />  gra.query();<br />  gra.getRowCount();<br /><br />  &lt;j2:set var="jvar_my_approvals_link" value="sysapproval_approver_list.do?sysparm_query=state=requested^approver=$[user]^EQ"/&gt;<br />&lt;/g2:evaluate&gt;<br /></pre><br /><br /><h2>The HTML squeleton</h2><br />Nothing can get much simpler. A simple unordered list with three items.<br />We can even add a hyperlink to each item which will allow us to click on it and go to the corresponding list.<br /><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />&lt;ul&gt;<br />    &lt;div id="menu"&gt;<br />    &lt;li&gt;&lt;a href="$[jvar_my_work_link]"&gt;My Work&lt;/a&gt;&lt;div id="my_work" class="badge"&gt;$[jvar_my_work_count]&lt;/div&gt;&lt;/li&gt;<br />    &lt;li&gt;&lt;a href="$[jvar_my_groups_work_link]"&gt;My Groups Work&lt;/a&gt;&lt;div id="my_groups_work" class="badge"&gt;$[jvar_my_groups_work_count]&lt;/div&gt;&lt;/li&gt;<br />    &lt;li&gt;&lt;a href="$[jvar_my_approvals_link]"&gt;My Approvals&lt;/a&gt;&lt;div id="my_approvals" class="badge"&gt;$[jvar_my_approvals]&lt;/div&gt;&lt;/li&gt;<br />    &lt;/div&gt;<br />&lt;/ul&gt;<br /></pre><br /><br /><h2>Styling the baby</h2><br />In order to make the widget look like having notification badges we can't escape the power of CSS.<br />I will not go into the details of the CSS styles and will let curious minds reverse engineer them.<br />The most important one is the .badge style that allows us to make extremely rounded rectangles that become circles representing iOS style bades.<br /><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />&lt;style&gt;<br />#menu {<br />    float: left;<br />    list-style-type: none;<br />    margin: 0 25% 30px 25%;<br />    width: auto;<br />    position: relative;<br />}<br /><br />#menu li {<br />    display: inline;<br />    float:left;<br />    position: relative;<br />    text-transform: uppercase;<br />    font: bold 12px Verdana, Arial, Helvetica;<br />    color: #f1f1f1;<br />    border: 1px solid #1240AB;<br />    border-radius: 6px;<br />    background-color: #1240AB;<br />    background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#1240AB), to(#06266F));<br />    background: -webkit-linear-gradient(top, #1240AB, #06266F);<br />    background: -moz-linear-gradient(top, #1240AB, #06266F);<br />    background: -ms-linear-gradient(top, #1240AB, #06266F);<br />    background: -o-linear-gradient(top, #1240AB, #06266F);<br />    box-shadow: 2px 2px 2px 2px #ccc;<br />    margin-top: 25px;<br />    margin-left: 10px;<br />    padding-left: 5px;<br />    padding-top: 2px;<br />}<br /><br />#menu li a {<br />    color: #f1f1f1;<br />    text-decoration: none;<br />}<br /><br />.badge {<br />    background: radial-gradient( 5px -9px, circle, white 5%, red 26px );<br />    background: -moz-radial-gradient( 5px -9px, circle, white 5%, red 26px );<br />    background: -ms-radial-gradient( 5px -9px, circle, white 5%, red 26px );<br />    background: -o-radial-gradient( 5px -9px, circle, white 5%, red 26px );<br />    background: -webkit-radial-gradient( 5px -9px, circle, white 5%, red 26px );<br />    background-color: red;<br />    border: 2px solid white;<br />    border-radius: 12px;<br />    box-shadow: 1px 1px 1px black;<br />    color: white;<br />    font: bold 15px/13px Helvetica, Verdana, Tahoma;<br />    height: 16px;<br />    padding: 4px 3px 0 3px;<br />    text-align: center;<br />    min-width: 14px;<br />    float: right;<br />    margin: 6px;<br />    position: relative;<br />    top: 20px;<br />}<br />&lt;/style&gt;<br /></pre><br /><br />At this stage you can click on the 'Try It' button to preview the how the UI Page looks like.<br /><br /><h2>Creating the widget</h2><br />In order to be able to add this UI Page on a home page, we need to wrap it in a widget.<br />Create a new UI Widget:<br /><br /><b>Name:</b> Tasks Badges<br /><b>Renderer Type:</b> Javascript<br /><b>Script:</b> <br /><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />function sections() {<br />  return {<br />    'Widget' : { 'type' : 'tasks_badges' }<br />  };<br />}<br /><br />function render() {<br />  var type = renderer.getPreferences().get("type");<br />  var gf = new GlideForm(renderer.getGC(), "render_gadget_" + type, 0);<br />  gf.setDirect(true);<br />  gf.setRenderProperties(renderer.getRenderProperties());<br />  return gf.getRenderedPage();<br />}<br /><br />function getEditLink() {<br />  return "sys_ui_page.do?sysparm_query=name=render_gadget_" + renderer.getPreferences().get("type");<br />}<br /></pre><br /><br /><h2>Adding the widget to a home page</h2><br />The above widget can then be added to a home page as per the below screenshot:<br /><br /><img  alt="" class="jive-image" src="c0802ccadbdc9fc03eb27a9e0f961985.iix" style="width: 613px; height: auto;" /><br /><br /><h2>The final result</h2><br />The screenshot below shows what the final result looks like on a user homepage. Setting a 5 minute refresh cycle on the homepage guarantees a quasi-realtime refresh of the widget.<br /><br /><img  alt="" class="jive-image" src="7ba24406dbd8d3041dcaf3231f961900.iix" style="width: 1088px; height: auto;" /><br /><br />I hope this post proves useful to you.<br /><br /><font color="gray"><em>Disclaimer: The views expressed in this blog's posts do not reflect the positions or opinions of ServiceNow. They should be understood as the personal opinions of the author. No information on this blog will be understood as official. For more authoritative information, please refer to the ServiceNow Wiki.</em></font></p>