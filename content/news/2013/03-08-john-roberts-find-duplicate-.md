---
title: "Find duplicate user email or anything else"
date: 2013-03-08T04:34:25.000Z
authors: ["john.roberts"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=4a5da629dbd0dbc01dcaf3231f96192e"
---
<p>Just saw this gem on our internal Live Feed from our resident wizard Mr. Goodliffe. The question on Live was how can I easily locate users with duplicate email addresses. I've always used a GlideAggregate script running in background scripts which really limits it to admins and can't view the results in a list.<br /><!--break--><br />Solution:<br />Create a client callable script include to perform a query for duplicate records, then call that script from a list filter.<br /><a title="ki.servicenow.com/index.php?title=GlideAggregate" href="http://wiki.servicenow.com/index.php?title=GlideAggregate">More info on GlideAggregate</a><br /><br />* Script Include:<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />/*<br />Client callable script include used for filtering sys_user lists<br />to identify duplication email users<br />name: duplicateEmail<br />active: true<br />client callabe: true<br />*/<br />function duplicateEmail() {<br />    var xx = new GlideAggregate('sys_user');<br />    xx.addAggregate('COUNT', 'email');<br />    xx.addHaving('COUNT', 'email', '&gt;', '1');<br />    xx.query();<br />    var answer = new Array();<br />    while (xx.next()) {<br />        answer.push(xx.getValue('email'));<br />    }<br />    return answer;<br />}</pre><br /><br />* Call the script from a filter. Open the list of users, apply filter Email - is - javascript:duplicateEmail();<br />* Run it and view the list of users that have duplicate email values<br /><img  alt="" class="jive-image" src="044a9c0edb581f048c8ef4621f96193d.iix" style="width: 883px; height: auto;" /></p>