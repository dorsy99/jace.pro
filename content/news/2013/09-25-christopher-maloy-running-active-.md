---
title: "Running Active Directory CMDLETS in your workflow with Powershell"
date: 2013-09-24T19:14:45.000Z
authors: ["Christopher.Maloy"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=928da669dbd0dbc01dcaf3231f961986"
---
<p>I have had this bit of information for sometime and I have to thank a customer and friends of mine I was working with about a year ago: Roy Walton and Tim Warren. They are the brains behind this blog.<br /><br />If you are using ServiceNow Orchestration you probably know already that you can drag and drop Active Directory activities into a workflow and do some basic task (like reset password, update AD user accounts, create AD user accounts, etc). It may also be helpful for you to write your own Powershell script. There is an activity for that. <br /><br />If you want to leverage the AWESOME CMDLETS Microsoft provides in your Powershell you have to modify your MID server to include the libraries. Using these CMDLETS can really facilitate AD management when you get to know them. I am not the expert when it comes to AD administration - so if anyone has more to add to this blog - I'd be grateful.<br /><br />Here are the steps to take on your MID server so the AD CMDLETS are available:<br /><br />1. Go to "Server Manager"<br />2. Right click on Features and select Add Features<br />3. Scroll down to "Remote Server Administration Tools" and click the +<br />4. Find "Role Administration Tools" and click the plus<br />5. Find "AD DS and AD LDS Tools" and click the plus<br />6. Select the checkbox called "Active Directory Module for Windows PowerShell"<br />7. Install<br /><br /><b>FOR MS EXCHANGE:</b><br />Similarly, for Exchange 2010, you have to run Add-PSSnapin Microsoft.Exchange.Management.PowerShell.E2010 (and have the Exchange 2010 admin tools installed on the MID server).<br /><br />Before writing your Powershell now you will need to import the modules for active directory using:<br /><br />Import-Module ActiveDirectory<br /><br />For reference here is the documentation for the AD CMDLET API as well:<br />http://technet.microsoft.com/en-us/library/ee617195.aspx</p>