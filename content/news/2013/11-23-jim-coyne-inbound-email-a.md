---
title: "Inbound Email Actions Sanity Check"
date: 2013-11-22T07:55:09.000Z
authors: ["Jim Coyne"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=0c2de2e5dbd0dbc01dcaf3231f961932"
---
<p>I've been pretty busy lately with my switch over to Crossfuze Solutions and my blogging time has suffered a lot so I thought it was time to post a couple articles.<br /><br />A client of ours has an integration using an Inbound Email Action that reads emails from a specific user and creates new records based on the contents of the message, one record for each line in the email. It's meant to create a few records every couple of days and was working quite nicely until one day an email was mistakenly sent with over 2,000 lines in the message. Obviously it was an error on the transmission side, but the Inbound Email Action just chugged away and created all 2,000+ records.<br /><br />So in order to avoid the problem in the future, I added a simple check in the script to check how many records were sent to us. I won't put the whole script here, but you'll get a good idea:<br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br />(function(){<br />   // Parse email message<br />   var recordArray = email.body_text.split('\n');<br />   var numberOfRecords = recordArray.length;<br />   //assume a problem email if there are more than 20 records included<br />   if (numberOfRecords &lt; 21) {   //  &lt;&lt; *********** this is the important part<br />      for (i = 0; i &lt; numberOfRecords; i++) {<br />         //the code to create the actual records goes here<br />         ...<br />         ...<br />         ...<br />      }<br />   } else {<br />      gs.eventQueue("sys_email.u.mail_integration.max.records.exceeded", sys_email, null, null);<br />   }<br />   event.state="stop_processing";<br />})();</pre><br /><br />There is an email notification setup to fire on the event and send out an email to the ServiceNow administators group to investigate the email. So now we are safe if we ever receive an email with more than 20 entries in it.</p>