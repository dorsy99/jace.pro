---
title: "Installing And Setting Up OpenSSO To Use As Your SAML  IDP With ServiceNow"
date: 2013-04-05T20:58:34.000Z
authors: ["jason.petty"]
link: "https://community.servicenow.com/community?id=community_blog&sys_id=db3d2ee5dbd0dbc01dcaf3231f961936"
---
<p>I work a lot with customers setting up their SAML SSO solution. There have been a number of IDPs that the customers I have worked with use and I hardly ever get to see that side of the configuration. I wanted to understand what they had to do in order to set up their IDP to work with ServiceNow. I have documented the steps that I took to install and configure OpenAM (Formerly known as OpenSSO) to work with ServiceNow as my SAML 2.0 IDP. These instructions assume you are setting up your own virtual machine locally.<br /><br /><b>Setup Your Virtual Machine's Host file</b><br /><ol><li>Bring up a Linux VM in your favorite hypervisor</li><li>Set your host name in your network settings to something you can use in your hosts file like <b>openamtest</b></li><li>Modify your /etc/hosts file to have an entry like this:</li><li style="list-style: none"><br /> <ol><li><b>192.168.1.106 openamtest.org openamtest</b></li></ol><br /></li></ol><br /><b>Install Open DJ</b><br /><ol><li>Download OpenDJ-2.4.6 from <a title="rgerock.org/opendj-archive.html" href="http://forgerock.org/opendj-archive.html">Here</a> (Get the ZIP file)</li><li>Unzip the file</li><li>Run "./setup --cli"</li><li style="list-style: none"><br /> <ol><li>Put in an LDAP syntax for the root user for your LDAP Directory (cn=Directory Manager)</li><li style="list-style: none"><br /> <ol><li><b>What would you like to use as the initial root user DN for the Directory Server? [cn=Directory Manager]:</b></li></ol><br /></li><li>Set to port to something like 1389</li><li style="list-style: none"><br /> <ol><li><b>On which port would you like the Directory Server to accept connections from LDAP clients? [1389]:</b></li></ol><br /></li><li>Set the Administration Connector port to 4444</li><li style="list-style: none"><br /> <ol><li><b>On which port would you like the Administration Connector to accept connections? [4444]:</b></li></ol><br /></li><li>Create the base DNs of the server</li><li style="list-style: none"><br /> <ol><li><b>Do you want to create base DNs in the server? (yes / no) [yes]:</b></li></ol><br /></li><li>Provide the base DN:</li><li style="list-style: none"><br /> <ol><li><b>Provide the base DN for the directory data: [dc=example,dc=com]:</b></li></ol><br /></li><li>Only Create Base Entry:</li><li style="list-style: none"><br /> <ol><li><b>Options for populating the database:<br /><br />1) Only create the base entry<br />2) Leave the database empty<br />3) Import data from an LDIF file<br />4) Load automatically-generated sample data<br /><br />Enter choice [1]: 1</b></li></ol><br /></li><li>Don't enable SSL:</li><li style="list-style: none"><br /> <ol><li><b>Do you want to enable SSL? (yes / no) [no]:</b></li></ol><br /></li><li>Don't enable Start TLS:</li><li style="list-style: none"><br /> <ol><li><b>Do you want to enable Start TLS? (yes / no) [no]:</b></li></ol><br /></li><li>Chose Yes to start server when configuration is complete:</li><li style="list-style: none"><br /> <ol><li><b>Do you want to start the server when the configuration is completed? (yes / no) [yes]:</b></li></ol><br /></li><li>When you see the setup summary, choose "Set up server with parameters above":</li><li style="list-style: none"><br /> <ol><li><b>Setup Summary<br />=============<br />LDAP Listener Port: 1389<br />Administration Connector Port: 4444<br />LDAP Secure Access: disabled<br />Root User DN: cn=Directory Manager<br />Directory Data: Create New Base DN dc=example,dc=com.<br />Base DN Data: Only Create Base Entry (dc=example,dc=com)<br /><br />Start Server when the configuration is completed<br /><br />What would you like to do?<br /><br /> 1) Set up the server with the parameters above<br /> 2) Provide the setup parameters again<br /> 3) Print equivalent non-interactive command-line<br /> 4) Cancel and exit<br /><br />Enter choice [1]:</b></li></ol><br /></li><li>After it is done, you will see this:</li><li style="list-style: none"><br /> <ol><li><b>Configuring Directory Server ..... Done.<br />Creating Base Entry dc=example,dc=com ..... Done.<br />Starting Directory Server ........ Done.<br /><br /><br />To see basic server configuration status and configuration you can launch /opt/OpenDJ-2.4.6/bin/status</b></li></ol><br /></li></ol><br /><br /><b>Install Tomcat</b><br /><ol><li>Download Tomcat 7 from <a title="mcat.apache.org/download-70.cgi" href="http://tomcat.apache.org/download-70.cgi">Here</a> (Get the Zip File)</li><li>Unzip the file</li><li>CD to the apache/bin directory</li><li>Do a chmod 755 * in that folder</li><li>Modify the catalina.sh file and put in this line somewhere</li><li style="list-style: none"><br /> <ol><li><b>JAVA_OPTS="-Xmx1024m -XX:MaxPermSize=256m"</b></li></ol><br /></li><li>Run "./startup.sh"</li></ol><br /><br /><b>Install OpenAM (Formerly known as OpenSSO)</b><br /><ol><li>Download OpenAM 10.0.1 from <a title="rgerock.org/openam-archive.html" href="http://forgerock.org/openam-archive.html">Here</a> (Get the Zip File)</li><li>Unzip the file</li><li>Copy the <i>opensso/deployable-war/opensso.war</i> to the <i>apache/webapps</i> directory</li><li style="list-style: none"><br /> <ol><li>It will automatically deploy the war file and extract it to a folder in the webapps directory</li></ol><br /></li><li>Go to <a title="addressOfVm:8080/opensso/config/options.htm" href="http://ipaddressOfVm:8080/opensso/config/options.htm">http://ipaddressOfVm:8080/opensso/config/options.htm</a></li><li>Click on Create New Configuration</li><li>Type in a password on the first screen twice that you want to set</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/1.png" width="600" height="400" /><br /></li><li>On the next screen, make sure your ip address is in the first field like this:</li><li style="list-style: none"><br /> <ol><li>http://192.168.1.102:8080</li><li>Cookie Domain should be 192.168.1.102</li><li>Leave the rest default</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/2.png" width="600" height="400" /><br /></li></ol><br /></li><li>On the next screen, leave everything default and click next</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/3.png" width="600" height="400" /><br /></li><li>On the next screen, Choose OpenDJ as the type</li><li style="list-style: none"><br /> <ol><li>Hostname is localhost</li><li>Set the right port 1389</li><li>Set the Context to dc=example,dc=com like you did when setting up OpenDJ</li><li>Type in a password</li><li>Click next</li></ol><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/7.png" width="600" height="400" /><br /></li><li>Leave the next option set to no and click next</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/4.png" width="600" height="400" /><br /></li><li>Type in a password twice - it has to be different than the one you set in step 6 then click Next</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/5.png" width="600" height="400" /><br /></li><li>Click the Create Configuration button and let it run the configuration</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/6.png" width="600" height="400" /><br /></li><li>When the configuration finishes, click "proceed to login" or just login at this address: <a title="addressOfVm:8080/opensso/" href="http://ipaddressOfVm:8080/opensso/">http://ipaddressOfVm:8080/opensso/</a></li><li style="list-style: none"><br /> <ol><li><b>username:</b> amAdmin</li><li><b>password:</b> your password you set up in step 6 above</li></ol><br /></li><li>Create Users in your IDP</li><li style="list-style: none"><br /> <ol><li>Click on Access Control tab</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/8.png" width="600" height="400" /><br /></li><li>Click on the link "(Top Level Realm)" in the list of realms</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/9.png" width="600" height="250" /><br /></li><li>Click on Subjects tab</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/10.png" width="600" height="350" /><br /></li><li>Click on the New button</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/11.png" width="600" height="350" /><br /></li><li>Put in the id, First Name, Last Name, Password twice and then click OK</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/12.png" width="600" height="400" /><br /></li><li>Now open the details of that user you just created and put in an email that will match a user in ServiceNow</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/13.png" width="600" height="400" /><br /></li><li>Save</li><li>Click "Back to Subjects" button</li><li>Click "Back to Access Control" button</li></ol><br /></li><li>Increase the buffer length so signing won't fail</li><li style="list-style: none"><br /> <ol><li>Click on Configuration tab</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/14.png" width="600" height="400" /><br /></li><li>Click on Global sub-tab</li><li>Click on <b>SAMLv2 Service Configuration</b> property</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/15.png" width="600" height="500" /><br /></li><li>Add a 0 to the end of the Buffer Length value (last value)</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/16.png" width="600" height="500" /><br /></li><li>Save</li><li>Click "Back to Service Configuration" button</li></ol><br /></li><li>Create your IDP</li><li style="list-style: none"><br /> <ol><li>Click on Common Tasks Tab</li><li>Click on "Create Hosted Identity Provider"</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/17.png" width="600" height="400" /><br /></li><li>Set the Signing key to "test"</li><li>Type in the "Circle of Trust" field a name you want to name your IDP like "OpenSSOIdP"</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/18.png" width="600" height="500" /><br /></li><li>Click Configure</li><li>Click Finish</li></ol><br /></li><li>Get settings from OpenAM and set all your settings in your ServiceNow instance</li><li style="list-style: none"><br /> <ol><li>Click on Federation tab</li><li>In the "Entity Providers" section, click on the hyperlink of your IDP's ip address</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/19.png" width="600" height="500" /><br /></li><li>Click on the Services tab</li><li>Copy the appropriate values from here to your ServiceNow instance</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/21.png" width="600" height="700" /><br /></li><li>Set the values in your ServiceNow instance</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/20.png" width="600" height="300" /><br /></li><li>Click the "Back" button</li><li>Put the certificate in ServiceNow (This is the certificate for OpenSSO)</li><li style="list-style: none"><br /><pre __default_attr="plain" __jive_macro_name="code" class="jive_text_macro jive_macro_code"><br /><br /><br />-----BEGIN CERTIFICATE-----<br />MIICQDCCAakCBEeNB0swDQYJKoZIhvcNAQEEBQAwZzELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNh<br />bGlmb3JuaWExFDASBgNVBAcTC1NhbnRhIENsYXJhMQwwCgYDVQQKEwNTdW4xEDAOBgNVBAsTB09w<br />ZW5TU08xDTALBgNVBAMTBHRlc3QwHhcNMDgwMTE1MTkxOTM5WhcNMTgwMTEyMTkxOTM5WjBnMQsw<br />CQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEUMBIGA1UEBxMLU2FudGEgQ2xhcmExDDAK<br />BgNVBAoTA1N1bjEQMA4GA1UECxMHT3BlblNTTzENMAsGA1UEAxMEdGVzdDCBnzANBgkqhkiG9w0B<br />AQEFAAOBjQAwgYkCgYEArSQc/U75GB2AtKhbGS5piiLkmJzqEsp64rDxbMJ+xDrye0EN/q1U5Of+<br />RkDsaN/igkAvV1cuXEgTL6RlafFPcUX7QxDhZBhsYF9pbwtMzi4A4su9hnxIhURebGEmxKW9qJNY<br />Js0Vo5+IgjxuEWnjnnVgHTs1+mq5QYTA7E6ZyL8CAwEAATANBgkqhkiG9w0BAQQFAAOBgQB3Pw/U<br />QzPKTPTYi9upbFXlrAKMwtFf2OW4yvGWWvlcwcNSZJmTJ8ARvVYOMEVNbsT4OFcfu2/PeYoAdiDA<br />cGy/F2Zuj8XJJpuQRSE6PtQqBuDEHjjmOQJ0rV/r8mO1ZCtHRhpZ5zYRjhRC9eCbjx9VrFax0JDC<br />/FfwWigmrW0Y0Q==<br />-----END CERTIFICATE-----<br /></pre><br /></li></ol><br /></li><li>Create your SP</li><li style="list-style: none"><br /> <ol><li>Click on the Metadata module in ServiceNow</li><li>Copy it and save it to a file for later</li><li>Click on the Common Tasks tab</li><li>Click on "Register Remote Service Provider"</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/22.png" width="600" height="300" /><br /></li><li>Click on the File radio button</li><li>Click "Upload..." button"</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/23.png" width="600" height="300" /><br /></li><li>Browse to the file from step 2</li><li>Click "Upload File" button</li><li style="list-style: none"><br /><img src="http://www.hobbycache.com/images/servicenow/opensso/24.png" width="600" height="350" /><br /></li><li>Click "Configure" button</li><li>Click "OK" button when it pops up the successfully configured SP dialog</li></ol><br /></li></ol><br /><br /><b>Try to Login to ServiceNow</b></li></ol></p>